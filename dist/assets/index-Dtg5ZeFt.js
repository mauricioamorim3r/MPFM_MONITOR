var Zs=Object.defineProperty;var gs=r=>{throw TypeError(r)};var Qs=(r,e,s)=>e in r?Zs(r,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[e]=s;var Je=(r,e,s)=>Qs(r,typeof e!="symbol"?e+"":e,s),Ft=(r,e,s)=>e.has(r)||gs("Cannot "+s);var n=(r,e,s)=>(Ft(r,e,"read from private field"),s?s.call(r):e.get(r)),ne=(r,e,s)=>e.has(r)?gs("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,s),le=(r,e,s,t)=>(Ft(r,e,"write to private field"),t?t.call(r,s):e.set(r,s),s),J=(r,e,s)=>(Ft(r,e,"access private method"),s);var ht=(r,e,s,t)=>({set _(i){le(r,e,i,s)},get _(){return n(r,e,t)}});import{j as jsxRuntimeExports}from"./ui-DdXoV9Hu.js";import{a as reactDomExports,r as reactExports,g as getDefaultExportFromCjs,R as React$2,u as useLocation,b as useNavigate,d as getAugmentedNamespace,e as Routes,f as Route,N as Navigate,B as BrowserRouter}from"./vendor-D9FlTlAl.js";import{c as clsx,R as ResponsiveContainer,A as AreaChart,C as CartesianGrid,X as XAxis,Y as YAxis,T as Tooltip,a as ReferenceLine,b as Area,L as Legend,B as BarChart,d as Bar}from"./charts-D8KGVdYi.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))t(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&t(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}})();var client={},m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),createLucideIcon=(r,e)=>{const s=reactExports.forwardRef(({color:t="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:w="",children:S,...y},u)=>reactExports.createElement("svg",{ref:u,...defaultAttributes,width:i,height:i,stroke:t,strokeWidth:o?Number(a)*24/Number(i):a,className:["lucide",`lucide-${toKebabCase(r)}`,w].join(" "),...y},[...e.map(([h,l])=>reactExports.createElement(h,l)),...Array.isArray(S)?S:[S]]));return s.displayName=`${r}`,s};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Activity=createLucideIcon("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AlertCircle=createLucideIcon("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AlertTriangle=createLucideIcon("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ArrowDownRight=createLucideIcon("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ArrowUpRight=createLucideIcon("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BarChart3=createLucideIcon("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Beaker=createLucideIcon("Beaker",[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bell=createLucideIcon("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Calculator=createLucideIcon("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Calendar=createLucideIcon("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CheckCircle2=createLucideIcon("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CheckCircle=createLucideIcon("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Check=createLucideIcon("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronLeft=createLucideIcon("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronRight=createLucideIcon("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ClipboardList=createLucideIcon("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Clipboard=createLucideIcon("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Clock=createLucideIcon("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Database=createLucideIcon("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Download=createLucideIcon("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Droplets=createLucideIcon("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eye=createLucideIcon("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileCheck=createLucideIcon("FileCheck",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileText=createLucideIcon("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileUp=createLucideIcon("FileUp",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Filter=createLucideIcon("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Flame=createLucideIcon("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FlaskConical=createLucideIcon("FlaskConical",[["path",{d:"M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2",key:"pzvekw"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M7 16h10",key:"wp8him"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gauge=createLucideIcon("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Info=createLucideIcon("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Layers=createLucideIcon("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Loader2=createLucideIcon("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Menu=createLucideIcon("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PenLine=createLucideIcon("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PenSquare=createLucideIcon("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Play=createLucideIcon("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Plus=createLucideIcon("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Save=createLucideIcon("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Send=createLucideIcon("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Settings=createLucideIcon("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sparkles=createLucideIcon("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Target=createLucideIcon("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Trash2=createLucideIcon("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Upload=createLucideIcon("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const User=createLucideIcon("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Waves=createLucideIcon("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XCircle=createLucideIcon("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=createLucideIcon("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),CLASS_PART_SEPARATOR="-",createClassGroupUtils=r=>{const e=createClassMap(r),{conflictingClassGroups:s,conflictingClassGroupModifiers:t}=r;return{getClassGroupId:o=>{const w=o.split(CLASS_PART_SEPARATOR);return w[0]===""&&w.length!==1&&w.shift(),getGroupRecursive(w,e)||getGroupIdForArbitraryProperty(o)},getConflictingClassGroupIds:(o,w)=>{const S=s[o]||[];return w&&t[o]?[...S,...t[o]]:S}}},getGroupRecursive=(r,e)=>{var o;if(r.length===0)return e.classGroupId;const s=r[0],t=e.nextPart.get(s),i=t?getGroupRecursive(r.slice(1),t):void 0;if(i)return i;if(e.validators.length===0)return;const a=r.join(CLASS_PART_SEPARATOR);return(o=e.validators.find(({validator:w})=>w(a)))==null?void 0:o.classGroupId},arbitraryPropertyRegex=/^\[(.+)\]$/,getGroupIdForArbitraryProperty=r=>{if(arbitraryPropertyRegex.test(r)){const e=arbitraryPropertyRegex.exec(r)[1],s=e==null?void 0:e.substring(0,e.indexOf(":"));if(s)return"arbitrary.."+s}},createClassMap=r=>{const{theme:e,prefix:s}=r,t={nextPart:new Map,validators:[]};return getPrefixedClassGroupEntries(Object.entries(r.classGroups),s).forEach(([a,o])=>{processClassesRecursively(o,t,a,e)}),t},processClassesRecursively=(r,e,s,t)=>{r.forEach(i=>{if(typeof i=="string"){const a=i===""?e:getPart(e,i);a.classGroupId=s;return}if(typeof i=="function"){if(isThemeGetter(i)){processClassesRecursively(i(t),e,s,t);return}e.validators.push({validator:i,classGroupId:s});return}Object.entries(i).forEach(([a,o])=>{processClassesRecursively(o,getPart(e,a),s,t)})})},getPart=(r,e)=>{let s=r;return e.split(CLASS_PART_SEPARATOR).forEach(t=>{s.nextPart.has(t)||s.nextPart.set(t,{nextPart:new Map,validators:[]}),s=s.nextPart.get(t)}),s},isThemeGetter=r=>r.isThemeGetter,getPrefixedClassGroupEntries=(r,e)=>e?r.map(([s,t])=>{const i=t.map(a=>typeof a=="string"?e+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([o,w])=>[e+o,w])):a);return[s,i]}):r,createLruCache=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,s=new Map,t=new Map;const i=(a,o)=>{s.set(a,o),e++,e>r&&(e=0,t=s,s=new Map)};return{get(a){let o=s.get(a);if(o!==void 0)return o;if((o=t.get(a))!==void 0)return i(a,o),o},set(a,o){s.has(a)?s.set(a,o):i(a,o)}}},IMPORTANT_MODIFIER="!",createParseClassName=r=>{const{separator:e,experimentalParseClassName:s}=r,t=e.length===1,i=e[0],a=e.length,o=w=>{const S=[];let y=0,u=0,h;for(let f=0;f<w.length;f++){let p=w[f];if(y===0){if(p===i&&(t||w.slice(f,f+a)===e)){S.push(w.slice(u,f)),u=f+a;continue}if(p==="/"){h=f;continue}}p==="["?y++:p==="]"&&y--}const l=S.length===0?w:w.substring(u),c=l.startsWith(IMPORTANT_MODIFIER),b=c?l.substring(1):l,_=h&&h>u?h-u:void 0;return{modifiers:S,hasImportantModifier:c,baseClassName:b,maybePostfixModifierPosition:_}};return s?w=>s({className:w,parseClassName:o}):o},sortModifiers=r=>{if(r.length<=1)return r;const e=[];let s=[];return r.forEach(t=>{t[0]==="["?(e.push(...s.sort(),t),s=[]):s.push(t)}),e.push(...s.sort()),e},createConfigUtils=r=>({cache:createLruCache(r.cacheSize),parseClassName:createParseClassName(r),...createClassGroupUtils(r)}),SPLIT_CLASSES_REGEX=/\s+/,mergeClassList=(r,e)=>{const{parseClassName:s,getClassGroupId:t,getConflictingClassGroupIds:i}=e,a=[],o=r.trim().split(SPLIT_CLASSES_REGEX);let w="";for(let S=o.length-1;S>=0;S-=1){const y=o[S],{modifiers:u,hasImportantModifier:h,baseClassName:l,maybePostfixModifierPosition:c}=s(y);let b=!!c,_=t(b?l.substring(0,c):l);if(!_){if(!b){w=y+(w.length>0?" "+w:w);continue}if(_=t(l),!_){w=y+(w.length>0?" "+w:w);continue}b=!1}const f=sortModifiers(u).join(":"),p=h?f+IMPORTANT_MODIFIER:f,A=p+_;if(a.includes(A))continue;a.push(A);const k=i(_,b);for(let P=0;P<k.length;++P){const g=k[P];a.push(p+g)}w=y+(w.length>0?" "+w:w)}return w};function twJoin(){let r=0,e,s,t="";for(;r<arguments.length;)(e=arguments[r++])&&(s=toValue(e))&&(t&&(t+=" "),t+=s);return t}const toValue=r=>{if(typeof r=="string")return r;let e,s="";for(let t=0;t<r.length;t++)r[t]&&(e=toValue(r[t]))&&(s&&(s+=" "),s+=e);return s};function createTailwindMerge(r,...e){let s,t,i,a=o;function o(S){const y=e.reduce((u,h)=>h(u),r());return s=createConfigUtils(y),t=s.cache.get,i=s.cache.set,a=w,w(S)}function w(S){const y=t(S);if(y)return y;const u=mergeClassList(S,s);return i(S,u),u}return function(){return a(twJoin.apply(null,arguments))}}const fromTheme=r=>{const e=s=>s[r]||[];return e.isThemeGetter=!0,e},arbitraryValueRegex=/^\[(?:([a-z-]+):)?(.+)\]$/i,fractionRegex=/^\d+\/\d+$/,stringLengths=new Set(["px","full","screen"]),tshirtUnitRegex=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,lengthUnitRegex=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,colorFunctionRegex=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,shadowRegex=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,imageRegex=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,isLength=r=>isNumber(r)||stringLengths.has(r)||fractionRegex.test(r),isArbitraryLength=r=>getIsArbitraryValue(r,"length",isLengthOnly),isNumber=r=>!!r&&!Number.isNaN(Number(r)),isArbitraryNumber=r=>getIsArbitraryValue(r,"number",isNumber),isInteger=r=>!!r&&Number.isInteger(Number(r)),isPercent=r=>r.endsWith("%")&&isNumber(r.slice(0,-1)),isArbitraryValue=r=>arbitraryValueRegex.test(r),isTshirtSize=r=>tshirtUnitRegex.test(r),sizeLabels=new Set(["length","size","percentage"]),isArbitrarySize=r=>getIsArbitraryValue(r,sizeLabels,isNever),isArbitraryPosition=r=>getIsArbitraryValue(r,"position",isNever),imageLabels=new Set(["image","url"]),isArbitraryImage=r=>getIsArbitraryValue(r,imageLabels,isImage),isArbitraryShadow=r=>getIsArbitraryValue(r,"",isShadow),isAny=()=>!0,getIsArbitraryValue=(r,e,s)=>{const t=arbitraryValueRegex.exec(r);return t?t[1]?typeof e=="string"?t[1]===e:e.has(t[1]):s(t[2]):!1},isLengthOnly=r=>lengthUnitRegex.test(r)&&!colorFunctionRegex.test(r),isNever=()=>!1,isShadow=r=>shadowRegex.test(r),isImage=r=>imageRegex.test(r),getDefaultConfig=()=>{const r=fromTheme("colors"),e=fromTheme("spacing"),s=fromTheme("blur"),t=fromTheme("brightness"),i=fromTheme("borderColor"),a=fromTheme("borderRadius"),o=fromTheme("borderSpacing"),w=fromTheme("borderWidth"),S=fromTheme("contrast"),y=fromTheme("grayscale"),u=fromTheme("hueRotate"),h=fromTheme("invert"),l=fromTheme("gap"),c=fromTheme("gradientColorStops"),b=fromTheme("gradientColorStopPositions"),_=fromTheme("inset"),f=fromTheme("margin"),p=fromTheme("opacity"),A=fromTheme("padding"),k=fromTheme("saturate"),P=fromTheme("scale"),g=fromTheme("sepia"),R=fromTheme("skew"),E=fromTheme("space"),C=fromTheme("translate"),j=()=>["auto","contain","none"],z=()=>["auto","hidden","clip","visible","scroll"],v=()=>["auto",isArbitraryValue,e],T=()=>[isArbitraryValue,e],O=()=>["",isLength,isArbitraryLength],se=()=>["auto",isNumber,isArbitraryValue],V=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Q=()=>["solid","dashed","dotted","double","none"],K=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ue=()=>["start","end","center","between","around","evenly","stretch"],D=()=>["","0",isArbitraryValue],q=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ee=()=>[isNumber,isArbitraryValue];return{cacheSize:500,separator:":",theme:{colors:[isAny],spacing:[isLength,isArbitraryLength],blur:["none","",isTshirtSize,isArbitraryValue],brightness:ee(),borderColor:[r],borderRadius:["none","","full",isTshirtSize,isArbitraryValue],borderSpacing:T(),borderWidth:O(),contrast:ee(),grayscale:D(),hueRotate:ee(),invert:D(),gap:T(),gradientColorStops:[r],gradientColorStopPositions:[isPercent,isArbitraryLength],inset:v(),margin:v(),opacity:ee(),padding:T(),saturate:ee(),scale:ee(),sepia:D(),skew:ee(),space:T(),translate:T()},classGroups:{aspect:[{aspect:["auto","square","video",isArbitraryValue]}],container:["container"],columns:[{columns:[isTshirtSize]}],"break-after":[{"break-after":q()}],"break-before":[{"break-before":q()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...V(),isArbitraryValue]}],overflow:[{overflow:z()}],"overflow-x":[{"overflow-x":z()}],"overflow-y":[{"overflow-y":z()}],overscroll:[{overscroll:j()}],"overscroll-x":[{"overscroll-x":j()}],"overscroll-y":[{"overscroll-y":j()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[_]}],"inset-x":[{"inset-x":[_]}],"inset-y":[{"inset-y":[_]}],start:[{start:[_]}],end:[{end:[_]}],top:[{top:[_]}],right:[{right:[_]}],bottom:[{bottom:[_]}],left:[{left:[_]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",isInteger,isArbitraryValue]}],basis:[{basis:v()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",isArbitraryValue]}],grow:[{grow:D()}],shrink:[{shrink:D()}],order:[{order:["first","last","none",isInteger,isArbitraryValue]}],"grid-cols":[{"grid-cols":[isAny]}],"col-start-end":[{col:["auto",{span:["full",isInteger,isArbitraryValue]},isArbitraryValue]}],"col-start":[{"col-start":se()}],"col-end":[{"col-end":se()}],"grid-rows":[{"grid-rows":[isAny]}],"row-start-end":[{row:["auto",{span:[isInteger,isArbitraryValue]},isArbitraryValue]}],"row-start":[{"row-start":se()}],"row-end":[{"row-end":se()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",isArbitraryValue]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",isArbitraryValue]}],gap:[{gap:[l]}],"gap-x":[{"gap-x":[l]}],"gap-y":[{"gap-y":[l]}],"justify-content":[{justify:["normal",...ue()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...ue(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...ue(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[A]}],px:[{px:[A]}],py:[{py:[A]}],ps:[{ps:[A]}],pe:[{pe:[A]}],pt:[{pt:[A]}],pr:[{pr:[A]}],pb:[{pb:[A]}],pl:[{pl:[A]}],m:[{m:[f]}],mx:[{mx:[f]}],my:[{my:[f]}],ms:[{ms:[f]}],me:[{me:[f]}],mt:[{mt:[f]}],mr:[{mr:[f]}],mb:[{mb:[f]}],ml:[{ml:[f]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",isArbitraryValue,e]}],"min-w":[{"min-w":[isArbitraryValue,e,"min","max","fit"]}],"max-w":[{"max-w":[isArbitraryValue,e,"none","full","min","max","fit","prose",{screen:[isTshirtSize]},isTshirtSize]}],h:[{h:[isArbitraryValue,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[isArbitraryValue,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[isArbitraryValue,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[isArbitraryValue,e,"auto","min","max","fit"]}],"font-size":[{text:["base",isTshirtSize,isArbitraryLength]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",isArbitraryNumber]}],"font-family":[{font:[isAny]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",isArbitraryValue]}],"line-clamp":[{"line-clamp":["none",isNumber,isArbitraryNumber]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",isLength,isArbitraryValue]}],"list-image":[{"list-image":["none",isArbitraryValue]}],"list-style-type":[{list:["none","disc","decimal",isArbitraryValue]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[p]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[p]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Q(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",isLength,isArbitraryLength]}],"underline-offset":[{"underline-offset":["auto",isLength,isArbitraryValue]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",isArbitraryValue]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",isArbitraryValue]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[p]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...V(),isArbitraryPosition]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",isArbitrarySize]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},isArbitraryImage]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[c]}],"gradient-via":[{via:[c]}],"gradient-to":[{to:[c]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[w]}],"border-w-x":[{"border-x":[w]}],"border-w-y":[{"border-y":[w]}],"border-w-s":[{"border-s":[w]}],"border-w-e":[{"border-e":[w]}],"border-w-t":[{"border-t":[w]}],"border-w-r":[{"border-r":[w]}],"border-w-b":[{"border-b":[w]}],"border-w-l":[{"border-l":[w]}],"border-opacity":[{"border-opacity":[p]}],"border-style":[{border:[...Q(),"hidden"]}],"divide-x":[{"divide-x":[w]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[w]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[p]}],"divide-style":[{divide:Q()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...Q()]}],"outline-offset":[{"outline-offset":[isLength,isArbitraryValue]}],"outline-w":[{outline:[isLength,isArbitraryLength]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[p]}],"ring-offset-w":[{"ring-offset":[isLength,isArbitraryLength]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",isTshirtSize,isArbitraryShadow]}],"shadow-color":[{shadow:[isAny]}],opacity:[{opacity:[p]}],"mix-blend":[{"mix-blend":[...K(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":K()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[t]}],contrast:[{contrast:[S]}],"drop-shadow":[{"drop-shadow":["","none",isTshirtSize,isArbitraryValue]}],grayscale:[{grayscale:[y]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[k]}],sepia:[{sepia:[g]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[t]}],"backdrop-contrast":[{"backdrop-contrast":[S]}],"backdrop-grayscale":[{"backdrop-grayscale":[y]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[p]}],"backdrop-saturate":[{"backdrop-saturate":[k]}],"backdrop-sepia":[{"backdrop-sepia":[g]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",isArbitraryValue]}],duration:[{duration:ee()}],ease:[{ease:["linear","in","out","in-out",isArbitraryValue]}],delay:[{delay:ee()}],animate:[{animate:["none","spin","ping","pulse","bounce",isArbitraryValue]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[P]}],"scale-x":[{"scale-x":[P]}],"scale-y":[{"scale-y":[P]}],rotate:[{rotate:[isInteger,isArbitraryValue]}],"translate-x":[{"translate-x":[C]}],"translate-y":[{"translate-y":[C]}],"skew-x":[{"skew-x":[R]}],"skew-y":[{"skew-y":[R]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",isArbitraryValue]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",isArbitraryValue]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",isArbitraryValue]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[isLength,isArbitraryLength,isArbitraryNumber]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},twMerge=createTailwindMerge(getDefaultConfig);function cn(...r){return twMerge(clsx(r))}function formatNumber(r,e=2){return r.toLocaleString("pt-BR",{minimumFractionDigits:e,maximumFractionDigits:e})}function formatDate(r,e="short"){const s=typeof r=="string"?new Date(r):r;return e==="long"?s.toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"}):s.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})}function formatDateTime(r){const e=typeof r=="string"?new Date(r):r;return`${formatDate(e)} ${e.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`}const modules=[{id:"monitoring",label:"Monitoramento SGM-FM",icon:Activity,description:"Variáveis críticas"},{id:"calibration",label:"Avaliação de Desempenho",icon:Gauge,description:"Calibração MPFM"},{id:"compliance",label:"Conformidade ANP",icon:FileCheck,description:"RANP 44/2015"},{id:"desenquadramento",label:"Desenquadramento",icon:AlertTriangle,description:"Seção 10 RANP44"}];function Sidebar({activeModule:r,onModuleChange:e,collapsed:s}){return jsxRuntimeExports.jsxs("aside",{className:cn("bg-zinc-900 border-r border-zinc-800 flex flex-col transition-all duration-200 flex-shrink-0",s?"w-16":"w-56"),children:[jsxRuntimeExports.jsx("div",{className:"p-3 border-b border-zinc-800",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-700 rounded-lg flex items-center justify-center flex-shrink-0",children:jsxRuntimeExports.jsx(Droplets,{className:"w-6 h-6 text-white"})}),!s&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-bold text-sm",children:"MPFM Monitor"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-zinc-500",children:"FPSO Bacalhau"})]})]})}),jsxRuntimeExports.jsx("nav",{className:"flex-1 p-2 space-y-1",children:modules.map(t=>{const i=t.icon,a=r===t.id;return jsxRuntimeExports.jsxs("button",{onClick:()=>e(t.id),className:cn("w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition text-sm",a?"bg-blue-600 text-white":"hover:bg-zinc-800 text-zinc-400"),children:[jsxRuntimeExports.jsx(i,{className:"w-5 h-5 flex-shrink-0"}),!s&&jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsx("div",{className:"text-xs font-medium",children:t.label}),jsxRuntimeExports.jsx("div",{className:"text-[10px] opacity-60",children:t.description})]})]},t.id)})}),jsxRuntimeExports.jsx("div",{className:"p-3 border-t border-zinc-800",children:!s&&jsxRuntimeExports.jsxs("div",{className:"text-xs text-zinc-500",children:[jsxRuntimeExports.jsx("div",{children:"RANP 44/2015 ANP"}),jsxRuntimeExports.jsx("div",{className:"text-zinc-600",children:"v2.1.0"})]})})]})}const variantStyles$1={default:"bg-zinc-700 text-zinc-300",success:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",warning:"bg-amber-500/20 text-amber-400 border border-amber-500/30",error:"bg-red-500/20 text-red-400 border border-red-500/30",danger:"bg-red-500/20 text-red-400 border border-red-500/30",info:"bg-blue-500/20 text-blue-400 border border-blue-500/30",purple:"bg-purple-500/20 text-purple-400 border border-purple-500/30",secondary:"bg-zinc-600/20 text-zinc-300 border border-zinc-500/30",OK:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",ALERT:"bg-amber-500/20 text-amber-400 border border-amber-500/30",FAIL:"bg-red-500/20 text-red-400 border border-red-500/30",ERROR:"bg-red-500/20 text-red-400 border border-red-500/30",Dentro:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",Fora:"bg-red-500/20 text-red-400 border border-red-500/30",active:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",inactive:"bg-zinc-600/20 text-zinc-400 border border-zinc-500/30",TOPSIDE:"bg-purple-500/20 text-purple-400 border border-purple-500/30",SUBSEA:"bg-blue-500/20 text-blue-400 border border-blue-500/30",MONITORAR:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",INVESTIGAR:"bg-red-500/20 text-red-400 border border-red-500/30",Pendente:"bg-amber-500/20 text-amber-400 border border-amber-500/30",Parcial:"bg-blue-500/20 text-blue-400 border border-blue-500/30",Crítico:"bg-red-500/20 text-red-400 border border-red-500/30",Alerta:"bg-amber-500/20 text-amber-400 border border-amber-500/30",Aberto:"bg-red-500/20 text-red-400 border border-red-500/30","Em Investigação":"bg-amber-500/20 text-amber-400 border border-amber-500/30","Plano de Ação":"bg-blue-500/20 text-blue-400 border border-blue-500/30","Aguardando Validação":"bg-purple-500/20 text-purple-400 border border-purple-500/30",Concluído:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30","Enviado ANP":"bg-cyan-500/20 text-cyan-400 border border-cyan-500/30"},sizeStyles$2={sm:"px-1.5 py-0.5 text-[10px]",default:"px-2 py-0.5 text-xs"};function Badge({variant:r="default",size:e="default",children:s,className:t}){return jsxRuntimeExports.jsx("span",{className:cn("rounded-full font-medium inline-flex items-center",variantStyles$1[r],sizeStyles$2[e],t),children:s})}const variantStyles={primary:"bg-blue-600 hover:bg-blue-700 text-white",secondary:"bg-zinc-800 hover:bg-zinc-700 text-white border border-zinc-700",success:"bg-emerald-600 hover:bg-emerald-700 text-white",danger:"bg-red-600 hover:bg-red-700 text-white",ghost:"hover:bg-zinc-800 text-zinc-400",outline:"border border-zinc-600 hover:bg-zinc-800 text-zinc-300"},sizeStyles$1={xs:"px-2 py-1 text-xs",sm:"px-2 py-1.5 text-xs",default:"px-3 py-1.5 text-sm",lg:"px-4 py-2 text-sm"},iconSizes={xs:"w-3 h-3",sm:"w-3.5 h-3.5",default:"w-4 h-4",lg:"w-4 h-4"},Button=reactExports.forwardRef(({variant:r="primary",size:e="default",icon:s,loading:t=!1,disabled:i,className:a,children:o,...w},S)=>jsxRuntimeExports.jsxs("button",{ref:S,disabled:i||t,className:cn("flex items-center justify-center gap-1.5 rounded-lg font-medium transition",variantStyles[r],sizeStyles$1[e],(i||t)&&"opacity-50 cursor-not-allowed",a),...w,children:[t?jsxRuntimeExports.jsxs("svg",{className:cn("animate-spin",iconSizes[e]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):s?jsxRuntimeExports.jsx(s,{className:iconSizes[e]}):null,o]}));Button.displayName="Button";function Card({children:r,className:e,title:s,subtitle:t,headerRight:i,noPadding:a=!1}){return jsxRuntimeExports.jsxs("div",{className:cn("bg-zinc-900/80 border border-zinc-800 rounded-xl",e),children:[s&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-zinc-800",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-white",children:s}),t&&jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:t})]}),i]}),jsxRuntimeExports.jsx("div",{className:a?"":"p-4",children:r})]})}const Input=reactExports.forwardRef(({label:r,unit:e,error:s,inputSize:t="default",disabled:i,readOnly:a,className:o,...w},S)=>jsxRuntimeExports.jsxs("div",{className:cn("space-y-1",o),children:[r&&jsxRuntimeExports.jsx("label",{className:"text-xs text-zinc-400",children:r}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("input",{ref:S,disabled:i,readOnly:a,className:cn("w-full bg-zinc-800 border rounded text-white placeholder-zinc-500 focus:outline-none focus:border-blue-500",s?"border-red-500":"border-zinc-700",(i||a)&&"opacity-60 cursor-not-allowed",t==="sm"?"px-2 py-1 text-xs":"px-3 py-2 text-sm",e&&"pr-12"),...w}),e&&jsxRuntimeExports.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-zinc-500",children:e})]}),s&&jsxRuntimeExports.jsx("p",{className:"text-xs text-red-400",children:s})]}));Input.displayName="Input";const Select=reactExports.forwardRef(({label:r,options:e,selectSize:s="default",error:t,disabled:i,className:a,...o},w)=>jsxRuntimeExports.jsxs("div",{className:cn("space-y-1",a),children:[r&&jsxRuntimeExports.jsx("label",{className:"text-xs text-zinc-400",children:r}),jsxRuntimeExports.jsx("select",{ref:w,disabled:i,className:cn("w-full bg-zinc-800 border border-zinc-700 rounded text-white focus:outline-none focus:border-blue-500",i&&"opacity-60 cursor-not-allowed",t&&"border-red-500",s==="sm"?"px-2 py-1 text-xs":"px-3 py-2 text-sm"),...o,children:e.map(S=>jsxRuntimeExports.jsx("option",{value:S.value,children:S.label},S.value))}),t&&jsxRuntimeExports.jsx("p",{className:"text-xs text-red-400",children:t})]}));Select.displayName="Select";const sizeStyles={sm:"max-w-sm",md:"max-w-md",default:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};function Modal({isOpen:r,onClose:e,title:s,children:t,size:i="default"}){return reactExports.useEffect(()=>{const a=o=>{o.key==="Escape"&&e()};return r&&(document.addEventListener("keydown",a),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",a),document.body.style.overflow="unset"}},[r,e]),r?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:cn("bg-zinc-900 border border-zinc-800 rounded-xl w-full max-h-[90vh] flex flex-col",sizeStyles[i]),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-zinc-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-white",children:s}),jsxRuntimeExports.jsx("button",{onClick:e,title:"Fechar",className:"p-1 hover:bg-zinc-800 rounded-lg transition",children:jsxRuntimeExports.jsx(X,{className:"w-4 h-4 text-zinc-400"})})]}),jsxRuntimeExports.jsx("div",{className:"p-4 overflow-y-auto flex-1",children:t})]})}):null}function Tabs({tabs:r,activeTab:e,onChange:s,className:t}){return jsxRuntimeExports.jsx("div",{className:cn("flex gap-1 p-1 bg-zinc-800/50 rounded-lg",t),children:r.map(i=>jsxRuntimeExports.jsxs("button",{onClick:()=>s(i.id),className:cn("px-3 py-1.5 text-xs font-medium rounded-md transition flex items-center gap-1.5",e===i.id?"bg-blue-600 text-white":"text-zinc-400 hover:text-white hover:bg-zinc-700"),children:[i.icon&&jsxRuntimeExports.jsx(i.icon,{className:"w-3.5 h-3.5"}),i.label,i.count!==void 0&&jsxRuntimeExports.jsx("span",{className:cn("px-1.5 py-0.5 rounded-full text-[10px]",e===i.id?"bg-white/20":"bg-zinc-700"),children:i.count})]},i.id))})}const colorStyles$2={blue:"from-blue-500/20 to-blue-600/5 border-blue-500/30",emerald:"from-emerald-500/20 to-emerald-600/5 border-emerald-500/30",amber:"from-amber-500/20 to-amber-600/5 border-amber-500/30",red:"from-red-500/20 to-red-600/5 border-red-500/30",purple:"from-purple-500/20 to-purple-600/5 border-purple-500/30"},iconColors={blue:"text-blue-400",emerald:"text-emerald-400",amber:"text-amber-400",red:"text-red-400",purple:"text-purple-400"};function KPICard({title:r,value:e,unit:s,subtitle:t,icon:i,color:a,trend:o,onClick:w,className:S}){return jsxRuntimeExports.jsx("div",{className:cn("bg-gradient-to-br border rounded-xl p-3",colorStyles$2[a],w&&"cursor-pointer hover:brightness-110 transition",S),onClick:w,children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-400",children:r}),jsxRuntimeExports.jsxs("div",{className:"flex items-baseline gap-1 mt-1",children:[jsxRuntimeExports.jsx("span",{className:"text-xl font-bold text-white",children:e}),s&&jsxRuntimeExports.jsx("span",{className:"text-xs text-zinc-400",children:s})]}),t&&jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:t}),o!==void 0&&o!==0&&jsxRuntimeExports.jsxs("div",{className:cn("flex items-center gap-1 mt-1 text-xs",o>0?"text-emerald-400":"text-red-400"),children:[o>0?jsxRuntimeExports.jsx(ArrowUpRight,{className:"w-3 h-3"}):jsxRuntimeExports.jsx(ArrowDownRight,{className:"w-3 h-3"}),jsxRuntimeExports.jsxs("span",{children:[Math.abs(o),"%"]})]})]}),jsxRuntimeExports.jsx("div",{className:cn("p-2 rounded-lg bg-zinc-800/50",iconColors[a]),children:jsxRuntimeExports.jsx(i,{className:"w-4 h-4"})})]})})}const colorStyles$1={blue:"bg-blue-500",emerald:"bg-emerald-500",amber:"bg-amber-500",red:"bg-red-500",purple:"bg-purple-500"};function ProgressBar({value:r,max:e=100,color:s="blue",showLabel:t=!0,size:i="default",className:a}){const o=Math.min(r/e*100,100),S=s==="auto"?o>=100?"bg-red-500":o>=70?"bg-amber-500":"bg-emerald-500":colorStyles$1[s];return jsxRuntimeExports.jsxs("div",{className:cn("space-y-1",a),children:[jsxRuntimeExports.jsx("div",{className:cn("bg-zinc-800 rounded-full overflow-hidden",i==="sm"?"h-1.5":"h-2"),children:jsxRuntimeExports.jsx("div",{className:cn("h-full rounded-full transition-all",S),style:{width:`${o}%`}})}),t&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs text-zinc-500",children:[jsxRuntimeExports.jsx("span",{children:r}),jsxRuntimeExports.jsx("span",{children:e})]})]})}function StepIndicator({steps:r,currentStep:e,onStepClick:s,className:t}){return jsxRuntimeExports.jsx("div",{className:cn("flex items-center gap-1 overflow-x-auto pb-1",t),children:r.map((i,a)=>{const o=a+1,w=o<e,S=o===e,y=o>e;return jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>s==null?void 0:s(o),className:cn("flex items-center gap-1.5 px-2 py-1 rounded-lg transition flex-shrink-0",S&&"bg-blue-600 text-white",w&&"bg-emerald-500/20 text-emerald-400 hover:bg-emerald-500/30",y&&"bg-zinc-800 text-zinc-500 hover:bg-zinc-700"),children:[jsxRuntimeExports.jsx("div",{className:cn("w-5 h-5 rounded-full flex items-center justify-center text-xs font-medium",w&&"bg-emerald-500 text-white",S&&"bg-white text-blue-600",y&&"bg-zinc-700 text-zinc-400"),children:w?jsxRuntimeExports.jsx(Check,{className:"w-3 h-3"}):o}),jsxRuntimeExports.jsx("span",{className:"text-xs hidden lg:inline whitespace-nowrap",children:i})]}),a<r.length-1&&jsxRuntimeExports.jsx("div",{className:cn("w-4 h-px flex-shrink-0 mx-1",w?"bg-emerald-500":"bg-zinc-700")})]},a)})})}const colorStyles={blue:"text-blue-400 bg-blue-500/10",purple:"text-purple-400 bg-purple-500/10",amber:"text-amber-400 bg-amber-500/10",emerald:"text-emerald-400 bg-emerald-500/10",red:"text-red-400 bg-red-500/10"};function SectionHeader({icon:r,title:e,color:s="blue",action:t,className:i}){return jsxRuntimeExports.jsxs("div",{className:cn("flex items-center justify-between px-3 py-2 rounded-lg mb-3",colorStyles[s],i),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(r,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",children:e})]}),t]})}const ToastContext=reactExports.createContext(null);function ToastProvider({children:r}){const[e,s]=reactExports.useState([]),t=reactExports.useCallback(y=>{s(u=>u.filter(h=>h.id!==y))},[]),i=reactExports.useCallback(y=>{const u=`toast-${Date.now()}-${Math.random().toString(36).substr(2,5)}`,h={...y,id:u};s(c=>[...c,h]);const l=y.duration||5e3;setTimeout(()=>{t(u)},l)},[t]),a=reactExports.useCallback((y,u)=>i({type:"success",title:y,message:u}),[i]),o=reactExports.useCallback((y,u)=>i({type:"error",title:y,message:u,duration:8e3}),[i]),w=reactExports.useCallback((y,u)=>i({type:"warning",title:y,message:u}),[i]),S=reactExports.useCallback((y,u)=>i({type:"info",title:y,message:u}),[i]);return jsxRuntimeExports.jsxs(ToastContext.Provider,{value:{toasts:e,addToast:i,removeToast:t,success:a,error:o,warning:w,info:S},children:[r,jsxRuntimeExports.jsx(ToastContainer,{toasts:e,onRemove:t})]})}function useToast(){const r=reactExports.useContext(ToastContext);if(!r)throw new Error("useToast deve ser usado dentro de ToastProvider");return r}function ToastContainer({toasts:r,onRemove:e}){return r.length===0?null:jsxRuntimeExports.jsx("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col gap-2 max-w-md",children:r.map(s=>jsxRuntimeExports.jsx(ToastItem,{toast:s,onRemove:e},s.id))})}function ToastItem({toast:r,onRemove:e}){const[s,t]=reactExports.useState(!1),i=()=>{t(!0),setTimeout(()=>e(r.id),200)},a={success:CheckCircle,error:XCircle,warning:AlertTriangle,info:Info},o={success:"bg-emerald-500/10 border-emerald-500/30 text-emerald-400",error:"bg-red-500/10 border-red-500/30 text-red-400",warning:"bg-amber-500/10 border-amber-500/30 text-amber-400",info:"bg-blue-500/10 border-blue-500/30 text-blue-400"},w=a[r.type];return jsxRuntimeExports.jsxs("div",{className:cn("flex items-start gap-3 p-4 rounded-lg border backdrop-blur-sm","min-w-[300px] shadow-lg transition-all duration-200",s?"opacity-0 translate-x-4":"opacity-100 translate-x-0",o[r.type]),children:[jsxRuntimeExports.jsx(w,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-white",children:r.title}),r.message&&jsxRuntimeExports.jsx("p",{className:"text-sm opacity-80 mt-1",children:r.message})]}),jsxRuntimeExports.jsx("button",{onClick:i,className:"text-zinc-500 hover:text-white transition-colors p-1",title:"Fechar notificação","aria-label":"Fechar notificação",children:jsxRuntimeExports.jsx(X,{className:"w-4 h-4"})})]})}function Header({title:r,subtitle:e,onToggleSidebar:s,onImport:t,onExport:i,alertCount:a=0}){return jsxRuntimeExports.jsxs("header",{className:"h-14 bg-zinc-900 border-b border-zinc-800 flex items-center justify-between px-4 flex-shrink-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:s,title:"Menu",className:"p-2 hover:bg-zinc-800 rounded-lg transition",children:jsxRuntimeExports.jsx(Menu,{className:"w-5 h-5 text-zinc-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-sm font-semibold",children:r}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:e||`Última atualização: ${formatDateTime(new Date)}`})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[t&&jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:Upload,onClick:t,children:"Importar"}),i&&jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:Download,onClick:i,children:"Exportar"}),jsxRuntimeExports.jsxs("button",{title:"Notificações",className:"relative p-2 hover:bg-zinc-800 rounded-lg transition",children:[jsxRuntimeExports.jsx(Bell,{className:"w-5 h-5 text-zinc-400"}),a>0&&jsxRuntimeExports.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),jsxRuntimeExports.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-xs font-medium",children:"MA"})]})]})}const __vite_import_meta_env__$2={},createStoreImpl=r=>{let e;const s=new Set,t=(u,h)=>{const l=typeof u=="function"?u(e):u;if(!Object.is(l,e)){const c=e;e=h??(typeof l!="object"||l===null)?l:Object.assign({},e,l),s.forEach(b=>b(e,c))}},i=()=>e,S={setState:t,getState:i,getInitialState:()=>y,subscribe:u=>(s.add(u),()=>s.delete(u)),destroy:()=>{(__vite_import_meta_env__$2?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},y=e=r(t,i,S);return S},createStore=r=>r?createStoreImpl(r):createStoreImpl;var withSelector={exports:{}},withSelector_production={},shim$2={exports:{}},useSyncExternalStoreShim_production={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React$1=reactExports;function is$1(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var objectIs$1=typeof Object.is=="function"?Object.is:is$1,useState=React$1.useState,useEffect$1=React$1.useEffect,useLayoutEffect=React$1.useLayoutEffect,useDebugValue$2=React$1.useDebugValue;function useSyncExternalStore$2(r,e){var s=e(),t=useState({inst:{value:s,getSnapshot:e}}),i=t[0].inst,a=t[1];return useLayoutEffect(function(){i.value=s,i.getSnapshot=e,checkIfSnapshotChanged(i)&&a({inst:i})},[r,s,e]),useEffect$1(function(){return checkIfSnapshotChanged(i)&&a({inst:i}),r(function(){checkIfSnapshotChanged(i)&&a({inst:i})})},[r]),useDebugValue$2(s),s}function checkIfSnapshotChanged(r){var e=r.getSnapshot;r=r.value;try{var s=e();return!objectIs$1(r,s)}catch{return!0}}function useSyncExternalStore$1(r,e){return e()}var shim$1=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?useSyncExternalStore$1:useSyncExternalStore$2;useSyncExternalStoreShim_production.useSyncExternalStore=React$1.useSyncExternalStore!==void 0?React$1.useSyncExternalStore:shim$1;shim$2.exports=useSyncExternalStoreShim_production;var shimExports=shim$2.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React=reactExports,shim=shimExports;function is(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var objectIs=typeof Object.is=="function"?Object.is:is,useSyncExternalStore=shim.useSyncExternalStore,useRef=React.useRef,useEffect=React.useEffect,useMemo=React.useMemo,useDebugValue$1=React.useDebugValue;withSelector_production.useSyncExternalStoreWithSelector=function(r,e,s,t,i){var a=useRef(null);if(a.current===null){var o={hasValue:!1,value:null};a.current=o}else o=a.current;a=useMemo(function(){function S(c){if(!y){if(y=!0,u=c,c=t(c),i!==void 0&&o.hasValue){var b=o.value;if(i(b,c))return h=b}return h=c}if(b=h,objectIs(u,c))return b;var _=t(c);return i!==void 0&&i(b,_)?(u=c,b):(u=c,h=_)}var y=!1,u,h,l=s===void 0?null:s;return[function(){return S(e())},l===null?void 0:function(){return S(l())}]},[e,s,t,i]);var w=useSyncExternalStore(r,a[0],a[1]);return useEffect(function(){o.hasValue=!0,o.value=w},[w]),useDebugValue$1(w),w};withSelector.exports=withSelector_production;var withSelectorExports=withSelector.exports;const useSyncExternalStoreExports=getDefaultExportFromCjs(withSelectorExports),__vite_import_meta_env__$1={},{useDebugValue}=React$2,{useSyncExternalStoreWithSelector}=useSyncExternalStoreExports;let didWarnAboutEqualityFn=!1;const identity=r=>r;function useStore(r,e=identity,s){(__vite_import_meta_env__$1?"production":void 0)!=="production"&&s&&!didWarnAboutEqualityFn&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),didWarnAboutEqualityFn=!0);const t=useSyncExternalStoreWithSelector(r.subscribe,r.getState,r.getServerState||r.getInitialState,e,s);return useDebugValue(t),t}const createImpl=r=>{(__vite_import_meta_env__$1?"production":void 0)!=="production"&&typeof r!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof r=="function"?createStore(r):r,s=(t,i)=>useStore(e,t,i);return Object.assign(s,e),s},create=r=>createImpl,__vite_import_meta_env__={};function createJSONStorage(r,e){let s;try{s=r()}catch{return}return{getItem:i=>{var a;const o=S=>S===null?null:JSON.parse(S,void 0),w=(a=s.getItem(i))!=null?a:null;return w instanceof Promise?w.then(o):o(w)},setItem:(i,a)=>s.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>s.removeItem(i)}}const toThenable=r=>e=>{try{const s=r(e);return s instanceof Promise?s:{then(t){return toThenable(t)(s)},catch(t){return this}}}catch(s){return{then(t){return this},catch(t){return toThenable(t)(s)}}}},oldImpl=(r,e)=>(s,t,i)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:f=>f,version:0,merge:(f,p)=>({...p,...f}),...e},o=!1;const w=new Set,S=new Set;let y;try{y=a.getStorage()}catch{}if(!y)return r((...f)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),s(...f)},t,i);const u=toThenable(a.serialize),h=()=>{const f=a.partialize({...t()});let p;const A=u({state:f,version:a.version}).then(k=>y.setItem(a.name,k)).catch(k=>{p=k});if(p)throw p;return A},l=i.setState;i.setState=(f,p)=>{l(f,p),h()};const c=r((...f)=>{s(...f),h()},t,i);let b;const _=()=>{var f;if(!y)return;o=!1,w.forEach(A=>A(t()));const p=((f=a.onRehydrateStorage)==null?void 0:f.call(a,t()))||void 0;return toThenable(y.getItem.bind(y))(a.name).then(A=>{if(A)return a.deserialize(A)}).then(A=>{if(A)if(typeof A.version=="number"&&A.version!==a.version){if(a.migrate)return a.migrate(A.state,A.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return A.state}).then(A=>{var k;return b=a.merge(A,(k=t())!=null?k:c),s(b,!0),h()}).then(()=>{p==null||p(b,void 0),o=!0,S.forEach(A=>A(b))}).catch(A=>{p==null||p(void 0,A)})};return i.persist={setOptions:f=>{a={...a,...f},f.getStorage&&(y=f.getStorage())},clearStorage:()=>{y==null||y.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:f=>(w.add(f),()=>{w.delete(f)}),onFinishHydration:f=>(S.add(f),()=>{S.delete(f)})},_(),b||c},newImpl=(r,e)=>(s,t,i)=>{let a={storage:createJSONStorage(()=>localStorage),partialize:_=>_,version:0,merge:(_,f)=>({...f,..._}),...e},o=!1;const w=new Set,S=new Set;let y=a.storage;if(!y)return r((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),s(..._)},t,i);const u=()=>{const _=a.partialize({...t()});return y.setItem(a.name,{state:_,version:a.version})},h=i.setState;i.setState=(_,f)=>{h(_,f),u()};const l=r((..._)=>{s(..._),u()},t,i);i.getInitialState=()=>l;let c;const b=()=>{var _,f;if(!y)return;o=!1,w.forEach(A=>{var k;return A((k=t())!=null?k:l)});const p=((f=a.onRehydrateStorage)==null?void 0:f.call(a,(_=t())!=null?_:l))||void 0;return toThenable(y.getItem.bind(y))(a.name).then(A=>{if(A)if(typeof A.version=="number"&&A.version!==a.version){if(a.migrate)return[!0,a.migrate(A.state,A.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,A.state];return[!1,void 0]}).then(A=>{var k;const[P,g]=A;if(c=a.merge(g,(k=t())!=null?k:l),s(c,!0),P)return u()}).then(()=>{p==null||p(c,void 0),c=t(),o=!0,S.forEach(A=>A(c))}).catch(A=>{p==null||p(void 0,A)})};return i.persist={setOptions:_=>{a={...a,..._},_.storage&&(y=_.storage)},clearStorage:()=>{y==null||y.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>b(),hasHydrated:()=>o,onHydrate:_=>(w.add(_),()=>{w.delete(_)}),onFinishHydration:_=>(S.add(_),()=>{S.delete(_)})},a.skipHydration||b(),c||l},persistImpl=(r,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((__vite_import_meta_env__?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),oldImpl(r,e)):newImpl(r,e),persist=persistImpl,ANP_LIMITS={HC_BALANCE_WARNING:7,HC_BALANCE_ERROR:10,TOTAL_BALANCE_WARNING:5,TOTAL_BALANCE_ERROR:7,K_FACTOR_MIN:.8,K_FACTOR_MAX:1.2};function calculateDeviation(r,e){return e===0?r===0?0:100:(r-e)/e*100}function getDeviationStatus(r,e,s){const t=Math.abs(r);return t>=s?"FAIL":t>=e?"ALERT":"OK"}function calculateMassBalance(r,e){const s=r.oil+r.gas,t=e.oil+e.gas,i=s+r.water,a=t+e.water,o=calculateDeviation(s,t),w=calculateDeviation(i,a),S=getDeviationStatus(o,ANP_LIMITS.HC_BALANCE_WARNING,ANP_LIMITS.HC_BALANCE_ERROR),y=getDeviationStatus(w,ANP_LIMITS.TOTAL_BALANCE_WARNING,ANP_LIMITS.TOTAL_BALANCE_ERROR);return{hcBalance:o,totalBalance:w,hcStatus:S,totalStatus:y,action:S==="FAIL"||y==="FAIL"?"INVESTIGAR":"MONITORAR"}}function calculateKFactor(r,e){return r===0?e===0?1:0:e/r}function generateCalibrationEventId(r,e,s=new Date){const t=r.startsWith("13")?"TOP":"SUB",i=e.substring(0,3).toUpperCase(),a=String(s.getMonth()+1).padStart(2,"0"),o=String(s.getFullYear()).slice(-2);return`CAL-MPFM_${t}-${i}-${a}-${o}`}function generateUniqueId(r=""){const e=Date.now().toString(36),s=Math.random().toString(36).substring(2,8);return r?`${r}-${e}-${s}`:`${e}-${s}`}const getInitialState=()=>({user:{id:"user-1",name:"Mauricio Amorim",email:"mauricio.amorim@equinor.com",role:"Admin"},activeModule:"monitoring",sidebarCollapsed:!1,showNewEventModal:!1,showImportModal:!1,showExportModal:!1,showMeterModal:!1,showAlertModal:!1,editingMeter:null,meters:[],selectedMeter:null,monitoringData:[],calibrationEvents:[],selectedEvent:null,calibrationFormData:null,alerts:[],monitoringFilters:{startDate:"",endDate:"",meterId:"",status:""},calibrationFilters:{status:"",type:"",meterId:"",responsible:""}}),useAppStore=create()(persist((r,e)=>({...getInitialState(),setActiveModule:s=>r({activeModule:s,selectedEvent:null}),toggleSidebar:()=>r(s=>({sidebarCollapsed:!s.sidebarCollapsed})),setShowNewEventModal:s=>r({showNewEventModal:s}),setShowImportModal:s=>r({showImportModal:s}),setShowExportModal:s=>r({showExportModal:s}),setShowMeterModal:s=>r({showMeterModal:s}),setShowAlertModal:s=>r({showAlertModal:s}),setEditingMeter:s=>r({editingMeter:s,showMeterModal:!!s}),setSelectedMeter:s=>r({selectedMeter:s}),addMeter:s=>{const t={...s,id:generateUniqueId("meter")};r(i=>({meters:[...i.meters,t]})),e().addAlert({type:"success",severity:"info",message:`Medidor ${t.tag} adicionado com sucesso`,meterId:t.id,meterTag:t.tag})},updateMeter:(s,t)=>{r(i=>({meters:i.meters.map(a=>a.id===s?{...a,...t}:a)}))},deleteMeter:s=>{const t=e().meters.find(i=>i.id===s);r(i=>{var a;return{meters:i.meters.filter(o=>o.id!==s),selectedMeter:((a=i.selectedMeter)==null?void 0:a.id)===s?null:i.selectedMeter}}),t&&e().addAlert({type:"warning",severity:"warning",message:`Medidor ${t.tag} removido`})},addMonitoringData:s=>{const t={...s,id:generateUniqueId("mon")};r(i=>({monitoringData:[...i.monitoringData,t]}))},updateMonitoringData:(s,t)=>{r(i=>({monitoringData:i.monitoringData.map(a=>a.id===s?{...a,...t}:a)}))},deleteMonitoringData:s=>{r(t=>({monitoringData:t.monitoringData.filter(i=>i.id!==s)}))},importMonitoringData:s=>{const t=s.map(i=>({...i,id:i.id||generateUniqueId("mon")}));r(i=>({monitoringData:[...i.monitoringData,...t]})),e().addAlert({type:"success",severity:"info",message:`${s.length} registros de monitoramento importados`})},recalculateBalances:()=>{r(s=>({monitoringData:s.monitoringData.map(t=>{const i=calculateMassBalance({oil:t.topOil,gas:t.topGas,water:t.topWater||0},{oil:t.sepOil,gas:t.sepGas,water:t.sepWater||0});return{...t,hcBalancePercent:i.hcBalance,totalBalancePercent:i.totalBalance,hcStatus:i.hcStatus,totalStatus:i.totalStatus,action:i.action}})}))},setSelectedEvent:s=>r({selectedEvent:s}),addCalibrationEvent:(s,t)=>{const i=new Date,a=generateCalibrationEventId(s.tag,t,i),o={id:a,meterId:s.id,meterTag:s.tag,meterName:s.name,type:t,status:"Em Andamento",startDate:i.toISOString().split("T")[0],currentStep:1,progress:0,responsible:e().user.name,createdAt:i.toISOString(),updatedAt:i.toISOString()};return r(w=>({calibrationEvents:[...w.calibrationEvents,o],showNewEventModal:!1})),e().addAlert({type:"info",severity:"info",message:`Avaliação ${a} iniciada para ${s.tag}`,meterId:s.id,meterTag:s.tag}),o},updateCalibrationEvent:(s,t)=>{r(i=>{var a;return{calibrationEvents:i.calibrationEvents.map(o=>o.id===s?{...o,...t,updatedAt:new Date().toISOString()}:o),selectedEvent:((a=i.selectedEvent)==null?void 0:a.id)===s?{...i.selectedEvent,...t,updatedAt:new Date().toISOString()}:i.selectedEvent}})},deleteCalibrationEvent:s=>{r(t=>{var i;return{calibrationEvents:t.calibrationEvents.filter(a=>a.id!==s),selectedEvent:((i=t.selectedEvent)==null?void 0:i.id)===s?null:t.selectedEvent}})},setCalibrationFormData:s=>r({calibrationFormData:s}),updateCalibrationFormData:s=>{r(t=>({calibrationFormData:t.calibrationFormData?{...t.calibrationFormData,...s}:null}))},completeCalibrationStep:(s,t)=>{const i=Math.round(t/7*100);e().updateCalibrationEvent(s,{currentStep:Math.min(t+1,7),progress:i,status:t>=7?"Concluída":"Em Andamento"})},finalizeCalibration:(s,t)=>{var o;const i=new Date;e().updateCalibrationEvent(s,{status:"Concluída",result:t,progress:100,currentStep:7,endDate:i.toISOString().split("T")[0]});const a=e().calibrationEvents.find(w=>w.id===s);if(a){if(t==="Aprovado"&&((o=e().calibrationFormData)!=null&&o.kFactors)){const{kFactors:w}=e().calibrationFormData;e().updateMeter(a.meterId,{kOil:w.kOil,kGas:w.kGas,kWater:w.kWater,lastCalibration:i.toISOString().split("T")[0],daysToCalibration:365})}e().addAlert({type:t==="Aprovado"?"success":"error",severity:t==="Aprovado"?"info":"critical",message:`Calibração ${s} finalizada: ${t}`,meterId:a.meterId,meterTag:a.meterTag})}},addAlert:s=>{const t={...s,id:generateUniqueId("alert"),timestamp:new Date().toISOString(),read:!1};r(i=>({alerts:[t,...i.alerts]}))},markAlertAsRead:s=>{r(t=>({alerts:t.alerts.map(i=>i.id===s?{...i,read:!0}:i)}))},markAllAlertsAsRead:()=>{r(s=>({alerts:s.alerts.map(t=>({...t,read:!0}))}))},deleteAlert:s=>{r(t=>({alerts:t.alerts.filter(i=>i.id!==s)}))},clearAllAlerts:()=>r({alerts:[]}),setMonitoringFilters:s=>{r(t=>({monitoringFilters:{...t.monitoringFilters,...s}}))},setCalibrationFilters:s=>{r(t=>({calibrationFilters:{...t.calibrationFilters,...s}}))},resetToDefaults:()=>{r(getInitialState())},clearAllData:()=>{r({meters:[],monitoringData:[],calibrationEvents:[],alerts:[],selectedMeter:null,selectedEvent:null,calibrationFormData:null})},getUnreadAlertsCount:()=>e().alerts.filter(s=>!s.read).length,getActiveMetersCount:()=>e().meters.filter(s=>s.status==="active").length,getFilteredMonitoringData:()=>{const{monitoringData:s,monitoringFilters:t}=e();return s.filter(i=>!(t.startDate&&i.date<t.startDate||t.endDate&&i.date>t.endDate||t.status&&i.hcStatus!==t.status))},getFilteredCalibrationEvents:()=>{const{calibrationEvents:s,calibrationFilters:t}=e();return s.filter(i=>!(t.status&&i.status!==t.status||t.type&&i.type!==t.type||t.meterId&&i.meterId!==t.meterId||t.responsible&&!i.responsible.toLowerCase().includes(t.responsible.toLowerCase())))}}),{name:"mpfm-monitor-storage",storage:createJSONStorage(()=>localStorage),partialize:r=>({meters:r.meters,monitoringData:r.monitoringData,calibrationEvents:r.calibrationEvents,alerts:r.alerts,user:r.user,sidebarCollapsed:r.sidebarCollapsed})})),MODULE_TITLES={monitoring:"Monitoramento SGM-FM",calibration:"Avaliação de Desempenho",compliance:"Conformidade ANP"};function Layout({children:r}){const[e,s]=reactExports.useState(!1),t=useLocation(),i=useNavigate(),{alerts:a,setShowImportModal:o,setShowExportModal:w}=useAppStore(),S=a.filter(l=>!l.read).length,u=(l=>l.includes("calibration")?"calibration":l.includes("compliance")?"compliance":"monitoring")(t.pathname),h=l=>{i(`/${l}`)};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white flex",children:[jsxRuntimeExports.jsx(Sidebar,{activeModule:u,onModuleChange:h,collapsed:e}),jsxRuntimeExports.jsxs("main",{className:"flex-1 flex flex-col min-w-0",children:[jsxRuntimeExports.jsx(Header,{title:MODULE_TITLES[u]||"MPFM Monitor",onToggleSidebar:()=>s(!e),onImport:()=>o(!0),onExport:()=>w(!0),alertCount:S}),jsxRuntimeExports.jsx("div",{className:"flex-1 p-4 overflow-auto",children:r})]})]})}function BalanceChart({data:r}){return jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:220,children:jsxRuntimeExports.jsxs(AreaChart,{data:r,children:[jsxRuntimeExports.jsxs("defs",{children:[jsxRuntimeExports.jsxs("linearGradient",{id:"hcGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[jsxRuntimeExports.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),jsxRuntimeExports.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]}),jsxRuntimeExports.jsxs("linearGradient",{id:"totalGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[jsxRuntimeExports.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.3}),jsxRuntimeExports.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})]}),jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3",stroke:"#27272a"}),jsxRuntimeExports.jsx(XAxis,{dataKey:"date",stroke:"#71717a",fontSize:10,tickFormatter:e=>e.slice(5)}),jsxRuntimeExports.jsx(YAxis,{stroke:"#71717a",fontSize:10,domain:[-15,40]}),jsxRuntimeExports.jsx(Tooltip,{contentStyle:{backgroundColor:"#18181b",border:"1px solid #27272a",borderRadius:"8px",fontSize:"11px"}}),jsxRuntimeExports.jsx(ReferenceLine,{y:10,stroke:"#ef4444",strokeDasharray:"5 5"}),jsxRuntimeExports.jsx(ReferenceLine,{y:-10,stroke:"#ef4444",strokeDasharray:"5 5"}),jsxRuntimeExports.jsx(ReferenceLine,{y:7,stroke:"#f59e0b",strokeDasharray:"3 3"}),jsxRuntimeExports.jsx(ReferenceLine,{y:-7,stroke:"#f59e0b",strokeDasharray:"3 3"}),jsxRuntimeExports.jsx(ReferenceLine,{y:0,stroke:"#52525b"}),jsxRuntimeExports.jsx(Area,{type:"monotone",dataKey:"hcBalTS",stroke:"#3b82f6",fill:"url(#hcGrad)",name:"HC %",strokeWidth:2}),jsxRuntimeExports.jsx(Area,{type:"monotone",dataKey:"totalBalTS",stroke:"#10b981",fill:"url(#totalGrad)",name:"Total %",strokeWidth:2}),jsxRuntimeExports.jsx(Legend,{wrapperStyle:{fontSize:"11px"}})]})})}function ProductionChart({data:r}){return jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:220,children:jsxRuntimeExports.jsxs(BarChart,{data:r,children:[jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3",stroke:"#27272a"}),jsxRuntimeExports.jsx(XAxis,{dataKey:"date",stroke:"#71717a",fontSize:10,tickFormatter:e=>e.slice(5)}),jsxRuntimeExports.jsx(YAxis,{stroke:"#71717a",fontSize:10}),jsxRuntimeExports.jsx(Tooltip,{contentStyle:{backgroundColor:"#18181b",border:"1px solid #27272a",borderRadius:"8px",fontSize:"11px"}}),jsxRuntimeExports.jsx(Bar,{dataKey:"subHC",fill:"#3b82f6",name:"Subsea",radius:[4,4,0,0]}),jsxRuntimeExports.jsx(Bar,{dataKey:"topHC",fill:"#8b5cf6",name:"Topside",radius:[4,4,0,0]}),jsxRuntimeExports.jsx(Bar,{dataKey:"sepHC",fill:"#10b981",name:"Test Sep",radius:[4,4,0,0]}),jsxRuntimeExports.jsx(Legend,{wrapperStyle:{fontSize:"11px"}})]})})}function DayCell({dayStatus:r,isToday:e,onClick:s}){if(!r)return jsxRuntimeExports.jsx("div",{className:"h-16 bg-zinc-900/30 rounded"});const t=parseInt(r.date.split("-")[2],10),i={OK:"bg-emerald-500/10 border-emerald-500/30 hover:bg-emerald-500/20",ALERT:"bg-amber-500/10 border-amber-500/30 hover:bg-amber-500/20",FAIL:"bg-red-500/10 border-red-500/30 hover:bg-red-500/20",NO_DATA:"bg-zinc-800/50 border-zinc-700/30 hover:bg-zinc-700/50"},a={OK:"bg-emerald-500",ALERT:"bg-amber-500",FAIL:"bg-red-500",NO_DATA:"bg-zinc-600"},o={OK:"text-emerald-400",ALERT:"text-amber-400",FAIL:"text-red-400",NO_DATA:"text-zinc-500"};return jsxRuntimeExports.jsxs("button",{onClick:s,disabled:!r.hasData,className:cn("h-16 rounded border transition-all duration-200 flex flex-col items-center justify-center gap-1","focus:outline-none focus:ring-2 focus:ring-blue-500/50",i[r.status],e&&"ring-2 ring-blue-500",r.hasData?"cursor-pointer":"cursor-default"),children:[jsxRuntimeExports.jsx("span",{className:cn("text-sm font-medium",r.hasData?"text-white":"text-zinc-600",e&&"text-blue-400"),children:t}),r.hasData&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:cn("w-2 h-2 rounded-full",a[r.status])}),jsxRuntimeExports.jsx("span",{className:cn("text-[10px] font-medium",o[r.status]),children:r.status})]}),r.hasData&&r.hcBalance!==void 0&&jsxRuntimeExports.jsxs("span",{className:cn("text-[9px]",o[r.status]),children:["HC: ",r.hcBalance>0?"+":"",r.hcBalance.toFixed(1),"%"]})]})}const STORAGE_KEY$3="mpfm_audit_log",MAX_ENTRIES=1e4;class AuditLogService{constructor(){Je(this,"logs",[]);Je(this,"initialized",!1);this.loadFromStorage()}loadFromStorage(){if(!this.initialized){try{const e=localStorage.getItem(STORAGE_KEY$3);e&&(this.logs=JSON.parse(e))}catch(e){console.error("[AuditLog] Erro ao carregar logs:",e),this.logs=[]}this.initialized=!0}}saveToStorage(){try{this.logs.length>MAX_ENTRIES&&(this.logs=this.logs.slice(-MAX_ENTRIES)),localStorage.setItem(STORAGE_KEY$3,JSON.stringify(this.logs))}catch(e){console.error("[AuditLog] Erro ao salvar logs:",e)}}async log(e){const s={...e,id:`audit-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date().toISOString(),userAgent:typeof navigator<"u"?navigator.userAgent:"server"};return this.logs.push(s),this.saveToStorage(),this.sendToServer(s).catch(console.error),s}async sendToServer(e){try{await fetch("/api/audit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(s){console.error("[AuditLog] Erro ao enviar para servidor:",s)}}getRecentLogs(e=100){return this.logs.slice(-e).reverse()}getLogsByEntity(e,s){return this.logs.filter(t=>!(t.entity!==e||s&&t.entityId!==s)).reverse()}getLogsByUser(e){return this.logs.filter(s=>s.userId===e).reverse()}getLogsByPeriod(e,s){const t=e.getTime(),i=s.getTime();return this.logs.filter(a=>{const o=new Date(a.timestamp).getTime();return o>=t&&o<=i}).reverse()}getLogsByAction(e){return this.logs.filter(s=>s.action===e).reverse()}exportLogs(){return JSON.stringify(this.logs,null,2)}exportLogsAsCSV(){const e=["ID","Timestamp","Usuário","Ação","Entidade","ID Entidade","Nome Entidade","Motivo"],s=this.logs.map(t=>[t.id,t.timestamp,t.userName,t.action,t.entity,t.entityId,t.entityName||"",t.reason||""]);return[e.join(","),...s.map(t=>t.join(","))].join(`
`)}clearLogs(){{console.warn("[AuditLog] Não é possível limpar logs em produção");return}}}const auditLog=new AuditLogService;function useAuditLog(){const r=useAppStore(s=>s.user);return{logAction:reactExports.useCallback(async(s,t,i,a)=>auditLog.log({userId:(r==null?void 0:r.id)||"anonymous",userName:(r==null?void 0:r.name)||"Operador",action:s,entity:t,entityId:i,...a}),[r]),getRecentLogs:auditLog.getRecentLogs.bind(auditLog),getLogsByEntity:auditLog.getLogsByEntity.bind(auditLog),getLogsByUser:auditLog.getLogsByUser.bind(auditLog),getLogsByPeriod:auditLog.getLogsByPeriod.bind(auditLog),exportLogs:auditLog.exportLogs.bind(auditLog),exportLogsAsCSV:auditLog.exportLogsAsCSV.bind(auditLog)}}function DayDetailModal({isOpen:r,onClose:e,date:s}){const t=useAppStore(R=>R.monitoringData),i=useAppStore(R=>R.updateMonitoringData),a=useAppStore(R=>R.addAlert),{logAction:o}=useAuditLog(),w=useToast(),[S,y]=reactExports.useState(!1),[u,h]=reactExports.useState(""),[l,c]=reactExports.useState({});if(!s)return null;const b=t.find(R=>R.date===s);if(!b)return jsxRuntimeExports.jsx(Modal,{isOpen:r,onClose:e,title:"Detalhes do Dia",size:"md",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-zinc-500",children:[jsxRuntimeExports.jsx(Calendar,{size:48,className:"mb-4 opacity-50"}),jsxRuntimeExports.jsxs("p",{children:["Sem dados de medição para ",s]})]})});const _=R=>{const[E,C,j]=R.split("-");return`${j}/${C}/${E}`},f={OK:{icon:CheckCircle,color:"text-emerald-400",bg:"bg-emerald-500/10"},ALERT:{icon:AlertTriangle,color:"text-amber-400",bg:"bg-amber-500/10"},FAIL:{icon:XCircle,color:"text-red-400",bg:"bg-red-500/10"}},p=f[b.hcStatus]||f.OK,A=p.icon,k=()=>{y(!0),c({subOil:b.subOil,subGas:b.subGas,subWater:b.subWater||0,topOil:b.topOil,topGas:b.topGas,topWater:b.topWater||0})},P=()=>{y(!1),h(""),c({})},g=()=>{if(!u.trim()){a({type:"error",severity:"warning",message:"É necessário informar o motivo da alteração"});return}const R=l.subOil+l.subGas,E=l.topOil+l.topGas,C=R>0?(E-R)/R*100:0,j=R+(l.subWater||0),z=E+(l.topWater||0),v=j>0?(z-j)/j*100:0,T=Math.abs(C)>10?"FAIL":Math.abs(C)>7?"ALERT":"OK",O=Math.abs(v)>7?"FAIL":Math.abs(v)>5?"ALERT":"OK";i(b.id,{subOil:l.subOil,subGas:l.subGas,subWater:l.subWater,subHC:R,topOil:l.topOil,topGas:l.topGas,topWater:l.topWater,topHC:E,hcBalTS:parseFloat(C.toFixed(2)),totalBalTS:parseFloat(v.toFixed(2)),hcBalancePercent:parseFloat(C.toFixed(2)),totalBalancePercent:parseFloat(v.toFixed(2)),hcStatus:T,totalStatus:O,action:T==="FAIL"||O==="FAIL"?"INVESTIGAR":"MONITORAR"}),o("UPDATE","MONITORING_DATA",b.id,{entityName:`Dados de medição - ${_(s)}`,previousValue:{subOil:b.subOil,subGas:b.subGas,topOil:b.topOil,topGas:b.topGas},newValue:{subOil:l.subOil,subGas:l.subGas,topOil:l.topOil,topGas:l.topGas},reason:u}),w.success("Dados atualizados",`Medição de ${_(s)} atualizada com sucesso`),a({type:"info",severity:"info",message:`Dados de ${_(s)} editados. Motivo: ${u}`}),y(!1),h(""),c({})};return jsxRuntimeExports.jsx(Modal,{isOpen:r,onClose:e,title:"",size:"lg",children:jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:cn("p-2 rounded-lg",p.bg),children:jsxRuntimeExports.jsx(A,{className:p.color,size:24})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-white",children:_(s)}),jsxRuntimeExports.jsx("p",{className:"text-sm text-zinc-400",children:"Dados de medição diária"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Badge,{variant:b.hcStatus==="OK"?"success":b.hcStatus==="ALERT"?"warning":"error",children:b.hcStatus}),!S&&jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",onClick:k,children:[jsxRuntimeExports.jsx(PenLine,{size:14,className:"mr-1"}),"Editar"]})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4 bg-zinc-800/50",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-zinc-400 mb-3 flex items-center gap-2",children:[jsxRuntimeExports.jsx(BarChart3,{size:16}),"Balanço de Massa"]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"text-center p-3 rounded-lg bg-zinc-900/50",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mb-1",children:"Balanço HC"}),jsxRuntimeExports.jsxs("p",{className:cn("text-2xl font-bold",Math.abs(b.hcBalTS)>10?"text-red-400":Math.abs(b.hcBalTS)>7?"text-amber-400":"text-emerald-400"),children:[b.hcBalTS>0?"+":"",b.hcBalTS.toFixed(2),"%"]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Limite: ±10%"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center p-3 rounded-lg bg-zinc-900/50",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mb-1",children:"Balanço Total"}),jsxRuntimeExports.jsxs("p",{className:cn("text-2xl font-bold",Math.abs(b.totalBalTS)>7?"text-red-400":Math.abs(b.totalBalTS)>5?"text-amber-400":"text-emerald-400"),children:[b.totalBalTS>0?"+":"",b.totalBalTS.toFixed(2),"%"]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Limite: ±7%"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4 bg-zinc-800/50",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-blue-400 mb-3 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Waves,{size:16}),"SUBSEA (MPFM)"]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:S?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Input,{label:"Óleo (t)",type:"number",value:l.subOil,onChange:R=>c({...l,subOil:parseFloat(R.target.value)||0})}),jsxRuntimeExports.jsx(Input,{label:"Gás (t)",type:"number",value:l.subGas,onChange:R=>c({...l,subGas:parseFloat(R.target.value)||0})}),jsxRuntimeExports.jsx(Input,{label:"Água (t)",type:"number",value:l.subWater,onChange:R=>c({...l,subWater:parseFloat(R.target.value)||0})})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Droplets,{size:12})," Óleo"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[b.subOil.toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Flame,{size:12})," Gás"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[b.subGas.toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Waves,{size:12})," Água"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[(b.subWater||0).toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm pt-2 border-t border-zinc-700",children:[jsxRuntimeExports.jsx("span",{className:"text-zinc-300 font-medium",children:"HC Total"}),jsxRuntimeExports.jsxs("span",{className:"text-blue-400 font-mono font-medium",children:[b.subHC.toFixed(2)," t"]})]})]})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4 bg-zinc-800/50",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-purple-400 mb-3 flex items-center gap-2",children:[jsxRuntimeExports.jsx(BarChart3,{size:16}),"TOPSIDE (MPFM)"]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:S?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Input,{label:"Óleo (t)",type:"number",value:l.topOil,onChange:R=>c({...l,topOil:parseFloat(R.target.value)||0})}),jsxRuntimeExports.jsx(Input,{label:"Gás (t)",type:"number",value:l.topGas,onChange:R=>c({...l,topGas:parseFloat(R.target.value)||0})}),jsxRuntimeExports.jsx(Input,{label:"Água (t)",type:"number",value:l.topWater,onChange:R=>c({...l,topWater:parseFloat(R.target.value)||0})})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Droplets,{size:12})," Óleo"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[b.topOil.toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Flame,{size:12})," Gás"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[b.topGas.toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Waves,{size:12})," Água"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[(b.topWater||0).toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm pt-2 border-t border-zinc-700",children:[jsxRuntimeExports.jsx("span",{className:"text-zinc-300 font-medium",children:"HC Total"}),jsxRuntimeExports.jsxs("span",{className:"text-purple-400 font-mono font-medium",children:[b.topHC.toFixed(2)," t"]})]})]})})]})]}),S&&jsxRuntimeExports.jsxs(Card,{className:"p-4 bg-amber-500/10 border-amber-500/30",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-amber-400 mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx(FileText,{size:16}),"Justificativa da Alteração (obrigatório)"]}),jsxRuntimeExports.jsx("textarea",{value:u,onChange:R=>h(R.target.value),placeholder:"Descreva o motivo da alteração para registro de auditoria...",className:"w-full h-20 bg-zinc-900/50 border border-zinc-700 rounded-lg p-2 text-sm text-white resize-none focus:outline-none focus:ring-2 focus:ring-amber-500/50"})]}),jsxRuntimeExports.jsx("div",{className:"flex justify-end gap-2 pt-2 border-t border-zinc-800",children:S?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",onClick:P,children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{variant:"primary",onClick:g,children:"Salvar Alterações"})]}):jsxRuntimeExports.jsx(Button,{variant:"ghost",onClick:e,children:"Fechar"})})]})})}const WEEKDAYS=["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],MONTHS=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];function CalendarView(){const r=new Date,[e,s]=reactExports.useState(r.getMonth()),[t,i]=reactExports.useState(r.getFullYear()),[a,o]=reactExports.useState(null),[w,S]=reactExports.useState(!1),y=useAppStore(p=>p.monitoringData),u=reactExports.useMemo(()=>{const p=new Date(t,e,1),A=new Date(t,e+1,0),k=p.getDay(),P=A.getDate(),g=[];for(let R=0;R<k;R++)g.push(null);for(let R=1;R<=P;R++){const E=`${t}-${String(e+1).padStart(2,"0")}-${String(R).padStart(2,"0")}`,C=y.find(j=>j.date===E);C?g.push({date:E,hasData:!0,status:C.hcStatus,hcBalance:C.hcBalTS,totalBalance:C.totalBalTS}):g.push({date:E,hasData:!1,status:"NO_DATA"})}return g},[e,t,y]),h=()=>{e===0?(s(11),i(t-1)):s(e-1)},l=()=>{e===11?(s(0),i(t+1)):s(e+1)},c=()=>{s(r.getMonth()),i(r.getFullYear())},b=p=>{o(p.date),S(!0)},_=reactExports.useMemo(()=>{const p=u.filter(g=>g==null?void 0:g.hasData),A=p.filter(g=>(g==null?void 0:g.status)==="OK").length,k=p.filter(g=>(g==null?void 0:g.status)==="ALERT").length,P=p.filter(g=>(g==null?void 0:g.status)==="FAIL").length;return{total:p.length,ok:A,alert:k,fail:P}},[u]),f=Array.from({length:10},(p,A)=>({value:String(t-5+A),label:String(t-5+A)}));return jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(Calendar,{className:"text-blue-400",size:24}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-white",children:"Calendário de Medições"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400",children:[_.total," dias com dados:"]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded-full bg-emerald-500"}),jsxRuntimeExports.jsxs("span",{className:"text-emerald-400",children:[_.ok," OK"]})]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded-full bg-amber-500"}),jsxRuntimeExports.jsxs("span",{className:"text-amber-400",children:[_.alert," Alert"]})]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded-full bg-red-500"}),jsxRuntimeExports.jsxs("span",{className:"text-red-400",children:[_.fail," Fail"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4 bg-zinc-800/50 rounded-lg p-2",children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:h,className:"text-zinc-400 hover:text-white",children:jsxRuntimeExports.jsx(ChevronLeft,{size:20})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Select,{value:String(e),onChange:p=>s(Number(p.target.value)),options:MONTHS.map((p,A)=>({value:String(A),label:p})),className:"w-32"}),jsxRuntimeExports.jsx(Select,{value:String(t),onChange:p=>i(Number(p.target.value)),options:f,className:"w-24"}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:c,className:"ml-2",children:"Hoje"})]}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:l,className:"text-zinc-400 hover:text-white",children:jsxRuntimeExports.jsx(ChevronRight,{size:20})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[WEEKDAYS.map(p=>jsxRuntimeExports.jsx("div",{className:"text-center text-xs font-medium text-zinc-500 py-2",children:p},p)),u.map((p,A)=>jsxRuntimeExports.jsx(DayCell,{dayStatus:p,isToday:(p==null?void 0:p.date)===r.toISOString().split("T")[0],onClick:p?()=>b(p):void 0},A))]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4 pt-4 border-t border-zinc-800 text-xs text-zinc-500",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded bg-emerald-500/20 border border-emerald-500"}),"OK (HC ≤ 7%)"]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded bg-amber-500/20 border border-amber-500"}),"Alert (7% < HC ≤ 10%)"]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded bg-red-500/20 border border-red-500"}),"Fail (HC > 10%)"]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded bg-zinc-700 border border-zinc-600"}),"Sem dados"]})]}),jsxRuntimeExports.jsx(DayDetailModal,{isOpen:w,onClose:()=>S(!1),date:a})]})}function getTimeAgo(r){const e=new Date,s=new Date(r),t=e.getTime()-s.getTime(),i=Math.floor(t/6e4),a=Math.floor(t/36e5),o=Math.floor(t/864e5);return i<60?`${i}m atrás`:a<24?`${a}h atrás`:`${o}d atrás`}const realMeters=[{tag:"13FT0367",name:"Riser P5",location:"TOPSIDE",status:"active",serialNumber:"SLB-VX-2024-0367",manufacturer:"Schlumberger",model:"Vx Spectra",lastCalibration:"2026-01-18",kOil:1.0908,kGas:1.09262,kWater:1,daysToCalibration:365},{tag:"13FT0417",name:"Riser P6",location:"TOPSIDE",status:"inactive",serialNumber:"SLB-VX-2024-0417",manufacturer:"Schlumberger",model:"Vx Spectra",lastCalibration:"2025-06-15",kOil:1,kGas:1,kWater:1,daysToCalibration:180},{tag:"18FT1506",name:"PE_4",location:"SUBSEA",status:"active",serialNumber:"TFMC-MPM-2024-1506",manufacturer:"TechnipFMC",model:"MPM",lastCalibration:"2025-12-01",kOil:1,kGas:1,kWater:1,daysToCalibration:320},{tag:"18FT1806",name:"PE_EO4",location:"SUBSEA",status:"inactive",serialNumber:"TFMC-MPM-2024-1806",manufacturer:"TechnipFMC",model:"MPM",lastCalibration:"2025-08-20",kOil:1,kGas:1,kWater:1,daysToCalibration:0},{tag:"18FT1706",name:"PE_EO105",location:"SUBSEA",status:"inactive",serialNumber:"TFMC-MPM-2024-1706",manufacturer:"TechnipFMC",model:"MPM",lastCalibration:"2025-07-10",kOil:1,kGas:1,kWater:1,daysToCalibration:0},{tag:"18FT1406",name:"PE_EO10",location:"SUBSEA",status:"inactive",serialNumber:"TFMC-MPM-2024-1406",manufacturer:"TechnipFMC",model:"MPM",lastCalibration:"2025-09-05",kOil:1,kGas:1,kWater:1,daysToCalibration:0}],realCalibrationPVT={calibrationNo:211,meterName:"N1 - Riser P5",startDate:"2026-01-17",endDate:"2026-01-18",densities:{oil:{mpfm:754.033},gas:{mpfm:91.842},water:{mpfm:999.784}},composition:[{component:"N₂",molPercent:.575,molecularWeight:28.01},{component:"CO₂",molPercent:.02,molecularWeight:44.01},{component:"C₁",molPercent:62.183,molecularWeight:16.04},{component:"C₂",molPercent:8.069,molecularWeight:30.07},{component:"C₃",molPercent:5.047,molecularWeight:44.1},{component:"i-C₄",molPercent:1.069,molecularWeight:58.12},{component:"n-C₄",molPercent:1.858,molecularWeight:58.12},{component:"i-C₅",molPercent:.681,molecularWeight:72.15},{component:"n-C₅",molPercent:.788,molecularWeight:72.15},{component:"C₆",molPercent:1.112,molecularWeight:86.18},{component:"C₇",molPercent:1.138,molecularWeight:97.37},{component:"C₈",molPercent:1.657,molecularWeight:111.29},{component:"C₉",molPercent:1.472,molecularWeight:125.25},{component:"C₁₀+",molPercent:14.331,molecularWeight:289.64}],peneloux:{gas:1,oil:1}};function AlertsList({limit:r}){const e=useAppStore(a=>a.alerts),s=r?e.slice(0,r):e,t=a=>{switch(a){case"error":return AlertCircle;case"warning":return AlertTriangle;case"success":return CheckCircle;default:return Info}},i=a=>{switch(a){case"error":return"bg-red-500/20 text-red-400";case"warning":return"bg-amber-500/20 text-amber-400";case"success":return"bg-emerald-500/20 text-emerald-400";default:return"bg-blue-500/20 text-blue-400"}};return jsxRuntimeExports.jsx("div",{className:"divide-y divide-zinc-800",children:s.map(a=>{const o=t(a.type);return jsxRuntimeExports.jsx("div",{className:cn("p-3",!a.read&&"bg-zinc-800/30"),children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-2",children:[jsxRuntimeExports.jsx("div",{className:cn("mt-0.5 p-1 rounded",i(a.type)),children:jsxRuntimeExports.jsx(o,{className:"w-3 h-3"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-200 truncate",children:a.message}),jsxRuntimeExports.jsxs("p",{className:"text-[10px] text-zinc-500 mt-0.5",children:[a.meterTag," • ",getTimeAgo(a.timestamp)]})]})]})},a.id)})})}function DailyTable({data:r}){const e=[...r].reverse().slice(0,5);return jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700 bg-zinc-800/50",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-left text-zinc-400",children:"Data"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-blue-400",children:"Subsea HC"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-purple-400",children:"Topside HC"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-emerald-400",children:"Test Sep HC"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Bal HC%"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Status"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Ação"})]})}),jsxRuntimeExports.jsx("tbody",{children:e.map((s,t)=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50 hover:bg-zinc-800/30",children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-zinc-200",children:s.date}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-right text-blue-400",children:s.subHC.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-right text-purple-400",children:s.topHC.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-right text-emerald-400",children:s.sepHC.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsxs("td",{className:cn("py-2 px-3 text-center font-mono",Math.abs(s.hcBalTS)>10?"text-red-400":"text-zinc-300"),children:[s.hcBalTS>0?"+":"",s.hcBalTS.toFixed(2),"%"]}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:s.hcStatus,size:"sm",children:s.hcStatus})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:s.action,size:"sm",children:s.action})})]},t))})]})})}function MetersList(){const{meters:r,setShowMeterModal:e,setEditingMeter:s,deleteMeter:t}=useAppStore(),i=o=>{s(o)},a=o=>{confirm("Tem certeza que deseja remover este medidor?")&&t(o)};return jsxRuntimeExports.jsx(Card,{title:"Medidores MPFM",subtitle:"Status e próximas calibrações",headerRight:jsxRuntimeExports.jsx(Button,{variant:"primary",size:"sm",icon:Plus,onClick:()=>e(!0),children:"Adicionar"}),noPadding:!0,children:r.length===0?jsxRuntimeExports.jsxs("div",{className:"p-8 text-center text-zinc-500",children:[jsxRuntimeExports.jsx("p",{className:"mb-4",children:"Nenhum medidor cadastrado."}),jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:Plus,onClick:()=>e(!0),children:"Adicionar Primeiro Medidor"})]}):jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700 bg-zinc-800/50",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-left text-zinc-400",children:"TAG"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-left text-zinc-400",children:"Nome"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Localização"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Status"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Última Calib."}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-zinc-400",children:"K-Oil"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-zinc-400",children:"K-Gas"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Próx. Calib."}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Ações"})]})}),jsxRuntimeExports.jsx("tbody",{children:r.map(o=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50 hover:bg-zinc-800/30",children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-3 font-mono text-blue-400",children:o.tag}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-zinc-200",children:o.name}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:o.location,size:"sm",children:o.location})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:o.status,size:"sm",children:o.status==="active"?"Ativo":"Inativo"})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center text-zinc-400",children:o.lastCalibration}),jsxRuntimeExports.jsx("td",{className:cn("py-2 px-3 text-right font-mono",o.kOil<.8||o.kOil>1.2?"text-red-400":"text-emerald-400"),children:o.kOil.toFixed(4)}),jsxRuntimeExports.jsx("td",{className:cn("py-2 px-3 text-right font-mono",o.kGas<.8||o.kGas>1.2?"text-red-400":"text-emerald-400"),children:o.kGas.toFixed(4)}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsxs(Badge,{variant:o.daysToCalibration<30?"error":o.daysToCalibration<60?"warning":"success",size:"sm",children:[o.daysToCalibration,"d"]})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-1",children:[jsxRuntimeExports.jsx("button",{onClick:()=>i(o),className:"p-1 hover:bg-zinc-700 rounded transition-colors",title:"Editar",children:jsxRuntimeExports.jsx(PenSquare,{className:"w-3.5 h-3.5 text-zinc-400 hover:text-blue-400"})}),jsxRuntimeExports.jsx("button",{onClick:()=>a(o.id),className:"p-1 hover:bg-zinc-700 rounded transition-colors",title:"Remover",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3.5 h-3.5 text-zinc-400 hover:text-red-400"})})]})})]},o.id))})]})})})}function MonitoringDashboard(){var l,c;const{monitoringData:r,meters:e,getUnreadAlertsCount:s,getActiveMetersCount:t,setShowMeterModal:i,setShowImportModal:a}=useAppStore(),o=r.length>0,w=e.length>0,S=o?r[r.length-1]:null,y=o?Math.max(...r.map(b=>Math.max(b.subVsTS||0,b.topVsTS||0,b.topVsSub||0))):0,u=s(),h=t();return!o&&!w?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-[60vh] space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx(Database,{className:"w-16 h-16 text-zinc-600 mx-auto mb-4"}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Bem-vindo ao MPFM Monitor"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400 max-w-md",children:"Comece adicionando medidores MPFM e importando dados de monitoramento para visualizar os balanços de massa."})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsx(Button,{variant:"primary",icon:Plus,onClick:()=>i(!0),children:"Adicionar Medidor"}),jsxRuntimeExports.jsx(Button,{variant:"secondary",icon:Database,onClick:()=>a(!0),children:"Importar Dados"})]})]}):jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-3",children:[jsxRuntimeExports.jsx(KPICard,{title:"Balanço HC Atual",value:S?((l=S.hcBalTS)==null?void 0:l.toFixed(2))||"0.00":"--",unit:"%",subtitle:S&&Math.abs(S.hcBalTS||0)>10?"FORA DO LIMITE":"Dentro do limite",icon:Target,color:S&&Math.abs(S.hcBalTS||0)>10?"red":"emerald"}),jsxRuntimeExports.jsx(KPICard,{title:"Balanço Total",value:S?((c=S.totalBalTS)==null?void 0:c.toFixed(2))||"0.00":"--",unit:"%",subtitle:"Limite: ±7%",icon:Activity,color:S&&Math.abs(S.totalBalTS||0)>7?"red":"emerald"}),jsxRuntimeExports.jsx(KPICard,{title:"Dias Consecutivos",value:y,unit:"/10",subtitle:"Gatilho calibração",icon:Calendar,color:y>=10?"red":y>=7?"amber":"emerald"}),jsxRuntimeExports.jsx(KPICard,{title:"Medidores Ativos",value:h,unit:`/${e.length}`,icon:Gauge,color:"purple"}),jsxRuntimeExports.jsx(KPICard,{title:"Alertas Pendentes",value:u,icon:Bell,color:u>0?"amber":"emerald"})]}),o&&jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(Card,{title:"Histórico de Balanço de Massa",subtitle:"Últimos 7 dias - Limites ANP: HC ±10%, Total ±7%",children:jsxRuntimeExports.jsx(BalanceChart,{data:r})}),jsxRuntimeExports.jsx(Card,{title:"Produção HC por Sistema",subtitle:"Últimos 7 dias (t)",children:jsxRuntimeExports.jsx(ProductionChart,{data:r})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[jsxRuntimeExports.jsx(Card,{title:"Monitoramento Diário",subtitle:o?"Últimos registros":"Nenhum dado importado",className:"lg:col-span-2",noPadding:!0,children:o?jsxRuntimeExports.jsx(DailyTable,{data:r}):jsxRuntimeExports.jsxs("div",{className:"p-8 text-center text-zinc-500",children:[jsxRuntimeExports.jsx("p",{children:"Importe dados de monitoramento para visualizar a tabela."}),jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",className:"mt-4",onClick:()=>a(!0),children:"Importar Dados"})]})}),jsxRuntimeExports.jsx(Card,{title:"Alertas Recentes",headerRight:jsxRuntimeExports.jsxs(Badge,{variant:u>0?"warning":"success",children:[u," novos"]}),noPadding:!0,children:jsxRuntimeExports.jsx(AlertsList,{limit:4})})]}),jsxRuntimeExports.jsx(MetersList,{}),jsxRuntimeExports.jsx(CalendarView,{})]})}const KFACTOR_LIMITS={K_FACTOR_MIN:.8,K_FACTOR_MAX:1.2,K_FACTOR_WARNING_MIN:.85,K_FACTOR_WARNING_MAX:1.15,CONSECUTIVE_DAYS_TRIGGER:10,CONSECUTIVE_DAYS_WARNING:7,HC_DEVIATION_MAX:10,TOTAL_DEVIATION_MAX:7,BSW_WARNING:15,BSW_CRITICAL:20,CALIBRATION_INTERVAL_DAYS:180,CALIBRATION_WARNING_DAYS:150},STORAGE_KEY$2="mpfm_kfactor_history";class KFactorTrackerService{constructor(){Je(this,"histories",new Map);Je(this,"consecutiveDays",new Map);this.loadFromStorage()}loadFromStorage(){try{const e=localStorage.getItem(STORAGE_KEY$2);if(e){const s=JSON.parse(e);this.histories=new Map(Object.entries(s.histories||{})),this.consecutiveDays=new Map(Object.entries(s.consecutiveDays||{}))}}catch(e){console.error("[KFactorTracker] Erro ao carregar histórico:",e)}}saveToStorage(){try{const e={histories:Object.fromEntries(this.histories),consecutiveDays:Object.fromEntries(this.consecutiveDays)};localStorage.setItem(STORAGE_KEY$2,JSON.stringify(e))}catch(e){console.error("[KFactorTracker] Erro ao salvar histórico:",e)}}isWithinLimits(e){return e>=KFACTOR_LIMITS.K_FACTOR_MIN&&e<=KFACTOR_LIMITS.K_FACTOR_MAX}isNearLimits(e){return e>=KFACTOR_LIMITS.K_FACTOR_MIN&&e<KFACTOR_LIMITS.K_FACTOR_WARNING_MIN||e>KFACTOR_LIMITS.K_FACTOR_WARNING_MAX&&e<=KFACTOR_LIMITS.K_FACTOR_MAX}addReading(e,s,t,i,a,o="calculated"){const w=new Date,S=w.toISOString().split("T")[0],y=this.isWithinLimits(t)&&this.isWithinLimits(i)&&this.isWithinLimits(a),u={date:S,timestamp:w.toISOString(),meterId:e,meterTag:s,kOil:t,kGas:i,kWater:a,source:o,isWithinLimits:y};let h=this.histories.get(e);h||(h={meterId:e,readings:[],statistics:{avgKOil:1,avgKGas:1,avgKWater:1,stdDevKOil:0,stdDevKGas:0,stdDevKWater:0,daysInRange:0,daysOutOfRange:0,complianceRate:100}});const l=h.readings.findIndex(c=>c.date===S);return l>=0?h.readings[l]=u:h.readings.push(u),h.readings.length>365&&(h.readings=h.readings.slice(-365)),this.updateConsecutiveDays(e,y),this.updateStatistics(h),this.histories.set(e,h),this.saveToStorage(),console.log(`[KFactorTracker] Leitura adicionada: ${s} - Oil: ${t.toFixed(4)}, Gas: ${i.toFixed(4)}, Water: ${a.toFixed(4)}`),u}updateConsecutiveDays(e,s){if(s)this.consecutiveDays.set(e,0);else{const t=this.consecutiveDays.get(e)||0;this.consecutiveDays.set(e,t+1)}}updateStatistics(e){const s=e.readings;if(s.length===0)return;const t=s.map(l=>l.kOil),i=s.map(l=>l.kGas),a=s.map(l=>l.kWater),o=l=>l.reduce((c,b)=>c+b,0)/l.length,w=(l,c)=>Math.sqrt(l.reduce((b,_)=>b+Math.pow(_-c,2),0)/l.length),S=o(t),y=o(i),u=o(a),h=s.filter(l=>l.isWithinLimits).length;e.statistics={avgKOil:S,avgKGas:y,avgKWater:u,stdDevKOil:w(t,S),stdDevKGas:w(i,y),stdDevKWater:w(a,u),daysInRange:h,daysOutOfRange:s.length-h,complianceRate:h/s.length*100}}getConsecutiveDaysOutOfRange(e){return this.consecutiveDays.get(e)||0}needsCalibration(e,s){const t=this.getConsecutiveDaysOutOfRange(e);let i=0;if(s){const a=new Date(s);i=Math.floor((Date.now()-a.getTime())/(1e3*60*60*24))}else i=365;return t>=KFACTOR_LIMITS.CONSECUTIVE_DAYS_TRIGGER?{required:!0,reason:`K-Factor fora do limite por ${t} dias consecutivos (ANP 44/2015 Art. 12)`,severity:"critical",daysOutOfRange:t,daysSinceCalibration:i}:i>KFACTOR_LIMITS.CALIBRATION_INTERVAL_DAYS?{required:!0,reason:`Calibração periódica vencida (${i} dias desde última calibração)`,severity:"critical",daysOutOfRange:t,daysSinceCalibration:i}:t>=KFACTOR_LIMITS.CONSECUTIVE_DAYS_WARNING?{required:!1,reason:`Atenção: ${t} dias consecutivos fora do limite. Calibração obrigatória em ${KFACTOR_LIMITS.CONSECUTIVE_DAYS_TRIGGER-t} dias.`,severity:"warning",daysOutOfRange:t,daysSinceCalibration:i}:i>KFACTOR_LIMITS.CALIBRATION_WARNING_DAYS?{required:!1,reason:`Calibração periódica vence em ${KFACTOR_LIMITS.CALIBRATION_INTERVAL_DAYS-i} dias`,severity:"warning",daysOutOfRange:t,daysSinceCalibration:i}:{required:!1,severity:"none",daysOutOfRange:t,daysSinceCalibration:i}}getMeterStatus(e,s,t,i,a){const o=this.needsCalibration(e,a),w=this.histories.get(e);let S="ok";if(o.severity==="critical")S="critical";else if(o.severity==="warning")S="warning";else{const{oil:u,gas:h,water:l}=i;(this.isNearLimits(u)||this.isNearLimits(h)||this.isNearLimits(l))&&(S="warning")}let y="stable";if(w&&w.readings.length>=14){const u=w.readings.slice(-7),h=w.readings.slice(-14,-7),l=u.filter(b=>!b.isWithinLimits).length,c=h.filter(b=>!b.isWithinLimits).length;l<c?y="improving":l>c&&(y="degrading")}return{meterId:e,meterTag:s,meterName:t,currentKFactors:i,status:S,consecutiveDaysOutOfRange:o.daysOutOfRange,lastCalibrationDate:a,daysSinceCalibration:o.daysSinceCalibration,calibrationRequired:o.required,calibrationReason:o.reason,complianceRate:(w==null?void 0:w.statistics.complianceRate)||100,trend:y}}getHistory(e){return this.histories.get(e)}recordCalibration(e,s,t,i){var o;this.consecutiveDays.set(e,0);const a=this.histories.get(e);a&&this.addReading(e,((o=a.readings[0])==null?void 0:o.meterTag)||e,s,t,i,"calibration"),this.saveToStorage(),console.log(`[KFactorTracker] Calibração registrada para ${e}`)}clearAll(){}}new KFactorTrackerService;const STORAGE_KEY$1="mpfm_alerts";class AlertEngineService{constructor(){Je(this,"alerts",[]);Je(this,"rules",[]);Je(this,"listeners",new Set);this.loadFromStorage(),this.initializeDefaultRules()}loadFromStorage(){try{const e=localStorage.getItem(STORAGE_KEY$1);e&&(this.alerts=JSON.parse(e))}catch(e){console.error("[AlertEngine] Erro ao carregar alertas:",e)}}saveToStorage(){try{localStorage.setItem(STORAGE_KEY$1,JSON.stringify(this.alerts)),this.notifyListeners()}catch(e){console.error("[AlertEngine] Erro ao salvar alertas:",e)}}notifyListeners(){this.listeners.forEach(e=>e([...this.alerts]))}generateId(){return`alert_${Date.now()}_${Math.random().toString(36).substring(2,9)}`}initializeDefaultRules(){this.rules=[{id:"k_factor_out_of_range",name:"K-Factor Fora do Limite",category:"k_factor",condition:e=>!e.kOil||!e.kGas||!e.kWater?!1:e.kOil<KFACTOR_LIMITS.K_FACTOR_MIN||e.kOil>KFACTOR_LIMITS.K_FACTOR_MAX||e.kGas<KFACTOR_LIMITS.K_FACTOR_MIN||e.kGas>KFACTOR_LIMITS.K_FACTOR_MAX||e.kWater<KFACTOR_LIMITS.K_FACTOR_MIN||e.kWater>KFACTOR_LIMITS.K_FACTOR_MAX,severity:"warning",titleTemplate:"K-Factor fora do limite - {meterTag}",descriptionTemplate:"K-Factor(s) fora do intervalo permitido (0.8 - 1.2). K-Oil: {kOil}, K-Gas: {kGas}, K-Water: {kWater}",enabled:!0},{id:"consecutive_days_warning",name:"Dias Consecutivos - Aviso",category:"calibration",condition:e=>{const s=e.consecutiveDaysOutOfRange||0;return s>=KFACTOR_LIMITS.CONSECUTIVE_DAYS_WARNING&&s<KFACTOR_LIMITS.CONSECUTIVE_DAYS_TRIGGER},severity:"warning",titleTemplate:"Atenção: {consecutiveDaysOutOfRange} dias consecutivos fora do limite",descriptionTemplate:"Medidor {meterTag} está fora do limite por {consecutiveDaysOutOfRange} dias. Calibração obrigatória em {daysRemaining} dias.",enabled:!0},{id:"consecutive_days_critical",name:"Dias Consecutivos - Crítico",category:"calibration",condition:e=>(e.consecutiveDaysOutOfRange||0)>=KFACTOR_LIMITS.CONSECUTIVE_DAYS_TRIGGER,severity:"critical",titleTemplate:"CALIBRAÇÃO OBRIGATÓRIA - {meterTag}",descriptionTemplate:"K-Factor fora do limite por {consecutiveDaysOutOfRange} dias consecutivos. Calibração obrigatória conforme ANP 44/2015 Art. 12.",enabled:!0},{id:"hc_deviation_exceeded",name:"Desvio HC Excedido",category:"deviation",condition:e=>{const s=Math.abs(e.oilDeviation||0),t=Math.abs(e.gasDeviation||0);return s>KFACTOR_LIMITS.HC_DEVIATION_MAX||t>KFACTOR_LIMITS.HC_DEVIATION_MAX},severity:"critical",titleTemplate:"Desvio de HC excedido - {meterTag}",descriptionTemplate:"Desvio de hidrocarboneto excede limite de ±10%. Óleo: {oilDeviation}%, Gás: {gasDeviation}%",enabled:!0},{id:"total_deviation_exceeded",name:"Desvio Total Excedido",category:"deviation",condition:e=>Math.abs(e.totalDeviation||0)>KFACTOR_LIMITS.TOTAL_DEVIATION_MAX,severity:"warning",titleTemplate:"Desvio total excedido - {meterTag}",descriptionTemplate:"Desvio total excede limite de ±7%. Valor: {totalDeviation}%",enabled:!0},{id:"bsw_warning",name:"BSW Elevado",category:"bsw",condition:e=>{const s=e.bsw||0;return s>=KFACTOR_LIMITS.BSW_WARNING&&s<KFACTOR_LIMITS.BSW_CRITICAL},severity:"warning",titleTemplate:"BSW elevado - {meterTag}",descriptionTemplate:"BSW em {bsw}% - acima do limite de advertência de {threshold}%",enabled:!0},{id:"bsw_critical",name:"BSW Crítico",category:"bsw",condition:e=>(e.bsw||0)>=KFACTOR_LIMITS.BSW_CRITICAL,severity:"critical",titleTemplate:"BSW crítico - {meterTag}",descriptionTemplate:"BSW em {bsw}% - impacta significativamente a qualidade do óleo",enabled:!0},{id:"calibration_due_warning",name:"Calibração Periódica - Aviso",category:"calibration",condition:e=>{const s=e.daysSinceCalibration||0;return s>=KFACTOR_LIMITS.CALIBRATION_WARNING_DAYS&&s<KFACTOR_LIMITS.CALIBRATION_INTERVAL_DAYS},severity:"info",titleTemplate:"Calibração periódica se aproximando - {meterTag}",descriptionTemplate:"Última calibração há {daysSinceCalibration} dias. Vence em {daysRemaining} dias.",enabled:!0},{id:"calibration_overdue",name:"Calibração Periódica Vencida",category:"calibration",condition:e=>(e.daysSinceCalibration||0)>KFACTOR_LIMITS.CALIBRATION_INTERVAL_DAYS,severity:"critical",titleTemplate:"CALIBRAÇÃO VENCIDA - {meterTag}",descriptionTemplate:"Calibração periódica vencida há {overdueDays} dias. Verificar conformidade ANP.",enabled:!0}]}processTemplate(e,s){let t=e;if(Object.entries(s).forEach(([i,a])=>{const o=new RegExp(`\\{${i}\\}`,"g");t=t.replace(o,String(a??"N/A"))}),s.consecutiveDaysOutOfRange){const i=KFACTOR_LIMITS.CONSECUTIVE_DAYS_TRIGGER-s.consecutiveDaysOutOfRange;t=t.replace(/\{daysRemaining\}/g,String(Math.max(0,i)))}if(s.daysSinceCalibration){const i=KFACTOR_LIMITS.CALIBRATION_INTERVAL_DAYS-s.daysSinceCalibration;t=t.replace(/\{daysRemaining\}/g,String(Math.max(0,i)));const a=s.daysSinceCalibration-KFACTOR_LIMITS.CALIBRATION_INTERVAL_DAYS;t=t.replace(/\{overdueDays\}/g,String(Math.max(0,a)))}return t=t.replace(/\{threshold\}/g,String(KFACTOR_LIMITS.BSW_WARNING)),t}checkAndGenerateAlerts(e){const s=[];for(const t of this.rules)if(t.enabled)try{if(t.condition(e)&&!this.alerts.find(a=>!a.resolved&&a.meterId===e.meterId&&a.title.includes(t.id.replace(/_/g," ")))){const a=this.createAlert({meterId:e.meterId,meterTag:e.meterTag,category:t.category,severity:t.severity,title:this.processTemplate(t.titleTemplate,e),description:this.processTemplate(t.descriptionTemplate,e),source:"automatic"});s.push(a)}}catch(i){console.error(`[AlertEngine] Erro na regra ${t.id}:`,i)}return s}createAlert(e){const s={id:this.generateId(),timestamp:new Date().toISOString(),acknowledged:!1,resolved:!1,...e};return this.alerts.unshift(s),this.saveToStorage(),console.log(`[AlertEngine] Alerta criado: ${s.severity.toUpperCase()} - ${s.title}`),s}acknowledgeAlert(e,s){const t=this.alerts.find(i=>i.id===e);return t?(t.acknowledged=!0,t.acknowledgedBy=s,t.acknowledgedAt=new Date().toISOString(),this.saveToStorage(),console.log(`[AlertEngine] Alerta reconhecido: ${e} por ${s}`),!0):!1}resolveAlert(e,s){const t=this.alerts.find(i=>i.id===e);return t?(t.resolved=!0,t.resolvedAt=new Date().toISOString(),s&&(t.resolutionNote=s),this.saveToStorage(),console.log(`[AlertEngine] Alerta resolvido: ${e}`),!0):!1}getActiveAlerts(){return this.alerts.filter(e=>!e.resolved)}getAlertsBySeverity(e){return this.alerts.filter(s=>s.severity===e&&!s.resolved)}getAlertsByMeter(e){return this.alerts.filter(s=>s.meterId===e)}getAlertCounts(){const e=this.getActiveAlerts();return{critical:e.filter(s=>s.severity==="critical").length,warning:e.filter(s=>s.severity==="warning").length,info:e.filter(s=>s.severity==="info").length}}getAllAlerts(){return[...this.alerts]}cleanupOldAlerts(){const e=Date.now()-2592e6,s=this.alerts.length;return this.alerts=this.alerts.filter(t=>t.resolved?new Date(t.timestamp).getTime()>e:!0),this.saveToStorage(),s-this.alerts.length}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}clearAll(){}}new AlertEngineService;function MonitoringPage(){return jsxRuntimeExports.jsx(MonitoringDashboard,{})}function CalibrationEventsList({onSelectEvent:r}){const{calibrationEvents:e,setShowNewEventModal:s,deleteCalibrationEvent:t}=useAppStore(),[i,a]=reactExports.useState("all"),o=e.filter(h=>i==="all"?!0:i==="active"?h.status==="Em Andamento":i==="pending"?h.status==="Pendente":i==="completed"?h.status==="Concluída":!0),w=(h,l)=>{h.stopPropagation(),confirm("Tem certeza que deseja remover este evento de calibração?")&&t(l)},S=h=>{switch(h){case"Concluída":return CheckCircle;case"Em Andamento":return Play;default:return Clock}},y=h=>{switch(h){case"Concluída":return"bg-emerald-500/20";case"Em Andamento":return"bg-blue-500/20";default:return"bg-zinc-700"}},u=h=>{switch(h){case"Concluída":return"text-emerald-400";case"Em Andamento":return"text-blue-400";default:return"text-zinc-400"}};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-white",children:"Eventos de Calibração"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Avaliações de desempenho MPFM - Comissionamento, Periódica, Investigação"})]}),jsxRuntimeExports.jsx(Button,{onClick:()=>s(!0),icon:Plus,children:"Nova Avaliação"})]}),jsxRuntimeExports.jsx(Tabs,{tabs:[{id:"all",label:"Todos",count:e.length},{id:"active",label:"Em Andamento",count:e.filter(h=>h.status==="Em Andamento").length},{id:"pending",label:"Pendentes",count:e.filter(h=>h.status==="Pendente").length},{id:"completed",label:"Concluídas",count:e.filter(h=>h.status==="Concluída").length}],activeTab:i,onChange:a}),o.length===0?jsxRuntimeExports.jsxs(Card,{className:"p-8 text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-zinc-500 mb-4",children:i==="all"?"Nenhum evento de calibração cadastrado.":`Nenhum evento com status "${i==="active"?"Em Andamento":i==="pending"?"Pendente":"Concluída"}".`}),i==="all"&&jsxRuntimeExports.jsx(Button,{variant:"primary",size:"sm",icon:Plus,onClick:()=>s(!0),children:"Criar Primeira Avaliação"})]}):jsxRuntimeExports.jsx("div",{className:"grid gap-3",children:o.map(h=>{const l=S(h.status);return jsxRuntimeExports.jsx(Card,{className:"hover:ring-1 hover:ring-blue-500/50 cursor-pointer transition",noPadding:!0,children:jsxRuntimeExports.jsx("div",{className:"p-4",onClick:()=>r(h),children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4",children:[jsxRuntimeExports.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${y(h.status)}`,children:jsxRuntimeExports.jsx(l,{className:`w-6 h-6 ${u(h.status)}`})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-white",children:h.id}),jsxRuntimeExports.jsx(Badge,{variant:h.status==="Concluída"?"success":h.status==="Em Andamento"?"info":"warning",children:h.status}),jsxRuntimeExports.jsx(Badge,{variant:"purple",children:h.type}),h.result&&jsxRuntimeExports.jsx(Badge,{variant:h.result==="Aprovado"?"success":"error",children:h.result})]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-zinc-400 mt-1",children:[jsxRuntimeExports.jsx("span",{className:"text-blue-400",children:h.meterTag})," -"," ",h.meterName," | Início: ",h.startDate," | Resp:"," ",h.responsible]}),jsxRuntimeExports.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 max-w-xs",children:jsxRuntimeExports.jsx(ProgressBar,{value:h.progress,color:h.status==="Concluída"?"emerald":"blue",showLabel:!1,size:"sm"})}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-zinc-400",children:["Etapa ",h.currentStep,"/7"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:c=>w(c,h.id),className:"p-2 hover:bg-zinc-700 rounded-lg transition-colors",title:"Remover evento",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4 text-zinc-400 hover:text-red-400"})}),jsxRuntimeExports.jsx(ChevronRight,{className:"w-5 h-5 text-zinc-500"})]})]})})},h.id)})})]})}function Step01Registro({event:r}){const{calibrationFormData:e,updateCalibrationFormData:s,user:t}=useAppStore(),i=(o,w)=>{s({[o]:w})},a=e||{eventId:r.id,status:r.status,resultado:"",operador:"Equinor Brasil Energia Ltda.",serviceOrder:"-",responsavelCalibracao:r.responsible||t.name,preenchidoPor:t.name,dataEmissao:new Date().toISOString().split("T")[0],unidade:"FPSO Bacalhau",baciaCampo:"Santos / Bacalhau",localizacao:`MEDIDOR SUBSEA - Poço ${r.meterName}`,referenciaMet:"Separador de Teste - TAG: 20VA121",tagMPFM:r.meterTag,serialNumber:"",fabricante:"TechnipFMC",modelo:"MPM High-Performance Flowmeter",tamanho:'5"',razaoBeta:"B = 0.7 MPM",modoMedicao:"Dual Mode",sistema:r.meterName,versaoSoftwareMedidor:"",versaoFPM207:"",versaoFCS320:"",versaoPVTsim:"",naturezaAtividade:`${r.type} - ${r.meterName} - ${r.meterTag}`,idEventoDesvio:"-",inicioEstabilizacao:"",inicioTotalizacao:"",fimTotalizacao:"",duracaoEfetiva:24,observacoesIniciais:"",comentariosGerais:""};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Clipboard,title:"Identificação do Responsável e Autoridade",color:"blue"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"ID do Evento/Relatório",value:a.eventId,readOnly:!0}),jsxRuntimeExports.jsx(Select,{label:"Status",value:a.status,onChange:o=>i("status",o.target.value),options:[{value:"Em Andamento",label:"Em Andamento"},{value:"Aguardando PVT",label:"Aguardando PVT"},{value:"Em Totalização",label:"Em Totalização"},{value:"Concluída",label:"Concluída"}]}),jsxRuntimeExports.jsx(Input,{label:"Operador",value:a.operador,onChange:o=>i("operador",o.target.value)}),jsxRuntimeExports.jsx(Select,{label:"Resultado",value:a.resultado,onChange:o=>i("resultado",o.target.value),options:[{value:"",label:"Pendente"},{value:"Aprovado",label:"Aprovado"},{value:"Reprovado",label:"Reprovado"}]}),jsxRuntimeExports.jsx(Input,{label:"Ordem de Serviço (S.O.)",value:a.serviceOrder,onChange:o=>i("serviceOrder",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Responsável Calibração",value:a.responsavelCalibracao,onChange:o=>i("responsavelCalibracao",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Preenchido por",value:a.preenchidoPor,onChange:o=>i("preenchidoPor",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Data de Emissão",type:"date",value:a.dataEmissao,onChange:o=>i("dataEmissao",o.target.value)})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Database,title:"Dados da Instalação",color:"purple"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"Unidade / FPSO",value:a.unidade,onChange:o=>i("unidade",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Bacia / Campo",value:a.baciaCampo,onChange:o=>i("baciaCampo",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Localização na Planta",value:a.localizacao,onChange:o=>i("localizacao",o.target.value),className:"col-span-2"}),jsxRuntimeExports.jsx(Input,{label:"Referência Metrológica (Autorizada)",value:a.referenciaMet,onChange:o=>i("referenciaMet",o.target.value),className:"col-span-2"})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Gauge,title:"Identificação do Instrumento (MPFM)",color:"amber"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"TAG do MPFM",value:a.tagMPFM,readOnly:!0}),jsxRuntimeExports.jsx(Input,{label:"Número de Série (S/N)",value:a.serialNumber,onChange:o=>i("serialNumber",o.target.value),placeholder:"Ex: 14-100269"}),jsxRuntimeExports.jsx(Input,{label:"Fabricante",value:a.fabricante,onChange:o=>i("fabricante",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Modelo",value:a.modelo,onChange:o=>i("modelo",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Tamanho",value:a.tamanho,onChange:o=>i("tamanho",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Razão Beta",value:a.razaoBeta,onChange:o=>i("razaoBeta",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Modo de Medição Ativo",value:a.modoMedicao,onChange:o=>i("modoMedicao",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Sistema",value:a.sistema,readOnly:!0})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Settings,title:"Configuração de Software e Integridade",color:"emerald"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"Versão de Software (Medidor)",value:a.versaoSoftwareMedidor,onChange:o=>i("versaoSoftwareMedidor",o.target.value),placeholder:"Ex: FW-MPM-BAC-v1.12.3"}),jsxRuntimeExports.jsx(Input,{label:"Versão do Computador de Vazão FPM207",value:a.versaoFPM207,onChange:o=>i("versaoFPM207",o.target.value),placeholder:"Ex: v2.8.5"}),jsxRuntimeExports.jsx(Input,{label:"Versão do Software FCS320",value:a.versaoFCS320,onChange:o=>i("versaoFCS320",o.target.value),placeholder:"Ex: v8.4.1 Build 710"}),jsxRuntimeExports.jsx(Input,{label:"Software de Simulação (Calsep PVTsim)",value:a.versaoPVTsim,onChange:o=>i("versaoPVTsim",o.target.value),placeholder:"Ex: v23.1.0"})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Calendar,title:"Escopo e Período do Teste de Calibração",color:"red"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"Natureza da Atividade",value:a.naturezaAtividade,className:"col-span-2",readOnly:!0}),jsxRuntimeExports.jsx(Input,{label:"ID do Evento de Desvio (se aplicável)",value:a.idEventoDesvio,onChange:o=>i("idEventoDesvio",o.target.value)}),jsxRuntimeExports.jsx("div",{}),jsxRuntimeExports.jsx(Input,{label:"Início da Estabilização",type:"datetime-local",value:a.inicioEstabilizacao,onChange:o=>i("inicioEstabilizacao",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Início da Totalização (24h)",type:"datetime-local",value:a.inicioTotalizacao,onChange:o=>i("inicioTotalizacao",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Fim da Totalização",type:"datetime-local",value:a.fimTotalizacao,onChange:o=>i("fimTotalizacao",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Duração Total Efetiva (h)",value:String(a.duracaoEfetiva),unit:"h",readOnly:!0}),jsxRuntimeExports.jsx(Input,{label:"Observações Iniciais",className:"col-span-2",value:a.observacoesIniciais,onChange:o=>i("observacoesIniciais",o.target.value),placeholder:"Observações..."})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:FileText,title:"Comentários Gerais"}),jsxRuntimeExports.jsx("textarea",{className:"w-full h-24 px-3 py-2 bg-zinc-800 border border-zinc-700 rounded-lg text-sm text-white placeholder-zinc-500 focus:outline-none focus:border-blue-500",placeholder:"Observações adicionais sobre o evento de calibração...",value:a.comentariosGerais,onChange:o=>i("comentariosGerais",o.target.value)})]})]})}const defaultComposition=[{component:"N₂",molecularWeight:28.01,molPercent:0,normalizedMolPercent:0},{component:"CO₂",molecularWeight:44.01,molPercent:0,normalizedMolPercent:0},{component:"H₂S",molecularWeight:34.08,molPercent:0,normalizedMolPercent:0},{component:"C₁",molecularWeight:16.04,molPercent:0,normalizedMolPercent:0},{component:"C₂",molecularWeight:30.07,molPercent:0,normalizedMolPercent:0},{component:"C₃",molecularWeight:44.1,molPercent:0,normalizedMolPercent:0},{component:"i-C₄",molecularWeight:58.12,molPercent:0,normalizedMolPercent:0},{component:"n-C₄",molecularWeight:58.12,molPercent:0,normalizedMolPercent:0},{component:"i-C₅",molecularWeight:72.15,molPercent:0,normalizedMolPercent:0},{component:"n-C₅",molecularWeight:72.15,molPercent:0,normalizedMolPercent:0},{component:"C₆",molecularWeight:86.18,molPercent:0,normalizedMolPercent:0},{component:"C₇+",molecularWeight:97.37,molPercent:0,normalizedMolPercent:0}];function Step02PVT(){const{calibrationFormData:r,updateCalibrationFormData:e}=useAppStore(),[s,t]=reactExports.useState((r==null?void 0:r.composicao)||defaultComposition),i=r||{pvtReportId:"",dataAmostragem:"",pontoAmostragem:"Separador",softwareModelagem:"PVTsim",versaoModelo:"",statusAprovacao:"Pendente",dataAprovacao:"",comentariosPVT:"",densidadeOleo:0,densidadeGas:0,densidadeAgua:0,gor:0,bsw:0,fatorEncolhimento:0,penelouxGas:1,penelouxOil:1,pvtLoadedFCS320:!1,pvtLoadedFPM207:!1,gammaRestarted:!1,pressureVerified:!1,temperatureVerified:!1},a=(h,l)=>{e({[h]:l})},o=(h,l)=>{const c=[...s];c[h]={...c[h],molPercent:l},t(c)},w=()=>{e({pvtReportId:`Calibration #${realCalibrationPVT.calibrationNo}`,dataAmostragem:realCalibrationPVT.startDate,pontoAmostragem:"Separador de Teste",softwareModelagem:"PVTsim",versaoModelo:"v23.1.0",statusAprovacao:"Aprovado",dataAprovacao:realCalibrationPVT.endDate,comentariosPVT:`Dados reais do FPSO Bacalhau - ${realCalibrationPVT.meterName}`,densidadeOleo:realCalibrationPVT.densities.oil.mpfm,densidadeGas:realCalibrationPVT.densities.gas.mpfm,densidadeAgua:realCalibrationPVT.densities.water.mpfm,gor:350,bsw:.02,fatorEncolhimento:.85,penelouxGas:realCalibrationPVT.peneloux.gas,penelouxOil:realCalibrationPVT.peneloux.oil,pvtLoadedFCS320:!0,pvtLoadedFPM207:!0,gammaRestarted:!0,pressureVerified:!0,temperatureVerified:!0});const h=realCalibrationPVT.composition.map(l=>({component:l.component,molecularWeight:l.molecularWeight,molPercent:l.molPercent,normalizedMolPercent:l.molPercent}));t(h),e({composicao:h})};reactExports.useEffect(()=>{const h=setTimeout(()=>{e({composicao:s})},500);return()=>clearTimeout(h)},[s,e]);const S=s.reduce((h,l)=>h+l.molPercent,0),y=S>0?s.reduce((h,l)=>h+l.molPercent*l.molecularWeight,0)/S:0,u=[{key:"pvtLoadedFCS320",label:"PVT carregada no FCS320"},{key:"pvtLoadedFPM207",label:"PVT carregada no FPM207"},{key:"gammaRestarted",label:"Gamma reiniciado"},{key:"pressureVerified",label:"Pressão verificada"},{key:"temperatureVerified",label:"Temperatura verificada"}];return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:FlaskConical,title:"Identificação do Relatório PVT / Amostragem",color:"purple"}),jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",onClick:w,className:"flex items-center gap-2 text-purple-400 border-purple-500/30 hover:bg-purple-500/10",children:[jsxRuntimeExports.jsx(Sparkles,{size:14}),"Carregar Dados Reais (Cal. #211)"]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"ID do Relatório Laboratorial",value:i.pvtReportId,onChange:h=>a("pvtReportId",h.target.value),className:"col-span-2",placeholder:"Ex: SLB - P.1077663_2025BRRD-P004039"}),jsxRuntimeExports.jsx(Input,{label:"Data da Amostragem",type:"date",value:i.dataAmostragem,onChange:h=>a("dataAmostragem",h.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Ponto de Amostragem",value:i.pontoAmostragem,onChange:h=>a("pontoAmostragem",h.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Software de Modelagem",value:i.softwareModelagem,onChange:h=>a("softwareModelagem",h.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Versão/Arquivo do Modelo",value:i.versaoModelo,onChange:h=>a("versaoModelo",h.target.value),placeholder:"Ex: v23.1.0"}),jsxRuntimeExports.jsx(Select,{label:"Status de Aprovação (PVT GROUP)",value:i.statusAprovacao,onChange:h=>a("statusAprovacao",h.target.value),options:[{value:"Pendente",label:"Pendente"},{value:"Em Análise",label:"Em Análise"},{value:"Aprovado",label:"Aprovado"},{value:"Reprovado",label:"Reprovado"}]}),jsxRuntimeExports.jsx(Input,{label:"Data de Aprovação",type:"date",value:i.dataAprovacao,onChange:h=>a("dataAprovacao",h.target.value)})]}),jsxRuntimeExports.jsx("div",{className:"mt-3",children:jsxRuntimeExports.jsx(Input,{label:"Comentários",value:i.comentariosPVT,onChange:h=>a("comentariosPVT",h.target.value),placeholder:"Observações sobre o relatório PVT..."})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Beaker,title:"Propriedades de Referência (@std)",color:"blue"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"Densidade Óleo",type:"number",value:i.densidadeOleo||"",onChange:h=>a("densidadeOleo",parseFloat(h.target.value)||0),unit:"kg/m³",placeholder:"773.41"}),jsxRuntimeExports.jsx(Input,{label:"Densidade Gás",type:"number",value:i.densidadeGas||"",onChange:h=>a("densidadeGas",parseFloat(h.target.value)||0),unit:"kg/m³",placeholder:"0.87"}),jsxRuntimeExports.jsx(Input,{label:"Densidade Água",type:"number",value:i.densidadeAgua||"",onChange:h=>a("densidadeAgua",parseFloat(h.target.value)||0),unit:"kg/m³",placeholder:"1.25"}),jsxRuntimeExports.jsx(Input,{label:"GOR",type:"number",value:i.gor||"",onChange:h=>a("gor",parseFloat(h.target.value)||0),unit:"Sm³/Sm³",placeholder:"216.81"}),jsxRuntimeExports.jsx(Input,{label:"BSW",type:"number",value:i.bsw||"",onChange:h=>a("bsw",parseFloat(h.target.value)||0),unit:"%",placeholder:"5.5"})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Database,title:"Composição molar (mol%)",color:"amber"}),jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Componente"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"Massa Molar"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"mol% (entrada)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"mol% (normalizado)"})]})}),jsxRuntimeExports.jsx("tbody",{children:s.map((h,l)=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50",children:[jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-zinc-200",children:h.component}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-right text-zinc-400",children:h.molecularWeight.toFixed(2)}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-right",children:jsxRuntimeExports.jsx("input",{type:"number",step:"0.001",value:h.molPercent||"",onChange:c=>o(l,parseFloat(c.target.value)||0),className:"w-20 px-2 py-1 bg-zinc-800 border border-zinc-700 rounded text-xs text-blue-400 text-right",placeholder:"0.000",title:`mol% de ${h.component}`})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-right text-emerald-400",children:S>0?(h.molPercent/S*100).toFixed(3):"0.000"})]},h.component))}),jsxRuntimeExports.jsxs("tfoot",{className:"bg-zinc-800/50",children:[jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-zinc-200 font-medium",children:"Soma mol%"}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2"}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-right text-blue-400 font-medium",children:S.toFixed(3)}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-right text-emerald-400 font-medium",children:"100.000"})]}),jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-zinc-200 font-medium",children:"MW mistura"}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2"}),jsxRuntimeExports.jsxs("td",{className:"py-2 px-2 text-right text-amber-400 font-medium",colSpan:2,children:[y.toFixed(2)," kg/kmol"]})]})]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Layers,title:"Fatores Peneloux",color:"emerald"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[jsxRuntimeExports.jsx(Input,{label:"Peneloux Gas",type:"number",step:"0.001",value:i.penelouxGas||"",onChange:h=>a("penelouxGas",parseFloat(h.target.value)||1),inputSize:"sm"}),jsxRuntimeExports.jsx(Input,{label:"Peneloux Oil",type:"number",step:"0.001",value:i.penelouxOil||"",onChange:h=>a("penelouxOil",parseFloat(h.target.value)||1),inputSize:"sm"})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:CheckCircle,title:"Controle de Aplicação PVT",color:"emerald"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mb-3",children:"Clique para alternar"}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:u.map(h=>{const l=i[h.key];return jsxRuntimeExports.jsxs("button",{type:"button",onClick:()=>a(h.key,!l),className:"w-full flex items-center justify-between p-2 bg-zinc-800/50 rounded hover:bg-zinc-700/50 transition-colors",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-zinc-300",children:h.label}),jsxRuntimeExports.jsx(Badge,{variant:l?"OK":"Pendente",size:"sm",children:l?"OK":"Pendente"})]},h.key)})})]})]})]})}const generateRowId=()=>`tot-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;function Step03Totalizadores(){const{calibrationFormData:r,updateCalibrationFormData:e}=useAppStore(),[s,t]=reactExports.useState((r==null?void 0:r.totalizadores)||[]),i=(_,f)=>{if(!_||!f)return 0;const p=new Date(_),A=new Date(f);return Math.max(0,(A.getTime()-p.getTime())/(1e3*60*60))},a=(_,f)=>_+f,o=reactExports.useCallback(()=>{const _={id:generateRowId(),startTime:"",endTime:"",deltaHours:0,mpfmOil:0,mpfmGas:0,mpfmWater:0,mpfmHC:0,mpfmTotal:0,refOilVolume:0,refOilDensity:0,refOilMassCalc:0,refOilMassPI:0,refGas:0,refWater:0,refHC:0,status:"Pendente"},f=[...s,_];t(f),e({totalizadores:f})},[s,e]),w=reactExports.useCallback(_=>{const f=s.filter(p=>p.id!==_);t(f),e({totalizadores:f})},[s,e]),S=reactExports.useCallback((_,f,p)=>{const A=s.map(k=>{if(k.id!==_)return k;const P={...k,[f]:p};if((f==="startTime"||f==="endTime")&&(P.deltaHours=i(f==="startTime"?String(p):k.startTime,f==="endTime"?String(p):k.endTime)),f==="mpfmOil"||f==="mpfmGas"){const g=f==="mpfmOil"?Number(p):k.mpfmOil,R=f==="mpfmGas"?Number(p):k.mpfmGas;P.mpfmHC=a(g,R)}if(f==="refOilMassCalc"||f==="refGas"){const g=f==="refOilMassCalc"?Number(p):k.refOilMassCalc,R=f==="refGas"?Number(p):k.refGas;P.refHC=a(g,R)}return P.deltaHours>=24&&P.mpfmOil>0&&P.refOilMassCalc>0?P.status="OK":P.startTime&&P.endTime&&(P.status="Parcial"),P});t(A),e({totalizadores:A})},[s,e]),y=s.reduce((_,f)=>_+f.mpfmOil,0),u=s.reduce((_,f)=>_+f.mpfmGas,0),h=s.reduce((_,f)=>_+f.mpfmHC,0),l=s.reduce((_,f)=>_+f.refOilMassCalc,0),c=s.reduce((_,f)=>_+f.refGas,0),b=s.reduce((_,f)=>_+f.deltaHours,0);return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-blue-300",children:[jsxRuntimeExports.jsx(Info,{className:"w-3 h-3 inline mr-1"}),"Adicione períodos de totalização. As deltas e totais são calculados automaticamente. O período total deve ser de no mínimo 24 horas."]})}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Database,title:"Totalizadores / Horário (mínimo 24h)",color:"blue"}),jsxRuntimeExports.jsx(Button,{variant:"primary",size:"sm",icon:Plus,onClick:o,children:"Adicionar Período"})]}),s.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-8 text-zinc-500",children:[jsxRuntimeExports.jsx(Database,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),jsxRuntimeExports.jsx("p",{children:"Nenhum período de totalização adicionado."}),jsxRuntimeExports.jsx("p",{className:"text-xs mt-1",children:'Clique em "Adicionar Período" para começar.'})]}):jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-left text-zinc-400",children:"Início"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-left text-zinc-400",children:"Fim"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-center text-zinc-400",children:"Δt (h)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-right text-blue-400",children:"MPFM Óleo (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-right text-blue-400",children:"MPFM Gás (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-right text-blue-400",children:"HC (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-right text-emerald-400",children:"REF Óleo (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-right text-emerald-400",children:"REF Gás (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-center text-zinc-400",children:"Status"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 w-8"})]})}),jsxRuntimeExports.jsx("tbody",{children:s.map(_=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50",children:[jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"datetime-local",value:_.startTime,onChange:f=>S(_.id,"startTime",f.target.value),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",title:"Início do período"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"datetime-local",value:_.endTime,onChange:f=>S(_.id,"endTime",f.target.value),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",title:"Fim do período"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1 text-center text-zinc-400",children:_.deltaHours.toFixed(2)}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"number",value:_.mpfmOil||"",onChange:f=>S(_.id,"mpfmOil",parseFloat(f.target.value)||0),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-blue-400 text-right",placeholder:"0",title:"MPFM Óleo"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"number",value:_.mpfmGas||"",onChange:f=>S(_.id,"mpfmGas",parseFloat(f.target.value)||0),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-blue-400 text-right",placeholder:"0",title:"MPFM Gás"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1 text-right text-blue-400 font-medium",children:formatNumber(_.mpfmHC)}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"number",value:_.refOilMassCalc||"",onChange:f=>S(_.id,"refOilMassCalc",parseFloat(f.target.value)||0),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-emerald-400 text-right",placeholder:"0",title:"Referência Óleo"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"number",value:_.refGas||"",onChange:f=>S(_.id,"refGas",parseFloat(f.target.value)||0),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-emerald-400 text-right",placeholder:"0",title:"Referência Gás"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:_.status,size:"sm",children:_.status})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>w(_.id),className:"p-1 text-red-400 hover:text-red-300 transition-colors",title:"Remover período",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3 h-3"})})})]},_.id))})]})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Calculator,title:"Total - Somatório",color:"amber"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-6 gap-3",children:[jsxRuntimeExports.jsxs("div",{className:`p-3 rounded-lg ${b>=24?"bg-emerald-500/10 border border-emerald-500/20":"bg-zinc-800/50"}`,children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Duração Total"}),jsxRuntimeExports.jsxs("p",{className:`text-lg font-bold ${b>=24?"text-emerald-400":"text-white"}`,children:[b.toFixed(1),"h"]}),b<24&&jsxRuntimeExports.jsx("p",{className:"text-xs text-amber-400",children:"Mínimo 24h"})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/20",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"MPFM Óleo"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-blue-400",children:formatNumber(y)})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/20",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"MPFM Gás"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-blue-400",children:formatNumber(u)})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/20",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"MPFM HC"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-blue-400",children:formatNumber(h)})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-emerald-500/10 rounded-lg border border-emerald-500/20",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"REF Óleo"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-emerald-400",children:formatNumber(l)})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-emerald-500/10 rounded-lg border border-emerald-500/20",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"REF Gás"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-emerald-400",children:formatNumber(c)})]})]})]})]})}function Step04KFactors(){var u,h;const{calibrationFormData:r,updateCalibrationFormData:e}=useAppStore(),s=r||{kMin:ANP_LIMITS.K_FACTOR_MIN,kMax:ANP_LIMITS.K_FACTOR_MAX,limiteHC:ANP_LIMITS.HC_BALANCE_ERROR,limiteTotal:ANP_LIMITS.TOTAL_BALANCE_ERROR,massas:{oleo:{mpfm:0,ref:0},gas:{mpfm:0,ref:0},agua:{mpfm:0,ref:0}},totalizadores:[]},t=reactExports.useMemo(()=>{const l=s.totalizadores||[];return{mpfmOil:l.reduce((c,b)=>c+b.mpfmOil,0),mpfmGas:l.reduce((c,b)=>c+b.mpfmGas,0),refOil:l.reduce((c,b)=>c+b.refOilMassCalc,0),refGas:l.reduce((c,b)=>c+b.refGas,0)}},[s.totalizadores]),i=(l,c,b)=>l>=c&&l<=b,a=reactExports.useMemo(()=>{var _,f;const l=calculateKFactor(t.refOil,t.mpfmOil),c=calculateKFactor(t.refGas,t.mpfmGas),b=((f=(_=s.massas)==null?void 0:_.agua)==null?void 0:f.mpfm)>0?calculateKFactor(s.massas.agua.ref,s.massas.agua.mpfm):1;return{kOil:l,kGas:c,kWater:b,kOilStatus:i(l,s.kMin,s.kMax)?"Dentro":"Fora",kGasStatus:i(c,s.kMin,s.kMax)?"Dentro":"Fora",kWaterStatus:i(b,s.kMin,s.kMax)?"Dentro":"Fora"}},[t,s.kMin,s.kMax,s.massas]),o=reactExports.useMemo(()=>{var _,f,p,A,k,P,g,R;const l=(E,C)=>C===0?0:(E-C)/C*100,c=t.mpfmOil+t.mpfmGas,b=t.refOil+t.refGas;return[{fase:"Óleo",mpfm:t.mpfmOil,ref:t.refOil,desvio:l(t.mpfmOil,t.refOil)},{fase:"Gás",mpfm:t.mpfmGas,ref:t.refGas,desvio:l(t.mpfmGas,t.refGas)},{fase:"Água",mpfm:((f=(_=s.massas)==null?void 0:_.agua)==null?void 0:f.mpfm)||0,ref:((A=(p=s.massas)==null?void 0:p.agua)==null?void 0:A.ref)||0,desvio:l(((P=(k=s.massas)==null?void 0:k.agua)==null?void 0:P.mpfm)||0,((R=(g=s.massas)==null?void 0:g.agua)==null?void 0:R.ref)||0)},{fase:"HC (Total)",mpfm:c,ref:b,desvio:l(c,b),isTotal:!0}]},[t,s.massas]);reactExports.useEffect(()=>{var l;e({kFactors:a,massas:{oleo:{mpfm:t.mpfmOil,ref:t.refOil},gas:{mpfm:t.mpfmGas,ref:t.refGas},agua:((l=s.massas)==null?void 0:l.agua)||{mpfm:0,ref:0}}})},[a,t,e,(u=s.massas)==null?void 0:u.agua]);const w=(l,c)=>{e({[l]:c})},S=a.kOilStatus==="Dentro"&&a.kGasStatus==="Dentro",y=((h=o.find(l=>l.fase==="HC (Total)"))==null?void 0:h.desvio)||0;return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[t.mpfmOil>0&&t.refOil>0&&jsxRuntimeExports.jsx("div",{className:cn("p-4 rounded-lg flex items-center gap-3",S&&Math.abs(y)<=s.limiteHC?"bg-emerald-500/10 border border-emerald-500/20":"bg-red-500/10 border border-red-500/20"),children:S&&Math.abs(y)<=s.limiteHC?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CheckCircle,{className:"w-5 h-5 text-emerald-400"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-emerald-400",children:"K-Factors dentro do limite"}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-zinc-400",children:["Todos os fatores estão entre ",s.kMin," e ",s.kMax]})]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-5 h-5 text-red-400"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-red-400",children:"K-Factors fora do limite"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-400",children:"Um ou mais fatores estão fora do intervalo permitido"})]})]})}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Settings,title:"Parâmetros de Aceitação (ANP 44/2015)",color:"amber"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"K mínimo",type:"number",step:"0.01",value:s.kMin,onChange:l=>w("kMin",parseFloat(l.target.value)||.8)}),jsxRuntimeExports.jsx(Input,{label:"K máximo",type:"number",step:"0.01",value:s.kMax,onChange:l=>w("kMax",parseFloat(l.target.value)||1.2)}),jsxRuntimeExports.jsx(Input,{label:"Limite desvio HC (±)",type:"number",step:"0.1",value:s.limiteHC,onChange:l=>w("limiteHC",parseFloat(l.target.value)||10),unit:"%"}),jsxRuntimeExports.jsx(Input,{label:"Limite desvio Total (±)",type:"number",step:"0.1",value:s.limiteTotal,onChange:l=>w("limiteTotal",parseFloat(l.target.value)||7),unit:"%"})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Database,title:"Massas Totalizadas (24h)",color:"blue"}),t.mpfmOil===0&&t.refOil===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-6 text-zinc-500",children:[jsxRuntimeExports.jsx(Database,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"Nenhum dado de totalização"}),jsxRuntimeExports.jsx("p",{className:"text-xs",children:"Preencha os totalizadores no passo anterior"})]}):jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Fase"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-blue-400",children:"MPFM (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-emerald-400",children:"Ref (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"Desvio"})]})}),jsxRuntimeExports.jsx("tbody",{children:o.map(l=>jsxRuntimeExports.jsxs("tr",{className:cn("border-b border-zinc-800/50",l.isTotal&&"bg-zinc-800/30 font-medium"),children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-zinc-200",children:l.fase}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-right text-blue-400",children:l.mpfm.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-right text-emerald-400",children:l.ref.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsxs("td",{className:cn("py-2 px-2 text-right",l.isTotal?Math.abs(l.desvio)>s.limiteHC?"text-red-400":"text-emerald-400":Math.abs(l.desvio)>20?"text-red-400":"text-zinc-300"),children:[l.desvio.toFixed(1),"%"]})]},l.fase))})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Calculator,title:"K-Factors Calculados",color:"purple"}),t.mpfmOil===0&&t.refOil===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-6 text-zinc-500",children:[jsxRuntimeExports.jsx(Calculator,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"K-Factors serão calculados"}),jsxRuntimeExports.jsx("p",{className:"text-xs",children:"após preenchimento dos totalizadores"})]}):jsxRuntimeExports.jsx("div",{className:"space-y-3",children:[{fase:"K-Oil (Óleo)",k:a.kOil,status:a.kOilStatus},{fase:"K-Gas (Gás)",k:a.kGas,status:a.kGasStatus},{fase:"K-Water (Água)",k:a.kWater,status:a.kWaterStatus}].map(l=>jsxRuntimeExports.jsxs("div",{className:cn("p-3 rounded-lg flex items-center justify-between",l.status==="Fora"?"bg-red-500/10 border border-red-500/20":"bg-emerald-500/10 border border-emerald-500/20"),children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-zinc-400",children:l.fase}),jsxRuntimeExports.jsx("p",{className:cn("text-xl font-bold font-mono",l.status==="Fora"?"text-red-400":"text-emerald-400"),children:l.k.toFixed(4)})]}),jsxRuntimeExports.jsx(Badge,{variant:l.status==="Dentro"?"OK":"Fora",children:l.status==="Dentro"?`${s.kMin} - ${s.kMax}`:"Fora"})]},l.fase))}),jsxRuntimeExports.jsxs("div",{className:"mt-4 p-3 bg-zinc-800/50 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mb-2",children:"Fórmula ANP 44/2015:"}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-zinc-400 font-mono",children:["K = Massa",jsxRuntimeExports.jsx("sub",{children:"REF"})," / Massa",jsxRuntimeExports.jsx("sub",{children:"MPFM"})]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-zinc-500 mt-2",children:["Intervalo válido: ",s.kMin," ≤ K ≤ ",s.kMax]})]})]})]})]})}const defaultEnvelope=[{id:"gvf",item:"GVF (%)",value:0,limit:95,status:"Pendente"},{id:"pressure",item:"Pressão (bar)",value:0,limit:500,status:"Pendente"},{id:"temperature",item:"Temperatura (°C)",value:0,limit:150,status:"Pendente"},{id:"flow",item:"Vazão (m³/h)",value:0,limit:1e3,status:"Pendente"},{id:"bsw",item:"BSW (%)",value:0,limit:50,status:"Pendente"}];function Step05Balanco(){const{calibrationFormData:r,updateCalibrationFormData:e}=useAppStore(),s=r||{balancoTopOil:0,balancoTopGas:0,balancoGasLift:0,balancoDesvio:0},[t,i]=reactExports.useState(defaultEnvelope),a=reactExports.useMemo(()=>{const y=s.totalizadores||[],u=y.reduce((_,f)=>_+(f.mpfmOil||0),0),h=y.reduce((_,f)=>_+(f.mpfmGas||0),0),l=u+h,c=s.balancoTopOil+s.balancoTopGas-s.balancoGasLift,b=l>0?(c-l)/l*100:0;return{subseaTotal:l,topsideTotal:c,desvio:b,status:Math.abs(b)<=10?"Dentro":"Fora"}},[s]),o=(y,u)=>{e({[y]:u,balancoDesvio:a.desvio})},w=(y,u,h)=>{i(l=>l.map(c=>{if(c.id!==y)return c;const b={...c,[u]:h};return b.value>0&&b.limit>0&&(b.status=b.value<=b.limit?"OK":"Fora"),b}))},S=t.every(y=>y.status==="OK"||y.status==="Pendente");return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Target,title:"Balanço HC Subsea vs Topside (com desconto de Gás Lift)",color:"blue"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[jsxRuntimeExports.jsx(Input,{label:"MPFM Topside – Óleo (kg)",type:"number",value:s.balancoTopOil||"",onChange:y=>o("balancoTopOil",parseFloat(y.target.value)||0),placeholder:"0"}),jsxRuntimeExports.jsx(Input,{label:"MPFM Topside – Gás (kg)",type:"number",value:s.balancoTopGas||"",onChange:y=>o("balancoTopGas",parseFloat(y.target.value)||0),placeholder:"0"}),jsxRuntimeExports.jsx(Input,{label:"Gás Lift – Gás (kg)",type:"number",value:s.balancoGasLift||"",onChange:y=>o("balancoGasLift",parseFloat(y.target.value)||0),placeholder:"0"}),jsxRuntimeExports.jsx(Input,{label:"Desvio (%)",value:a.desvio.toFixed(2),readOnly:!0,className:cn(Math.abs(a.desvio)>10&&"text-red-400")})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/20 text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"MPFM Subsea (Total)"}),jsxRuntimeExports.jsxs("p",{className:"text-lg font-bold text-blue-400",children:[a.subseaTotal.toLocaleString("pt-BR",{maximumFractionDigits:0})," kg"]})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-emerald-500/10 rounded-lg border border-emerald-500/20 text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Topside (Corrigido)"}),jsxRuntimeExports.jsxs("p",{className:"text-lg font-bold text-emerald-400",children:[a.topsideTotal.toLocaleString("pt-BR",{maximumFractionDigits:0})," kg"]})]}),jsxRuntimeExports.jsxs("div",{className:cn("p-3 rounded-lg text-center",a.status==="Dentro"?"bg-emerald-500/10 border border-emerald-500/20":"bg-red-500/10 border border-red-500/20"),children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Desvio"}),jsxRuntimeExports.jsxs("p",{className:cn("text-lg font-bold",a.status==="Dentro"?"text-emerald-400":"text-red-400"),children:[a.desvio.toFixed(1),"%"]})]})]}),jsxRuntimeExports.jsx("div",{className:cn("p-3 rounded-lg flex items-center gap-2",a.status==="Dentro"?"bg-emerald-500/10 border border-emerald-500/20":"bg-red-500/10 border border-red-500/20"),children:a.status==="Dentro"?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CheckCircle,{className:"w-4 h-4 text-emerald-400"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-emerald-300",children:"Status (±10%): Dentro do limite"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-4 h-4 text-red-400"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-red-300",children:"Status (±10%): Fora do limite - verificar dados"})]})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:CheckCircle,title:"Checagens de Envelope / Integridade",color:"emerald"}),jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-left text-zinc-400",children:"Item"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-zinc-400",children:"Valor Medido"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-zinc-400",children:"Limite Máx."}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Status"})]})}),jsxRuntimeExports.jsx("tbody",{children:t.map(y=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50",children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-zinc-200",children:y.item}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3",children:jsxRuntimeExports.jsx("input",{type:"number",value:y.value||"",onChange:u=>w(y.id,"value",parseFloat(u.target.value)||0),className:"w-full px-2 py-1 bg-zinc-800 border border-zinc-700 rounded text-xs text-white text-right",placeholder:"0",title:`Valor de ${y.item}`})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3",children:jsxRuntimeExports.jsx("input",{type:"number",value:y.limit||"",onChange:u=>w(y.id,"limit",parseFloat(u.target.value)||0),className:"w-full px-2 py-1 bg-zinc-800 border border-zinc-700 rounded text-xs text-white text-right",placeholder:"0",title:`Limite de ${y.item}`})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:y.status,size:"sm",children:y.status})})]},y.id))})]})}),!S&&jsxRuntimeExports.jsx("div",{className:"mt-3 p-3 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-amber-300",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-3 h-3 inline mr-1"}),"Alguns itens estão fora do envelope operacional. Verifique os valores."]})})]})]})}const generateId$1=()=>`mon-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,migrateRows=r=>!r||!Array.isArray(r)?[]:r.map(e=>({id:e.id||generateId$1(),data:e.data||"",duracao:e.duracao||0,mpfmOil:e.mpfmOil||0,mpfmGas:e.mpfmGas||0,mpfmTotal:e.mpfmTotal||0,refTotal:e.refTotal||0,desvio:e.desvio||0,alarmes:e.alarmes||""}));function Step06Monitoramento(){const{calibrationFormData:r,updateCalibrationFormData:e}=useAppStore(),[s,t]=reactExports.useState(()=>migrateRows((r==null?void 0:r.monitoramentoPosData)||[])),i=reactExports.useCallback(()=>{const S={id:generateId$1(),data:new Date().toISOString().split("T")[0],duracao:24,mpfmOil:0,mpfmGas:0,mpfmTotal:0,refTotal:0,desvio:0,alarmes:""},y=[...s,S];t(y),e({monitoramentoPosData:y})},[s,e]),a=reactExports.useCallback(S=>{const y=s.filter(u=>u.id!==S);t(y),e({monitoramentoPosData:y})},[s,e]),o=reactExports.useCallback((S,y,u)=>{const h=s.map(l=>{if(l.id!==S)return l;const c={...l,[y]:u};if(y==="mpfmOil"||y==="mpfmGas"){const b=y==="mpfmOil"?Number(u):l.mpfmOil,_=y==="mpfmGas"?Number(u):l.mpfmGas;c.mpfmTotal=b+_,c.refTotal>0&&(c.desvio=(c.mpfmTotal-c.refTotal)/c.refTotal*100)}return y==="refTotal"&&c.mpfmTotal>0&&(c.desvio=(c.mpfmTotal-Number(u))/Number(u)*100),c});t(h),e({monitoramentoPosData:h})},[s,e]),w=S=>{const y=Math.abs(S);return y<=7?"OK":y<=10?"Alerta":"Crítico"};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-purple-500/10 border border-purple-500/20 rounded-lg",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-purple-300",children:[jsxRuntimeExports.jsx(Info,{className:"w-3 h-3 inline mr-1"}),"Registre por período as massas totalizadas e o efeito dos novos K-factors. Este monitoramento serve como evidência pós-calibração."]})}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Eye,title:"Monitoramento Pós-Aplicação de Novos Fatores",color:"purple"}),jsxRuntimeExports.jsx(Button,{variant:"primary",size:"sm",icon:Plus,onClick:i,children:"Adicionar Período"})]}),s.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-8 text-zinc-500",children:[jsxRuntimeExports.jsx(Eye,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),jsxRuntimeExports.jsx("p",{children:"Nenhum período de monitoramento registrado."}),jsxRuntimeExports.jsx("p",{className:"text-xs mt-1",children:"Adicione períodos para acompanhar o desempenho pós-calibração."})]}):jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Data"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-center text-zinc-400",children:"Duração (h)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"MPFM Óleo"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"MPFM Gás"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-blue-400",children:"MPFM Total"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-emerald-400",children:"REF Total"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-center text-zinc-400",children:"Desvio"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Alarmes"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 w-8"})]})}),jsxRuntimeExports.jsx("tbody",{children:s.map(S=>{const y=w(S.desvio);return jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50",children:[jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"date",value:S.data,onChange:u=>o(S.id,"data",u.target.value),className:"px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",title:"Data do período"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"number",value:S.duracao||"",onChange:u=>o(S.id,"duracao",parseFloat(u.target.value)||0),className:"w-14 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white text-center",placeholder:"24",title:"Duração em horas"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"number",value:S.mpfmOil||"",onChange:u=>o(S.id,"mpfmOil",parseFloat(u.target.value)||0),className:"w-20 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white text-right",placeholder:"0",title:"MPFM Óleo"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"number",value:S.mpfmGas||"",onChange:u=>o(S.id,"mpfmGas",parseFloat(u.target.value)||0),className:"w-20 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white text-right",placeholder:"0",title:"MPFM Gás"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-right text-blue-400 font-medium",children:S.mpfmTotal.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"number",value:S.refTotal||"",onChange:u=>o(S.id,"refTotal",parseFloat(u.target.value)||0),className:"w-20 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-emerald-400 text-right",placeholder:"0",title:"Referência Total"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-center",children:jsxRuntimeExports.jsxs(Badge,{variant:y==="OK"?"OK":y==="Alerta"?"Alerta":"Crítico",size:"sm",children:[S.desvio.toFixed(1),"%"]})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{value:S.alarmes,onChange:u=>o(S.id,"alarmes",u.target.value),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",placeholder:"Nenhum",title:"Alarmes observados"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>a(S.id),className:"p-1 text-red-400 hover:text-red-300 transition-colors",title:"Remover período",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3 h-3"})})})]},S.id)})})]})}),s.length>0&&jsxRuntimeExports.jsx("div",{className:"mt-4 p-3 bg-zinc-800/50 rounded-lg",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400",children:["Total de períodos: ",s.length]}),jsxRuntimeExports.jsxs("span",{className:cn(s.filter(S=>w(S.desvio)==="OK").length===s.length?"text-emerald-400":"text-amber-400"),children:["Períodos OK: ",s.filter(S=>w(S.desvio)==="OK").length," / ",s.length]})]})})]})]})}const generateId=()=>`alm-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,migrateAlarmRows=r=>!r||!Array.isArray(r)?[]:r.map(e=>({id:e.id||generateId(),dataHora:e.dataHora||"",tag:e.tag||"",codigo:e.codigo||"",descricao:e.descricao||"",gravidade:e.gravidade||"Info",acaoTomada:e.acaoTomada||""}));function Step07Alarmes(){const{calibrationFormData:r,updateCalibrationFormData:e,selectedEvent:s}=useAppStore(),[t,i]=reactExports.useState(()=>migrateAlarmRows((r==null?void 0:r.alarmes)||[])),a=reactExports.useCallback(()=>{const h={id:generateId(),dataHora:new Date().toISOString().slice(0,16),tag:(s==null?void 0:s.meterTag)||"",codigo:"",descricao:"",gravidade:"Info",acaoTomada:""},l=[...t,h];i(l),e({alarmes:l})},[t,e,s]),o=reactExports.useCallback(h=>{const l=t.filter(c=>c.id!==h);i(l),e({alarmes:l})},[t,e]),w=reactExports.useCallback((h,l,c)=>{const b=t.map(_=>_.id===h?{..._,[l]:c}:_);i(b),e({alarmes:b})},[t,e]),S=h=>{switch(h){case"Critical":return"bg-red-500/10 border-red-500/20";case"Warning":return"bg-amber-500/10 border-amber-500/20";default:return"bg-blue-500/10 border-blue-500/20"}},y=t.filter(h=>h.gravidade==="Critical").length,u=t.filter(h=>h.gravidade==="Warning").length;return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-red-300",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-3 h-3 inline mr-1"}),"Use este log para rastreabilidade: alarmes críticos devem estar inativos no início do teste e investigados quando ocorrerem."]})}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[jsxRuntimeExports.jsxs("div",{className:cn("p-3 rounded-lg border text-center",t.length===0?"bg-emerald-500/10 border-emerald-500/20":"bg-zinc-800/50 border-zinc-700"),children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Total de Alarmes"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-white",children:t.length})]}),jsxRuntimeExports.jsxs("div",{className:cn("p-3 rounded-lg border text-center",y>0?"bg-red-500/10 border-red-500/20":"bg-emerald-500/10 border-emerald-500/20"),children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Críticos"}),jsxRuntimeExports.jsx("p",{className:cn("text-2xl font-bold",y>0?"text-red-400":"text-emerald-400"),children:y})]}),jsxRuntimeExports.jsxs("div",{className:cn("p-3 rounded-lg border text-center",u>0?"bg-amber-500/10 border-amber-500/20":"bg-emerald-500/10 border-emerald-500/20"),children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Warnings"}),jsxRuntimeExports.jsx("p",{className:cn("text-2xl font-bold",u>0?"text-amber-400":"text-emerald-400"),children:u})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Bell,title:"Registro de Alarmes / Eventos (HMI/MPM/FCS320)",color:"red"}),jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:Plus,onClick:a,children:"Adicionar Alarme"})]}),t.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-8 text-zinc-500",children:[jsxRuntimeExports.jsx(CheckCircle,{className:"w-12 h-12 mx-auto mb-3 text-emerald-500 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-emerald-400",children:"Nenhum alarme registrado durante o período."}),jsxRuntimeExports.jsx("p",{className:"text-xs mt-1",children:"Isso é um bom sinal para a calibração."})]}):jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Data/Hora"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"TAG"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Código"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Descrição"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-center text-zinc-400",children:"Gravidade"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Ação Tomada"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 w-8"})]})}),jsxRuntimeExports.jsx("tbody",{children:t.map(h=>jsxRuntimeExports.jsxs("tr",{className:cn("border-b border-zinc-800/50",S(h.gravidade)),children:[jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"datetime-local",value:h.dataHora,onChange:l=>w(h.id,"dataHora",l.target.value),className:"px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",title:"Data e hora do alarme"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{value:h.tag,onChange:l=>w(h.id,"tag",l.target.value),className:"w-24 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-blue-400",placeholder:"TAG",title:"TAG do equipamento"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{value:h.codigo,onChange:l=>w(h.id,"codigo",l.target.value),className:"w-20 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",placeholder:"Código",title:"Código do alarme"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{value:h.descricao,onChange:l=>w(h.id,"descricao",l.target.value),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",placeholder:"Descrição do alarme",title:"Descrição detalhada"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-center",children:jsxRuntimeExports.jsxs("select",{value:h.gravidade,onChange:l=>w(h.id,"gravidade",l.target.value),className:"px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",title:"Gravidade do alarme",children:[jsxRuntimeExports.jsx("option",{value:"Info",children:"Info"}),jsxRuntimeExports.jsx("option",{value:"Warning",children:"Warning"}),jsxRuntimeExports.jsx("option",{value:"Critical",children:"Critical"})]})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{value:h.acaoTomada,onChange:l=>w(h.id,"acaoTomada",l.target.value),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",placeholder:"Ação tomada",title:"Ação tomada para resolver"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>o(h.id),className:"p-1 text-red-400 hover:text-red-300 transition-colors",title:"Remover alarme",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3 h-3"})})})]},h.id))})]})})]}),y>0&&jsxRuntimeExports.jsxs("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-4 h-4 text-red-400"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-red-400",children:"Atenção"})]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-red-300",children:["Há ",y," alarme(s) crítico(s) registrado(s). Certifique-se de que todos foram investigados e as ações corretivas foram tomadas antes de finalizar a calibração."]})]})]})}const STEPS=["Registro","PVT","Totalizadores","K-Fatores","Balanços","Pós-Monit.","Alarmes"];function CalibrationWorkflow({event:r,onBack:e}){const{setSelectedEvent:s,setCalibrationFormData:t,calibrationFormData:i,completeCalibrationStep:a,finalizeCalibration:o}=useAppStore(),[w,S]=reactExports.useState(r.currentStep),[y,u]=reactExports.useState(!1);reactExports.useEffect(()=>{s(r),(!i||i.eventId!==r.id)&&t({eventId:r.id,status:r.status,resultado:r.result||"",operador:"",serviceOrder:"",responsavelCalibracao:r.responsible,preenchidoPor:"",dataEmissao:new Date().toISOString().split("T")[0],unidade:"",baciaCampo:"",localizacao:"",referenciaMet:"",tagMPFM:r.meterTag,serialNumber:"",fabricante:"",modelo:"",tamanho:"",razaoBeta:"",modoMedicao:"",sistema:"",versaoSoftwareMedidor:"",versaoFPM207:"",versaoFCS320:"",versaoPVTsim:"",naturezaAtividade:r.type,idEventoDesvio:"",inicioEstabilizacao:r.startDate,inicioTotalizacao:"",fimTotalizacao:"",duracaoEfetiva:0,observacoesIniciais:"",comentariosGerais:"",pvtReportId:"",dataAmostragem:"",pontoAmostragem:"",softwareModelagem:"PVTsim",versaoModelo:"",statusAprovacao:"Pendente",dataAprovacao:"",comentariosPVT:"",densidadeOleo:0,densidadeGas:0,densidadeAgua:0,gor:0,bsw:0,fatorEncolhimento:0,composicao:[],penelouxGas:1,penelouxOil:1,pvtLoadedFCS320:!1,pvtLoadedFPM207:!1,gammaRestarted:!1,pressureVerified:!1,temperatureVerified:!1,totalizadores:[],kMin:.8,kMax:1.2,limiteHC:10,limiteTotal:7,massas:{oleo:{mpfm:0,ref:0},gas:{mpfm:0,ref:0},agua:{mpfm:0,ref:0}},kFactors:{kOil:1,kGas:1,kWater:1,kOilStatus:"Dentro",kGasStatus:"Dentro",kWaterStatus:"Dentro"},balancoTopOil:0,balancoTopGas:0,balancoGasLift:0,balancoDesvio:0,monitoramentoPosData:[],alarmes:[]})},[r,s,t,i]);const h=async()=>{u(!0),setTimeout(()=>{u(!1),alert("Dados salvos com sucesso!")},500)},l=()=>{a(r.id,w),S(Math.min(7,w+1))},c=()=>{const _=confirm(`Deseja aprovar ou reprovar a calibração?

OK = Aprovado
Cancelar = Reprovado`);o(r.id,_?"Aprovado":"Reprovado"),alert(`Calibração ${_?"aprovada":"reprovada"} com sucesso!`),e()},b=()=>{switch(w){case 1:return jsxRuntimeExports.jsx(Step01Registro,{event:r});case 2:return jsxRuntimeExports.jsx(Step02PVT,{});case 3:return jsxRuntimeExports.jsx(Step03Totalizadores,{});case 4:return jsxRuntimeExports.jsx(Step04KFactors,{});case 5:return jsxRuntimeExports.jsx(Step05Balanco,{});case 6:return jsxRuntimeExports.jsx(Step06Monitoramento,{});case 7:return jsxRuntimeExports.jsx(Step07Alarmes,{});default:return null}};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:e,icon:ChevronLeft,children:"Voltar"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-white",children:r.id}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-zinc-500",children:[r.meterTag," - ",r.meterName," | ",r.type]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Badge,{variant:"info",children:r.status}),jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:Save,onClick:h,disabled:y,children:y?"Salvando...":"Salvar"}),jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:FileText,children:"Relatório"})]})]}),jsxRuntimeExports.jsx(Card,{className:"p-3",children:jsxRuntimeExports.jsx(StepIndicator,{steps:STEPS,currentStep:w,onStepClick:S})}),b(),jsxRuntimeExports.jsxs("div",{className:"flex justify-between pt-4 border-t border-zinc-800",children:[jsxRuntimeExports.jsx(Button,{variant:"secondary",onClick:()=>S(Math.max(1,w-1)),disabled:w===1,icon:ChevronLeft,children:"Anterior"}),jsxRuntimeExports.jsx("div",{className:"flex gap-2",children:w<7?jsxRuntimeExports.jsxs(Button,{onClick:l,children:["Próximo",jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4 ml-1"})]}):jsxRuntimeExports.jsx(Button,{variant:"success",icon:Check,onClick:c,children:"Concluir Avaliação"})})]})]})}function CalibrationPage(){const[r,e]=reactExports.useState(null);return r?jsxRuntimeExports.jsx(CalibrationWorkflow,{event:r,onBack:()=>e(null)}):jsxRuntimeExports.jsx(CalibrationEventsList,{onSelectEvent:e})}const checklistData=[{id:"1",category:"RTMV",description:"Avaliação de desempenho no comissionamento",status:"compliant",dueDate:"2025-12-01",notes:"Concluído - CAL-2025-001"},{id:"2",category:"RTMV",description:"Avaliação periódica (intervalos 6-12 meses)",status:"in-progress",dueDate:"2026-06-01",notes:"Próxima avaliação agendada"},{id:"3",category:"RTMV",description:"Investigação por gatilho ANP (±10% HC ou ±7% total)",status:"pending",notes:"Aplicável quando limite excedido"},{id:"4",category:"RTMV",description:"Arquivo PVT atualizado e aprovado",status:"compliant",dueDate:"2026-01-10",notes:"PVTsim v23.1.0"},{id:"5",category:"RTMV",description:"Software do medidor atualizado",status:"compliant",notes:"FW-MPM-BAC-v1.12.3"},{id:"6",category:"RTMV",description:"Relatório de calibração arquivado",status:"compliant",notes:"3 relatórios gerados"},{id:"7",category:"RTMV",description:"K-factors dentro do range (0.8-1.2)",status:"overdue",notes:"K-Gas fora do limite - investigar"},{id:"8",category:"RTMV",description:"Monitoramento de balanço diário implementado",status:"compliant",notes:"Dashboard operacional"},{id:"9",category:"Manutenção",description:"Verificação de integridade mecânica",status:"pending",dueDate:"2026-03-15"},{id:"10",category:"Manutenção",description:"Calibração de sensores P/T",status:"in-progress",dueDate:"2026-02-01"}],categoryStats=[{name:"RTMV",total:8,compliant:5,pending:1,overdue:1,inProgress:1},{name:"Manutenção",total:2,compliant:0,pending:1,overdue:0,inProgress:1}];function ComplianceDashboard(){const r=checklistData.length,e=checklistData.filter(o=>o.status==="compliant").length,s=checklistData.filter(o=>o.status==="pending").length,t=checklistData.filter(o=>o.status==="overdue").length,i=o=>{switch(o){case"compliant":return jsxRuntimeExports.jsx(Badge,{variant:"success",children:"Conforme"});case"pending":return jsxRuntimeExports.jsx(Badge,{variant:"warning",children:"Pendente"});case"overdue":return jsxRuntimeExports.jsx(Badge,{variant:"error",children:"Atrasado"});case"in-progress":return jsxRuntimeExports.jsx(Badge,{variant:"info",children:"Em Andamento"})}},a=o=>{switch(o){case"compliant":return jsxRuntimeExports.jsx(CheckCircle2,{className:"w-4 h-4 text-emerald-400"});case"pending":return jsxRuntimeExports.jsx(Clock,{className:"w-4 h-4 text-amber-400"});case"overdue":return jsxRuntimeExports.jsx(AlertCircle,{className:"w-4 h-4 text-red-400"});case"in-progress":return jsxRuntimeExports.jsx(Clock,{className:"w-4 h-4 text-blue-400"})}};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Card,{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-zinc-700 flex items-center justify-center",children:jsxRuntimeExports.jsx(FileCheck,{className:"w-5 h-5 text-zinc-300"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Total Requisitos"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-white",children:r})]})]})}),jsxRuntimeExports.jsx(Card,{className:"p-4 bg-emerald-500/10 border-emerald-500/20",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-500/20 flex items-center justify-center",children:jsxRuntimeExports.jsx(CheckCircle2,{className:"w-5 h-5 text-emerald-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Conformes"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:e})]})]})}),jsxRuntimeExports.jsx(Card,{className:"p-4 bg-amber-500/10 border-amber-500/20",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-500/20 flex items-center justify-center",children:jsxRuntimeExports.jsx(Clock,{className:"w-5 h-5 text-amber-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Pendentes"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-amber-400",children:s})]})]})}),jsxRuntimeExports.jsx(Card,{className:"p-4 bg-red-500/10 border-red-500/20",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-500/20 flex items-center justify-center",children:jsxRuntimeExports.jsx(AlertCircle,{className:"w-5 h-5 text-red-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Atrasados"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-red-400",children:t})]})]})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:FileCheck,title:"Conformidade por Categoria",color:"blue"}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:categoryStats.map(o=>jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-zinc-300",children:o.name}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-zinc-500",children:[o.compliant,"/",o.total," conformes"]})]}),jsxRuntimeExports.jsx(ProgressBar,{value:o.compliant/o.total*100,color:o.overdue>0?"red":o.compliant===o.total?"emerald":"amber"})]},o.name))})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:CheckCircle2,title:"Checklist de Requisitos Regulatórios (RTMV)",color:"emerald"}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:checklistData.map(o=>jsxRuntimeExports.jsxs("div",{className:cn("flex items-center justify-between p-3 rounded-lg border transition cursor-pointer hover:bg-zinc-700/50",o.status==="overdue"?"bg-red-500/5 border-red-500/20":o.status==="compliant"?"bg-emerald-500/5 border-emerald-500/10":"bg-zinc-800/50 border-zinc-700"),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[a(o.status),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-zinc-200",children:o.description}),jsxRuntimeExports.jsx(Badge,{variant:"secondary",size:"sm",children:o.category})]}),o.notes&&jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mt-0.5",children:o.notes})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[o.dueDate&&jsxRuntimeExports.jsx("span",{className:"text-xs text-zinc-500",children:o.dueDate}),i(o.status),jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4 text-zinc-600"})]})]},o.id))})]})]})}function CompliancePage(){return jsxRuntimeExports.jsx(ComplianceDashboard,{})}const PRAZOS_RANP44={RELATORIO_PARCIAL_DIAS:10,RELATORIO_FINAL_TOPSIDE:30,RELATORIO_FINAL_SUBSEA:60,REPARO_TOPSIDE_DIAS:60,REPARO_SUBSEA_DIAS:120},CHECKLIST_PADRAO_ANP=[{itemRANP:"10.4.1.a",descricao:"Identificação do Agente Autorizado",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.b",descricao:"Bacia, campo e instalação",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.c",descricao:"Identificação do sistema de medição",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.d",descricao:"TAG e nome do equipamento",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.e",descricao:"Responsável técnico",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.f",descricao:"Condições operacionais (GVF, BSW, P, T, vazões)",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.g",descricao:"Data de ocorrência da falha",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.h",descricao:"Data de detecção da falha",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.i",descricao:"Data de emissão do relatório",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.j",descricao:"Descrição da falha ou irregularidade",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.k",descricao:"Investigação realizada até o momento",obrigatorio:!0,tipoRelatorio:["Parcial"]},{itemRANP:"10.4.1.l",descricao:"Plano de contingência acionado",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.m",descricao:"Medidas mitigadoras",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.2.j",descricao:"Investigação completa",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.k",descricao:"Cronologia e metodologia da investigação",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.l",descricao:"Causa provável da falha",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.m",descricao:"Fato determinante do evento",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.n",descricao:"Plano de contingência acionado e eficácia",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.o",descricao:"Recomendações de ações corretivas/preventivas",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.p",descricao:"Cronograma de execução das recomendações",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.q",descricao:"Prazo previsto para reparo",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.r",descricao:"Justificativa se prazo > 60/120 dias",obrigatorio:!1,tipoRelatorio:["Final"]}],STORAGE_KEY="mpfm_desenquadramento_events";class DesenquadramentoService{constructor(){Je(this,"events",[]);this.loadFromStorage()}loadFromStorage(){try{const e=localStorage.getItem(STORAGE_KEY);e&&(this.events=JSON.parse(e))}catch(e){console.error("[Desenquadramento] Erro ao carregar eventos:",e)}}saveToStorage(){try{localStorage.setItem(STORAGE_KEY,JSON.stringify(this.events))}catch(e){console.error("[Desenquadramento] Erro ao salvar eventos:",e)}}generateId(){const e=new Date().getFullYear(),s=this.events.filter(t=>t.id.startsWith(`DES-${e}`)).length+1;return`DES-${e}-${String(s).padStart(4,"0")}`}generateEntryId(){return`ENT-${Date.now()}-${Math.random().toString(36).substring(2,7)}`}calcularPrazos(e,s){const t=new Date(e),i=new Date(t);i.setDate(i.getDate()+PRAZOS_RANP44.RELATORIO_PARCIAL_DIAS);const a=s==="TOPSIDE"?PRAZOS_RANP44.RELATORIO_FINAL_TOPSIDE:PRAZOS_RANP44.RELATORIO_FINAL_SUBSEA,o=new Date(t);o.setDate(o.getDate()+a);const w=s==="TOPSIDE"?PRAZOS_RANP44.REPARO_TOPSIDE_DIAS:PRAZOS_RANP44.REPARO_SUBSEA_DIAS,S=new Date(t);return S.setDate(S.getDate()+w),{prazoRelatorioParcial:i.toISOString().split("T")[0],prazoRelatorioFinal:o.toISOString().split("T")[0],prazoReparo:S.toISOString().split("T")[0]}}gerarChecklistANP(e){return CHECKLIST_PADRAO_ANP.filter(s=>s.tipoRelatorio.includes(e)).map((s,t)=>({...s,id:`CHK-${t+1}`,status:"Pendente"}))}criarEvento(e){const s=this.calcularPrazos(e.dataOcorrencia,e.ambiente),t=new Date().toISOString(),i={id:this.generateId(),status:"Aberto",tipoRelatorio:"Parcial",ambiente:e.ambiente,equipamentoId:e.equipamentoId,equipamentoTag:e.equipamentoTag,equipamentoNome:e.equipamentoNome,dataOcorrencia:e.dataOcorrencia,dataDeteccao:e.dataDeteccao,dataRelatorio:t.split("T")[0],...s,responsavelTecnico:e.responsavelTecnico,condicoesOperacionais:e.condicoesOperacionais,diarioBordo:[],planosAcao:[],anexos:[],checklistANP:this.gerarChecklistANP("Parcial"),diasConsecutivosDesvio:e.diasConsecutivosDesvio,desvioHC:e.desvioHC,desvioTotal:e.desvioTotal,createdAt:t,updatedAt:t,createdBy:e.createdBy},a={id:this.generateEntryId(),eventId:i.id,dataHora:t,dPlus:0,etapa:"Abertura do Evento",detalhe:`Evento de desenquadramento aberto automaticamente após ${e.diasConsecutivosDesvio} dias consecutivos de desvio. Desvio HC: ${e.desvioHC.toFixed(2)}%, Desvio Total: ${e.desvioTotal.toFixed(2)}%`,responsavel:e.createdBy,area:"Medição",status:"Concluído",itemRANP:"10.4.1.g"};return i.diarioBordo.push(a),this.events.push(i),this.saveToStorage(),console.log(`[Desenquadramento] Evento criado: ${i.id}`),i}adicionarEntradaDiario(e,s){const t=this.events.find(a=>a.id===e);if(!t)return null;const i={id:this.generateEntryId(),eventId:e,dataHora:new Date().toISOString(),...s};return t.diarioBordo.push(i),t.updatedAt=new Date().toISOString(),this.saveToStorage(),console.log(`[Desenquadramento] Entrada adicionada ao diário: ${i.id}`),i}atualizarDiagnostico(e,s){const t=this.events.find(i=>i.id===e);return t?(t.diagnostico=s,t.updatedAt=new Date().toISOString(),(t.status==="Aberto"||t.status==="Em Investigação")&&(t.status="Em Investigação"),this.saveToStorage(),!0):!1}atualizarContingencia(e,s){const t=this.events.find(i=>i.id===e);return t?(t.contingencia=s,t.updatedAt=new Date().toISOString(),this.saveToStorage(),!0):!1}adicionarAcaoCAPA(e,s){const t=this.events.find(a=>a.id===e);if(!t)return null;const i={id:`CAPA-${Date.now()}`,eventId:e,...s};return t.planosAcao.push(i),t.updatedAt=new Date().toISOString(),t.status==="Em Investigação"&&(t.status="Plano de Ação"),this.saveToStorage(),i}atualizarAcaoCAPA(e,s,t){const i=this.events.find(o=>o.id===e);if(!i)return!1;const a=i.planosAcao.find(o=>o.id===s);return a?(Object.assign(a,t),i.updatedAt=new Date().toISOString(),this.saveToStorage(),!0):!1}atualizarChecklistItem(e,s,t,i){const a=this.events.find(w=>w.id===e);if(!a)return!1;const o=a.checklistANP.find(w=>w.id===s);return o?(o.status=t,i&&(o.observacao=i),a.updatedAt=new Date().toISOString(),this.saveToStorage(),!0):!1}verificarProntidaoEnvio(e){const s=this.events.find(o=>o.id===e);if(!s)return{pronto:!1,itensOK:0,itensPendentes:0,itensObrigatoriosPendentes:[]};const t=s.checklistANP.filter(o=>o.status==="OK").length,i=s.checklistANP.filter(o=>o.status==="Pendente").length,a=s.checklistANP.filter(o=>o.obrigatorio&&o.status==="Pendente").map(o=>o.itemRANP);return{pronto:a.length===0,itensOK:t,itensPendentes:i,itensObrigatoriosPendentes:a}}atualizarStatus(e,s){const t=this.events.find(a=>a.id===e);if(!t)return!1;const i=t.status;return t.status=s,t.updatedAt=new Date().toISOString(),this.adicionarEntradaDiario(e,{dPlus:this.calcularDPlus(t.dataOcorrencia),etapa:"Alteração de Status",detalhe:`Status alterado de "${i}" para "${s}"`,responsavel:"Sistema",area:"Medição",status:"Concluído"}),this.saveToStorage(),!0}promoverParaFinal(e){const s=this.events.find(t=>t.id===e);return s?(s.tipoRelatorio="Final",s.checklistANP=this.gerarChecklistANP("Final"),s.updatedAt=new Date().toISOString(),this.adicionarEntradaDiario(e,{dPlus:this.calcularDPlus(s.dataOcorrencia),etapa:"Promoção para Relatório Final",detalhe:"Evento promovido de Relatório Parcial para Relatório Final",responsavel:"Sistema",area:"Medição",status:"Concluído",itemRANP:"10.4.2"}),this.saveToStorage(),!0):!1}calcularDPlus(e){const s=new Date(e),i=new Date().getTime()-s.getTime();return Math.floor(i/(1e3*60*60*24))}getAll(){return[...this.events]}getById(e){return this.events.find(s=>s.id===e)}getAtivos(){return this.events.filter(e=>e.status!=="Concluído"&&e.status!=="Enviado ANP")}getComPrazoProximo(e=3){const s=new Date;return this.events.filter(t=>{if(t.status==="Concluído"||t.status==="Enviado ANP")return!1;const i=t.tipoRelatorio==="Parcial"?new Date(t.prazoRelatorioParcial):new Date(t.prazoRelatorioFinal),a=Math.ceil((i.getTime()-s.getTime())/(1e3*60*60*24));return a<=e&&a>=0})}getVencidos(){const e=new Date;return this.events.filter(s=>s.status==="Concluído"||s.status==="Enviado ANP"?!1:(s.tipoRelatorio==="Parcial"?new Date(s.prazoRelatorioParcial):new Date(s.prazoRelatorioFinal))<e)}getEstatisticas(){const e=this.getVencidos().length,s=this.getComPrazoProximo(3).length;return{total:this.events.length,abertos:this.events.filter(t=>t.status==="Aberto").length,emInvestigacao:this.events.filter(t=>t.status==="Em Investigação").length,planoAcao:this.events.filter(t=>t.status==="Plano de Ação").length,concluidos:this.events.filter(t=>t.status==="Concluído"||t.status==="Enviado ANP").length,vencidos:e,proximos3Dias:s}}clearAll(){}}const desenquadramentoService=new DesenquadramentoService;function Desenquadramento(){const[r,e]=reactExports.useState([]),[s,t]=reactExports.useState(null),[i,a]=reactExports.useState(!1),[o,w]=reactExports.useState("all"),[S,y]=reactExports.useState("lista");reactExports.useEffect(()=>{u()},[]);const u=()=>{e(desenquadramentoService.getAll())},h=reactExports.useMemo(()=>desenquadramentoService.getEstatisticas(),[r]),l=reactExports.useMemo(()=>desenquadramentoService.getVencidos(),[r]),c=reactExports.useMemo(()=>desenquadramentoService.getComPrazoProximo(3),[r]),b=reactExports.useMemo(()=>o==="all"?r:r.filter(A=>A.status===o),[r,o]),_=A=>({Aberto:{color:"text-red-500",icon:XCircle,bgColor:"bg-red-50"},"Em Investigação":{color:"text-yellow-500",icon:Activity,bgColor:"bg-yellow-50"},"Plano de Ação":{color:"text-blue-500",icon:ClipboardList,bgColor:"bg-blue-50"},"Aguardando Validação":{color:"text-purple-500",icon:Clock,bgColor:"bg-purple-50"},Concluído:{color:"text-green-500",icon:CheckCircle,bgColor:"bg-green-50"},"Enviado ANP":{color:"text-emerald-500",icon:Send,bgColor:"bg-emerald-50"}})[A],f=A=>{const k=new Date,P=new Date(A);return Math.ceil((P.getTime()-k.getTime())/(1e3*60*60*24))},p=A=>new Date(A).toLocaleDateString("pt-BR");return jsxRuntimeExports.jsxs("div",{className:"p-6 space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-7 h-7 text-orange-500"}),"Gestão de Desenquadramento"]}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400 mt-1",children:"Conforme Resolução ANP nº 44/2015 - Seção 10"})]}),jsxRuntimeExports.jsxs(Button,{onClick:()=>a(!0),children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4 mr-2"}),"Novo Evento"]})]}),(l.length>0||c.length>0)&&jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[l.length>0&&jsxRuntimeExports.jsxs("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx(XCircle,{className:"w-6 h-6 text-red-400 flex-shrink-0"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("p",{className:"text-red-400 font-medium",children:[l.length," evento(s) com prazo vencido!"]}),jsxRuntimeExports.jsx("p",{className:"text-red-300/80 text-sm",children:l.map(A=>A.id).join(", ")})]})]}),c.length>0&&jsxRuntimeExports.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx(Clock,{className:"w-6 h-6 text-yellow-400 flex-shrink-0"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("p",{className:"text-yellow-400 font-medium",children:[c.length," evento(s) com prazo nos próximos 3 dias"]}),jsxRuntimeExports.jsx("p",{className:"text-yellow-300/80 text-sm",children:c.map(A=>`${A.id} (${f(A.tipoRelatorio==="Parcial"?A.prazoRelatorioParcial:A.prazoRelatorioFinal)}d)`).join(", ")})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[jsxRuntimeExports.jsx(KPICard,{title:"Total Eventos",value:h.total,icon:FileText,color:"blue"}),jsxRuntimeExports.jsx(KPICard,{title:"Abertos",value:h.abertos,icon:XCircle,color:h.abertos>0?"red":"blue"}),jsxRuntimeExports.jsx(KPICard,{title:"Em Investigação",value:h.emInvestigacao,icon:Activity,color:h.emInvestigacao>0?"amber":"blue"}),jsxRuntimeExports.jsx(KPICard,{title:"Plano de Ação",value:h.planoAcao,icon:ClipboardList,color:"purple"}),jsxRuntimeExports.jsx(KPICard,{title:"Concluídos",value:h.concluidos,icon:CheckCircle,color:"emerald"}),jsxRuntimeExports.jsx(KPICard,{title:"Vencidos",value:h.vencidos,icon:Clock,color:h.vencidos>0?"red":"blue"})]}),jsxRuntimeExports.jsx(Tabs,{activeTab:S,onChange:y,tabs:[{id:"lista",label:"Lista de Eventos",icon:FileText},{id:"timeline",label:"Timeline",icon:Clock},{id:"relatorios",label:"Relatórios ANP",icon:Send}]}),S==="lista"&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Filter,{className:"w-4 h-4 text-zinc-400"}),jsxRuntimeExports.jsx("label",{htmlFor:"status-filter",className:"sr-only",children:"Filtrar por status"}),jsxRuntimeExports.jsx(Select,{id:"status-filter",value:o,onChange:A=>w(A.target.value),options:[{value:"all",label:"Todos os Status"},{value:"Aberto",label:"Aberto"},{value:"Em Investigação",label:"Em Investigação"},{value:"Plano de Ação",label:"Plano de Ação"},{value:"Aguardando Validação",label:"Aguardando Validação"},{value:"Concluído",label:"Concluído"},{value:"Enviado ANP",label:"Enviado ANP"}]})]}),jsxRuntimeExports.jsxs("span",{className:"text-zinc-500 text-sm",children:[b.length," evento(s)"]})]}),S==="lista"&&jsxRuntimeExports.jsx("div",{className:"space-y-4",children:b.length===0?jsxRuntimeExports.jsxs(Card,{className:"p-12 text-center",children:[jsxRuntimeExports.jsx(FileText,{className:"w-16 h-16 text-zinc-600 mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400 text-lg",children:"Nenhum evento de desenquadramento registrado"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-sm mt-2",children:"Eventos são criados automaticamente quando K-Factors ficam fora do limite por 10 dias consecutivos"})]}):b.map(A=>{const k=_(A.status),P=k.icon,g=f(A.tipoRelatorio==="Parcial"?A.prazoRelatorioParcial:A.prazoRelatorioFinal),R=g<0,E=desenquadramentoService.calcularDPlus(A.dataOcorrencia);return jsxRuntimeExports.jsx("div",{className:"cursor-pointer",onClick:()=>t(A),role:"button",tabIndex:0,onKeyDown:C=>C.key==="Enter"&&t(A),children:jsxRuntimeExports.jsx(Card,{className:cn("p-4 hover:border-blue-500/50 transition-colors",R&&"border-red-500/50"),children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4",children:[jsxRuntimeExports.jsx("div",{className:cn("p-3 rounded-lg",k.bgColor),children:jsxRuntimeExports.jsx(P,{className:cn("w-6 h-6",k.color)})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-white",children:A.id}),jsxRuntimeExports.jsxs(Badge,{variant:A.tipoRelatorio==="Parcial"?"warning":"info",children:["Relatório ",A.tipoRelatorio]}),jsxRuntimeExports.jsx(Badge,{variant:A.ambiente==="TOPSIDE"?"TOPSIDE":"SUBSEA",children:A.ambiente})]}),jsxRuntimeExports.jsxs("p",{className:"text-zinc-400 mt-1",children:[A.equipamentoTag," - ",A.equipamentoNome]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-zinc-500",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(Calendar,{className:"w-4 h-4"}),"Ocorrência: ",p(A.dataOcorrencia)]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(Clock,{className:"w-4 h-4"}),"D+",E]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(User,{className:"w-4 h-4"}),A.responsavelTecnico]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[jsxRuntimeExports.jsx("span",{className:cn("text-sm font-medium",R?"text-red-400":g<=3?"text-yellow-400":"text-zinc-400"),children:R?`Vencido há ${Math.abs(g)} dia(s)`:`${g} dia(s) restante(s)`}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-zinc-500",children:["Desvio HC: ",A.desvioHC.toFixed(1),"%"]}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-zinc-500",children:[A.diarioBordo.length," entrada(s) no diário"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Badge,{variant:A.status,children:A.status}),jsxRuntimeExports.jsx(ChevronRight,{className:"w-5 h-5 text-zinc-500"})]})]})})},A.id)})}),S==="timeline"&&jsxRuntimeExports.jsxs(Card,{className:"p-8 text-center",children:[jsxRuntimeExports.jsx(Clock,{className:"w-16 h-16 text-zinc-600 mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400 text-lg",children:"Timeline de Eventos"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-sm mt-2",children:"Visualização cronológica dos eventos e marcos D+10, D+30"})]}),S==="relatorios"&&jsxRuntimeExports.jsxs(Card,{className:"p-8 text-center",children:[jsxRuntimeExports.jsx(Send,{className:"w-16 h-16 text-zinc-600 mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400 text-lg",children:"Relatórios para ANP"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-sm mt-2",children:"Geração e controle de relatórios parciais e finais"})]}),s&&jsxRuntimeExports.jsx(EventDetailModal,{event:s,onClose:()=>t(null),onUpdate:u}),i&&jsxRuntimeExports.jsx(NewEventModal,{onClose:()=>a(!1),onCreate:A=>{u(),t(A),a(!1)}})]})}function EventDetailModal({event:r,onClose:e,onUpdate:s}){const[t,i]=reactExports.useState("geral"),a=desenquadramentoService.verificarProntidaoEnvio(r.id),o=desenquadramentoService.calcularDPlus(r.dataOcorrencia);return jsxRuntimeExports.jsx(Modal,{isOpen:!0,onClose:e,title:`Evento ${r.id}`,size:"xl",children:jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between pb-4 border-b border-zinc-700",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(Badge,{variant:r.status,children:r.status}),jsxRuntimeExports.jsxs(Badge,{variant:r.tipoRelatorio==="Parcial"?"warning":"info",children:["Relatório ",r.tipoRelatorio]}),jsxRuntimeExports.jsx(Badge,{variant:r.ambiente==="TOPSIDE"?"TOPSIDE":"SUBSEA",children:r.ambiente}),jsxRuntimeExports.jsxs("span",{className:"text-zinc-400",children:["D+",o]})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:a.pronto?jsxRuntimeExports.jsx(Badge,{variant:"success",children:"Pronto para Envio"}):jsxRuntimeExports.jsxs(Badge,{variant:"warning",children:[a.itensPendentes," itens pendentes"]})})]}),jsxRuntimeExports.jsx(Tabs,{activeTab:t,onChange:i,tabs:[{id:"geral",label:"Informações Gerais"},{id:"diario",label:`Diário de Bordo (${r.diarioBordo.length})`},{id:"diagnostico",label:"Diagnóstico"},{id:"acoes",label:`Ações CAPA (${r.planosAcao.length})`},{id:"checklist",label:"Checklist ANP"}]}),t==="geral"&&jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-white",children:"Identificação"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-zinc-500",children:"Equipamento:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:r.equipamentoTag}),jsxRuntimeExports.jsx("span",{className:"text-zinc-500",children:"Nome:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:r.equipamentoNome}),jsxRuntimeExports.jsx("span",{className:"text-zinc-500",children:"Responsável:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:r.responsavelTecnico})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-white",children:"Datas"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-zinc-500",children:"Ocorrência:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:new Date(r.dataOcorrencia).toLocaleDateString("pt-BR")}),jsxRuntimeExports.jsx("span",{className:"text-zinc-500",children:"Detecção:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:new Date(r.dataDeteccao).toLocaleDateString("pt-BR")}),jsxRuntimeExports.jsx("span",{className:"text-zinc-500",children:"Prazo Parcial:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:new Date(r.prazoRelatorioParcial).toLocaleDateString("pt-BR")}),jsxRuntimeExports.jsx("span",{className:"text-zinc-500",children:"Prazo Final:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:new Date(r.prazoRelatorioFinal).toLocaleDateString("pt-BR")})]})]}),jsxRuntimeExports.jsxs("div",{className:"col-span-2 space-y-4",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-white",children:"Condições Operacionais"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-zinc-800 p-3 rounded-lg text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-xs",children:"GVF"}),jsxRuntimeExports.jsxs("p",{className:"text-white font-mono",children:[r.condicoesOperacionais.gvf,"%"]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-zinc-800 p-3 rounded-lg text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-xs",children:"BSW"}),jsxRuntimeExports.jsxs("p",{className:"text-white font-mono",children:[r.condicoesOperacionais.bsw,"%"]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-zinc-800 p-3 rounded-lg text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-xs",children:"Pressão"}),jsxRuntimeExports.jsxs("p",{className:"text-white font-mono",children:[r.condicoesOperacionais.pressao," bar"]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-zinc-800 p-3 rounded-lg text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-xs",children:"Temperatura"}),jsxRuntimeExports.jsxs("p",{className:"text-white font-mono",children:[r.condicoesOperacionais.temperatura,"°C"]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-zinc-800 p-3 rounded-lg text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-xs",children:"Desvio HC"}),jsxRuntimeExports.jsxs("p",{className:"text-white font-mono",children:[r.desvioHC.toFixed(2),"%"]})]})]})]})]}),t==="diario"&&jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[r.diarioBordo.length===0?jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-center py-8",children:"Nenhuma entrada no diário de bordo"}):jsxRuntimeExports.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:r.diarioBordo.map((w,S)=>jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center",children:[jsxRuntimeExports.jsxs("div",{className:"w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400 text-xs font-bold",children:["D+",w.dPlus]}),S<r.diarioBordo.length-1&&jsxRuntimeExports.jsx("div",{className:"w-0.5 h-full bg-zinc-700 my-1"})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 bg-zinc-800 rounded-lg p-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-white",children:w.etapa}),jsxRuntimeExports.jsx(Badge,{variant:w.status==="Concluído"?"success":"warning",size:"sm",children:w.status})]}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400 text-sm mt-1",children:w.detalhe}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-zinc-500",children:[jsxRuntimeExports.jsx("span",{children:new Date(w.dataHora).toLocaleString("pt-BR")}),jsxRuntimeExports.jsx("span",{children:w.responsavel}),w.itemRANP&&jsxRuntimeExports.jsxs("span",{children:["Ref: ",w.itemRANP]})]})]})]},w.id))}),jsxRuntimeExports.jsxs(Button,{variant:"outline",className:"w-full",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4 mr-2"}),"Adicionar Entrada"]})]}),t==="checklist"&&jsxRuntimeExports.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:r.checklistANP.map(w=>jsxRuntimeExports.jsxs("div",{className:cn("flex items-center justify-between p-3 rounded-lg",w.status==="OK"?"bg-green-500/10":w.status==="Pendente"?"bg-zinc-800":"bg-zinc-700"),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[w.status==="OK"?jsxRuntimeExports.jsx(CheckCircle,{className:"w-5 h-5 text-green-500"}):w.status==="N/A"?jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full bg-zinc-600"}):jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-zinc-500"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-zinc-400 text-sm font-mono mr-2",children:w.itemRANP}),jsxRuntimeExports.jsx("span",{className:"text-white text-sm",children:w.descricao}),w.obrigatorio&&jsxRuntimeExports.jsx("span",{className:"text-red-400 text-xs ml-2",children:"*"})]})]}),jsxRuntimeExports.jsx(Badge,{variant:w.status==="OK"?"success":w.status==="N/A"?"secondary":"warning",size:"sm",children:w.status})]},w.id))}),t==="diagnostico"&&jsxRuntimeExports.jsx("div",{className:"space-y-4",children:r.diagnostico?jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-white mb-2",children:"Descrição da Falha"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400",children:r.diagnostico.descricaoFalha})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-white mb-2",children:"Causa Provável"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400",children:r.diagnostico.causaProvavel})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-white mb-2",children:"Metodologia"}),jsxRuntimeExports.jsx(Badge,{children:r.diagnostico.metodologiaAnalise})]})]}):jsxRuntimeExports.jsxs("div",{className:"text-center py-8",children:[jsxRuntimeExports.jsx(Activity,{className:"w-12 h-12 text-zinc-600 mx-auto mb-2"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-500",children:"Diagnóstico ainda não preenchido"}),jsxRuntimeExports.jsxs(Button,{variant:"outline",className:"mt-4",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4 mr-2"}),"Iniciar Diagnóstico"]})]})}),t==="acoes"&&jsxRuntimeExports.jsx("div",{className:"space-y-4",children:r.planosAcao.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-8",children:[jsxRuntimeExports.jsx(ClipboardList,{className:"w-12 h-12 text-zinc-600 mx-auto mb-2"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-500",children:"Nenhuma ação CAPA registrada"}),jsxRuntimeExports.jsxs(Button,{variant:"outline",className:"mt-4",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4 mr-2"}),"Adicionar Ação"]})]}):jsxRuntimeExports.jsx("div",{className:"space-y-3",children:r.planosAcao.map(w=>jsxRuntimeExports.jsxs("div",{className:"bg-zinc-800 rounded-lg p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-white",children:w.acao}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Badge,{variant:w.tipo==="Corretiva"?"error":"info",size:"sm",children:w.tipo}),jsxRuntimeExports.jsx(Badge,{variant:w.status==="Concluído"?"success":"warning",size:"sm",children:w.status})]})]}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400 text-sm mt-2",children:w.descricao}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-zinc-500",children:[jsxRuntimeExports.jsxs("span",{children:["Responsável: ",w.responsavel]}),jsxRuntimeExports.jsxs("span",{children:["Prazo: ",new Date(w.prazo).toLocaleDateString("pt-BR")]})]})]},w.id))})}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-zinc-700",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",onClick:e,children:"Fechar"}),r.tipoRelatorio==="Parcial"&&r.status!=="Enviado ANP"&&jsxRuntimeExports.jsx(Button,{variant:"outline",onClick:()=>{desenquadramentoService.promoverParaFinal(r.id),s()},children:"Promover para Final"}),a.pronto&&jsxRuntimeExports.jsxs(Button,{children:[jsxRuntimeExports.jsx(Send,{className:"w-4 h-4 mr-2"}),"Gerar Relatório ANP"]})]})]})})}function NewEventModal({onClose:r,onCreate:e}){const[s,t]=reactExports.useState({equipamentoId:"",equipamentoTag:"",equipamentoNome:"",ambiente:"TOPSIDE",dataOcorrencia:new Date().toISOString().split("T")[0],dataDeteccao:new Date().toISOString().split("T")[0],responsavelTecnico:"",diasConsecutivosDesvio:10,desvioHC:0,desvioTotal:0,gvf:0,bsw:0,pressao:0,temperatura:0,vazaoOleo:0,vazaoGas:0,vazaoAgua:0,vazaoTotal:0}),i=a=>{a.preventDefault();const o=desenquadramentoService.criarEvento({equipamentoId:s.equipamentoId,equipamentoTag:s.equipamentoTag,equipamentoNome:s.equipamentoNome,ambiente:s.ambiente,dataOcorrencia:s.dataOcorrencia,dataDeteccao:s.dataDeteccao,responsavelTecnico:s.responsavelTecnico,diasConsecutivosDesvio:s.diasConsecutivosDesvio,desvioHC:s.desvioHC,desvioTotal:s.desvioTotal,createdBy:"Usuário",condicoesOperacionais:{gvf:s.gvf,bsw:s.bsw,pressao:s.pressao,temperatura:s.temperatura,vazaoOleo:s.vazaoOleo,vazaoGas:s.vazaoGas,vazaoAgua:s.vazaoAgua,vazaoTotal:s.vazaoTotal,salinidade:0}});e(o)};return jsxRuntimeExports.jsx(Modal,{isOpen:!0,onClose:r,title:"Novo Evento de Desenquadramento",size:"lg",children:jsxRuntimeExports.jsxs("form",{onSubmit:i,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(Input,{label:"TAG do Equipamento",value:s.equipamentoTag,onChange:a=>t(o=>({...o,equipamentoTag:a.target.value})),placeholder:"Ex: 2601.18FT1506",required:!0}),jsxRuntimeExports.jsx(Input,{label:"Nome do Equipamento",value:s.equipamentoNome,onChange:a=>t(o=>({...o,equipamentoNome:a.target.value})),placeholder:"Ex: MPFM Bank 05",required:!0}),jsxRuntimeExports.jsx(Select,{label:"Ambiente",value:s.ambiente,onChange:a=>t(o=>({...o,ambiente:a.target.value})),options:[{value:"TOPSIDE",label:"Topside"},{value:"SUBSEA",label:"Subsea"}]}),jsxRuntimeExports.jsx(Input,{label:"Responsável Técnico",value:s.responsavelTecnico,onChange:a=>t(o=>({...o,responsavelTecnico:a.target.value})),required:!0}),jsxRuntimeExports.jsx(Input,{label:"Data de Ocorrência",type:"date",value:s.dataOcorrencia,onChange:a=>t(o=>({...o,dataOcorrencia:a.target.value})),required:!0}),jsxRuntimeExports.jsx(Input,{label:"Data de Detecção",type:"date",value:s.dataDeteccao,onChange:a=>t(o=>({...o,dataDeteccao:a.target.value})),required:!0}),jsxRuntimeExports.jsx(Input,{label:"Dias Consecutivos de Desvio",type:"number",value:s.diasConsecutivosDesvio,onChange:a=>t(o=>({...o,diasConsecutivosDesvio:Number(a.target.value)})),min:10,required:!0}),jsxRuntimeExports.jsx(Input,{label:"Desvio HC (%)",type:"number",step:"0.01",value:s.desvioHC,onChange:a=>t(o=>({...o,desvioHC:Number(a.target.value)}))})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3",children:[jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",onClick:r,children:"Cancelar"}),jsxRuntimeExports.jsxs(Button,{type:"submit",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4 mr-2"}),"Criar Evento"]})]})]})})}const initialFormData={tag:"",name:"",location:"TOPSIDE",status:"active",serialNumber:"",manufacturer:"Pietro Fiorentini",model:"Flowtwin",lastCalibration:new Date().toISOString().split("T")[0],kOil:1,kGas:1,kWater:1,daysToCalibration:365},NewMeterModal=({isOpen:r,onClose:e,editingMeter:s})=>{const{addMeter:t,updateMeter:i}=useAppStore(),[a,o]=reactExports.useState(s?{tag:s.tag,name:s.name,location:s.location,status:s.status,serialNumber:s.serialNumber,manufacturer:s.manufacturer,model:s.model,lastCalibration:s.lastCalibration,kOil:s.kOil,kGas:s.kGas,kWater:s.kWater,daysToCalibration:s.daysToCalibration}:initialFormData),[w,S]=reactExports.useState({}),y=reactExports.useCallback((c,b)=>{o(_=>({..._,[c]:b})),S(_=>({..._,[c]:void 0}))},[]),u=()=>{const c={};return a.tag.trim()?/^[A-Z0-9_-]+$/i.test(a.tag)||(c.tag="Tag deve conter apenas letras, números, - ou _"):c.tag="Tag é obrigatório",a.name.trim()||(c.name="Nome é obrigatório"),a.serialNumber.trim()||(c.serialNumber="Número de série é obrigatório"),a.manufacturer.trim()||(c.manufacturer="Fabricante é obrigatório"),a.model.trim()||(c.model="Modelo é obrigatório"),(a.kOil<.8||a.kOil>1.2)&&(c.kOil="K-factor deve estar entre 0.8 e 1.2"),(a.kGas<.8||a.kGas>1.2)&&(c.kGas="K-factor deve estar entre 0.8 e 1.2"),(a.kWater<.8||a.kWater>1.2)&&(c.kWater="K-factor deve estar entre 0.8 e 1.2"),S(c),Object.keys(c).length===0},h=c=>{c.preventDefault(),u()&&(s?i(s.id,a):t(a),o(initialFormData),e())},l=()=>{o(initialFormData),S({}),e()};return jsxRuntimeExports.jsx(Modal,{isOpen:r,onClose:l,title:s?"Editar Medidor":"Novo Medidor MPFM",size:"lg",children:jsxRuntimeExports.jsxs("form",{onSubmit:h,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Identificação"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(Input,{label:"Tag do Medidor *",placeholder:"Ex: MPFM-P55-001",value:a.tag,onChange:c=>y("tag",c.target.value.toUpperCase()),error:w.tag}),jsxRuntimeExports.jsx(Input,{label:"Nome *",placeholder:"Nome descritivo",value:a.name,onChange:c=>y("name",c.target.value),error:w.name})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[jsxRuntimeExports.jsx(Select,{label:"Localização *",value:a.location,onChange:c=>y("location",c.target.value),options:[{value:"TOPSIDE",label:"Topside"},{value:"SUBSEA",label:"Subsea"}]}),jsxRuntimeExports.jsx(Select,{label:"Status *",value:a.status,onChange:c=>y("status",c.target.value),options:[{value:"active",label:"Ativo"},{value:"inactive",label:"Inativo"}]})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Informações Técnicas"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[jsxRuntimeExports.jsx(Input,{label:"Número de Série *",placeholder:"SN-XXXXXX",value:a.serialNumber,onChange:c=>y("serialNumber",c.target.value),error:w.serialNumber}),jsxRuntimeExports.jsx(Input,{label:"Fabricante *",placeholder:"Pietro Fiorentini",value:a.manufacturer,onChange:c=>y("manufacturer",c.target.value),error:w.manufacturer}),jsxRuntimeExports.jsx(Input,{label:"Modelo *",placeholder:"Flowtwin",value:a.model,onChange:c=>y("model",c.target.value),error:w.model})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Calibração"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(Input,{label:"Última Calibração",type:"date",value:a.lastCalibration,onChange:c=>y("lastCalibration",c.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Dias até Próxima Calibração",type:"number",value:a.daysToCalibration,onChange:c=>y("daysToCalibration",parseInt(c.target.value)||0)})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"K-Factors (faixa válida: 0.8 - 1.2)"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[jsxRuntimeExports.jsx(Input,{label:"K-Factor Óleo",type:"number",step:"0.001",min:"0.8",max:"1.2",value:a.kOil,onChange:c=>y("kOil",parseFloat(c.target.value)||1),error:w.kOil}),jsxRuntimeExports.jsx(Input,{label:"K-Factor Gás",type:"number",step:"0.001",min:"0.8",max:"1.2",value:a.kGas,onChange:c=>y("kGas",parseFloat(c.target.value)||1),error:w.kGas}),jsxRuntimeExports.jsx(Input,{label:"K-Factor Água",type:"number",step:"0.001",min:"0.8",max:"1.2",value:a.kWater,onChange:c=>y("kWater",parseFloat(c.target.value)||1),error:w.kWater})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",onClick:l,children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{type:"submit",variant:"primary",children:s?"Salvar Alterações":"Adicionar Medidor"})]})]})})};function commonjsRequire(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports$1){(function(e,s){module.exports=e.pdfjsLib=s()})(globalThis,()=>(()=>{var __webpack_modules__=[,(r,e)=>{var Ye;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=D,e.bytesToString=me,e.createValidAbsoluteUrl=ee,e.getModificationDate=_e,e.getUuid=ze,e.getVerbosityLevel=V,e.info=Q,e.isArrayBuffer=te,e.isArrayEqual=Te,e.isNodeJS=void 0,e.normalizeUnicode=Me,e.objectFromMap=Re,e.objectSize=ye,e.setVerbosityLevel=se,e.shadow=F,e.string32=be,e.stringToBytes=xe,e.stringToPDFString=fe,e.stringToUTF8String=je,e.unreachable=ue,e.utf8StringToString=Ae,e.warn=K;const s=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=s;const t=[1,0,0,1,0,0];e.IDENTITY_MATRIX=t;const i=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=i;const a=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=a;const o=1.35;e.LINE_FACTOR=o;const w=.35;e.LINE_DESCENT_FACTOR=w;const S=w/o;e.BASELINE_FACTOR=S;const y={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=y;const u={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=u;const h="pdfjs_internal_editor_";e.AnnotationEditorPrefix=h;const l={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=l;const c={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=c;const b={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=b;const _={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=_;const f={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=f;const p={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=p;const A={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=A;const k={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=k;const P={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=P;const g={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=g;const R={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=R;const E={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=E;const C={O:"PageOpen",C:"PageClose"};e.PageActionEventType=C;const j={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=j;const z={NONE:0,BINARY:1};e.CMapCompressionType=z;const v={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=v;const T={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=T;let O=j.WARNINGS;function se(Ee){Number.isInteger(Ee)&&(O=Ee)}function V(){return O}function Q(Ee){O>=j.INFOS&&console.log(`Info: ${Ee}`)}function K(Ee){O>=j.WARNINGS&&console.log(`Warning: ${Ee}`)}function ue(Ee){throw new Error(Ee)}function D(Ee,oe){Ee||ue(oe)}function q(Ee){switch(Ee==null?void 0:Ee.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ee(Ee,oe=null,de=null){if(!Ee)return null;try{if(de&&typeof Ee=="string"){if(de.addDefaultProtocol&&Ee.startsWith("www.")){const qe=Ee.match(/\./g);(qe==null?void 0:qe.length)>=2&&(Ee=`http://${Ee}`)}if(de.tryConvertEncoding)try{Ee=je(Ee)}catch{}}const Pe=oe?new URL(Ee,oe):new URL(Ee);if(q(Pe))return Pe}catch{}return null}function F(Ee,oe,de,Pe=!1){return Object.defineProperty(Ee,oe,{value:de,enumerable:!Pe,configurable:!0,writable:!1}),de}const d=function(){function oe(de,Pe){this.constructor===oe&&ue("Cannot initialize BaseException."),this.message=de,this.name=Pe}return oe.prototype=new Error,oe.constructor=oe,oe}();e.BaseException=d;class x extends d{constructor(oe,de){super(oe,"PasswordException"),this.code=de}}e.PasswordException=x;class N extends d{constructor(oe,de){super(oe,"UnknownErrorException"),this.details=de}}e.UnknownErrorException=N;class B extends d{constructor(oe){super(oe,"InvalidPDFException")}}e.InvalidPDFException=B;class G extends d{constructor(oe){super(oe,"MissingPDFException")}}e.MissingPDFException=G;class W extends d{constructor(oe,de){super(oe,"UnexpectedResponseException"),this.status=de}}e.UnexpectedResponseException=W;class Y extends d{constructor(oe){super(oe,"FormatError")}}e.FormatError=Y;class ce extends d{constructor(oe){super(oe,"AbortException")}}e.AbortException=ce;function me(Ee){(typeof Ee!="object"||(Ee==null?void 0:Ee.length)===void 0)&&ue("Invalid argument for bytesToString");const oe=Ee.length,de=8192;if(oe<de)return String.fromCharCode.apply(null,Ee);const Pe=[];for(let qe=0;qe<oe;qe+=de){const Ve=Math.min(qe+de,oe),U=Ee.subarray(qe,Ve);Pe.push(String.fromCharCode.apply(null,U))}return Pe.join("")}function xe(Ee){typeof Ee!="string"&&ue("Invalid argument for stringToBytes");const oe=Ee.length,de=new Uint8Array(oe);for(let Pe=0;Pe<oe;++Pe)de[Pe]=Ee.charCodeAt(Pe)&255;return de}function be(Ee){return String.fromCharCode(Ee>>24&255,Ee>>16&255,Ee>>8&255,Ee&255)}function ye(Ee){return Object.keys(Ee).length}function Re(Ee){const oe=Object.create(null);for(const[de,Pe]of Ee)oe[de]=Pe;return oe}function ie(){const Ee=new Uint8Array(4);return Ee[0]=1,new Uint32Array(Ee.buffer,0,1)[0]===1}function ae(){try{return new Function(""),!0}catch{return!1}}class M{static get isLittleEndian(){return F(this,"isLittleEndian",ie())}static get isEvalSupported(){return F(this,"isEvalSupported",ae())}static get isOffscreenCanvasSupported(){return F(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?F(this,"platform",{isWin:!1,isMac:!1}):F(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var oe,de;return F(this,"isCSSRoundSupported",(de=(oe=globalThis.CSS)==null?void 0:oe.supports)==null?void 0:de.call(oe,"width: round(1.5px, 1px)"))}}e.FeatureTest=M;const H=[...Array(256).keys()].map(Ee=>Ee.toString(16).padStart(2,"0"));class Z{static makeHexColor(oe,de,Pe){return`#${H[oe]}${H[de]}${H[Pe]}`}static scaleMinMax(oe,de){let Pe;oe[0]?(oe[0]<0&&(Pe=de[0],de[0]=de[1],de[1]=Pe),de[0]*=oe[0],de[1]*=oe[0],oe[3]<0&&(Pe=de[2],de[2]=de[3],de[3]=Pe),de[2]*=oe[3],de[3]*=oe[3]):(Pe=de[0],de[0]=de[2],de[2]=Pe,Pe=de[1],de[1]=de[3],de[3]=Pe,oe[1]<0&&(Pe=de[2],de[2]=de[3],de[3]=Pe),de[2]*=oe[1],de[3]*=oe[1],oe[2]<0&&(Pe=de[0],de[0]=de[1],de[1]=Pe),de[0]*=oe[2],de[1]*=oe[2]),de[0]+=oe[4],de[1]+=oe[4],de[2]+=oe[5],de[3]+=oe[5]}static transform(oe,de){return[oe[0]*de[0]+oe[2]*de[1],oe[1]*de[0]+oe[3]*de[1],oe[0]*de[2]+oe[2]*de[3],oe[1]*de[2]+oe[3]*de[3],oe[0]*de[4]+oe[2]*de[5]+oe[4],oe[1]*de[4]+oe[3]*de[5]+oe[5]]}static applyTransform(oe,de){const Pe=oe[0]*de[0]+oe[1]*de[2]+de[4],qe=oe[0]*de[1]+oe[1]*de[3]+de[5];return[Pe,qe]}static applyInverseTransform(oe,de){const Pe=de[0]*de[3]-de[1]*de[2],qe=(oe[0]*de[3]-oe[1]*de[2]+de[2]*de[5]-de[4]*de[3])/Pe,Ve=(-oe[0]*de[1]+oe[1]*de[0]+de[4]*de[1]-de[5]*de[0])/Pe;return[qe,Ve]}static getAxialAlignedBoundingBox(oe,de){const Pe=this.applyTransform(oe,de),qe=this.applyTransform(oe.slice(2,4),de),Ve=this.applyTransform([oe[0],oe[3]],de),U=this.applyTransform([oe[2],oe[1]],de);return[Math.min(Pe[0],qe[0],Ve[0],U[0]),Math.min(Pe[1],qe[1],Ve[1],U[1]),Math.max(Pe[0],qe[0],Ve[0],U[0]),Math.max(Pe[1],qe[1],Ve[1],U[1])]}static inverseTransform(oe){const de=oe[0]*oe[3]-oe[1]*oe[2];return[oe[3]/de,-oe[1]/de,-oe[2]/de,oe[0]/de,(oe[2]*oe[5]-oe[4]*oe[3])/de,(oe[4]*oe[1]-oe[5]*oe[0])/de]}static singularValueDecompose2dScale(oe){const de=[oe[0],oe[2],oe[1],oe[3]],Pe=oe[0]*de[0]+oe[1]*de[2],qe=oe[0]*de[1]+oe[1]*de[3],Ve=oe[2]*de[0]+oe[3]*de[2],U=oe[2]*de[1]+oe[3]*de[3],ge=(Pe+U)/2,Ce=Math.sqrt((Pe+U)**2-4*(Pe*U-Ve*qe))/2,Ie=ge+Ce||1,Le=ge-Ce||1;return[Math.sqrt(Ie),Math.sqrt(Le)]}static normalizeRect(oe){const de=oe.slice(0);return oe[0]>oe[2]&&(de[0]=oe[2],de[2]=oe[0]),oe[1]>oe[3]&&(de[1]=oe[3],de[3]=oe[1]),de}static intersect(oe,de){const Pe=Math.max(Math.min(oe[0],oe[2]),Math.min(de[0],de[2])),qe=Math.min(Math.max(oe[0],oe[2]),Math.max(de[0],de[2]));if(Pe>qe)return null;const Ve=Math.max(Math.min(oe[1],oe[3]),Math.min(de[1],de[3])),U=Math.min(Math.max(oe[1],oe[3]),Math.max(de[1],de[3]));return Ve>U?null:[Pe,Ve,qe,U]}static bezierBoundingBox(oe,de,Pe,qe,Ve,U,ge,Ce){const Ie=[],Le=[[],[]];let Ne,L,I,$,he,pe,ve,Se;for(let He=0;He<2;++He){if(He===0?(L=6*oe-12*Pe+6*Ve,Ne=-3*oe+9*Pe-9*Ve+3*ge,I=3*Pe-3*oe):(L=6*de-12*qe+6*U,Ne=-3*de+9*qe-9*U+3*Ce,I=3*qe-3*de),Math.abs(Ne)<1e-12){if(Math.abs(L)<1e-12)continue;$=-I/L,0<$&&$<1&&Ie.push($);continue}ve=L*L-4*I*Ne,Se=Math.sqrt(ve),!(ve<0)&&(he=(-L+Se)/(2*Ne),0<he&&he<1&&Ie.push(he),pe=(-L-Se)/(2*Ne),0<pe&&pe<1&&Ie.push(pe))}let De=Ie.length,ke;const we=De;for(;De--;)$=Ie[De],ke=1-$,Le[0][De]=ke*ke*ke*oe+3*ke*ke*$*Pe+3*ke*$*$*Ve+$*$*$*ge,Le[1][De]=ke*ke*ke*de+3*ke*ke*$*qe+3*ke*$*$*U+$*$*$*Ce;return Le[0][we]=oe,Le[1][we]=de,Le[0][we+1]=ge,Le[1][we+1]=Ce,Le[0].length=Le[1].length=we+2,[Math.min(...Le[0]),Math.min(...Le[1]),Math.max(...Le[0]),Math.max(...Le[1])]}}e.Util=Z;const re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function fe(Ee){if(Ee[0]>="ï"){let de;if(Ee[0]==="þ"&&Ee[1]==="ÿ"?de="utf-16be":Ee[0]==="ÿ"&&Ee[1]==="þ"?de="utf-16le":Ee[0]==="ï"&&Ee[1]==="»"&&Ee[2]==="¿"&&(de="utf-8"),de)try{const Pe=new TextDecoder(de,{fatal:!0}),qe=xe(Ee);return Pe.decode(qe)}catch(Pe){K(`stringToPDFString: "${Pe}".`)}}const oe=[];for(let de=0,Pe=Ee.length;de<Pe;de++){const qe=re[Ee.charCodeAt(de)];oe.push(qe?String.fromCharCode(qe):Ee.charAt(de))}return oe.join("")}function je(Ee){return decodeURIComponent(escape(Ee))}function Ae(Ee){return unescape(encodeURIComponent(Ee))}function te(Ee){return typeof Ee=="object"&&(Ee==null?void 0:Ee.byteLength)!==void 0}function Te(Ee,oe){if(Ee.length!==oe.length)return!1;for(let de=0,Pe=Ee.length;de<Pe;de++)if(Ee[de]!==oe[de])return!1;return!0}function _e(Ee=new Date){return[Ee.getUTCFullYear().toString(),(Ee.getUTCMonth()+1).toString().padStart(2,"0"),Ee.getUTCDate().toString().padStart(2,"0"),Ee.getUTCHours().toString().padStart(2,"0"),Ee.getUTCMinutes().toString().padStart(2,"0"),Ee.getUTCSeconds().toString().padStart(2,"0")].join("")}class We{constructor(){ne(this,Ye,!1);this.promise=new Promise((oe,de)=>{this.resolve=Pe=>{le(this,Ye,!0),oe(Pe)},this.reject=Pe=>{le(this,Ye,!0),de(Pe)}})}get settled(){return n(this,Ye)}}Ye=new WeakMap,e.PromiseCapability=We;let Be=null,Ke=null;function Me(Ee){return Be||(Be=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ke=new Map([["ﬅ","ſt"]])),Ee.replaceAll(Be,(oe,de,Pe)=>de?de.normalize("NFKC"):Ke.get(Pe))}function ze(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const Ee=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(Ee);else for(let oe=0;oe<32;oe++)Ee[oe]=Math.floor(Math.random()*255);return me(Ee)}const Xe="pdfjs_internal_id_";e.AnnotationPrefix=Xe},(__unused_webpack_module,exports$1,__w_pdfjs_require__)=>{var r,s,t,i,ot,Et,w,S,y,u,h,l,c,b,_,yt,p,A,It,P,g;Object.defineProperty(exports$1,"__esModule",{value:!0}),exports$1.RenderTask=exports$1.PDFWorkerUtil=exports$1.PDFWorker=exports$1.PDFPageProxy=exports$1.PDFDocumentProxy=exports$1.PDFDocumentLoadingTask=exports$1.PDFDataRangeTransport=exports$1.LoopbackPort=exports$1.DefaultStandardFontDataFactory=exports$1.DefaultFilterFactory=exports$1.DefaultCanvasFactory=exports$1.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports$1,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports$1.build=void 0,exports$1.getDocument=getDocument,exports$1.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports$1.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports$1.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports$1.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports$1.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(E){if(typeof E=="string"||E instanceof URL?E={url:E}:(0,_util.isArrayBuffer)(E)&&(E={data:E}),typeof E!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!E.url&&!E.data&&!E.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const C=new PDFDocumentLoadingTask,{docId:j}=C,z=E.url?getUrlProp(E.url):null,v=E.data?getDataProp(E.data):null,T=E.httpHeaders||null,O=E.withCredentials===!0,se=E.password??null,V=E.range instanceof PDFDataRangeTransport?E.range:null,Q=Number.isInteger(E.rangeChunkSize)&&E.rangeChunkSize>0?E.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let K=E.worker instanceof PDFWorker?E.worker:null;const ue=E.verbosity,D=typeof E.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(E.docBaseUrl)?E.docBaseUrl:null,q=typeof E.cMapUrl=="string"?E.cMapUrl:null,ee=E.cMapPacked!==!1,F=E.CMapReaderFactory||DefaultCMapReaderFactory,d=typeof E.standardFontDataUrl=="string"?E.standardFontDataUrl:null,x=E.StandardFontDataFactory||DefaultStandardFontDataFactory,N=E.stopAtErrors!==!0,B=Number.isInteger(E.maxImageSize)&&E.maxImageSize>-1?E.maxImageSize:-1,G=E.isEvalSupported!==!1,W=typeof E.isOffscreenCanvasSupported=="boolean"?E.isOffscreenCanvasSupported:!_util.isNodeJS,Y=Number.isInteger(E.canvasMaxAreaInBytes)?E.canvasMaxAreaInBytes:-1,ce=typeof E.disableFontFace=="boolean"?E.disableFontFace:_util.isNodeJS,me=E.fontExtraProperties===!0,xe=E.enableXfa===!0,be=E.ownerDocument||globalThis.document,ye=E.disableRange===!0,Re=E.disableStream===!0,ie=E.disableAutoFetch===!0,ae=E.pdfBug===!0,M=V?V.length:E.length??NaN,H=typeof E.useSystemFonts=="boolean"?E.useSystemFonts:!_util.isNodeJS&&!ce,Z=typeof E.useWorkerFetch=="boolean"?E.useWorkerFetch:F===_display_utils.DOMCMapReaderFactory&&x===_display_utils.DOMStandardFontDataFactory&&q&&d&&(0,_display_utils.isValidFetchUrl)(q,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(d,document.baseURI),re=E.canvasFactory||new DefaultCanvasFactory({ownerDocument:be}),fe=E.filterFactory||new DefaultFilterFactory({docId:j,ownerDocument:be}),je=null;(0,_util.setVerbosityLevel)(ue);const Ae={canvasFactory:re,filterFactory:fe};if(Z||(Ae.cMapReaderFactory=new F({baseUrl:q,isCompressed:ee}),Ae.standardFontDataFactory=new x({baseUrl:d})),!K){const _e={verbosity:ue,port:_worker_options.GlobalWorkerOptions.workerPort};K=_e.port?PDFWorker.fromPort(_e):new PDFWorker(_e),C._worker=K}const te={docId:j,apiVersion:"3.11.174",data:v,password:se,disableAutoFetch:ie,rangeChunkSize:Q,length:M,docBaseUrl:D,enableXfa:xe,evaluatorOptions:{maxImageSize:B,disableFontFace:ce,ignoreErrors:N,isEvalSupported:G,isOffscreenCanvasSupported:W,canvasMaxAreaInBytes:Y,fontExtraProperties:me,useSystemFonts:H,cMapUrl:Z?q:null,standardFontDataUrl:Z?d:null}},Te={ignoreErrors:N,isEvalSupported:G,disableFontFace:ce,fontExtraProperties:me,enableXfa:xe,ownerDocument:be,disableAutoFetch:ie,pdfBug:ae,styleElement:je};return K.promise.then(function(){if(C.destroyed)throw new Error("Loading aborted");const _e=_fetchDocument(K,te),We=new Promise(function(Be){let Ke;V?Ke=new _transport_stream.PDFDataTransportStream({length:M,initialData:V.initialData,progressiveDone:V.progressiveDone,contentDispositionFilename:V.contentDispositionFilename,disableRange:ye,disableStream:Re},V):v||(Ke=(ze=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(ze):(0,_display_utils.isValidFetchUrl)(ze.url)?new _displayFetch_stream.PDFFetchStream(ze):new _displayNetwork.PDFNetworkStream(ze))({url:z,length:M,httpHeaders:T,withCredentials:O,rangeChunkSize:Q,disableRange:ye,disableStream:Re})),Be(Ke)});return Promise.all([_e,We]).then(function([Be,Ke]){if(C.destroyed)throw new Error("Loading aborted");const Me=new _message_handler.MessageHandler(j,Be,K.port),ze=new WorkerTransport(Me,C,Ke,Te,Ae);C._transport=ze,Me.send("Ready",null)})}).catch(C._capability.reject),C}async function _fetchDocument(E,C){if(E.destroyed)throw new Error("Worker was destroyed");const j=await E.messageHandler.sendWithPromise("GetDocRequest",C,C.data?[C.data.buffer]:null);if(E.destroyed)throw new Error("Worker was destroyed");return j}function getUrlProp(E){if(E instanceof URL)return E.href;try{return new URL(E,window.location).href}catch{if(_util.isNodeJS&&typeof E=="string")return E}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(E){if(_util.isNodeJS&&typeof Buffer<"u"&&E instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(E instanceof Uint8Array&&E.byteLength===E.buffer.byteLength)return E;if(typeof E=="string")return(0,_util.stringToBytes)(E);if(typeof E=="object"&&!isNaN(E==null?void 0:E.length)||(0,_util.isArrayBuffer)(E))return new Uint8Array(E);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${ht(e,r)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var C,j,z;this.destroyed=!0;try{(C=this._worker)!=null&&C.port&&(this._worker._pendingDestroy=!0),await((j=this._transport)==null?void 0:j.destroy())}catch(v){throw(z=this._worker)!=null&&z.port&&delete this._worker._pendingDestroy,v}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};r=new WeakMap,ne(e,r,0);let PDFDocumentLoadingTask=e;exports$1.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(C,j,z=!1,v=null){this.length=C,this.initialData=j,this.progressiveDone=z,this.contentDispositionFilename=v,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(C){this._rangeListeners.push(C)}addProgressListener(C){this._progressListeners.push(C)}addProgressiveReadListener(C){this._progressiveReadListeners.push(C)}addProgressiveDoneListener(C){this._progressiveDoneListeners.push(C)}onDataRange(C,j){for(const z of this._rangeListeners)z(C,j)}onDataProgress(C,j){this._readyCapability.promise.then(()=>{for(const z of this._progressListeners)z(C,j)})}onDataProgressiveRead(C){this._readyCapability.promise.then(()=>{for(const j of this._progressiveReadListeners)j(C)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const C of this._progressiveDoneListeners)C()})}transportReady(){this._readyCapability.resolve()}requestDataRange(C,j){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports$1.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(C,j){this._pdfInfo=C,this._transport=j,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(z=>{if(!z)return z;const v=[];for(const T in z)v.push(...z[T]);return v}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(C){return this._transport.getPage(C)}getPageIndex(C){return this._transport.getPageIndex(C)}getDestinations(){return this._transport.getDestinations()}getDestination(C){return this._transport.getDestination(C)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(C=!1){return this._transport.startCleanup(C||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports$1.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(C,j,z,v=!1){ne(this,i);ne(this,s,null);ne(this,t,!1);this._pageIndex=C,this._pageInfo=j,this._transport=z,this._stats=v?new _display_utils.StatTimer:null,this._pdfBug=v,this.commonObjs=z.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:C,rotation:j=this.rotate,offsetX:z=0,offsetY:v=0,dontFlip:T=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:C,rotation:j,offsetX:z,offsetY:v,dontFlip:T})}getAnnotations({intent:C="display"}={}){const j=this._transport.getRenderingIntent(C);return this._transport.getAnnotations(this._pageIndex,j.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var C;return((C=this._transport._htmlForXfa)==null?void 0:C.children[this._pageIndex])||null}render({canvasContext:C,viewport:j,intent:z="display",annotationMode:v=_util.AnnotationMode.ENABLE,transform:T=null,background:O=null,optionalContentConfigPromise:se=null,annotationCanvasMap:V=null,pageColors:Q=null,printAnnotationStorage:K=null}){var x,N;(x=this._stats)==null||x.time("Overall");const ue=this._transport.getRenderingIntent(z,v,K);le(this,t,!1),J(this,i,Et).call(this),se||(se=this._transport.getOptionalContentConfig());let D=this._intentStates.get(ue.cacheKey);D||(D=Object.create(null),this._intentStates.set(ue.cacheKey,D)),D.streamReaderCancelTimeout&&(clearTimeout(D.streamReaderCancelTimeout),D.streamReaderCancelTimeout=null);const q=!!(ue.renderingIntent&_util.RenderingIntentFlag.PRINT);D.displayReadyCapability||(D.displayReadyCapability=new _util.PromiseCapability,D.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(N=this._stats)==null||N.time("Page Request"),this._pumpOperatorList(ue));const ee=B=>{var G,W;D.renderTasks.delete(F),(this._maybeCleanupAfterRender||q)&&le(this,t,!0),J(this,i,ot).call(this,!q),B?(F.capability.reject(B),this._abortOperatorList({intentState:D,reason:B instanceof Error?B:new Error(B)})):F.capability.resolve(),(G=this._stats)==null||G.timeEnd("Rendering"),(W=this._stats)==null||W.timeEnd("Overall")},F=new InternalRenderTask({callback:ee,params:{canvasContext:C,viewport:j,transform:T,background:O},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:V,operatorList:D.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!q,pdfBug:this._pdfBug,pageColors:Q});(D.renderTasks||(D.renderTasks=new Set)).add(F);const d=F.task;return Promise.all([D.displayReadyCapability.promise,se]).then(([B,G])=>{var W;if(this.destroyed){ee();return}(W=this._stats)==null||W.time("Rendering"),F.initializeGraphics({transparency:B,optionalContentConfig:G}),F.operatorListChanged()}).catch(ee),d}getOperatorList({intent:C="display",annotationMode:j=_util.AnnotationMode.ENABLE,printAnnotationStorage:z=null}={}){var V;function v(){O.operatorList.lastChunk&&(O.opListReadCapability.resolve(O.operatorList),O.renderTasks.delete(se))}const T=this._transport.getRenderingIntent(C,j,z,!0);let O=this._intentStates.get(T.cacheKey);O||(O=Object.create(null),this._intentStates.set(T.cacheKey,O));let se;return O.opListReadCapability||(se=Object.create(null),se.operatorListChanged=v,O.opListReadCapability=new _util.PromiseCapability,(O.renderTasks||(O.renderTasks=new Set)).add(se),O.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(V=this._stats)==null||V.time("Page Request"),this._pumpOperatorList(T)),O.opListReadCapability.promise}streamTextContent({includeMarkedContent:C=!1,disableNormalization:j=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:C===!0,disableNormalization:j===!0},{highWaterMark:100,size(v){return v.items.length}})}getTextContent(C={}){if(this._transport._htmlForXfa)return this.getXfa().then(z=>_xfa_text.XfaText.textContent(z));const j=this.streamTextContent(C);return new Promise(function(z,v){function T(){O.read().then(function({value:V,done:Q}){if(Q){z(se);return}Object.assign(se.styles,V.styles),se.items.push(...V.items),T()},v)}const O=j.getReader(),se={items:[],styles:Object.create(null)};T()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const C=[];for(const j of this._intentStates.values())if(this._abortOperatorList({intentState:j,reason:new Error("Page was destroyed."),force:!0}),!j.opListReadCapability)for(const z of j.renderTasks)C.push(z.completed),z.cancel();return this.objs.clear(),le(this,t,!1),J(this,i,Et).call(this),Promise.all(C)}cleanup(C=!1){le(this,t,!0);const j=J(this,i,ot).call(this,!1);return C&&j&&this._stats&&(this._stats=new _display_utils.StatTimer),j}_startRenderPage(C,j){var v,T;const z=this._intentStates.get(j);z&&((v=this._stats)==null||v.timeEnd("Page Request"),(T=z.displayReadyCapability)==null||T.resolve(C))}_renderPageChunk(C,j){for(let z=0,v=C.length;z<v;z++)j.operatorList.fnArray.push(C.fnArray[z]),j.operatorList.argsArray.push(C.argsArray[z]);j.operatorList.lastChunk=C.lastChunk,j.operatorList.separateAnnots=C.separateAnnots;for(const z of j.renderTasks)z.operatorListChanged();C.lastChunk&&J(this,i,ot).call(this,!0)}_pumpOperatorList({renderingIntent:C,cacheKey:j,annotationStorageSerializable:z}){const{map:v,transfers:T}=z,se=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:C,cacheKey:j,annotationStorage:v},T).getReader(),V=this._intentStates.get(j);V.streamReader=se;const Q=()=>{se.read().then(({value:K,done:ue})=>{if(ue){V.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(K,V),Q())},K=>{if(V.streamReader=null,!this._transport.destroyed){if(V.operatorList){V.operatorList.lastChunk=!0;for(const ue of V.renderTasks)ue.operatorListChanged();J(this,i,ot).call(this,!0)}if(V.displayReadyCapability)V.displayReadyCapability.reject(K);else if(V.opListReadCapability)V.opListReadCapability.reject(K);else throw K}})};Q()}_abortOperatorList({intentState:C,reason:j,force:z=!1}){if(C.streamReader){if(C.streamReaderCancelTimeout&&(clearTimeout(C.streamReaderCancelTimeout),C.streamReaderCancelTimeout=null),!z){if(C.renderTasks.size>0)return;if(j instanceof _display_utils.RenderingCancelledException){let v=RENDERING_CANCELLED_TIMEOUT;j.extraDelay>0&&j.extraDelay<1e3&&(v+=j.extraDelay),C.streamReaderCancelTimeout=setTimeout(()=>{C.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:C,reason:j,force:!0})},v);return}}if(C.streamReader.cancel(new _util.AbortException(j.message)).catch(()=>{}),C.streamReader=null,!this._transport.destroyed){for(const[v,T]of this._intentStates)if(T===C){this._intentStates.delete(v);break}this.cleanup()}}}get stats(){return this._stats}}s=new WeakMap,t=new WeakMap,i=new WeakSet,ot=function(C=!1){if(J(this,i,Et).call(this),!n(this,t)||this.destroyed)return!1;if(C)return le(this,s,setTimeout(()=>{le(this,s,null),J(this,i,ot).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:j,operatorList:z}of this._intentStates.values())if(j.size>0||!z.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),le(this,t,!1),!0},Et=function(){n(this,s)&&(clearTimeout(n(this,s)),le(this,s,null))},exports$1.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){ne(this,w,new Set);ne(this,S,Promise.resolve())}postMessage(C,j){const z={data:structuredClone(C,j?{transfer:j}:null)};n(this,S).then(()=>{for(const v of n(this,w))v.call(this,z)})}addEventListener(C,j){n(this,w).add(j)}removeEventListener(C,j){n(this,w).delete(j)}terminate(){n(this,w).clear()}}w=new WeakMap,S=new WeakMap,exports$1.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports$1.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const E=(y=document==null?void 0:document.currentScript)==null?void 0:y.src;E&&(PDFWorkerUtil.fallbackWorkerSrc=E.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(E,C){let j;try{if(j=new URL(E),!j.origin||j.origin==="null")return!1}catch{return!1}const z=new URL(C,j);return j.origin===z.origin},PDFWorkerUtil.createCDNWrapper=function(E){const C=`importScripts("${E}");`;return URL.createObjectURL(new Blob([C]))}}const _PDFWorker=class _PDFWorker{constructor({name:E=null,port:C=null,verbosity:j=(0,_util.getVerbosityLevel)()}={}){var z;if(this.name=E,this.destroyed=!1,this.verbosity=j,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,C){if((z=n(_PDFWorker,u))!=null&&z.has(C))throw new Error("Cannot use more than one PDFWorker per port.");(n(_PDFWorker,u)||le(_PDFWorker,u,new WeakMap)).set(C,this),this._initializeFromPort(C);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(E){this._port=E,this._messageHandler=new _message_handler.MessageHandler("main","worker",E),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:E}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,E)||(E=PDFWorkerUtil.createCDNWrapper(new URL(E,window.location).href));const C=new Worker(E),j=new _message_handler.MessageHandler("main","worker",C),z=()=>{C.removeEventListener("error",v),j.destroy(),C.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},v=()=>{this._webWorker||z()};C.addEventListener("error",v),j.on("test",O=>{if(C.removeEventListener("error",v),this.destroyed){z();return}O?(this._messageHandler=j,this._port=C,this._webWorker=C,this._readyCapability.resolve(),j.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),j.destroy(),C.terminate())}),j.on("ready",O=>{if(C.removeEventListener("error",v),this.destroyed){z();return}try{T()}catch{this._setupFakeWorker()}});const T=()=>{const O=new Uint8Array;j.send("test",O,[O.buffer])};T();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(E=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const C=new LoopbackPort;this._port=C;const j=`fake${PDFWorkerUtil.fakeWorkerId++}`,z=new _message_handler.MessageHandler(j+"_worker",j,C);E.setup(z,C);const v=new _message_handler.MessageHandler(j,j+"_worker",C);this._messageHandler=v,this._readyCapability.resolve(),v.send("configure",{verbosity:this.verbosity})}).catch(E=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${E.message}".`))})}destroy(){var E;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(E=n(_PDFWorker,u))==null||E.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(E){var j;if(!(E!=null&&E.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const C=(j=n(this,u))==null?void 0:j.get(E.port);if(C){if(C._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return C}return new _PDFWorker(E)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var E;try{return((E=globalThis.pdfjsWorker)==null?void 0:E.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};u=new WeakMap,ne(_PDFWorker,u);let PDFWorker=_PDFWorker;exports$1.PDFWorker=PDFWorker;class WorkerTransport{constructor(C,j,z,v,T){ne(this,_);ne(this,h,new Map);ne(this,l,new Map);ne(this,c,new Map);ne(this,b,null);this.messageHandler=C,this.loadingTask=j,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:v.ownerDocument,styleElement:v.styleElement}),this._params=v,this.canvasFactory=T.canvasFactory,this.filterFactory=T.filterFactory,this.cMapReaderFactory=T.cMapReaderFactory,this.standardFontDataFactory=T.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=z,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(C,j=_util.AnnotationMode.ENABLE,z=null,v=!1){let T=_util.RenderingIntentFlag.DISPLAY,O=_annotation_storage.SerializableEmpty;switch(C){case"any":T=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":T=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${C}`)}switch(j){case _util.AnnotationMode.DISABLE:T+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:T+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:T+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,O=(T&_util.RenderingIntentFlag.PRINT&&z instanceof _annotation_storage.PrintAnnotationStorage?z:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${j}`)}return v&&(T+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:T,cacheKey:`${T}_${O.hash}`,annotationStorageSerializable:O}}destroy(){var z;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(z=n(this,b))==null||z.reject(new Error("Worker was destroyed during onPassword callback"));const C=[];for(const v of n(this,l).values())C.push(v._destroy());n(this,l).clear(),n(this,c).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const j=this.messageHandler.sendWithPromise("Terminate",null);return C.push(j),Promise.all(C).then(()=>{var v;this.commonObjs.clear(),this.fontLoader.clear(),n(this,h).clear(),this.filterFactory.destroy(),(v=this._networkStream)==null||v.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:C,loadingTask:j}=this;C.on("GetReader",(z,v)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=T=>{this._lastProgress={loaded:T.loaded,total:T.total}},v.onPull=()=>{this._fullReader.read().then(function({value:T,done:O}){if(O){v.close();return}(0,_util.assert)(T instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),v.enqueue(new Uint8Array(T),1,[T])}).catch(T=>{v.error(T)})},v.onCancel=T=>{this._fullReader.cancel(T),v.ready.catch(O=>{if(!this.destroyed)throw O})}}),C.on("ReaderHeadersReady",z=>{const v=new _util.PromiseCapability,T=this._fullReader;return T.headersReady.then(()=>{var O;(!T.isStreamingSupported||!T.isRangeSupported)&&(this._lastProgress&&((O=j.onProgress)==null||O.call(j,this._lastProgress)),T.onProgress=se=>{var V;(V=j.onProgress)==null||V.call(j,{loaded:se.loaded,total:se.total})}),v.resolve({isStreamingSupported:T.isStreamingSupported,isRangeSupported:T.isRangeSupported,contentLength:T.contentLength})},v.reject),v.promise}),C.on("GetRangeReader",(z,v)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const T=this._networkStream.getRangeReader(z.begin,z.end);if(!T){v.close();return}v.onPull=()=>{T.read().then(function({value:O,done:se}){if(se){v.close();return}(0,_util.assert)(O instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),v.enqueue(new Uint8Array(O),1,[O])}).catch(O=>{v.error(O)})},v.onCancel=O=>{T.cancel(O),v.ready.catch(se=>{if(!this.destroyed)throw se})}}),C.on("GetDoc",({pdfInfo:z})=>{this._numPages=z.numPages,this._htmlForXfa=z.htmlForXfa,delete z.htmlForXfa,j._capability.resolve(new PDFDocumentProxy(z,this))}),C.on("DocException",function(z){let v;switch(z.name){case"PasswordException":v=new _util.PasswordException(z.message,z.code);break;case"InvalidPDFException":v=new _util.InvalidPDFException(z.message);break;case"MissingPDFException":v=new _util.MissingPDFException(z.message);break;case"UnexpectedResponseException":v=new _util.UnexpectedResponseException(z.message,z.status);break;case"UnknownErrorException":v=new _util.UnknownErrorException(z.message,z.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}j._capability.reject(v)}),C.on("PasswordRequest",z=>{if(le(this,b,new _util.PromiseCapability),j.onPassword){const v=T=>{T instanceof Error?n(this,b).reject(T):n(this,b).resolve({password:T})};try{j.onPassword(v,z.code)}catch(T){n(this,b).reject(T)}}else n(this,b).reject(new _util.PasswordException(z.message,z.code));return n(this,b).promise}),C.on("DataLoaded",z=>{var v;(v=j.onProgress)==null||v.call(j,{loaded:z.length,total:z.length}),this.downloadInfoCapability.resolve(z)}),C.on("StartRenderPage",z=>{if(this.destroyed)return;n(this,l).get(z.pageIndex)._startRenderPage(z.transparency,z.cacheKey)}),C.on("commonobj",([z,v,T])=>{var O;if(!this.destroyed&&!this.commonObjs.has(z))switch(v){case"Font":const se=this._params;if("error"in T){const K=T.error;(0,_util.warn)(`Error during font loading: ${K}`),this.commonObjs.resolve(z,K);break}const V=se.pdfBug&&((O=globalThis.FontInspector)!=null&&O.enabled)?(K,ue)=>globalThis.FontInspector.fontAdded(K,ue):null,Q=new _font_loader.FontFaceObject(T,{isEvalSupported:se.isEvalSupported,disableFontFace:se.disableFontFace,ignoreErrors:se.ignoreErrors,inspectFont:V});this.fontLoader.bind(Q).catch(K=>C.sendWithPromise("FontFallback",{id:z})).finally(()=>{!se.fontExtraProperties&&Q.data&&(Q.data=null),this.commonObjs.resolve(z,Q)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(z,T);break;default:throw new Error(`Got unknown common object type ${v}`)}}),C.on("obj",([z,v,T,O])=>{var V;if(this.destroyed)return;const se=n(this,l).get(v);if(!se.objs.has(z))switch(T){case"Image":if(se.objs.resolve(z,O),O){let Q;if(O.bitmap){const{width:K,height:ue}=O;Q=K*ue*4}else Q=((V=O.data)==null?void 0:V.length)||0;Q>_util.MAX_IMAGE_SIZE_TO_CACHE&&(se._maybeCleanupAfterRender=!0)}break;case"Pattern":se.objs.resolve(z,O);break;default:throw new Error(`Got unknown object type ${T}`)}}),C.on("DocProgress",z=>{var v;this.destroyed||(v=j.onProgress)==null||v.call(j,{loaded:z.loaded,total:z.total})}),C.on("FetchBuiltInCMap",z=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(z):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),C.on("FetchStandardFontData",z=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(z):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var z;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:C,transfers:j}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:C,filename:((z=this._fullReader)==null?void 0:z.filename)??null},j).finally(()=>{this.annotationStorage.resetModified()})}getPage(C){if(!Number.isInteger(C)||C<=0||C>this._numPages)return Promise.reject(new Error("Invalid page request."));const j=C-1,z=n(this,c).get(j);if(z)return z;const v=this.messageHandler.sendWithPromise("GetPage",{pageIndex:j}).then(T=>{if(this.destroyed)throw new Error("Transport destroyed");const O=new PDFPageProxy(j,T,this,this._params.pdfBug);return n(this,l).set(j,O),O});return n(this,c).set(j,v),v}getPageIndex(C){return typeof C!="object"||C===null||!Number.isInteger(C.num)||C.num<0||!Number.isInteger(C.gen)||C.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:C.num,gen:C.gen})}getAnnotations(C,j){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:C,intent:j})}getFieldObjects(){return J(this,_,yt).call(this,"GetFieldObjects")}hasJSActions(){return J(this,_,yt).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(C){return typeof C!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:C})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return J(this,_,yt).call(this,"GetDocJSActions")}getPageJSActions(C){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:C})}getStructTree(C){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:C})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(C=>new _optional_content_config.OptionalContentConfig(C))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const C="GetMetadata",j=n(this,h).get(C);if(j)return j;const z=this.messageHandler.sendWithPromise(C,null).then(v=>{var T,O;return{info:v[0],metadata:v[1]?new _metadata.Metadata(v[1]):null,contentDispositionFilename:((T=this._fullReader)==null?void 0:T.filename)??null,contentLength:((O=this._fullReader)==null?void 0:O.contentLength)??null}});return n(this,h).set(C,z),z}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(C=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const j of n(this,l).values())if(!j.cleanup())throw new Error(`startCleanup: Page ${j.pageNumber} is currently rendering.`);this.commonObjs.clear(),C||this.fontLoader.clear(),n(this,h).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:C,enableXfa:j}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:C,enableXfa:j})}}h=new WeakMap,l=new WeakMap,c=new WeakMap,b=new WeakMap,_=new WeakSet,yt=function(C,j=null){const z=n(this,h).get(C);if(z)return z;const v=this.messageHandler.sendWithPromise(C,j);return n(this,h).set(C,v),v};class PDFObjects{constructor(){ne(this,A);ne(this,p,Object.create(null))}get(C,j=null){if(j){const v=J(this,A,It).call(this,C);return v.capability.promise.then(()=>j(v.data)),null}const z=n(this,p)[C];if(!(z!=null&&z.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${C}.`);return z.data}has(C){const j=n(this,p)[C];return(j==null?void 0:j.capability.settled)||!1}resolve(C,j=null){const z=J(this,A,It).call(this,C);z.data=j,z.capability.resolve()}clear(){var C;for(const j in n(this,p)){const{data:z}=n(this,p)[j];(C=z==null?void 0:z.bitmap)==null||C.close()}le(this,p,Object.create(null))}}p=new WeakMap,A=new WeakSet,It=function(C){var j;return(j=n(this,p))[C]||(j[C]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(C){ne(this,P,null);le(this,P,C),this.onContinue=null}get promise(){return n(this,P).capability.promise}cancel(C=0){n(this,P).cancel(null,C)}get separateAnnots(){const{separateAnnots:C}=n(this,P).operatorList;if(!C)return!1;const{annotationCanvasMap:j}=n(this,P);return C.form||C.canvas&&(j==null?void 0:j.size)>0}}P=new WeakMap,exports$1.RenderTask=RenderTask;const R=class R{constructor({callback:C,params:j,objs:z,commonObjs:v,annotationCanvasMap:T,operatorList:O,pageIndex:se,canvasFactory:V,filterFactory:Q,useRequestAnimationFrame:K=!1,pdfBug:ue=!1,pageColors:D=null}){this.callback=C,this.params=j,this.objs=z,this.commonObjs=v,this.annotationCanvasMap=T,this.operatorListIdx=null,this.operatorList=O,this._pageIndex=se,this.canvasFactory=V,this.filterFactory=Q,this._pdfBug=ue,this.pageColors=D,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=K===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=j.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:C=!1,optionalContentConfig:j}){var se,V;if(this.cancelled)return;if(this._canvas){if(n(R,g).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");n(R,g).add(this._canvas)}this._pdfBug&&((se=globalThis.StepperManager)!=null&&se.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:z,viewport:v,transform:T,background:O}=this.params;this.gfx=new _canvas.CanvasGraphics(z,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:j},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:T,viewport:v,transparency:C,background:O}),this.operatorListIdx=0,this.graphicsReady=!0,(V=this.graphicsReadyCallback)==null||V.call(this)}cancel(C=null,j=0){var z;this.running=!1,this.cancelled=!0,(z=this.gfx)==null||z.endDrawing(),n(R,g).delete(this._canvas),this.callback(C||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,j))}operatorListChanged(){var C;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(C=this.stepper)==null||C.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),n(R,g).delete(this._canvas),this.callback())))}};g=new WeakMap,ne(R,g,new WeakSet);let InternalRenderTask=R;const version="3.11.174";exports$1.version=version;const build="ce8716743";exports$1.build=build},(r,e,s)=>{var y,u,h,bs,c;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var t=s(1),i=s(4),a=s(8);const o=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=o;class w{constructor(){ne(this,h);ne(this,y,!1);ne(this,u,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(_,f){const p=n(this,u).get(_);return p===void 0?f:Object.assign(f,p)}getRawValue(_){return n(this,u).get(_)}remove(_){if(n(this,u).delete(_),n(this,u).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const f of n(this,u).values())if(f instanceof i.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(_,f){const p=n(this,u).get(_);let A=!1;if(p!==void 0)for(const[k,P]of Object.entries(f))p[k]!==P&&(A=!0,p[k]=P);else A=!0,n(this,u).set(_,f);A&&J(this,h,bs).call(this),f instanceof i.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(f.constructor._type)}has(_){return n(this,u).has(_)}getAll(){return n(this,u).size>0?(0,t.objectFromMap)(n(this,u)):null}setAll(_){for(const[f,p]of Object.entries(_))this.setValue(f,p)}get size(){return n(this,u).size}resetModified(){n(this,y)&&(le(this,y,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new S(this)}get serializable(){if(n(this,u).size===0)return o;const _=new Map,f=new a.MurmurHash3_64,p=[],A=Object.create(null);let k=!1;for(const[P,g]of n(this,u)){const R=g instanceof i.AnnotationEditor?g.serialize(!1,A):g;R&&(_.set(P,R),f.update(`${P}:${JSON.stringify(R)}`),k||(k=!!R.bitmap))}if(k)for(const P of _.values())P.bitmap&&p.push(P.bitmap);return _.size>0?{map:_,hash:f.hexdigest(),transfers:p}:o}}y=new WeakMap,u=new WeakMap,h=new WeakSet,bs=function(){n(this,y)||(le(this,y,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=w;class S extends w{constructor(f){super();ne(this,c);const{map:p,hash:A,transfers:k}=f.serializable,P=structuredClone(p,k?{transfer:k}:null);le(this,c,{map:P,hash:A,transfers:k})}get print(){(0,t.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return n(this,c)}}c=new WeakMap,e.PrintAnnotationStorage=S},(r,e,s)=>{var S,y,u,h,l,c,b,_,f,p,A,k,P,g,R,Dt,Ot,j,Lt,zt,vs,Es,ys,Bt,As;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var t=s(5),i=s(1),a=s(6);const K=class K{constructor(D){ne(this,R);ne(this,S,"");ne(this,y,!1);ne(this,u,null);ne(this,h,null);ne(this,l,null);ne(this,c,!1);ne(this,b,null);ne(this,_,this.focusin.bind(this));ne(this,f,this.focusout.bind(this));ne(this,p,!1);ne(this,A,!1);ne(this,k,!1);Je(this,"_initialOptions",Object.create(null));Je(this,"_uiManager",null);Je(this,"_focusEventsAllowed",!0);Je(this,"_l10nPromise",null);ne(this,P,!1);ne(this,g,K._zIndex++);this.constructor===K&&(0,i.unreachable)("Cannot initialize AnnotationEditor."),this.parent=D.parent,this.id=D.id,this.width=this.height=null,this.pageIndex=D.parent.pageIndex,this.name=D.name,this.div=null,this._uiManager=D.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=D.isCentered,this._structTreeParentId=null;const{rotation:q,rawDims:{pageWidth:ee,pageHeight:F,pageX:d,pageY:x}}=this.parent.viewport;this.rotation=q,this.pageRotation=(360+q-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[ee,F],this.pageTranslation=[d,x];const[N,B]=this.parentDimensions;this.x=D.x/N,this.y=D.y/B,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,i.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(D){const q=new w({id:D.parent.getNextId(),parent:D.parent,uiManager:D._uiManager});q.annotationElementId=D.annotationElementId,q.deleted=!0,q._uiManager.addToAnnotationStorage(q)}static initialize(D,q=null){if(K._l10nPromise||(K._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(F=>[F,D.get(F)]))),q!=null&&q.strings)for(const F of q.strings)K._l10nPromise.set(F,D.get(F));if(K._borderLineWidth!==-1)return;const ee=getComputedStyle(document.documentElement);K._borderLineWidth=parseFloat(ee.getPropertyValue("--outline-width"))||0}static updateDefaultParams(D,q){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(D){return!1}static paste(D,q){(0,i.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return n(this,P)}set _isDraggable(D){var q;le(this,P,D),(q=this.div)==null||q.classList.toggle("draggable",D)}center(){const[D,q]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*q/(D*2),this.y+=this.width*D/(q*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*q/(D*2),this.y-=this.width*D/(q*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(D){this._uiManager.addCommands(D)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=n(this,g)}setParent(D){D!==null&&(this.pageIndex=D.pageIndex,this.pageDimensions=D.pageDimensions),this.parent=D}focusin(D){this._focusEventsAllowed&&(n(this,p)?le(this,p,!1):this.parent.setSelected(this))}focusout(D){var ee;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const q=D.relatedTarget;q!=null&&q.closest(`#${this.id}`)||(D.preventDefault(),(ee=this.parent)!=null&&ee.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(D,q,ee,F){const[d,x]=this.parentDimensions;[ee,F]=this.screenToPageTranslation(ee,F),this.x=(D+ee)/d,this.y=(q+F)/x,this.fixAndSetPosition()}translate(D,q){J(this,R,Dt).call(this,this.parentDimensions,D,q)}translateInPage(D,q){J(this,R,Dt).call(this,this.pageDimensions,D,q),this.div.scrollIntoView({block:"nearest"})}drag(D,q){const[ee,F]=this.parentDimensions;if(this.x+=D/ee,this.y+=q/F,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:G,y:W}=this.div.getBoundingClientRect();this.parent.findNewParent(this,G,W)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:d,y:x}=this;const[N,B]=J(this,R,Ot).call(this);d+=N,x+=B,this.div.style.left=`${(100*d).toFixed(2)}%`,this.div.style.top=`${(100*x).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[D,q]=this.pageDimensions;let{x:ee,y:F,width:d,height:x}=this;switch(d*=D,x*=q,ee*=D,F*=q,this.rotation){case 0:ee=Math.max(0,Math.min(D-d,ee)),F=Math.max(0,Math.min(q-x,F));break;case 90:ee=Math.max(0,Math.min(D-x,ee)),F=Math.min(q,Math.max(d,F));break;case 180:ee=Math.min(D,Math.max(d,ee)),F=Math.min(q,Math.max(x,F));break;case 270:ee=Math.min(D,Math.max(x,ee)),F=Math.max(0,Math.min(q-d,F));break}this.x=ee/=D,this.y=F/=q;const[N,B]=J(this,R,Ot).call(this);ee+=N,F+=B;const{style:G}=this.div;G.left=`${(100*ee).toFixed(2)}%`,G.top=`${(100*F).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(D,q){var ee;return J(ee=K,j,Lt).call(ee,D,q,this.parentRotation)}pageTranslationToScreen(D,q){var ee;return J(ee=K,j,Lt).call(ee,D,q,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:D,pageDimensions:[q,ee]}=this,F=q*D,d=ee*D;return i.FeatureTest.isCSSRoundSupported?[Math.round(F),Math.round(d)]:[F,d]}setDims(D,q){var d;const[ee,F]=this.parentDimensions;this.div.style.width=`${(100*D/ee).toFixed(2)}%`,n(this,c)||(this.div.style.height=`${(100*q/F).toFixed(2)}%`),(d=n(this,u))==null||d.classList.toggle("small",D<K.SMALL_EDITOR_SIZE||q<K.SMALL_EDITOR_SIZE)}fixDims(){const{style:D}=this.div,{height:q,width:ee}=D,F=ee.endsWith("%"),d=!n(this,c)&&q.endsWith("%");if(F&&d)return;const[x,N]=this.parentDimensions;F||(D.width=`${(100*parseFloat(ee)/x).toFixed(2)}%`),!n(this,c)&&!d&&(D.height=`${(100*parseFloat(q)/N).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(n(this,u))return;const D=le(this,u,document.createElement("button"));D.className="altText";const q=await K._l10nPromise.get("editor_alt_text_button_label");D.textContent=q,D.setAttribute("aria-label",q),D.tabIndex="0",D.addEventListener("contextmenu",a.noContextMenu),D.addEventListener("pointerdown",ee=>ee.stopPropagation()),D.addEventListener("click",ee=>{ee.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),D.addEventListener("keydown",ee=>{ee.target===D&&ee.key==="Enter"&&(ee.preventDefault(),this._uiManager.editAltText(this))}),J(this,R,Bt).call(this),this.div.append(D),K.SMALL_EDITOR_SIZE||(K.SMALL_EDITOR_SIZE=Math.min(128,Math.round(D.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:n(this,S),decorative:n(this,y)}}set altTextData({altText:D,decorative:q}){n(this,S)===D&&n(this,y)===q||(le(this,S,D),le(this,y,q),J(this,R,Bt).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",n(this,_)),this.div.addEventListener("focusout",n(this,f));const[D,q]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*q/D).toFixed(2)}%`,this.div.style.maxHeight=`${(100*D/q).toFixed(2)}%`);const[ee,F]=this.getInitialTranslation();return this.translate(ee,F),(0,t.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(D){const{isMac:q}=i.FeatureTest.platform;if(D.button!==0||D.ctrlKey&&q){D.preventDefault();return}le(this,p,!0),J(this,R,As).call(this,D)}moveInDOM(){var D;(D=this.parent)==null||D.moveEditorInDOM(this)}_setParentAndPosition(D,q,ee){D.changeParent(this),this.x=q,this.y=ee,this.fixAndSetPosition()}getRect(D,q){const ee=this.parentScale,[F,d]=this.pageDimensions,[x,N]=this.pageTranslation,B=D/ee,G=q/ee,W=this.x*F,Y=this.y*d,ce=this.width*F,me=this.height*d;switch(this.rotation){case 0:return[W+B+x,d-Y-G-me+N,W+B+ce+x,d-Y-G+N];case 90:return[W+G+x,d-Y+B+N,W+G+me+x,d-Y+B+ce+N];case 180:return[W-B-ce+x,d-Y+G+N,W-B+x,d-Y+G+me+N];case 270:return[W-G-me+x,d-Y-B-ce+N,W-G+x,d-Y-B+N];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(D,q){const[ee,F,d,x]=D,N=d-ee,B=x-F;switch(this.rotation){case 0:return[ee,q-x,N,B];case 90:return[ee,q-F,B,N];case 180:return[d,q-F,N,B];case 270:return[d,q-x,B,N];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){le(this,k,!0)}disableEditMode(){le(this,k,!1)}isInEditMode(){return n(this,k)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var D,q;(D=this.div)==null||D.addEventListener("focusin",n(this,_)),(q=this.div)==null||q.addEventListener("focusout",n(this,f))}serialize(D=!1,q=null){(0,i.unreachable)("An editor must be serializable")}static deserialize(D,q,ee){const F=new this.prototype.constructor({parent:q,id:q.getNextId(),uiManager:ee});F.rotation=D.rotation;const[d,x]=F.pageDimensions,[N,B,G,W]=F.getRectInCurrentCoords(D.rect,x);return F.x=N/d,F.y=B/x,F.width=G/d,F.height=W/x,F}remove(){var D;this.div.removeEventListener("focusin",n(this,_)),this.div.removeEventListener("focusout",n(this,f)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(D=n(this,u))==null||D.remove(),le(this,u,null),le(this,h,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(J(this,R,vs).call(this),n(this,b).classList.remove("hidden"))}select(){var D;this.makeResizable(),(D=this.div)==null||D.classList.add("selectedEditor")}unselect(){var D,q,ee;(D=n(this,b))==null||D.classList.add("hidden"),(q=this.div)==null||q.classList.remove("selectedEditor"),(ee=this.div)!=null&&ee.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(D,q){}disableEditing(){n(this,u)&&(n(this,u).hidden=!0)}enableEditing(){n(this,u)&&(n(this,u).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return n(this,A)}set isEditing(D){le(this,A,D),this.parent&&(D?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(D,q){le(this,c,!0);const ee=D/q,{style:F}=this.div;F.aspectRatio=ee,F.height="auto"}static get MIN_SIZE(){return 16}};S=new WeakMap,y=new WeakMap,u=new WeakMap,h=new WeakMap,l=new WeakMap,c=new WeakMap,b=new WeakMap,_=new WeakMap,f=new WeakMap,p=new WeakMap,A=new WeakMap,k=new WeakMap,P=new WeakMap,g=new WeakMap,R=new WeakSet,Dt=function([D,q],ee,F){[ee,F]=this.screenToPageTranslation(ee,F),this.x+=ee/D,this.y+=F/q,this.fixAndSetPosition()},Ot=function(){const[D,q]=this.parentDimensions,{_borderLineWidth:ee}=K,F=ee/D,d=ee/q;switch(this.rotation){case 90:return[-F,d];case 180:return[F,d];case 270:return[F,-d];default:return[-F,-d]}},j=new WeakSet,Lt=function(D,q,ee){switch(ee){case 90:return[q,-D];case 180:return[-D,-q];case 270:return[-q,D];default:return[D,q]}},zt=function(D){switch(D){case 90:{const[q,ee]=this.pageDimensions;return[0,-q/ee,ee/q,0]}case 180:return[-1,0,0,-1];case 270:{const[q,ee]=this.pageDimensions;return[0,q/ee,-ee/q,0]}default:return[1,0,0,1]}},vs=function(){if(n(this,b))return;le(this,b,document.createElement("div")),n(this,b).classList.add("resizers");const D=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||D.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const q of D){const ee=document.createElement("div");n(this,b).append(ee),ee.classList.add("resizer",q),ee.addEventListener("pointerdown",J(this,R,Es).bind(this,q)),ee.addEventListener("contextmenu",a.noContextMenu)}this.div.prepend(n(this,b))},Es=function(D,q){q.preventDefault();const{isMac:ee}=i.FeatureTest.platform;if(q.button!==0||q.ctrlKey&&ee)return;const F=J(this,R,ys).bind(this,D),d=this._isDraggable;this._isDraggable=!1;const x={passive:!0,capture:!0};window.addEventListener("pointermove",F,x);const N=this.x,B=this.y,G=this.width,W=this.height,Y=this.parent.div.style.cursor,ce=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(q.target).cursor;const me=()=>{this._isDraggable=d,window.removeEventListener("pointerup",me),window.removeEventListener("blur",me),window.removeEventListener("pointermove",F,x),this.parent.div.style.cursor=Y,this.div.style.cursor=ce;const xe=this.x,be=this.y,ye=this.width,Re=this.height;xe===N&&be===B&&ye===G&&Re===W||this.addCommands({cmd:()=>{this.width=ye,this.height=Re,this.x=xe,this.y=be;const[ie,ae]=this.parentDimensions;this.setDims(ie*ye,ae*Re),this.fixAndSetPosition()},undo:()=>{this.width=G,this.height=W,this.x=N,this.y=B;const[ie,ae]=this.parentDimensions;this.setDims(ie*G,ae*W),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",me),window.addEventListener("blur",me)},ys=function(D,q){const[ee,F]=this.parentDimensions,d=this.x,x=this.y,N=this.width,B=this.height,G=K.MIN_SIZE/ee,W=K.MIN_SIZE/F,Y=Me=>Math.round(Me*1e4)/1e4,ce=J(this,R,zt).call(this,this.rotation),me=(Me,ze)=>[ce[0]*Me+ce[2]*ze,ce[1]*Me+ce[3]*ze],xe=J(this,R,zt).call(this,360-this.rotation),be=(Me,ze)=>[xe[0]*Me+xe[2]*ze,xe[1]*Me+xe[3]*ze];let ye,Re,ie=!1,ae=!1;switch(D){case"topLeft":ie=!0,ye=(Me,ze)=>[0,0],Re=(Me,ze)=>[Me,ze];break;case"topMiddle":ye=(Me,ze)=>[Me/2,0],Re=(Me,ze)=>[Me/2,ze];break;case"topRight":ie=!0,ye=(Me,ze)=>[Me,0],Re=(Me,ze)=>[0,ze];break;case"middleRight":ae=!0,ye=(Me,ze)=>[Me,ze/2],Re=(Me,ze)=>[0,ze/2];break;case"bottomRight":ie=!0,ye=(Me,ze)=>[Me,ze],Re=(Me,ze)=>[0,0];break;case"bottomMiddle":ye=(Me,ze)=>[Me/2,ze],Re=(Me,ze)=>[Me/2,0];break;case"bottomLeft":ie=!0,ye=(Me,ze)=>[0,ze],Re=(Me,ze)=>[Me,0];break;case"middleLeft":ae=!0,ye=(Me,ze)=>[0,ze/2],Re=(Me,ze)=>[Me,ze/2];break}const M=ye(N,B),H=Re(N,B);let Z=me(...H);const re=Y(d+Z[0]),fe=Y(x+Z[1]);let je=1,Ae=1,[te,Te]=this.screenToPageTranslation(q.movementX,q.movementY);if([te,Te]=be(te/ee,Te/F),ie){const Me=Math.hypot(N,B);je=Ae=Math.max(Math.min(Math.hypot(H[0]-M[0]-te,H[1]-M[1]-Te)/Me,1/N,1/B),G/N,W/B)}else ae?je=Math.max(G,Math.min(1,Math.abs(H[0]-M[0]-te)))/N:Ae=Math.max(W,Math.min(1,Math.abs(H[1]-M[1]-Te)))/B;const _e=Y(N*je),We=Y(B*Ae);Z=me(...Re(_e,We));const Be=re-Z[0],Ke=fe-Z[1];this.width=_e,this.height=We,this.x=Be,this.y=Ke,this.setDims(ee*_e,F*We),this.fixAndSetPosition()},Bt=async function(){var ee;const D=n(this,u);if(!D)return;if(!n(this,S)&&!n(this,y)){D.classList.remove("done"),(ee=n(this,h))==null||ee.remove();return}K._l10nPromise.get("editor_alt_text_edit_button_label").then(F=>{D.setAttribute("aria-label",F)});let q=n(this,h);if(!q){le(this,h,q=document.createElement("span")),q.className="tooltip",q.setAttribute("role","tooltip");const F=q.id=`alt-text-tooltip-${this.id}`;D.setAttribute("aria-describedby",F);const d=100;D.addEventListener("mouseenter",()=>{le(this,l,setTimeout(()=>{le(this,l,null),n(this,h).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},d))}),D.addEventListener("mouseleave",()=>{var x;clearTimeout(n(this,l)),le(this,l,null),(x=n(this,h))==null||x.classList.remove("show")})}D.classList.add("done"),q.innerText=n(this,y)?await K._l10nPromise.get("editor_alt_text_decorative_tooltip"):n(this,S),q.parentNode||D.append(q)},As=function(D){if(!this._isDraggable)return;const q=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let ee,F;q&&(ee={passive:!0,capture:!0},F=x=>{const[N,B]=this.screenToPageTranslation(x.movementX,x.movementY);this._uiManager.dragSelectedEditors(N,B)},window.addEventListener("pointermove",F,ee));const d=()=>{if(window.removeEventListener("pointerup",d),window.removeEventListener("blur",d),q&&window.removeEventListener("pointermove",F,ee),le(this,p,!1),!this._uiManager.endDragSession()){const{isMac:x}=i.FeatureTest.platform;D.ctrlKey&&!x||D.shiftKey||D.metaKey&&x?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",d),window.addEventListener("blur",d)},ne(K,j),Je(K,"_borderLineWidth",-1),Je(K,"_colorManager",new t.ColorManager),Je(K,"_zIndex",1),Je(K,"SMALL_EDITOR_SIZE",0);let o=K;e.AnnotationEditor=o;class w extends o{constructor(D){super(D),this.annotationElementId=D.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(r,e,s)=>{var c,b,_,f,p,Gt,P,g,R,E,C,Rs,v,T,O,se,V,Q,K,ue,D,q,ee,F,d,x,N,B,G,W,Y,ce,me,xe,be,ye,Re,ie,ae,M,H,Z,re,fe,je,Ae,te,js,Wt,Ht,At,Ut,Vt,tt,pt,Ss,_s,qt,mt,Kt;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=a,e.opacityToHex=o;var t=s(1),i=s(6);function a(Ve,U,ge){for(const Ce of ge)U.addEventListener(Ce,Ve[Ce].bind(Ve))}function o(Ve){return Math.round(Math.min(255,Math.max(1,255*Ve))).toString(16).padStart(2,"0")}class w{constructor(){ne(this,c,0)}getId(){return`${t.AnnotationEditorPrefix}${ht(this,c)._++}`}}c=new WeakMap;const k=class k{constructor(){ne(this,p);ne(this,b,(0,t.getUuid)());ne(this,_,0);ne(this,f,null)}static get _isSVGFittingCanvas(){const U='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Ce=new OffscreenCanvas(1,3).getContext("2d"),Ie=new Image;Ie.src=U;const Le=Ie.decode().then(()=>(Ce.drawImage(Ie,0,0,1,1,0,0,1,3),new Uint32Array(Ce.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,t.shadow)(this,"_isSVGFittingCanvas",Le)}async getFromFile(U){const{lastModified:ge,name:Ce,size:Ie,type:Le}=U;return J(this,p,Gt).call(this,`${ge}_${Ce}_${Ie}_${Le}`,U)}async getFromUrl(U){return J(this,p,Gt).call(this,U,U)}async getFromId(U){n(this,f)||le(this,f,new Map);const ge=n(this,f).get(U);return ge?ge.bitmap?(ge.refCounter+=1,ge):ge.file?this.getFromFile(ge.file):this.getFromUrl(ge.url):null}getSvgUrl(U){const ge=n(this,f).get(U);return ge!=null&&ge.isSvg?ge.svgUrl:null}deleteId(U){n(this,f)||le(this,f,new Map);const ge=n(this,f).get(U);ge&&(ge.refCounter-=1,ge.refCounter===0&&(ge.bitmap=null))}isValidId(U){return U.startsWith(`image_${n(this,b)}_`)}};b=new WeakMap,_=new WeakMap,f=new WeakMap,p=new WeakSet,Gt=async function(U,ge){n(this,f)||le(this,f,new Map);let Ce=n(this,f).get(U);if(Ce===null)return null;if(Ce!=null&&Ce.bitmap)return Ce.refCounter+=1,Ce;try{Ce||(Ce={bitmap:null,id:`image_${n(this,b)}_${ht(this,_)._++}`,refCounter:0,isSvg:!1});let Ie;if(typeof ge=="string"){Ce.url=ge;const Le=await fetch(ge);if(!Le.ok)throw new Error(Le.statusText);Ie=await Le.blob()}else Ie=Ce.file=ge;if(Ie.type==="image/svg+xml"){const Le=k._isSVGFittingCanvas,Ne=new FileReader,L=new Image,I=new Promise(($,he)=>{L.onload=()=>{Ce.bitmap=L,Ce.isSvg=!0,$()},Ne.onload=async()=>{const pe=Ce.svgUrl=Ne.result;L.src=await Le?`${pe}#svgView(preserveAspectRatio(none))`:pe},L.onerror=Ne.onerror=he});Ne.readAsDataURL(Ie),await I}else Ce.bitmap=await createImageBitmap(Ie);Ce.refCounter=1}catch(Ie){console.error(Ie),Ce=null}return n(this,f).set(U,Ce),Ce&&n(this,f).set(Ce.id,Ce),Ce};let S=k;class y{constructor(U=128){ne(this,P,[]);ne(this,g,!1);ne(this,R);ne(this,E,-1);le(this,R,U)}add({cmd:U,undo:ge,mustExec:Ce,type:Ie=NaN,overwriteIfSameType:Le=!1,keepUndo:Ne=!1}){if(Ce&&U(),n(this,g))return;const L={cmd:U,undo:ge,type:Ie};if(n(this,E)===-1){n(this,P).length>0&&(n(this,P).length=0),le(this,E,0),n(this,P).push(L);return}if(Le&&n(this,P)[n(this,E)].type===Ie){Ne&&(L.undo=n(this,P)[n(this,E)].undo),n(this,P)[n(this,E)]=L;return}const I=n(this,E)+1;I===n(this,R)?n(this,P).splice(0,1):(le(this,E,I),I<n(this,P).length&&n(this,P).splice(I)),n(this,P).push(L)}undo(){n(this,E)!==-1&&(le(this,g,!0),n(this,P)[n(this,E)].undo(),le(this,g,!1),le(this,E,n(this,E)-1))}redo(){n(this,E)<n(this,P).length-1&&(le(this,E,n(this,E)+1),le(this,g,!0),n(this,P)[n(this,E)].cmd(),le(this,g,!1))}hasSomethingToUndo(){return n(this,E)!==-1}hasSomethingToRedo(){return n(this,E)<n(this,P).length-1}destroy(){le(this,P,null)}}P=new WeakMap,g=new WeakMap,R=new WeakMap,E=new WeakMap,e.CommandManager=y;class u{constructor(U){ne(this,C);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:ge}=t.FeatureTest.platform;for(const[Ce,Ie,Le={}]of U)for(const Ne of Ce){const L=Ne.startsWith("mac+");ge&&L?(this.callbacks.set(Ne.slice(4),{callback:Ie,options:Le}),this.allKeys.add(Ne.split("+").at(-1))):!ge&&!L&&(this.callbacks.set(Ne,{callback:Ie,options:Le}),this.allKeys.add(Ne.split("+").at(-1)))}}exec(U,ge){if(!this.allKeys.has(ge.key))return;const Ce=this.callbacks.get(J(this,C,Rs).call(this,ge));if(!Ce)return;const{callback:Ie,options:{bubbles:Le=!1,args:Ne=[],checker:L=null}}=Ce;L&&!L(U,ge)||(Ie.bind(U,...Ne)(),Le||(ge.stopPropagation(),ge.preventDefault()))}}C=new WeakSet,Rs=function(U){U.altKey&&this.buffer.push("alt"),U.ctrlKey&&this.buffer.push("ctrl"),U.metaKey&&this.buffer.push("meta"),U.shiftKey&&this.buffer.push("shift"),this.buffer.push(U.key);const ge=this.buffer.join("+");return this.buffer.length=0,ge},e.KeyboardManager=u;const z=class z{get _colors(){const U=new Map([["CanvasText",null],["Canvas",null]]);return(0,i.getColorValues)(U),(0,t.shadow)(this,"_colors",U)}convert(U){const ge=(0,i.getRGB)(U);if(!window.matchMedia("(forced-colors: active)").matches)return ge;for(const[Ce,Ie]of this._colors)if(Ie.every((Le,Ne)=>Le===ge[Ne]))return z._colorsMapping.get(Ce);return ge}getHexCode(U){const ge=this._colors.get(U);return ge?t.Util.makeHexColor(...ge):U}};Je(z,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let h=z;e.ColorManager=h;const qe=class qe{constructor(U,ge,Ce,Ie,Le,Ne){ne(this,te);ne(this,v,null);ne(this,T,new Map);ne(this,O,new Map);ne(this,se,null);ne(this,V,null);ne(this,Q,new y);ne(this,K,0);ne(this,ue,new Set);ne(this,D,null);ne(this,q,null);ne(this,ee,new Set);ne(this,F,null);ne(this,d,new w);ne(this,x,!1);ne(this,N,!1);ne(this,B,null);ne(this,G,t.AnnotationEditorType.NONE);ne(this,W,new Set);ne(this,Y,null);ne(this,ce,this.blur.bind(this));ne(this,me,this.focus.bind(this));ne(this,xe,this.copy.bind(this));ne(this,be,this.cut.bind(this));ne(this,ye,this.paste.bind(this));ne(this,Re,this.keydown.bind(this));ne(this,ie,this.onEditingAction.bind(this));ne(this,ae,this.onPageChanging.bind(this));ne(this,M,this.onScaleChanging.bind(this));ne(this,H,this.onRotationChanging.bind(this));ne(this,Z,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});ne(this,re,[0,0]);ne(this,fe,null);ne(this,je,null);ne(this,Ae,null);le(this,je,U),le(this,Ae,ge),le(this,se,Ce),this._eventBus=Ie,this._eventBus._on("editingaction",n(this,ie)),this._eventBus._on("pagechanging",n(this,ae)),this._eventBus._on("scalechanging",n(this,M)),this._eventBus._on("rotationchanging",n(this,H)),le(this,V,Le.annotationStorage),le(this,F,Le.filterFactory),le(this,Y,Ne),this.viewParameters={realScale:i.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const U=qe.prototype,ge=Le=>{const{activeElement:Ne}=document;return Ne&&n(Le,je).contains(Ne)&&Le.hasSomethingToControl()},Ce=this.TRANSLATE_SMALL,Ie=this.TRANSLATE_BIG;return(0,t.shadow)(this,"_keyboardManager",new u([[["ctrl+a","mac+meta+a"],U.selectAll],[["ctrl+z","mac+meta+z"],U.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],U.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],U.delete],[["Escape","mac+Escape"],U.unselectAll],[["ArrowLeft","mac+ArrowLeft"],U.translateSelectedEditors,{args:[-Ce,0],checker:ge}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],U.translateSelectedEditors,{args:[-Ie,0],checker:ge}],[["ArrowRight","mac+ArrowRight"],U.translateSelectedEditors,{args:[Ce,0],checker:ge}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],U.translateSelectedEditors,{args:[Ie,0],checker:ge}],[["ArrowUp","mac+ArrowUp"],U.translateSelectedEditors,{args:[0,-Ce],checker:ge}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],U.translateSelectedEditors,{args:[0,-Ie],checker:ge}],[["ArrowDown","mac+ArrowDown"],U.translateSelectedEditors,{args:[0,Ce],checker:ge}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],U.translateSelectedEditors,{args:[0,Ie],checker:ge}]]))}destroy(){J(this,te,At).call(this),J(this,te,Wt).call(this),this._eventBus._off("editingaction",n(this,ie)),this._eventBus._off("pagechanging",n(this,ae)),this._eventBus._off("scalechanging",n(this,M)),this._eventBus._off("rotationchanging",n(this,H));for(const U of n(this,O).values())U.destroy();n(this,O).clear(),n(this,T).clear(),n(this,ee).clear(),le(this,v,null),n(this,W).clear(),n(this,Q).destroy(),n(this,se).destroy()}get hcmFilter(){return(0,t.shadow)(this,"hcmFilter",n(this,Y)?n(this,F).addHCMFilter(n(this,Y).foreground,n(this,Y).background):"none")}get direction(){return(0,t.shadow)(this,"direction",getComputedStyle(n(this,je)).direction)}editAltText(U){var ge;(ge=n(this,se))==null||ge.editAltText(this,U)}onPageChanging({pageNumber:U}){le(this,K,U-1)}focusMainContainer(){n(this,je).focus()}findParent(U,ge){for(const Ce of n(this,O).values()){const{x:Ie,y:Le,width:Ne,height:L}=Ce.div.getBoundingClientRect();if(U>=Ie&&U<=Ie+Ne&&ge>=Le&&ge<=Le+L)return Ce}return null}disableUserSelect(U=!1){n(this,Ae).classList.toggle("noUserSelect",U)}addShouldRescale(U){n(this,ee).add(U)}removeShouldRescale(U){n(this,ee).delete(U)}onScaleChanging({scale:U}){this.commitOrRemove(),this.viewParameters.realScale=U*i.PixelsPerInch.PDF_TO_CSS_UNITS;for(const ge of n(this,ee))ge.onScaleChanging()}onRotationChanging({pagesRotation:U}){this.commitOrRemove(),this.viewParameters.rotation=U}addToAnnotationStorage(U){!U.isEmpty()&&n(this,V)&&!n(this,V).has(U.id)&&n(this,V).setValue(U.id,U)}blur(){if(!this.hasSelection)return;const{activeElement:U}=document;for(const ge of n(this,W))if(ge.div.contains(U)){le(this,B,[ge,U]),ge._focusEventsAllowed=!1;break}}focus(){if(!n(this,B))return;const[U,ge]=n(this,B);le(this,B,null),ge.addEventListener("focusin",()=>{U._focusEventsAllowed=!0},{once:!0}),ge.focus()}addEditListeners(){J(this,te,Ht).call(this),J(this,te,Ut).call(this)}removeEditListeners(){J(this,te,At).call(this),J(this,te,Vt).call(this)}copy(U){var Ce;if(U.preventDefault(),(Ce=n(this,v))==null||Ce.commitOrRemove(),!this.hasSelection)return;const ge=[];for(const Ie of n(this,W)){const Le=Ie.serialize(!0);Le&&ge.push(Le)}ge.length!==0&&U.clipboardData.setData("application/pdfjs",JSON.stringify(ge))}cut(U){this.copy(U),this.delete()}paste(U){U.preventDefault();const{clipboardData:ge}=U;for(const Le of ge.items)for(const Ne of n(this,q))if(Ne.isHandlingMimeForPasting(Le.type)){Ne.paste(Le,this.currentLayer);return}let Ce=ge.getData("application/pdfjs");if(!Ce)return;try{Ce=JSON.parse(Ce)}catch(Le){(0,t.warn)(`paste: "${Le.message}".`);return}if(!Array.isArray(Ce))return;this.unselectAll();const Ie=this.currentLayer;try{const Le=[];for(const I of Ce){const $=Ie.deserialize(I);if(!$)return;Le.push($)}const Ne=()=>{for(const I of Le)J(this,te,qt).call(this,I);J(this,te,Kt).call(this,Le)},L=()=>{for(const I of Le)I.remove()};this.addCommands({cmd:Ne,undo:L,mustExec:!0})}catch(Le){(0,t.warn)(`paste: "${Le.message}".`)}}keydown(U){var ge;(ge=this.getActive())!=null&&ge.shouldGetKeyboardEvents()||qe._keyboardManager.exec(this,U)}onEditingAction(U){["undo","redo","delete","selectAll"].includes(U.name)&&this[U.name]()}setEditingState(U){U?(J(this,te,js).call(this),J(this,te,Ht).call(this),J(this,te,Ut).call(this),J(this,te,tt).call(this,{isEditing:n(this,G)!==t.AnnotationEditorType.NONE,isEmpty:J(this,te,mt).call(this),hasSomethingToUndo:n(this,Q).hasSomethingToUndo(),hasSomethingToRedo:n(this,Q).hasSomethingToRedo(),hasSelectedEditor:!1})):(J(this,te,Wt).call(this),J(this,te,At).call(this),J(this,te,Vt).call(this),J(this,te,tt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(U){if(!n(this,q)){le(this,q,U);for(const ge of n(this,q))J(this,te,pt).call(this,ge.defaultPropertiesToUpdate)}}getId(){return n(this,d).getId()}get currentLayer(){return n(this,O).get(n(this,K))}getLayer(U){return n(this,O).get(U)}get currentPageIndex(){return n(this,K)}addLayer(U){n(this,O).set(U.pageIndex,U),n(this,x)?U.enable():U.disable()}removeLayer(U){n(this,O).delete(U.pageIndex)}updateMode(U,ge=null){if(n(this,G)!==U){if(le(this,G,U),U===t.AnnotationEditorType.NONE){this.setEditingState(!1),J(this,te,_s).call(this);return}this.setEditingState(!0),J(this,te,Ss).call(this),this.unselectAll();for(const Ce of n(this,O).values())Ce.updateMode(U);if(ge){for(const Ce of n(this,T).values())if(Ce.annotationElementId===ge){this.setSelected(Ce),Ce.enterInEditMode();break}}}}updateToolbar(U){U!==n(this,G)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:U})}updateParams(U,ge){if(n(this,q)){if(U===t.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(U);return}for(const Ce of n(this,W))Ce.updateParams(U,ge);for(const Ce of n(this,q))Ce.updateDefaultParams(U,ge)}}enableWaiting(U=!1){if(n(this,N)!==U){le(this,N,U);for(const ge of n(this,O).values())U?ge.disableClick():ge.enableClick(),ge.div.classList.toggle("waiting",U)}}getEditors(U){const ge=[];for(const Ce of n(this,T).values())Ce.pageIndex===U&&ge.push(Ce);return ge}getEditor(U){return n(this,T).get(U)}addEditor(U){n(this,T).set(U.id,U)}removeEditor(U){var ge;n(this,T).delete(U.id),this.unselect(U),(!U.annotationElementId||!n(this,ue).has(U.annotationElementId))&&((ge=n(this,V))==null||ge.remove(U.id))}addDeletedAnnotationElement(U){n(this,ue).add(U.annotationElementId),U.deleted=!0}isDeletedAnnotationElement(U){return n(this,ue).has(U)}removeDeletedAnnotationElement(U){n(this,ue).delete(U.annotationElementId),U.deleted=!1}setActiveEditor(U){n(this,v)!==U&&(le(this,v,U),U&&J(this,te,pt).call(this,U.propertiesToUpdate))}toggleSelected(U){if(n(this,W).has(U)){n(this,W).delete(U),U.unselect(),J(this,te,tt).call(this,{hasSelectedEditor:this.hasSelection});return}n(this,W).add(U),U.select(),J(this,te,pt).call(this,U.propertiesToUpdate),J(this,te,tt).call(this,{hasSelectedEditor:!0})}setSelected(U){for(const ge of n(this,W))ge!==U&&ge.unselect();n(this,W).clear(),n(this,W).add(U),U.select(),J(this,te,pt).call(this,U.propertiesToUpdate),J(this,te,tt).call(this,{hasSelectedEditor:!0})}isSelected(U){return n(this,W).has(U)}unselect(U){U.unselect(),n(this,W).delete(U),J(this,te,tt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return n(this,W).size!==0}undo(){n(this,Q).undo(),J(this,te,tt).call(this,{hasSomethingToUndo:n(this,Q).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:J(this,te,mt).call(this)})}redo(){n(this,Q).redo(),J(this,te,tt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:n(this,Q).hasSomethingToRedo(),isEmpty:J(this,te,mt).call(this)})}addCommands(U){n(this,Q).add(U),J(this,te,tt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:J(this,te,mt).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const U=[...n(this,W)],ge=()=>{for(const Ie of U)Ie.remove()},Ce=()=>{for(const Ie of U)J(this,te,qt).call(this,Ie)};this.addCommands({cmd:ge,undo:Ce,mustExec:!0})}commitOrRemove(){var U;(U=n(this,v))==null||U.commitOrRemove()}hasSomethingToControl(){return n(this,v)||this.hasSelection}selectAll(){for(const U of n(this,W))U.commit();J(this,te,Kt).call(this,n(this,T).values())}unselectAll(){if(n(this,v)){n(this,v).commitOrRemove();return}if(this.hasSelection){for(const U of n(this,W))U.unselect();n(this,W).clear(),J(this,te,tt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(U,ge,Ce=!1){if(Ce||this.commitOrRemove(),!this.hasSelection)return;n(this,re)[0]+=U,n(this,re)[1]+=ge;const[Ie,Le]=n(this,re),Ne=[...n(this,W)],L=1e3;n(this,fe)&&clearTimeout(n(this,fe)),le(this,fe,setTimeout(()=>{le(this,fe,null),n(this,re)[0]=n(this,re)[1]=0,this.addCommands({cmd:()=>{for(const I of Ne)n(this,T).has(I.id)&&I.translateInPage(Ie,Le)},undo:()=>{for(const I of Ne)n(this,T).has(I.id)&&I.translateInPage(-Ie,-Le)},mustExec:!1})},L));for(const I of Ne)I.translateInPage(U,ge)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),le(this,D,new Map);for(const U of n(this,W))n(this,D).set(U,{savedX:U.x,savedY:U.y,savedPageIndex:U.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!n(this,D))return!1;this.disableUserSelect(!1);const U=n(this,D);le(this,D,null);let ge=!1;for(const[{x:Ie,y:Le,pageIndex:Ne},L]of U)L.newX=Ie,L.newY=Le,L.newPageIndex=Ne,ge||(ge=Ie!==L.savedX||Le!==L.savedY||Ne!==L.savedPageIndex);if(!ge)return!1;const Ce=(Ie,Le,Ne,L)=>{if(n(this,T).has(Ie.id)){const I=n(this,O).get(L);I?Ie._setParentAndPosition(I,Le,Ne):(Ie.pageIndex=L,Ie.x=Le,Ie.y=Ne)}};return this.addCommands({cmd:()=>{for(const[Ie,{newX:Le,newY:Ne,newPageIndex:L}]of U)Ce(Ie,Le,Ne,L)},undo:()=>{for(const[Ie,{savedX:Le,savedY:Ne,savedPageIndex:L}]of U)Ce(Ie,Le,Ne,L)},mustExec:!0}),!0}dragSelectedEditors(U,ge){if(n(this,D))for(const Ce of n(this,D).keys())Ce.drag(U,ge)}rebuild(U){if(U.parent===null){const ge=this.getLayer(U.pageIndex);ge?(ge.changeParent(U),ge.addOrRebuild(U)):(this.addEditor(U),this.addToAnnotationStorage(U),U.rebuild())}else U.parent.addOrRebuild(U)}isActive(U){return n(this,v)===U}getActive(){return n(this,v)}getMode(){return n(this,G)}get imageManager(){return(0,t.shadow)(this,"imageManager",new S)}};v=new WeakMap,T=new WeakMap,O=new WeakMap,se=new WeakMap,V=new WeakMap,Q=new WeakMap,K=new WeakMap,ue=new WeakMap,D=new WeakMap,q=new WeakMap,ee=new WeakMap,F=new WeakMap,d=new WeakMap,x=new WeakMap,N=new WeakMap,B=new WeakMap,G=new WeakMap,W=new WeakMap,Y=new WeakMap,ce=new WeakMap,me=new WeakMap,xe=new WeakMap,be=new WeakMap,ye=new WeakMap,Re=new WeakMap,ie=new WeakMap,ae=new WeakMap,M=new WeakMap,H=new WeakMap,Z=new WeakMap,re=new WeakMap,fe=new WeakMap,je=new WeakMap,Ae=new WeakMap,te=new WeakSet,js=function(){window.addEventListener("focus",n(this,me)),window.addEventListener("blur",n(this,ce))},Wt=function(){window.removeEventListener("focus",n(this,me)),window.removeEventListener("blur",n(this,ce))},Ht=function(){window.addEventListener("keydown",n(this,Re),{capture:!0})},At=function(){window.removeEventListener("keydown",n(this,Re),{capture:!0})},Ut=function(){document.addEventListener("copy",n(this,xe)),document.addEventListener("cut",n(this,be)),document.addEventListener("paste",n(this,ye))},Vt=function(){document.removeEventListener("copy",n(this,xe)),document.removeEventListener("cut",n(this,be)),document.removeEventListener("paste",n(this,ye))},tt=function(U){Object.entries(U).some(([Ce,Ie])=>n(this,Z)[Ce]!==Ie)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(n(this,Z),U)})},pt=function(U){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:U})},Ss=function(){if(!n(this,x)){le(this,x,!0);for(const U of n(this,O).values())U.enable()}},_s=function(){if(this.unselectAll(),n(this,x)){le(this,x,!1);for(const U of n(this,O).values())U.disable()}},qt=function(U){const ge=n(this,O).get(U.pageIndex);ge?ge.addOrRebuild(U):this.addEditor(U)},mt=function(){if(n(this,T).size===0)return!0;if(n(this,T).size===1)for(const U of n(this,T).values())return U.isEmpty();return!1},Kt=function(U){n(this,W).clear();for(const ge of U)ge.isEmpty()||(n(this,W).add(ge),ge.select());J(this,te,tt).call(this,{hasSelectedEditor:!0})},Je(qe,"TRANSLATE_SMALL",1),Je(qe,"TRANSLATE_BIG",10);let l=qe;e.AnnotationEditorUIManager=l},(r,e,s)=>{var K,ue,D,q,ee,F,d,x,N,B,G,W,lt,ct,Xt,Rt,jt,xt,ft;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=E,e.getColorValues=T,e.getCurrentTransform=O,e.getCurrentTransformInverse=se,e.getFilenameFromUrl=p,e.getPdfFilenameFromUrl=A,e.getRGB=v,e.getXfaPageViewport=z,e.isDataScheme=_,e.isPdfFile=f,e.isValidFetchUrl=P,e.loadScript=R,e.noContextMenu=g,e.setLayerDimensions=V;var t=s(7),i=s(1);const a="http://www.w3.org/2000/svg",Q=class Q{};Je(Q,"CSS",96),Je(Q,"PDF",72),Je(Q,"PDF_TO_CSS_UNITS",Q.CSS/Q.PDF);let o=Q;e.PixelsPerInch=o;class w extends t.BaseFilterFactory{constructor({docId:M,ownerDocument:H=globalThis.document}={}){super();ne(this,W);ne(this,K);ne(this,ue);ne(this,D);ne(this,q);ne(this,ee);ne(this,F);ne(this,d);ne(this,x);ne(this,N);ne(this,B);ne(this,G,0);le(this,D,M),le(this,q,H)}addFilter(M){if(!M)return"none";let H=n(this,W,lt).get(M);if(H)return H;let Z,re,fe,je;if(M.length===1){const _e=M[0],We=new Array(256);for(let Be=0;Be<256;Be++)We[Be]=_e[Be]/255;je=Z=re=fe=We.join(",")}else{const[_e,We,Be]=M,Ke=new Array(256),Me=new Array(256),ze=new Array(256);for(let Xe=0;Xe<256;Xe++)Ke[Xe]=_e[Xe]/255,Me[Xe]=We[Xe]/255,ze[Xe]=Be[Xe]/255;Z=Ke.join(","),re=Me.join(","),fe=ze.join(","),je=`${Z}${re}${fe}`}if(H=n(this,W,lt).get(je),H)return n(this,W,lt).set(M,H),H;const Ae=`g_${n(this,D)}_transfer_map_${ht(this,G)._++}`,te=`url(#${Ae})`;n(this,W,lt).set(M,te),n(this,W,lt).set(je,te);const Te=J(this,W,Rt).call(this,Ae);return J(this,W,xt).call(this,Z,re,fe,Te),te}addHCMFilter(M,H){var We;const Z=`${M}-${H}`;if(n(this,F)===Z)return n(this,d);if(le(this,F,Z),le(this,d,"none"),(We=n(this,ee))==null||We.remove(),!M||!H)return n(this,d);const re=J(this,W,ft).call(this,M);M=i.Util.makeHexColor(...re);const fe=J(this,W,ft).call(this,H);if(H=i.Util.makeHexColor(...fe),n(this,W,ct).style.color="",M==="#000000"&&H==="#ffffff"||M===H)return n(this,d);const je=new Array(256);for(let Be=0;Be<=255;Be++){const Ke=Be/255;je[Be]=Ke<=.03928?Ke/12.92:((Ke+.055)/1.055)**2.4}const Ae=je.join(","),te=`g_${n(this,D)}_hcm_filter`,Te=le(this,x,J(this,W,Rt).call(this,te));J(this,W,xt).call(this,Ae,Ae,Ae,Te),J(this,W,Xt).call(this,Te);const _e=(Be,Ke)=>{const Me=re[Be]/255,ze=fe[Be]/255,Xe=new Array(Ke+1);for(let Ye=0;Ye<=Ke;Ye++)Xe[Ye]=Me+Ye/Ke*(ze-Me);return Xe.join(",")};return J(this,W,xt).call(this,_e(0,5),_e(1,5),_e(2,5),Te),le(this,d,`url(#${te})`),n(this,d)}addHighlightHCMFilter(M,H,Z,re){var ze;const fe=`${M}-${H}-${Z}-${re}`;if(n(this,N)===fe)return n(this,B);if(le(this,N,fe),le(this,B,"none"),(ze=n(this,x))==null||ze.remove(),!M||!H)return n(this,B);const[je,Ae]=[M,H].map(J(this,W,ft).bind(this));let te=Math.round(.2126*je[0]+.7152*je[1]+.0722*je[2]),Te=Math.round(.2126*Ae[0]+.7152*Ae[1]+.0722*Ae[2]),[_e,We]=[Z,re].map(J(this,W,ft).bind(this));Te<te&&([te,Te,_e,We]=[Te,te,We,_e]),n(this,W,ct).style.color="";const Be=(Xe,Ye,Ee)=>{const oe=new Array(256),de=(Te-te)/Ee,Pe=Xe/255,qe=(Ye-Xe)/(255*Ee);let Ve=0;for(let U=0;U<=Ee;U++){const ge=Math.round(te+U*de),Ce=Pe+U*qe;for(let Ie=Ve;Ie<=ge;Ie++)oe[Ie]=Ce;Ve=ge+1}for(let U=Ve;U<256;U++)oe[U]=oe[Ve-1];return oe.join(",")},Ke=`g_${n(this,D)}_hcm_highlight_filter`,Me=le(this,x,J(this,W,Rt).call(this,Ke));return J(this,W,Xt).call(this,Me),J(this,W,xt).call(this,Be(_e[0],We[0],5),Be(_e[1],We[1],5),Be(_e[2],We[2],5),Me),le(this,B,`url(#${Ke})`),n(this,B)}destroy(M=!1){M&&(n(this,d)||n(this,B))||(n(this,ue)&&(n(this,ue).parentNode.parentNode.remove(),le(this,ue,null)),n(this,K)&&(n(this,K).clear(),le(this,K,null)),le(this,G,0))}}K=new WeakMap,ue=new WeakMap,D=new WeakMap,q=new WeakMap,ee=new WeakMap,F=new WeakMap,d=new WeakMap,x=new WeakMap,N=new WeakMap,B=new WeakMap,G=new WeakMap,W=new WeakSet,lt=function(){return n(this,K)||le(this,K,new Map)},ct=function(){if(!n(this,ue)){const M=n(this,q).createElement("div"),{style:H}=M;H.visibility="hidden",H.contain="strict",H.width=H.height=0,H.position="absolute",H.top=H.left=0,H.zIndex=-1;const Z=n(this,q).createElementNS(a,"svg");Z.setAttribute("width",0),Z.setAttribute("height",0),le(this,ue,n(this,q).createElementNS(a,"defs")),M.append(Z),Z.append(n(this,ue)),n(this,q).body.append(M)}return n(this,ue)},Xt=function(M){const H=n(this,q).createElementNS(a,"feColorMatrix");H.setAttribute("type","matrix"),H.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),M.append(H)},Rt=function(M){const H=n(this,q).createElementNS(a,"filter");return H.setAttribute("color-interpolation-filters","sRGB"),H.setAttribute("id",M),n(this,W,ct).append(H),H},jt=function(M,H,Z){const re=n(this,q).createElementNS(a,H);re.setAttribute("type","discrete"),re.setAttribute("tableValues",Z),M.append(re)},xt=function(M,H,Z,re){const fe=n(this,q).createElementNS(a,"feComponentTransfer");re.append(fe),J(this,W,jt).call(this,fe,"feFuncR",M),J(this,W,jt).call(this,fe,"feFuncG",H),J(this,W,jt).call(this,fe,"feFuncB",Z)},ft=function(M){return n(this,W,ct).style.color=M,v(getComputedStyle(n(this,W,ct)).getPropertyValue("color"))},e.DOMFilterFactory=w;class S extends t.BaseCanvasFactory{constructor({ownerDocument:ae=globalThis.document}={}){super(),this._document=ae}_createCanvas(ae,M){const H=this._document.createElement("canvas");return H.width=ae,H.height=M,H}}e.DOMCanvasFactory=S;async function y(ie,ae=!1){if(P(ie,document.baseURI)){const M=await fetch(ie);if(!M.ok)throw new Error(M.statusText);return ae?new Uint8Array(await M.arrayBuffer()):(0,i.stringToBytes)(await M.text())}return new Promise((M,H)=>{const Z=new XMLHttpRequest;Z.open("GET",ie,!0),ae&&(Z.responseType="arraybuffer"),Z.onreadystatechange=()=>{if(Z.readyState===XMLHttpRequest.DONE){if(Z.status===200||Z.status===0){let re;if(ae&&Z.response?re=new Uint8Array(Z.response):!ae&&Z.responseText&&(re=(0,i.stringToBytes)(Z.responseText)),re){M(re);return}}H(new Error(Z.statusText))}},Z.send(null)})}class u extends t.BaseCMapReaderFactory{_fetchData(ae,M){return y(ae,this.isCompressed).then(H=>({cMapData:H,compressionType:M}))}}e.DOMCMapReaderFactory=u;class h extends t.BaseStandardFontDataFactory{_fetchData(ae){return y(ae,!0)}}e.DOMStandardFontDataFactory=h;class l extends t.BaseSVGFactory{_createSVG(ae){return document.createElementNS(a,ae)}}e.DOMSVGFactory=l;class c{constructor({viewBox:ae,scale:M,rotation:H,offsetX:Z=0,offsetY:re=0,dontFlip:fe=!1}){this.viewBox=ae,this.scale=M,this.rotation=H,this.offsetX=Z,this.offsetY=re;const je=(ae[2]+ae[0])/2,Ae=(ae[3]+ae[1])/2;let te,Te,_e,We;switch(H%=360,H<0&&(H+=360),H){case 180:te=-1,Te=0,_e=0,We=1;break;case 90:te=0,Te=1,_e=1,We=0;break;case 270:te=0,Te=-1,_e=-1,We=0;break;case 0:te=1,Te=0,_e=0,We=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}fe&&(_e=-_e,We=-We);let Be,Ke,Me,ze;te===0?(Be=Math.abs(Ae-ae[1])*M+Z,Ke=Math.abs(je-ae[0])*M+re,Me=(ae[3]-ae[1])*M,ze=(ae[2]-ae[0])*M):(Be=Math.abs(je-ae[0])*M+Z,Ke=Math.abs(Ae-ae[1])*M+re,Me=(ae[2]-ae[0])*M,ze=(ae[3]-ae[1])*M),this.transform=[te*M,Te*M,_e*M,We*M,Be-te*M*je-_e*M*Ae,Ke-Te*M*je-We*M*Ae],this.width=Me,this.height=ze}get rawDims(){const{viewBox:ae}=this;return(0,i.shadow)(this,"rawDims",{pageWidth:ae[2]-ae[0],pageHeight:ae[3]-ae[1],pageX:ae[0],pageY:ae[1]})}clone({scale:ae=this.scale,rotation:M=this.rotation,offsetX:H=this.offsetX,offsetY:Z=this.offsetY,dontFlip:re=!1}={}){return new c({viewBox:this.viewBox.slice(),scale:ae,rotation:M,offsetX:H,offsetY:Z,dontFlip:re})}convertToViewportPoint(ae,M){return i.Util.applyTransform([ae,M],this.transform)}convertToViewportRectangle(ae){const M=i.Util.applyTransform([ae[0],ae[1]],this.transform),H=i.Util.applyTransform([ae[2],ae[3]],this.transform);return[M[0],M[1],H[0],H[1]]}convertToPdfPoint(ae,M){return i.Util.applyInverseTransform([ae,M],this.transform)}}e.PageViewport=c;class b extends i.BaseException{constructor(ae,M=0){super(ae,"RenderingCancelledException"),this.extraDelay=M}}e.RenderingCancelledException=b;function _(ie){const ae=ie.length;let M=0;for(;M<ae&&ie[M].trim()==="";)M++;return ie.substring(M,M+5).toLowerCase()==="data:"}function f(ie){return typeof ie=="string"&&/\.pdf$/i.test(ie)}function p(ie,ae=!1){return ae||([ie]=ie.split(/[#?]/,1)),ie.substring(ie.lastIndexOf("/")+1)}function A(ie,ae="document.pdf"){if(typeof ie!="string")return ae;if(_(ie))return(0,i.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),ae;const M=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,H=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Z=M.exec(ie);let re=H.exec(Z[1])||H.exec(Z[2])||H.exec(Z[3]);if(re&&(re=re[0],re.includes("%")))try{re=H.exec(decodeURIComponent(re))[0]}catch{}return re||ae}class k{constructor(){Je(this,"started",Object.create(null));Je(this,"times",[])}time(ae){ae in this.started&&(0,i.warn)(`Timer is already running for ${ae}`),this.started[ae]=Date.now()}timeEnd(ae){ae in this.started||(0,i.warn)(`Timer has not been started for ${ae}`),this.times.push({name:ae,start:this.started[ae],end:Date.now()}),delete this.started[ae]}toString(){const ae=[];let M=0;for(const{name:H}of this.times)M=Math.max(H.length,M);for(const{name:H,start:Z,end:re}of this.times)ae.push(`${H.padEnd(M)} ${re-Z}ms
`);return ae.join("")}}e.StatTimer=k;function P(ie,ae){try{const{protocol:M}=ae?new URL(ie,ae):new URL(ie);return M==="http:"||M==="https:"}catch{return!1}}function g(ie){ie.preventDefault()}function R(ie,ae=!1){return new Promise((M,H)=>{const Z=document.createElement("script");Z.src=ie,Z.onload=function(re){ae&&Z.remove(),M(re)},Z.onerror=function(){H(new Error(`Cannot load script at: ${Z.src}`))},(document.head||document.documentElement).append(Z)})}function E(ie){console.log("Deprecated API usage: "+ie)}let C;class j{static toDateObject(ae){if(!ae||typeof ae!="string")return null;C||(C=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const M=C.exec(ae);if(!M)return null;const H=parseInt(M[1],10);let Z=parseInt(M[2],10);Z=Z>=1&&Z<=12?Z-1:0;let re=parseInt(M[3],10);re=re>=1&&re<=31?re:1;let fe=parseInt(M[4],10);fe=fe>=0&&fe<=23?fe:0;let je=parseInt(M[5],10);je=je>=0&&je<=59?je:0;let Ae=parseInt(M[6],10);Ae=Ae>=0&&Ae<=59?Ae:0;const te=M[7]||"Z";let Te=parseInt(M[8],10);Te=Te>=0&&Te<=23?Te:0;let _e=parseInt(M[9],10)||0;return _e=_e>=0&&_e<=59?_e:0,te==="-"?(fe+=Te,je+=_e):te==="+"&&(fe-=Te,je-=_e),new Date(Date.UTC(H,Z,re,fe,je,Ae))}}e.PDFDateString=j;function z(ie,{scale:ae=1,rotation:M=0}){const{width:H,height:Z}=ie.attributes.style,re=[0,0,parseInt(H),parseInt(Z)];return new c({viewBox:re,scale:ae,rotation:M})}function v(ie){if(ie.startsWith("#")){const ae=parseInt(ie.slice(1),16);return[(ae&16711680)>>16,(ae&65280)>>8,ae&255]}return ie.startsWith("rgb(")?ie.slice(4,-1).split(",").map(ae=>parseInt(ae)):ie.startsWith("rgba(")?ie.slice(5,-1).split(",").map(ae=>parseInt(ae)).slice(0,3):((0,i.warn)(`Not a valid color format: "${ie}"`),[0,0,0])}function T(ie){const ae=document.createElement("span");ae.style.visibility="hidden",document.body.append(ae);for(const M of ie.keys()){ae.style.color=M;const H=window.getComputedStyle(ae).color;ie.set(M,v(H))}ae.remove()}function O(ie){const{a:ae,b:M,c:H,d:Z,e:re,f:fe}=ie.getTransform();return[ae,M,H,Z,re,fe]}function se(ie){const{a:ae,b:M,c:H,d:Z,e:re,f:fe}=ie.getTransform().invertSelf();return[ae,M,H,Z,re,fe]}function V(ie,ae,M=!1,H=!0){if(ae instanceof c){const{pageWidth:Z,pageHeight:re}=ae.rawDims,{style:fe}=ie,je=i.FeatureTest.isCSSRoundSupported,Ae=`var(--scale-factor) * ${Z}px`,te=`var(--scale-factor) * ${re}px`,Te=je?`round(${Ae}, 1px)`:`calc(${Ae})`,_e=je?`round(${te}, 1px)`:`calc(${te})`;!M||ae.rotation%180===0?(fe.width=Te,fe.height=_e):(fe.width=_e,fe.height=Te)}H&&ie.setAttribute("data-main-rotation",ae.rotation)}},(r,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var t=s(1);class i{constructor(){this.constructor===i&&(0,t.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(u){return"none"}addHCMFilter(u,h){return"none"}addHighlightHCMFilter(u,h,l,c){return"none"}destroy(u=!1){}}e.BaseFilterFactory=i;class a{constructor(){this.constructor===a&&(0,t.unreachable)("Cannot initialize BaseCanvasFactory.")}create(u,h){if(u<=0||h<=0)throw new Error("Invalid canvas size");const l=this._createCanvas(u,h);return{canvas:l,context:l.getContext("2d")}}reset(u,h,l){if(!u.canvas)throw new Error("Canvas is not specified");if(h<=0||l<=0)throw new Error("Invalid canvas size");u.canvas.width=h,u.canvas.height=l}destroy(u){if(!u.canvas)throw new Error("Canvas is not specified");u.canvas.width=0,u.canvas.height=0,u.canvas=null,u.context=null}_createCanvas(u,h){(0,t.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=a;class o{constructor({baseUrl:u=null,isCompressed:h=!0}){this.constructor===o&&(0,t.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=u,this.isCompressed=h}async fetch({name:u}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!u)throw new Error("CMap name must be specified.");const h=this.baseUrl+u+(this.isCompressed?".bcmap":""),l=this.isCompressed?t.CMapCompressionType.BINARY:t.CMapCompressionType.NONE;return this._fetchData(h,l).catch(c=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${h}`)})}_fetchData(u,h){(0,t.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=o;class w{constructor({baseUrl:u=null}){this.constructor===w&&(0,t.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=u}async fetch({filename:u}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!u)throw new Error("Font filename must be specified.");const h=`${this.baseUrl}${u}`;return this._fetchData(h).catch(l=>{throw new Error(`Unable to load font data at: ${h}`)})}_fetchData(u){(0,t.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=w;class S{constructor(){this.constructor===S&&(0,t.unreachable)("Cannot initialize BaseSVGFactory.")}create(u,h,l=!1){if(u<=0||h<=0)throw new Error("Invalid SVG dimensions");const c=this._createSVG("svg:svg");return c.setAttribute("version","1.1"),l||(c.setAttribute("width",`${u}px`),c.setAttribute("height",`${h}px`)),c.setAttribute("preserveAspectRatio","none"),c.setAttribute("viewBox",`0 0 ${u} ${h}`),c}createElement(u){if(typeof u!="string")throw new Error("Invalid SVG element type");return this._createSVG(u)}_createSVG(u){(0,t.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=S},(r,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var t=s(1);const i=3285377520,a=4294901760,o=65535;class w{constructor(y){this.h1=y?y&4294967295:i,this.h2=y?y&4294967295:i}update(y){let u,h;if(typeof y=="string"){u=new Uint8Array(y.length*2),h=0;for(let E=0,C=y.length;E<C;E++){const j=y.charCodeAt(E);j<=255?u[h++]=j:(u[h++]=j>>>8,u[h++]=j&255)}}else if((0,t.isArrayBuffer)(y))u=y.slice(),h=u.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const l=h>>2,c=h-l*4,b=new Uint32Array(u.buffer,0,l);let _=0,f=0,p=this.h1,A=this.h2;const k=3432918353,P=461845907,g=k&o,R=P&o;for(let E=0;E<l;E++)E&1?(_=b[E],_=_*k&a|_*g&o,_=_<<15|_>>>17,_=_*P&a|_*R&o,p^=_,p=p<<13|p>>>19,p=p*5+3864292196):(f=b[E],f=f*k&a|f*g&o,f=f<<15|f>>>17,f=f*P&a|f*R&o,A^=f,A=A<<13|A>>>19,A=A*5+3864292196);switch(_=0,c){case 3:_^=u[l*4+2]<<16;case 2:_^=u[l*4+1]<<8;case 1:_^=u[l*4],_=_*k&a|_*g&o,_=_<<15|_>>>17,_=_*P&a|_*R&o,l&1?p^=_:A^=_}this.h1=p,this.h2=A}hexdigest(){let y=this.h1,u=this.h2;return y^=u>>>1,y=y*3981806797&a|y*36045&o,u=u*4283543511&a|((u<<16|y>>>16)*2950163797&a)>>>16,y^=u>>>1,y=y*444984403&a|y*60499&o,u=u*3301882366&a|((u<<16|y>>>16)*3120437893&a)>>>16,y^=u>>>1,(y>>>0).toString(16).padStart(8,"0")+(u>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=w},(r,e,s)=>{var o;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var t=s(1);class i{constructor({ownerDocument:S=globalThis.document,styleElement:y=null}){ne(this,o,new Set);this._document=S,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(S){this.nativeFontFaces.add(S),this._document.fonts.add(S)}removeNativeFontFace(S){this.nativeFontFaces.delete(S),this._document.fonts.delete(S)}insertRule(S){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const y=this.styleElement.sheet;y.insertRule(S,y.cssRules.length)}clear(){for(const S of this.nativeFontFaces)this._document.fonts.delete(S);this.nativeFontFaces.clear(),n(this,o).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(S){if(!(!S||n(this,o).has(S.loadedName))){if((0,t.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:y,src:u,style:h}=S,l=new FontFace(y,u,h);this.addNativeFontFace(l);try{await l.load(),n(this,o).add(y)}catch{(0,t.warn)(`Cannot load system font: ${S.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}(0,t.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(S){if(S.attached||S.missingFile&&!S.systemFontInfo)return;if(S.attached=!0,S.systemFontInfo){await this.loadSystemFont(S.systemFontInfo);return}if(this.isFontLoadingAPISupported){const u=S.createNativeFontFace();if(u){this.addNativeFontFace(u);try{await u.loaded}catch(h){throw(0,t.warn)(`Failed to load font '${u.family}': '${h}'.`),S.disableFontFace=!0,h}}return}const y=S.createFontFaceRule();if(y){if(this.insertRule(y),this.isSyncFontLoadingSupported)return;await new Promise(u=>{const h=this._queueLoadingCallback(u);this._prepareFontLoadEvent(S,h)})}}get isFontLoadingAPISupported(){var y;const S=!!((y=this._document)!=null&&y.fonts);return(0,t.shadow)(this,"isFontLoadingAPISupported",S)}get isSyncFontLoadingSupported(){let S=!1;return(t.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(S=!0),(0,t.shadow)(this,"isSyncFontLoadingSupported",S)}_queueLoadingCallback(S){function y(){for((0,t.assert)(!h.done,"completeRequest() cannot be called twice."),h.done=!0;u.length>0&&u[0].done;){const l=u.shift();setTimeout(l.callback,0)}}const{loadingRequests:u}=this,h={done:!1,complete:y,callback:S};return u.push(h),h}get _loadTestFont(){const S=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,t.shadow)(this,"_loadTestFont",S)}_prepareFontLoadEvent(S,y){function u(v,T){return v.charCodeAt(T)<<24|v.charCodeAt(T+1)<<16|v.charCodeAt(T+2)<<8|v.charCodeAt(T+3)&255}function h(v,T,O,se){const V=v.substring(0,T),Q=v.substring(T+O);return V+se+Q}let l,c;const b=this._document.createElement("canvas");b.width=1,b.height=1;const _=b.getContext("2d");let f=0;function p(v,T){if(++f>30){(0,t.warn)("Load test font never loaded."),T();return}if(_.font="30px "+v,_.fillText(".",0,20),_.getImageData(0,0,1,1).data[3]>0){T();return}setTimeout(p.bind(null,v,T))}const A=`lt${Date.now()}${this.loadTestFontId++}`;let k=this._loadTestFont;k=h(k,976,A.length,A);const g=16,R=1482184792;let E=u(k,g);for(l=0,c=A.length-3;l<c;l+=4)E=E-R+u(A,l)|0;l<A.length&&(E=E-R+u(A+"XXX",l)|0),k=h(k,g,4,(0,t.string32)(E));const C=`url(data:font/opentype;base64,${btoa(k)});`,j=`@font-face {font-family:"${A}";src:${C}}`;this.insertRule(j);const z=this._document.createElement("div");z.style.visibility="hidden",z.style.width=z.style.height="10px",z.style.position="absolute",z.style.top=z.style.left="0px";for(const v of[S.loadedName,A]){const T=this._document.createElement("span");T.textContent="Hi",T.style.fontFamily=v,z.append(T)}this._document.body.append(z),p(A,()=>{z.remove(),y.complete()})}}o=new WeakMap,e.FontLoader=i;class a{constructor(S,{isEvalSupported:y=!0,disableFontFace:u=!1,ignoreErrors:h=!1,inspectFont:l=null}){this.compiledGlyphs=Object.create(null);for(const c in S)this[c]=S[c];this.isEvalSupported=y!==!1,this.disableFontFace=u===!0,this.ignoreErrors=h===!0,this._inspectFont=l}createNativeFontFace(){var y;if(!this.data||this.disableFontFace)return null;let S;if(!this.cssFontInfo)S=new FontFace(this.loadedName,this.data,{});else{const u={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(u.style=`oblique ${this.cssFontInfo.italicAngle}deg`),S=new FontFace(this.cssFontInfo.fontFamily,this.data,u)}return(y=this._inspectFont)==null||y.call(this,this),S}createFontFaceRule(){var h;if(!this.data||this.disableFontFace)return null;const S=(0,t.bytesToString)(this.data),y=`url(data:${this.mimetype};base64,${btoa(S)});`;let u;if(!this.cssFontInfo)u=`@font-face {font-family:"${this.loadedName}";src:${y}}`;else{let l=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(l+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),u=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${l}src:${y}}`}return(h=this._inspectFont)==null||h.call(this,this,y),u}getPathGenerator(S,y){if(this.compiledGlyphs[y]!==void 0)return this.compiledGlyphs[y];let u;try{u=S.get(this.loadedName+"_path_"+y)}catch(h){if(!this.ignoreErrors)throw h;return(0,t.warn)(`getPathGenerator - ignoring character: "${h}".`),this.compiledGlyphs[y]=function(l,c){}}if(this.isEvalSupported&&t.FeatureTest.isEvalSupported){const h=[];for(const l of u){const c=l.args!==void 0?l.args.join(","):"";h.push("c.",l.cmd,"(",c,`);
`)}return this.compiledGlyphs[y]=new Function("c","size",h.join(""))}return this.compiledGlyphs[y]=function(h,l){for(const c of u)c.cmd==="scale"&&(c.args=[l,-l]),h[c.cmd].apply(h,c.args)}}}e.FontFaceObject=a},(r,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var t=s(7);s(1);const i=function(y){return new Promise((u,h)=>{require$$5.readFile(y,(c,b)=>{if(c||!b){h(new Error(c));return}u(new Uint8Array(b))})})};class a extends t.BaseFilterFactory{}e.NodeFilterFactory=a;class o extends t.BaseCanvasFactory{_createCanvas(u,h){return require$$5.createCanvas(u,h)}}e.NodeCanvasFactory=o;class w extends t.BaseCMapReaderFactory{_fetchData(u,h){return i(u).then(l=>({cMapData:l,compressionType:h}))}}e.NodeCMapReaderFactory=w;class S extends t.BaseStandardFontDataFactory{_fetchData(u){return i(u)}}e.NodeStandardFontDataFactory=S},(r,e,s)=>{var ue,$t,Yt;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var t=s(1),i=s(6),a=s(12),o=s(13);const w=16,S=100,y=4096,u=15,h=10,l=1e3,c=16;function b(F,d){if(F._removeMirroring)throw new Error("Context is already forwarding operations.");F.__originalSave=F.save,F.__originalRestore=F.restore,F.__originalRotate=F.rotate,F.__originalScale=F.scale,F.__originalTranslate=F.translate,F.__originalTransform=F.transform,F.__originalSetTransform=F.setTransform,F.__originalResetTransform=F.resetTransform,F.__originalClip=F.clip,F.__originalMoveTo=F.moveTo,F.__originalLineTo=F.lineTo,F.__originalBezierCurveTo=F.bezierCurveTo,F.__originalRect=F.rect,F.__originalClosePath=F.closePath,F.__originalBeginPath=F.beginPath,F._removeMirroring=()=>{F.save=F.__originalSave,F.restore=F.__originalRestore,F.rotate=F.__originalRotate,F.scale=F.__originalScale,F.translate=F.__originalTranslate,F.transform=F.__originalTransform,F.setTransform=F.__originalSetTransform,F.resetTransform=F.__originalResetTransform,F.clip=F.__originalClip,F.moveTo=F.__originalMoveTo,F.lineTo=F.__originalLineTo,F.bezierCurveTo=F.__originalBezierCurveTo,F.rect=F.__originalRect,F.closePath=F.__originalClosePath,F.beginPath=F.__originalBeginPath,delete F._removeMirroring},F.save=function(){d.save(),this.__originalSave()},F.restore=function(){d.restore(),this.__originalRestore()},F.translate=function(N,B){d.translate(N,B),this.__originalTranslate(N,B)},F.scale=function(N,B){d.scale(N,B),this.__originalScale(N,B)},F.transform=function(N,B,G,W,Y,ce){d.transform(N,B,G,W,Y,ce),this.__originalTransform(N,B,G,W,Y,ce)},F.setTransform=function(N,B,G,W,Y,ce){d.setTransform(N,B,G,W,Y,ce),this.__originalSetTransform(N,B,G,W,Y,ce)},F.resetTransform=function(){d.resetTransform(),this.__originalResetTransform()},F.rotate=function(N){d.rotate(N),this.__originalRotate(N)},F.clip=function(N){d.clip(N),this.__originalClip(N)},F.moveTo=function(x,N){d.moveTo(x,N),this.__originalMoveTo(x,N)},F.lineTo=function(x,N){d.lineTo(x,N),this.__originalLineTo(x,N)},F.bezierCurveTo=function(x,N,B,G,W,Y){d.bezierCurveTo(x,N,B,G,W,Y),this.__originalBezierCurveTo(x,N,B,G,W,Y)},F.rect=function(x,N,B,G){d.rect(x,N,B,G),this.__originalRect(x,N,B,G)},F.closePath=function(){d.closePath(),this.__originalClosePath()},F.beginPath=function(){d.beginPath(),this.__originalBeginPath()}}class _{constructor(d){this.canvasFactory=d,this.cache=Object.create(null)}getCanvas(d,x,N){let B;return this.cache[d]!==void 0?(B=this.cache[d],this.canvasFactory.reset(B,x,N)):(B=this.canvasFactory.create(x,N),this.cache[d]=B),B}delete(d){delete this.cache[d]}clear(){for(const d in this.cache){const x=this.cache[d];this.canvasFactory.destroy(x),delete this.cache[d]}}}function f(F,d,x,N,B,G,W,Y,ce,me){const[xe,be,ye,Re,ie,ae]=(0,i.getCurrentTransform)(F);if(be===0&&ye===0){const Z=W*xe+ie,re=Math.round(Z),fe=Y*Re+ae,je=Math.round(fe),Ae=(W+ce)*xe+ie,te=Math.abs(Math.round(Ae)-re)||1,Te=(Y+me)*Re+ae,_e=Math.abs(Math.round(Te)-je)||1;return F.setTransform(Math.sign(xe),0,0,Math.sign(Re),re,je),F.drawImage(d,x,N,B,G,0,0,te,_e),F.setTransform(xe,be,ye,Re,ie,ae),[te,_e]}if(xe===0&&Re===0){const Z=Y*ye+ie,re=Math.round(Z),fe=W*be+ae,je=Math.round(fe),Ae=(Y+me)*ye+ie,te=Math.abs(Math.round(Ae)-re)||1,Te=(W+ce)*be+ae,_e=Math.abs(Math.round(Te)-je)||1;return F.setTransform(0,Math.sign(be),Math.sign(ye),0,re,je),F.drawImage(d,x,N,B,G,0,0,_e,te),F.setTransform(xe,be,ye,Re,ie,ae),[_e,te]}F.drawImage(d,x,N,B,G,W,Y,ce,me);const M=Math.hypot(xe,be),H=Math.hypot(ye,Re);return[M*ce,H*me]}function p(F){const{width:d,height:x}=F;if(d>l||x>l)return null;const N=1e3,B=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),G=d+1;let W=new Uint8Array(G*(x+1)),Y,ce,me;const xe=d+7&-8;let be=new Uint8Array(xe*x),ye=0;for(const H of F.data){let Z=128;for(;Z>0;)be[ye++]=H&Z?0:255,Z>>=1}let Re=0;for(ye=0,be[ye]!==0&&(W[0]=1,++Re),ce=1;ce<d;ce++)be[ye]!==be[ye+1]&&(W[ce]=be[ye]?2:1,++Re),ye++;for(be[ye]!==0&&(W[ce]=2,++Re),Y=1;Y<x;Y++){ye=Y*xe,me=Y*G,be[ye-xe]!==be[ye]&&(W[me]=be[ye]?1:8,++Re);let H=(be[ye]?4:0)+(be[ye-xe]?8:0);for(ce=1;ce<d;ce++)H=(H>>2)+(be[ye+1]?4:0)+(be[ye-xe+1]?8:0),B[H]&&(W[me+ce]=B[H],++Re),ye++;if(be[ye-xe]!==be[ye]&&(W[me+ce]=be[ye]?2:4,++Re),Re>N)return null}for(ye=xe*(x-1),me=Y*G,be[ye]!==0&&(W[me]=8,++Re),ce=1;ce<d;ce++)be[ye]!==be[ye+1]&&(W[me+ce]=be[ye]?4:8,++Re),ye++;if(be[ye]!==0&&(W[me+ce]=4,++Re),Re>N)return null;const ie=new Int32Array([0,G,-1,0,-G,0,0,0,1]),ae=new Path2D;for(Y=0;Re&&Y<=x;Y++){let H=Y*G;const Z=H+d;for(;H<Z&&!W[H];)H++;if(H===Z)continue;ae.moveTo(H%G,Y);const re=H;let fe=W[H];do{const je=ie[fe];do H+=je;while(!W[H]);const Ae=W[H];Ae!==5&&Ae!==10?(fe=Ae,W[H]=0):(fe=Ae&51*fe>>4,W[H]&=fe>>2|fe<<2),ae.lineTo(H%G,H/G|0),W[H]||--Re}while(re!==H);--Y}return be=null,W=null,function(H){H.save(),H.scale(1/d,-1/x),H.translate(0,-x),H.fill(ae),H.beginPath(),H.restore()}}class A{constructor(d,x){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=t.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=t.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=t.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,d,x])}clone(){const d=Object.create(this);return d.clipBox=this.clipBox.slice(),d}setCurrentPoint(d,x){this.x=d,this.y=x}updatePathMinMax(d,x,N){[x,N]=t.Util.applyTransform([x,N],d),this.minX=Math.min(this.minX,x),this.minY=Math.min(this.minY,N),this.maxX=Math.max(this.maxX,x),this.maxY=Math.max(this.maxY,N)}updateRectMinMax(d,x){const N=t.Util.applyTransform(x,d),B=t.Util.applyTransform(x.slice(2),d);this.minX=Math.min(this.minX,N[0],B[0]),this.minY=Math.min(this.minY,N[1],B[1]),this.maxX=Math.max(this.maxX,N[0],B[0]),this.maxY=Math.max(this.maxY,N[1],B[1])}updateScalingPathMinMax(d,x){t.Util.scaleMinMax(d,x),this.minX=Math.min(this.minX,x[0]),this.maxX=Math.max(this.maxX,x[1]),this.minY=Math.min(this.minY,x[2]),this.maxY=Math.max(this.maxY,x[3])}updateCurvePathMinMax(d,x,N,B,G,W,Y,ce,me,xe){const be=t.Util.bezierBoundingBox(x,N,B,G,W,Y,ce,me);if(xe){xe[0]=Math.min(xe[0],be[0],be[2]),xe[1]=Math.max(xe[1],be[0],be[2]),xe[2]=Math.min(xe[2],be[1],be[3]),xe[3]=Math.max(xe[3],be[1],be[3]);return}this.updateRectMinMax(d,be)}getPathBoundingBox(d=a.PathType.FILL,x=null){const N=[this.minX,this.minY,this.maxX,this.maxY];if(d===a.PathType.STROKE){x||(0,t.unreachable)("Stroke bounding box must include transform.");const B=t.Util.singularValueDecompose2dScale(x),G=B[0]*this.lineWidth/2,W=B[1]*this.lineWidth/2;N[0]-=G,N[1]-=W,N[2]+=G,N[3]+=W}return N}updateClipFromPath(){const d=t.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(d||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(d){this.clipBox=d,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(d=a.PathType.FILL,x=null){return t.Util.intersect(this.clipBox,this.getPathBoundingBox(d,x))}}function k(F,d){if(typeof ImageData<"u"&&d instanceof ImageData){F.putImageData(d,0,0);return}const x=d.height,N=d.width,B=x%c,G=(x-B)/c,W=B===0?G:G+1,Y=F.createImageData(N,c);let ce=0,me;const xe=d.data,be=Y.data;let ye,Re,ie,ae;if(d.kind===t.ImageKind.GRAYSCALE_1BPP){const M=xe.byteLength,H=new Uint32Array(be.buffer,0,be.byteLength>>2),Z=H.length,re=N+7>>3,fe=4294967295,je=t.FeatureTest.isLittleEndian?4278190080:255;for(ye=0;ye<W;ye++){for(ie=ye<G?c:B,me=0,Re=0;Re<ie;Re++){const Ae=M-ce;let te=0;const Te=Ae>re?N:Ae*8-7,_e=Te&-8;let We=0,Be=0;for(;te<_e;te+=8)Be=xe[ce++],H[me++]=Be&128?fe:je,H[me++]=Be&64?fe:je,H[me++]=Be&32?fe:je,H[me++]=Be&16?fe:je,H[me++]=Be&8?fe:je,H[me++]=Be&4?fe:je,H[me++]=Be&2?fe:je,H[me++]=Be&1?fe:je;for(;te<Te;te++)We===0&&(Be=xe[ce++],We=128),H[me++]=Be&We?fe:je,We>>=1}for(;me<Z;)H[me++]=0;F.putImageData(Y,0,ye*c)}}else if(d.kind===t.ImageKind.RGBA_32BPP){for(Re=0,ae=N*c*4,ye=0;ye<G;ye++)be.set(xe.subarray(ce,ce+ae)),ce+=ae,F.putImageData(Y,0,Re),Re+=c;ye<W&&(ae=N*B*4,be.set(xe.subarray(ce,ce+ae)),F.putImageData(Y,0,Re))}else if(d.kind===t.ImageKind.RGB_24BPP)for(ie=c,ae=N*ie,ye=0;ye<W;ye++){for(ye>=G&&(ie=B,ae=N*ie),me=0,Re=ae;Re--;)be[me++]=xe[ce++],be[me++]=xe[ce++],be[me++]=xe[ce++],be[me++]=255;F.putImageData(Y,0,ye*c)}else throw new Error(`bad image kind: ${d.kind}`)}function P(F,d){if(d.bitmap){F.drawImage(d.bitmap,0,0);return}const x=d.height,N=d.width,B=x%c,G=(x-B)/c,W=B===0?G:G+1,Y=F.createImageData(N,c);let ce=0;const me=d.data,xe=Y.data;for(let be=0;be<W;be++){const ye=be<G?c:B;({srcPos:ce}=(0,o.convertBlackAndWhiteToRGBA)({src:me,srcPos:ce,dest:xe,width:N,height:ye,nonBlackColor:0})),F.putImageData(Y,0,be*c)}}function g(F,d){const x=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const N of x)F[N]!==void 0&&(d[N]=F[N]);F.setLineDash!==void 0&&(d.setLineDash(F.getLineDash()),d.lineDashOffset=F.lineDashOffset)}function R(F){if(F.strokeStyle=F.fillStyle="#000000",F.fillRule="nonzero",F.globalAlpha=1,F.lineWidth=1,F.lineCap="butt",F.lineJoin="miter",F.miterLimit=10,F.globalCompositeOperation="source-over",F.font="10px sans-serif",F.setLineDash!==void 0&&(F.setLineDash([]),F.lineDashOffset=0),!t.isNodeJS){const{filter:d}=F;d!=="none"&&d!==""&&(F.filter="none")}}function E(F,d,x,N){const B=F.length;for(let G=3;G<B;G+=4){const W=F[G];if(W===0)F[G-3]=d,F[G-2]=x,F[G-1]=N;else if(W<255){const Y=255-W;F[G-3]=F[G-3]*W+d*Y>>8,F[G-2]=F[G-2]*W+x*Y>>8,F[G-1]=F[G-1]*W+N*Y>>8}}}function C(F,d,x){const N=F.length,B=1/255;for(let G=3;G<N;G+=4){const W=x?x[F[G]]:F[G];d[G]=d[G]*W*B|0}}function j(F,d,x){const N=F.length;for(let B=3;B<N;B+=4){const G=F[B-3]*77+F[B-2]*152+F[B-1]*28;d[B]=x?d[B]*x[G>>8]>>8:d[B]*G>>16}}function z(F,d,x,N,B,G,W,Y,ce,me,xe){const be=!!G,ye=be?G[0]:0,Re=be?G[1]:0,ie=be?G[2]:0,ae=B==="Luminosity"?j:C,H=Math.min(N,Math.ceil(1048576/x));for(let Z=0;Z<N;Z+=H){const re=Math.min(H,N-Z),fe=F.getImageData(Y-me,Z+(ce-xe),x,re),je=d.getImageData(Y,Z+ce,x,re);be&&E(fe.data,ye,Re,ie),ae(fe.data,je.data,W),d.putImageData(je,Y,Z+ce)}}function v(F,d,x,N){const B=N[0],G=N[1],W=N[2]-B,Y=N[3]-G;W===0||Y===0||(z(d.context,x,W,Y,d.subtype,d.backdrop,d.transferMap,B,G,d.offsetX,d.offsetY),F.save(),F.globalAlpha=1,F.globalCompositeOperation="source-over",F.setTransform(1,0,0,1,0,0),F.drawImage(x.canvas,0,0),F.restore())}function T(F,d){const x=t.Util.singularValueDecompose2dScale(F);x[0]=Math.fround(x[0]),x[1]=Math.fround(x[1]);const N=Math.fround((globalThis.devicePixelRatio||1)*i.PixelsPerInch.PDF_TO_CSS_UNITS);return d!==void 0?d:x[0]<=N||x[1]<=N}const O=["butt","round","square"],se=["miter","round","bevel"],V={},Q={},ee=class ee{constructor(d,x,N,B,G,{optionalContentConfig:W,markedContentStack:Y=null},ce,me){ne(this,ue);this.ctx=d,this.current=new A(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=x,this.objs=N,this.canvasFactory=B,this.filterFactory=G,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Y||[],this.optionalContentConfig=W,this.cachedCanvases=new _(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=ce,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=me,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(d,x=null){return typeof d=="string"?d.startsWith("g_")?this.commonObjs.get(d):this.objs.get(d):x}beginDrawing({transform:d,viewport:x,transparency:N=!1,background:B=null}){const G=this.ctx.canvas.width,W=this.ctx.canvas.height,Y=this.ctx.fillStyle;if(this.ctx.fillStyle=B||"#ffffff",this.ctx.fillRect(0,0,G,W),this.ctx.fillStyle=Y,N){const ce=this.cachedCanvases.getCanvas("transparent",G,W);this.compositeCtx=this.ctx,this.transparentCanvas=ce.canvas,this.ctx=ce.context,this.ctx.save(),this.ctx.transform(...(0,i.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),R(this.ctx),d&&(this.ctx.transform(...d),this.outputScaleX=d[0],this.outputScaleY=d[0]),this.ctx.transform(...x.transform),this.viewportScale=x.scale,this.baseTransform=(0,i.getCurrentTransform)(this.ctx)}executeOperatorList(d,x,N,B){const G=d.argsArray,W=d.fnArray;let Y=x||0;const ce=G.length;if(ce===Y)return Y;const me=ce-Y>h&&typeof N=="function",xe=me?Date.now()+u:0;let be=0;const ye=this.commonObjs,Re=this.objs;let ie;for(;;){if(B!==void 0&&Y===B.nextBreakPoint)return B.breakIt(Y,N),Y;if(ie=W[Y],ie!==t.OPS.dependency)this[ie].apply(this,G[Y]);else for(const ae of G[Y]){const M=ae.startsWith("g_")?ye:Re;if(!M.has(ae))return M.get(ae,N),Y}if(Y++,Y===ce)return Y;if(me&&++be>h){if(Date.now()>xe)return N(),Y;be=0}}}endDrawing(){J(this,ue,$t).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const d of this._cachedBitmapsMap.values()){for(const x of d.values())typeof HTMLCanvasElement<"u"&&x instanceof HTMLCanvasElement&&(x.width=x.height=0);d.clear()}this._cachedBitmapsMap.clear(),J(this,ue,Yt).call(this)}_scaleImage(d,x){const N=d.width,B=d.height;let G=Math.max(Math.hypot(x[0],x[1]),1),W=Math.max(Math.hypot(x[2],x[3]),1),Y=N,ce=B,me="prescale1",xe,be;for(;G>2&&Y>1||W>2&&ce>1;){let ye=Y,Re=ce;G>2&&Y>1&&(ye=Y>=16384?Math.floor(Y/2)-1||1:Math.ceil(Y/2),G/=Y/ye),W>2&&ce>1&&(Re=ce>=16384?Math.floor(ce/2)-1||1:Math.ceil(ce)/2,W/=ce/Re),xe=this.cachedCanvases.getCanvas(me,ye,Re),be=xe.context,be.clearRect(0,0,ye,Re),be.drawImage(d,0,0,Y,ce,0,0,ye,Re),d=xe.canvas,Y=ye,ce=Re,me=me==="prescale1"?"prescale2":"prescale1"}return{img:d,paintWidth:Y,paintHeight:ce}}_createMaskCanvas(d){const x=this.ctx,{width:N,height:B}=d,G=this.current.fillColor,W=this.current.patternFill,Y=(0,i.getCurrentTransform)(x);let ce,me,xe,be;if((d.bitmap||d.data)&&d.count>1){const te=d.bitmap||d.data.buffer;me=JSON.stringify(W?Y:[Y.slice(0,4),G]),ce=this._cachedBitmapsMap.get(te),ce||(ce=new Map,this._cachedBitmapsMap.set(te,ce));const Te=ce.get(me);if(Te&&!W){const _e=Math.round(Math.min(Y[0],Y[2])+Y[4]),We=Math.round(Math.min(Y[1],Y[3])+Y[5]);return{canvas:Te,offsetX:_e,offsetY:We}}xe=Te}xe||(be=this.cachedCanvases.getCanvas("maskCanvas",N,B),P(be.context,d));let ye=t.Util.transform(Y,[1/N,0,0,-1/B,0,0]);ye=t.Util.transform(ye,[1,0,0,1,0,-B]);const Re=t.Util.applyTransform([0,0],ye),ie=t.Util.applyTransform([N,B],ye),ae=t.Util.normalizeRect([Re[0],Re[1],ie[0],ie[1]]),M=Math.round(ae[2]-ae[0])||1,H=Math.round(ae[3]-ae[1])||1,Z=this.cachedCanvases.getCanvas("fillCanvas",M,H),re=Z.context,fe=Math.min(Re[0],ie[0]),je=Math.min(Re[1],ie[1]);re.translate(-fe,-je),re.transform(...ye),xe||(xe=this._scaleImage(be.canvas,(0,i.getCurrentTransformInverse)(re)),xe=xe.img,ce&&W&&ce.set(me,xe)),re.imageSmoothingEnabled=T((0,i.getCurrentTransform)(re),d.interpolate),f(re,xe,0,0,xe.width,xe.height,0,0,N,B),re.globalCompositeOperation="source-in";const Ae=t.Util.transform((0,i.getCurrentTransformInverse)(re),[1,0,0,1,-fe,-je]);return re.fillStyle=W?G.getPattern(x,this,Ae,a.PathType.FILL):G,re.fillRect(0,0,N,B),ce&&!W&&(this.cachedCanvases.delete("fillCanvas"),ce.set(me,Z.canvas)),{canvas:Z.canvas,offsetX:Math.round(fe),offsetY:Math.round(je)}}setLineWidth(d){d!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=d,this.ctx.lineWidth=d}setLineCap(d){this.ctx.lineCap=O[d]}setLineJoin(d){this.ctx.lineJoin=se[d]}setMiterLimit(d){this.ctx.miterLimit=d}setDash(d,x){const N=this.ctx;N.setLineDash!==void 0&&(N.setLineDash(d),N.lineDashOffset=x)}setRenderingIntent(d){}setFlatness(d){}setGState(d){for(const[x,N]of d)switch(x){case"LW":this.setLineWidth(N);break;case"LC":this.setLineCap(N);break;case"LJ":this.setLineJoin(N);break;case"ML":this.setMiterLimit(N);break;case"D":this.setDash(N[0],N[1]);break;case"RI":this.setRenderingIntent(N);break;case"FL":this.setFlatness(N);break;case"Font":this.setFont(N[0],N[1]);break;case"CA":this.current.strokeAlpha=N;break;case"ca":this.current.fillAlpha=N,this.ctx.globalAlpha=N;break;case"BM":this.ctx.globalCompositeOperation=N;break;case"SMask":this.current.activeSMask=N?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(N);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const d=this.inSMaskMode;this.current.activeSMask&&!d?this.beginSMaskMode():!this.current.activeSMask&&d&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const d=this.ctx.canvas.width,x=this.ctx.canvas.height,N="smaskGroupAt"+this.groupLevel,B=this.cachedCanvases.getCanvas(N,d,x);this.suspendedCtx=this.ctx,this.ctx=B.context;const G=this.ctx;G.setTransform(...(0,i.getCurrentTransform)(this.suspendedCtx)),g(this.suspendedCtx,G),b(G,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),g(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(d){if(!this.current.activeSMask)return;d?(d[0]=Math.floor(d[0]),d[1]=Math.floor(d[1]),d[2]=Math.ceil(d[2]),d[3]=Math.ceil(d[3])):d=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const x=this.current.activeSMask,N=this.suspendedCtx;v(N,x,this.ctx,d),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(g(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const d=this.current;this.stateStack.push(d),this.current=d.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),g(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(d,x,N,B,G,W){this.ctx.transform(d,x,N,B,G,W),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(d,x,N){const B=this.ctx,G=this.current;let W=G.x,Y=G.y,ce,me;const xe=(0,i.getCurrentTransform)(B),be=xe[0]===0&&xe[3]===0||xe[1]===0&&xe[2]===0,ye=be?N.slice(0):null;for(let Re=0,ie=0,ae=d.length;Re<ae;Re++)switch(d[Re]|0){case t.OPS.rectangle:W=x[ie++],Y=x[ie++];const M=x[ie++],H=x[ie++],Z=W+M,re=Y+H;B.moveTo(W,Y),M===0||H===0?B.lineTo(Z,re):(B.lineTo(Z,Y),B.lineTo(Z,re),B.lineTo(W,re)),be||G.updateRectMinMax(xe,[W,Y,Z,re]),B.closePath();break;case t.OPS.moveTo:W=x[ie++],Y=x[ie++],B.moveTo(W,Y),be||G.updatePathMinMax(xe,W,Y);break;case t.OPS.lineTo:W=x[ie++],Y=x[ie++],B.lineTo(W,Y),be||G.updatePathMinMax(xe,W,Y);break;case t.OPS.curveTo:ce=W,me=Y,W=x[ie+4],Y=x[ie+5],B.bezierCurveTo(x[ie],x[ie+1],x[ie+2],x[ie+3],W,Y),G.updateCurvePathMinMax(xe,ce,me,x[ie],x[ie+1],x[ie+2],x[ie+3],W,Y,ye),ie+=6;break;case t.OPS.curveTo2:ce=W,me=Y,B.bezierCurveTo(W,Y,x[ie],x[ie+1],x[ie+2],x[ie+3]),G.updateCurvePathMinMax(xe,ce,me,W,Y,x[ie],x[ie+1],x[ie+2],x[ie+3],ye),W=x[ie+2],Y=x[ie+3],ie+=4;break;case t.OPS.curveTo3:ce=W,me=Y,W=x[ie+2],Y=x[ie+3],B.bezierCurveTo(x[ie],x[ie+1],W,Y,W,Y),G.updateCurvePathMinMax(xe,ce,me,x[ie],x[ie+1],W,Y,W,Y,ye),ie+=4;break;case t.OPS.closePath:B.closePath();break}be&&G.updateScalingPathMinMax(xe,ye),G.setCurrentPoint(W,Y)}closePath(){this.ctx.closePath()}stroke(d=!0){const x=this.ctx,N=this.current.strokeColor;x.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof N=="object"&&(N!=null&&N.getPattern)?(x.save(),x.strokeStyle=N.getPattern(x,this,(0,i.getCurrentTransformInverse)(x),a.PathType.STROKE),this.rescaleAndStroke(!1),x.restore()):this.rescaleAndStroke(!0)),d&&this.consumePath(this.current.getClippedPathBoundingBox()),x.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(d=!0){const x=this.ctx,N=this.current.fillColor,B=this.current.patternFill;let G=!1;B&&(x.save(),x.fillStyle=N.getPattern(x,this,(0,i.getCurrentTransformInverse)(x),a.PathType.FILL),G=!0);const W=this.current.getClippedPathBoundingBox();this.contentVisible&&W!==null&&(this.pendingEOFill?(x.fill("evenodd"),this.pendingEOFill=!1):x.fill()),G&&x.restore(),d&&this.consumePath(W)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=V}eoClip(){this.pendingClip=Q}beginText(){this.current.textMatrix=t.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const d=this.pendingTextPaths,x=this.ctx;if(d===void 0){x.beginPath();return}x.save(),x.beginPath();for(const N of d)x.setTransform(...N.transform),x.translate(N.x,N.y),N.addToPath(x,N.fontSize);x.restore(),x.clip(),x.beginPath(),delete this.pendingTextPaths}setCharSpacing(d){this.current.charSpacing=d}setWordSpacing(d){this.current.wordSpacing=d}setHScale(d){this.current.textHScale=d/100}setLeading(d){this.current.leading=-d}setFont(d,x){var xe;const N=this.commonObjs.get(d),B=this.current;if(!N)throw new Error(`Can't find font for ${d}`);if(B.fontMatrix=N.fontMatrix||t.FONT_IDENTITY_MATRIX,(B.fontMatrix[0]===0||B.fontMatrix[3]===0)&&(0,t.warn)("Invalid font matrix for font "+d),x<0?(x=-x,B.fontDirection=-1):B.fontDirection=1,this.current.font=N,this.current.fontSize=x,N.isType3Font)return;const G=N.loadedName||"sans-serif",W=((xe=N.systemFontInfo)==null?void 0:xe.css)||`"${G}", ${N.fallbackName}`;let Y="normal";N.black?Y="900":N.bold&&(Y="bold");const ce=N.italic?"italic":"normal";let me=x;x<w?me=w:x>S&&(me=S),this.current.fontSizeScale=x/me,this.ctx.font=`${ce} ${Y} ${me}px ${W}`}setTextRenderingMode(d){this.current.textRenderingMode=d}setTextRise(d){this.current.textRise=d}moveText(d,x){this.current.x=this.current.lineX+=d,this.current.y=this.current.lineY+=x}setLeadingMoveText(d,x){this.setLeading(-x),this.moveText(d,x)}setTextMatrix(d,x,N,B,G,W){this.current.textMatrix=[d,x,N,B,G,W],this.current.textMatrixScale=Math.hypot(d,x),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(d,x,N,B){const G=this.ctx,W=this.current,Y=W.font,ce=W.textRenderingMode,me=W.fontSize/W.fontSizeScale,xe=ce&t.TextRenderingMode.FILL_STROKE_MASK,be=!!(ce&t.TextRenderingMode.ADD_TO_PATH_FLAG),ye=W.patternFill&&!Y.missingFile;let Re;(Y.disableFontFace||be||ye)&&(Re=Y.getPathGenerator(this.commonObjs,d)),Y.disableFontFace||ye?(G.save(),G.translate(x,N),G.beginPath(),Re(G,me),B&&G.setTransform(...B),(xe===t.TextRenderingMode.FILL||xe===t.TextRenderingMode.FILL_STROKE)&&G.fill(),(xe===t.TextRenderingMode.STROKE||xe===t.TextRenderingMode.FILL_STROKE)&&G.stroke(),G.restore()):((xe===t.TextRenderingMode.FILL||xe===t.TextRenderingMode.FILL_STROKE)&&G.fillText(d,x,N),(xe===t.TextRenderingMode.STROKE||xe===t.TextRenderingMode.FILL_STROKE)&&G.strokeText(d,x,N)),be&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,i.getCurrentTransform)(G),x,y:N,fontSize:me,addToPath:Re})}get isFontSubpixelAAEnabled(){const{context:d}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);d.scale(1.5,1),d.fillText("I",0,10);const x=d.getImageData(0,0,10,10).data;let N=!1;for(let B=3;B<x.length;B+=4)if(x[B]>0&&x[B]<255){N=!0;break}return(0,t.shadow)(this,"isFontSubpixelAAEnabled",N)}showText(d){const x=this.current,N=x.font;if(N.isType3Font)return this.showType3Text(d);const B=x.fontSize;if(B===0)return;const G=this.ctx,W=x.fontSizeScale,Y=x.charSpacing,ce=x.wordSpacing,me=x.fontDirection,xe=x.textHScale*me,be=d.length,ye=N.vertical,Re=ye?1:-1,ie=N.defaultVMetrics,ae=B*x.fontMatrix[0],M=x.textRenderingMode===t.TextRenderingMode.FILL&&!N.disableFontFace&&!x.patternFill;G.save(),G.transform(...x.textMatrix),G.translate(x.x,x.y+x.textRise),me>0?G.scale(xe,-1):G.scale(xe,1);let H;if(x.patternFill){G.save();const Ae=x.fillColor.getPattern(G,this,(0,i.getCurrentTransformInverse)(G),a.PathType.FILL);H=(0,i.getCurrentTransform)(G),G.restore(),G.fillStyle=Ae}let Z=x.lineWidth;const re=x.textMatrixScale;if(re===0||Z===0){const Ae=x.textRenderingMode&t.TextRenderingMode.FILL_STROKE_MASK;(Ae===t.TextRenderingMode.STROKE||Ae===t.TextRenderingMode.FILL_STROKE)&&(Z=this.getSinglePixelWidth())}else Z/=re;if(W!==1&&(G.scale(W,W),Z/=W),G.lineWidth=Z,N.isInvalidPDFjsFont){const Ae=[];let te=0;for(const Te of d)Ae.push(Te.unicode),te+=Te.width;G.fillText(Ae.join(""),0,0),x.x+=te*ae*xe,G.restore(),this.compose();return}let fe=0,je;for(je=0;je<be;++je){const Ae=d[je];if(typeof Ae=="number"){fe+=Re*Ae*B/1e3;continue}let te=!1;const Te=(Ae.isSpace?ce:0)+Y,_e=Ae.fontChar,We=Ae.accent;let Be,Ke,Me=Ae.width;if(ye){const Xe=Ae.vmetric||ie,Ye=-(Ae.vmetric?Xe[1]:Me*.5)*ae,Ee=Xe[2]*ae;Me=Xe?-Xe[0]:Me,Be=Ye/W,Ke=(fe+Ee)/W}else Be=fe/W,Ke=0;if(N.remeasure&&Me>0){const Xe=G.measureText(_e).width*1e3/B*W;if(Me<Xe&&this.isFontSubpixelAAEnabled){const Ye=Me/Xe;te=!0,G.save(),G.scale(Ye,1),Be/=Ye}else Me!==Xe&&(Be+=(Me-Xe)/2e3*B/W)}if(this.contentVisible&&(Ae.isInFont||N.missingFile)){if(M&&!We)G.fillText(_e,Be,Ke);else if(this.paintChar(_e,Be,Ke,H),We){const Xe=Be+B*We.offset.x/W,Ye=Ke-B*We.offset.y/W;this.paintChar(We.fontChar,Xe,Ye,H)}}const ze=ye?Me*ae-Te*me:Me*ae+Te*me;fe+=ze,te&&G.restore()}ye?x.y-=fe:x.x+=fe*xe,G.restore(),this.compose()}showType3Text(d){const x=this.ctx,N=this.current,B=N.font,G=N.fontSize,W=N.fontDirection,Y=B.vertical?1:-1,ce=N.charSpacing,me=N.wordSpacing,xe=N.textHScale*W,be=N.fontMatrix||t.FONT_IDENTITY_MATRIX,ye=d.length,Re=N.textRenderingMode===t.TextRenderingMode.INVISIBLE;let ie,ae,M,H;if(!(Re||G===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,x.save(),x.transform(...N.textMatrix),x.translate(N.x,N.y),x.scale(xe,W),ie=0;ie<ye;++ie){if(ae=d[ie],typeof ae=="number"){H=Y*ae*G/1e3,this.ctx.translate(H,0),N.x+=H*xe;continue}const Z=(ae.isSpace?me:0)+ce,re=B.charProcOperatorList[ae.operatorListId];if(!re){(0,t.warn)(`Type3 character "${ae.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=ae,this.save(),x.scale(G,G),x.transform(...be),this.executeOperatorList(re),this.restore()),M=t.Util.applyTransform([ae.width,0],be)[0]*G+Z,x.translate(M,0),N.x+=M*xe}x.restore(),this.processingType3=null}}setCharWidth(d,x){}setCharWidthAndBounds(d,x,N,B,G,W){this.ctx.rect(N,B,G-N,W-B),this.ctx.clip(),this.endPath()}getColorN_Pattern(d){let x;if(d[0]==="TilingPattern"){const N=d[1],B=this.baseTransform||(0,i.getCurrentTransform)(this.ctx),G={createCanvasGraphics:W=>new ee(W,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};x=new a.TilingPattern(d,N,this.ctx,G,B)}else x=this._getPattern(d[1],d[2]);return x}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(d,x,N){const B=t.Util.makeHexColor(d,x,N);this.ctx.strokeStyle=B,this.current.strokeColor=B}setFillRGBColor(d,x,N){const B=t.Util.makeHexColor(d,x,N);this.ctx.fillStyle=B,this.current.fillColor=B,this.current.patternFill=!1}_getPattern(d,x=null){let N;return this.cachedPatterns.has(d)?N=this.cachedPatterns.get(d):(N=(0,a.getShadingPattern)(this.getObject(d)),this.cachedPatterns.set(d,N)),x&&(N.matrix=x),N}shadingFill(d){if(!this.contentVisible)return;const x=this.ctx;this.save();const N=this._getPattern(d);x.fillStyle=N.getPattern(x,this,(0,i.getCurrentTransformInverse)(x),a.PathType.SHADING);const B=(0,i.getCurrentTransformInverse)(x);if(B){const{width:G,height:W}=x.canvas,[Y,ce,me,xe]=t.Util.getAxialAlignedBoundingBox([0,0,G,W],B);this.ctx.fillRect(Y,ce,me-Y,xe-ce)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,t.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,t.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(d,x){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(d)&&d.length===6&&this.transform(...d),this.baseTransform=(0,i.getCurrentTransform)(this.ctx),x)){const N=x[2]-x[0],B=x[3]-x[1];this.ctx.rect(x[0],x[1],N,B),this.current.updateRectMinMax((0,i.getCurrentTransform)(this.ctx),x),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(d){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const x=this.ctx;d.isolated||(0,t.info)("TODO: Support non-isolated groups."),d.knockout&&(0,t.warn)("Knockout groups not supported.");const N=(0,i.getCurrentTransform)(x);if(d.matrix&&x.transform(...d.matrix),!d.bbox)throw new Error("Bounding box is required.");let B=t.Util.getAxialAlignedBoundingBox(d.bbox,(0,i.getCurrentTransform)(x));const G=[0,0,x.canvas.width,x.canvas.height];B=t.Util.intersect(B,G)||[0,0,0,0];const W=Math.floor(B[0]),Y=Math.floor(B[1]);let ce=Math.max(Math.ceil(B[2])-W,1),me=Math.max(Math.ceil(B[3])-Y,1),xe=1,be=1;ce>y&&(xe=ce/y,ce=y),me>y&&(be=me/y,me=y),this.current.startNewPathAndClipBox([0,0,ce,me]);let ye="groupAt"+this.groupLevel;d.smask&&(ye+="_smask_"+this.smaskCounter++%2);const Re=this.cachedCanvases.getCanvas(ye,ce,me),ie=Re.context;ie.scale(1/xe,1/be),ie.translate(-W,-Y),ie.transform(...N),d.smask?this.smaskStack.push({canvas:Re.canvas,context:ie,offsetX:W,offsetY:Y,scaleX:xe,scaleY:be,subtype:d.smask.subtype,backdrop:d.smask.backdrop,transferMap:d.smask.transferMap||null,startTransformInverse:null}):(x.setTransform(1,0,0,1,0,0),x.translate(W,Y),x.scale(xe,be),x.save()),g(x,ie),this.ctx=ie,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(x),this.groupLevel++}endGroup(d){if(!this.contentVisible)return;this.groupLevel--;const x=this.ctx,N=this.groupStack.pop();if(this.ctx=N,this.ctx.imageSmoothingEnabled=!1,d.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const B=(0,i.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...B);const G=t.Util.getAxialAlignedBoundingBox([0,0,x.canvas.width,x.canvas.height],B);this.ctx.drawImage(x.canvas,0,0),this.ctx.restore(),this.compose(G)}}beginAnnotation(d,x,N,B,G){if(J(this,ue,$t).call(this),R(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(x)&&x.length===4){const W=x[2]-x[0],Y=x[3]-x[1];if(G&&this.annotationCanvasMap){N=N.slice(),N[4]-=x[0],N[5]-=x[1],x=x.slice(),x[0]=x[1]=0,x[2]=W,x[3]=Y;const[ce,me]=t.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(this.ctx)),{viewportScale:xe}=this,be=Math.ceil(W*this.outputScaleX*xe),ye=Math.ceil(Y*this.outputScaleY*xe);this.annotationCanvas=this.canvasFactory.create(be,ye);const{canvas:Re,context:ie}=this.annotationCanvas;this.annotationCanvasMap.set(d,Re),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ie,this.ctx.save(),this.ctx.setTransform(ce,0,0,-me,0,Y*me),R(this.ctx)}else R(this.ctx),this.ctx.rect(x[0],x[1],W,Y),this.ctx.clip(),this.endPath()}this.current=new A(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...N),this.transform(...B)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),J(this,ue,Yt).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(d){if(!this.contentVisible)return;const x=d.count;d=this.getObject(d.data,d),d.count=x;const N=this.ctx,B=this.processingType3;if(B&&(B.compiled===void 0&&(B.compiled=p(d)),B.compiled)){B.compiled(N);return}const G=this._createMaskCanvas(d),W=G.canvas;N.save(),N.setTransform(1,0,0,1,0,0),N.drawImage(W,G.offsetX,G.offsetY),N.restore(),this.compose()}paintImageMaskXObjectRepeat(d,x,N=0,B=0,G,W){if(!this.contentVisible)return;d=this.getObject(d.data,d);const Y=this.ctx;Y.save();const ce=(0,i.getCurrentTransform)(Y);Y.transform(x,N,B,G,0,0);const me=this._createMaskCanvas(d);Y.setTransform(1,0,0,1,me.offsetX-ce[4],me.offsetY-ce[5]);for(let xe=0,be=W.length;xe<be;xe+=2){const ye=t.Util.transform(ce,[x,N,B,G,W[xe],W[xe+1]]),[Re,ie]=t.Util.applyTransform([0,0],ye);Y.drawImage(me.canvas,Re,ie)}Y.restore(),this.compose()}paintImageMaskXObjectGroup(d){if(!this.contentVisible)return;const x=this.ctx,N=this.current.fillColor,B=this.current.patternFill;for(const G of d){const{data:W,width:Y,height:ce,transform:me}=G,xe=this.cachedCanvases.getCanvas("maskCanvas",Y,ce),be=xe.context;be.save();const ye=this.getObject(W,G);P(be,ye),be.globalCompositeOperation="source-in",be.fillStyle=B?N.getPattern(be,this,(0,i.getCurrentTransformInverse)(x),a.PathType.FILL):N,be.fillRect(0,0,Y,ce),be.restore(),x.save(),x.transform(...me),x.scale(1,-1),f(x,xe.canvas,0,0,Y,ce,0,-1,1,1),x.restore()}this.compose()}paintImageXObject(d){if(!this.contentVisible)return;const x=this.getObject(d);if(!x){(0,t.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(x)}paintImageXObjectRepeat(d,x,N,B){if(!this.contentVisible)return;const G=this.getObject(d);if(!G){(0,t.warn)("Dependent image isn't ready yet");return}const W=G.width,Y=G.height,ce=[];for(let me=0,xe=B.length;me<xe;me+=2)ce.push({transform:[x,0,0,N,B[me],B[me+1]],x:0,y:0,w:W,h:Y});this.paintInlineImageXObjectGroup(G,ce)}applyTransferMapsToCanvas(d){return this.current.transferMaps!=="none"&&(d.filter=this.current.transferMaps,d.drawImage(d.canvas,0,0),d.filter="none"),d.canvas}applyTransferMapsToBitmap(d){if(this.current.transferMaps==="none")return d.bitmap;const{bitmap:x,width:N,height:B}=d,G=this.cachedCanvases.getCanvas("inlineImage",N,B),W=G.context;return W.filter=this.current.transferMaps,W.drawImage(x,0,0),W.filter="none",G.canvas}paintInlineImageXObject(d){if(!this.contentVisible)return;const x=d.width,N=d.height,B=this.ctx;if(this.save(),!t.isNodeJS){const{filter:Y}=B;Y!=="none"&&Y!==""&&(B.filter="none")}B.scale(1/x,-1/N);let G;if(d.bitmap)G=this.applyTransferMapsToBitmap(d);else if(typeof HTMLElement=="function"&&d instanceof HTMLElement||!d.data)G=d;else{const ce=this.cachedCanvases.getCanvas("inlineImage",x,N).context;k(ce,d),G=this.applyTransferMapsToCanvas(ce)}const W=this._scaleImage(G,(0,i.getCurrentTransformInverse)(B));B.imageSmoothingEnabled=T((0,i.getCurrentTransform)(B),d.interpolate),f(B,W.img,0,0,W.paintWidth,W.paintHeight,0,-N,x,N),this.compose(),this.restore()}paintInlineImageXObjectGroup(d,x){if(!this.contentVisible)return;const N=this.ctx;let B;if(d.bitmap)B=d.bitmap;else{const G=d.width,W=d.height,ce=this.cachedCanvases.getCanvas("inlineImage",G,W).context;k(ce,d),B=this.applyTransferMapsToCanvas(ce)}for(const G of x)N.save(),N.transform(...G.transform),N.scale(1,-1),f(N,B,G.x,G.y,G.w,G.h,0,-1,1,1),N.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(d){}markPointProps(d,x){}beginMarkedContent(d){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(d,x){d==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(x)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(d){const x=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(d);const N=this.ctx;this.pendingClip&&(x||(this.pendingClip===Q?N.clip("evenodd"):N.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),N.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const d=(0,i.getCurrentTransform)(this.ctx);if(d[1]===0&&d[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(d[0]),Math.abs(d[3]));else{const x=Math.abs(d[0]*d[3]-d[2]*d[1]),N=Math.hypot(d[0],d[2]),B=Math.hypot(d[1],d[3]);this._cachedGetSinglePixelWidth=Math.max(N,B)/x}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:d}=this.current,{a:x,b:N,c:B,d:G}=this.ctx.getTransform();let W,Y;if(N===0&&B===0){const ce=Math.abs(x),me=Math.abs(G);if(ce===me)if(d===0)W=Y=1/ce;else{const xe=ce*d;W=Y=xe<1?1/xe:1}else if(d===0)W=1/ce,Y=1/me;else{const xe=ce*d,be=me*d;W=xe<1?1/xe:1,Y=be<1?1/be:1}}else{const ce=Math.abs(x*G-N*B),me=Math.hypot(x,N),xe=Math.hypot(B,G);if(d===0)W=xe/ce,Y=me/ce;else{const be=d*ce;W=xe>be?xe/be:1,Y=me>be?me/be:1}}this._cachedScaleForStroking[0]=W,this._cachedScaleForStroking[1]=Y}return this._cachedScaleForStroking}rescaleAndStroke(d){const{ctx:x}=this,{lineWidth:N}=this.current,[B,G]=this.getScaleForStroking();if(x.lineWidth=N||1,B===1&&G===1){x.stroke();return}const W=x.getLineDash();if(d&&x.save(),x.scale(B,G),W.length>0){const Y=Math.max(B,G);x.setLineDash(W.map(ce=>ce/Y)),x.lineDashOffset/=Y}x.stroke(),d&&x.restore()}isContentVisible(){for(let d=this.markedContentStack.length-1;d>=0;d--)if(!this.markedContentStack[d].visible)return!1;return!0}};ue=new WeakSet,$t=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Yt=function(){if(this.pageColors){const d=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(d!=="none"){const x=this.ctx.filter;this.ctx.filter=d,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=x}}};let K=ee;e.CanvasGraphics=K;for(const F in t.OPS)K.prototype[F]!==void 0&&(K.prototype[t.OPS[F]]=K.prototype[F])},(r,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=c;var t=s(1),i=s(6);const a={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=a;function o(p,A){if(!A)return;const k=A[2]-A[0],P=A[3]-A[1],g=new Path2D;g.rect(A[0],A[1],k,P),p.clip(g)}class w{constructor(){this.constructor===w&&(0,t.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,t.unreachable)("Abstract method `getPattern` called.")}}class S extends w{constructor(A){super(),this._type=A[1],this._bbox=A[2],this._colorStops=A[3],this._p0=A[4],this._p1=A[5],this._r0=A[6],this._r1=A[7],this.matrix=null}_createGradient(A){let k;this._type==="axial"?k=A.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(k=A.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const P of this._colorStops)k.addColorStop(P[0],P[1]);return k}getPattern(A,k,P,g){let R;if(g===a.STROKE||g===a.FILL){const E=k.current.getClippedPathBoundingBox(g,(0,i.getCurrentTransform)(A))||[0,0,0,0],C=Math.ceil(E[2]-E[0])||1,j=Math.ceil(E[3]-E[1])||1,z=k.cachedCanvases.getCanvas("pattern",C,j,!0),v=z.context;v.clearRect(0,0,v.canvas.width,v.canvas.height),v.beginPath(),v.rect(0,0,v.canvas.width,v.canvas.height),v.translate(-E[0],-E[1]),P=t.Util.transform(P,[1,0,0,1,E[0],E[1]]),v.transform(...k.baseTransform),this.matrix&&v.transform(...this.matrix),o(v,this._bbox),v.fillStyle=this._createGradient(v),v.fill(),R=A.createPattern(z.canvas,"no-repeat");const T=new DOMMatrix(P);R.setTransform(T)}else o(A,this._bbox),R=this._createGradient(A);return R}}function y(p,A,k,P,g,R,E,C){const j=A.coords,z=A.colors,v=p.data,T=p.width*4;let O;j[k+1]>j[P+1]&&(O=k,k=P,P=O,O=R,R=E,E=O),j[P+1]>j[g+1]&&(O=P,P=g,g=O,O=E,E=C,C=O),j[k+1]>j[P+1]&&(O=k,k=P,P=O,O=R,R=E,E=O);const se=(j[k]+A.offsetX)*A.scaleX,V=(j[k+1]+A.offsetY)*A.scaleY,Q=(j[P]+A.offsetX)*A.scaleX,K=(j[P+1]+A.offsetY)*A.scaleY,ue=(j[g]+A.offsetX)*A.scaleX,D=(j[g+1]+A.offsetY)*A.scaleY;if(V>=D)return;const q=z[R],ee=z[R+1],F=z[R+2],d=z[E],x=z[E+1],N=z[E+2],B=z[C],G=z[C+1],W=z[C+2],Y=Math.round(V),ce=Math.round(D);let me,xe,be,ye,Re,ie,ae,M;for(let H=Y;H<=ce;H++){if(H<K){const Ae=H<V?0:(V-H)/(V-K);me=se-(se-Q)*Ae,xe=q-(q-d)*Ae,be=ee-(ee-x)*Ae,ye=F-(F-N)*Ae}else{let Ae;H>D?Ae=1:K===D?Ae=0:Ae=(K-H)/(K-D),me=Q-(Q-ue)*Ae,xe=d-(d-B)*Ae,be=x-(x-G)*Ae,ye=N-(N-W)*Ae}let Z;H<V?Z=0:H>D?Z=1:Z=(V-H)/(V-D),Re=se-(se-ue)*Z,ie=q-(q-B)*Z,ae=ee-(ee-G)*Z,M=F-(F-W)*Z;const re=Math.round(Math.min(me,Re)),fe=Math.round(Math.max(me,Re));let je=T*H+re*4;for(let Ae=re;Ae<=fe;Ae++)Z=(me-Ae)/(me-Re),Z<0?Z=0:Z>1&&(Z=1),v[je++]=xe-(xe-ie)*Z|0,v[je++]=be-(be-ae)*Z|0,v[je++]=ye-(ye-M)*Z|0,v[je++]=255}}function u(p,A,k){const P=A.coords,g=A.colors;let R,E;switch(A.type){case"lattice":const C=A.verticesPerRow,j=Math.floor(P.length/C)-1,z=C-1;for(R=0;R<j;R++){let v=R*C;for(let T=0;T<z;T++,v++)y(p,k,P[v],P[v+1],P[v+C],g[v],g[v+1],g[v+C]),y(p,k,P[v+C+1],P[v+1],P[v+C],g[v+C+1],g[v+1],g[v+C])}break;case"triangles":for(R=0,E=P.length;R<E;R+=3)y(p,k,P[R],P[R+1],P[R+2],g[R],g[R+1],g[R+2]);break;default:throw new Error("illegal figure")}}class h extends w{constructor(A){super(),this._coords=A[2],this._colors=A[3],this._figures=A[4],this._bounds=A[5],this._bbox=A[7],this._background=A[8],this.matrix=null}_createMeshCanvas(A,k,P){const C=Math.floor(this._bounds[0]),j=Math.floor(this._bounds[1]),z=Math.ceil(this._bounds[2])-C,v=Math.ceil(this._bounds[3])-j,T=Math.min(Math.ceil(Math.abs(z*A[0]*1.1)),3e3),O=Math.min(Math.ceil(Math.abs(v*A[1]*1.1)),3e3),se=z/T,V=v/O,Q={coords:this._coords,colors:this._colors,offsetX:-C,offsetY:-j,scaleX:1/se,scaleY:1/V},K=T+2*2,ue=O+2*2,D=P.getCanvas("mesh",K,ue,!1),q=D.context,ee=q.createImageData(T,O);if(k){const d=ee.data;for(let x=0,N=d.length;x<N;x+=4)d[x]=k[0],d[x+1]=k[1],d[x+2]=k[2],d[x+3]=255}for(const d of this._figures)u(ee,d,Q);return q.putImageData(ee,2,2),{canvas:D.canvas,offsetX:C-2*se,offsetY:j-2*V,scaleX:se,scaleY:V}}getPattern(A,k,P,g){o(A,this._bbox);let R;if(g===a.SHADING)R=t.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(A));else if(R=t.Util.singularValueDecompose2dScale(k.baseTransform),this.matrix){const C=t.Util.singularValueDecompose2dScale(this.matrix);R=[R[0]*C[0],R[1]*C[1]]}const E=this._createMeshCanvas(R,g===a.SHADING?null:this._background,k.cachedCanvases);return g!==a.SHADING&&(A.setTransform(...k.baseTransform),this.matrix&&A.transform(...this.matrix)),A.translate(E.offsetX,E.offsetY),A.scale(E.scaleX,E.scaleY),A.createPattern(E.canvas,"no-repeat")}}class l extends w{getPattern(){return"hotpink"}}function c(p){switch(p[0]){case"RadialAxial":return new S(p);case"Mesh":return new h(p);case"Dummy":return new l}throw new Error(`Unknown IR type: ${p[0]}`)}const b={COLORED:1,UNCOLORED:2},f=class f{constructor(A,k,P,g,R){this.operatorList=A[2],this.matrix=A[3]||[1,0,0,1,0,0],this.bbox=A[4],this.xstep=A[5],this.ystep=A[6],this.paintType=A[7],this.tilingType=A[8],this.color=k,this.ctx=P,this.canvasGraphicsFactory=g,this.baseTransform=R}createPatternCanvas(A){const k=this.operatorList,P=this.bbox,g=this.xstep,R=this.ystep,E=this.paintType,C=this.tilingType,j=this.color,z=this.canvasGraphicsFactory;(0,t.info)("TilingType: "+C);const v=P[0],T=P[1],O=P[2],se=P[3],V=t.Util.singularValueDecompose2dScale(this.matrix),Q=t.Util.singularValueDecompose2dScale(this.baseTransform),K=[V[0]*Q[0],V[1]*Q[1]],ue=this.getSizeAndScale(g,this.ctx.canvas.width,K[0]),D=this.getSizeAndScale(R,this.ctx.canvas.height,K[1]),q=A.cachedCanvases.getCanvas("pattern",ue.size,D.size,!0),ee=q.context,F=z.createCanvasGraphics(ee);F.groupLevel=A.groupLevel,this.setFillAndStrokeStyleToContext(F,E,j);let d=v,x=T,N=O,B=se;return v<0&&(d=0,N+=Math.abs(v)),T<0&&(x=0,B+=Math.abs(T)),ee.translate(-(ue.scale*d),-(D.scale*x)),F.transform(ue.scale,0,0,D.scale,0,0),ee.save(),this.clipBbox(F,d,x,N,B),F.baseTransform=(0,i.getCurrentTransform)(F.ctx),F.executeOperatorList(k),F.endDrawing(),{canvas:q.canvas,scaleX:ue.scale,scaleY:D.scale,offsetX:d,offsetY:x}}getSizeAndScale(A,k,P){A=Math.abs(A);const g=Math.max(f.MAX_PATTERN_SIZE,k);let R=Math.ceil(A*P);return R>=g?R=g:P=R/A,{scale:P,size:R}}clipBbox(A,k,P,g,R){const E=g-k,C=R-P;A.ctx.rect(k,P,E,C),A.current.updateRectMinMax((0,i.getCurrentTransform)(A.ctx),[k,P,g,R]),A.clip(),A.endPath()}setFillAndStrokeStyleToContext(A,k,P){const g=A.ctx,R=A.current;switch(k){case b.COLORED:const E=this.ctx;g.fillStyle=E.fillStyle,g.strokeStyle=E.strokeStyle,R.fillColor=E.fillStyle,R.strokeColor=E.strokeStyle;break;case b.UNCOLORED:const C=t.Util.makeHexColor(P[0],P[1],P[2]);g.fillStyle=C,g.strokeStyle=C,R.fillColor=C,R.strokeColor=C;break;default:throw new t.FormatError(`Unsupported paint type: ${k}`)}}getPattern(A,k,P,g){let R=P;g!==a.SHADING&&(R=t.Util.transform(R,k.baseTransform),this.matrix&&(R=t.Util.transform(R,this.matrix)));const E=this.createPatternCanvas(k);let C=new DOMMatrix(R);C=C.translate(E.offsetX,E.offsetY),C=C.scale(1/E.scaleX,1/E.scaleY);const j=A.createPattern(E.canvas,"repeat");return j.setTransform(C),j}};Je(f,"MAX_PATTERN_SIZE",3e3);let _=f;e.TilingPattern=_},(r,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=a,e.convertToRGBA=i,e.grayToRGBA=w;var t=s(1);function i(S){switch(S.kind){case t.ImageKind.GRAYSCALE_1BPP:return a(S);case t.ImageKind.RGB_24BPP:return o(S)}return null}function a({src:S,srcPos:y=0,dest:u,width:h,height:l,nonBlackColor:c=4294967295,inverseDecode:b=!1}){const _=t.FeatureTest.isLittleEndian?4278190080:255,[f,p]=b?[c,_]:[_,c],A=h>>3,k=h&7,P=S.length;u=new Uint32Array(u.buffer);let g=0;for(let R=0;R<l;R++){for(const C=y+A;y<C;y++){const j=y<P?S[y]:255;u[g++]=j&128?p:f,u[g++]=j&64?p:f,u[g++]=j&32?p:f,u[g++]=j&16?p:f,u[g++]=j&8?p:f,u[g++]=j&4?p:f,u[g++]=j&2?p:f,u[g++]=j&1?p:f}if(k===0)continue;const E=y<P?S[y++]:255;for(let C=0;C<k;C++)u[g++]=E&1<<7-C?p:f}return{srcPos:y,destPos:g}}function o({src:S,srcPos:y=0,dest:u,destPos:h=0,width:l,height:c}){let b=0;const _=S.length>>2,f=new Uint32Array(S.buffer,y,_);if(t.FeatureTest.isLittleEndian){for(;b<_-2;b+=3,h+=4){const p=f[b],A=f[b+1],k=f[b+2];u[h]=p|4278190080,u[h+1]=p>>>24|A<<8|4278190080,u[h+2]=A>>>16|k<<16|4278190080,u[h+3]=k>>>8|4278190080}for(let p=b*4,A=S.length;p<A;p+=3)u[h++]=S[p]|S[p+1]<<8|S[p+2]<<16|4278190080}else{for(;b<_-2;b+=3,h+=4){const p=f[b],A=f[b+1],k=f[b+2];u[h]=p|255,u[h+1]=p<<24|A>>>8|255,u[h+2]=A<<16|k>>>16|255,u[h+3]=k<<8|255}for(let p=b*4,A=S.length;p<A;p+=3)u[h++]=S[p]<<24|S[p+1]<<16|S[p+2]<<8|255}return{srcPos:y,destPos:h}}function w(S,y){if(t.FeatureTest.isLittleEndian)for(let u=0,h=S.length;u<h;u++)y[u]=S[u]*65793|4278190080;else for(let u=0,h=S.length;u<h;u++)y[u]=S[u]*16843008|255}},(r,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const s=Object.create(null);e.GlobalWorkerOptions=s,s.workerPort=null,s.workerSrc=""},(r,e,s)=>{var S,Cs,Ts,St;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var t=s(1);const i={DATA:1,ERROR:2},a={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function o(l){switch(l instanceof Error||typeof l=="object"&&l!==null||(0,t.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),l.name){case"AbortException":return new t.AbortException(l.message);case"MissingPDFException":return new t.MissingPDFException(l.message);case"PasswordException":return new t.PasswordException(l.message,l.code);case"UnexpectedResponseException":return new t.UnexpectedResponseException(l.message,l.status);case"UnknownErrorException":return new t.UnknownErrorException(l.message,l.details);default:return new t.UnknownErrorException(l.message,l.toString())}}class w{constructor(c,b,_){ne(this,S);this.sourceName=c,this.targetName=b,this.comObj=_,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=f=>{const p=f.data;if(p.targetName!==this.sourceName)return;if(p.stream){J(this,S,Ts).call(this,p);return}if(p.callback){const k=p.callbackId,P=this.callbackCapabilities[k];if(!P)throw new Error(`Cannot resolve callback ${k}`);if(delete this.callbackCapabilities[k],p.callback===i.DATA)P.resolve(p.data);else if(p.callback===i.ERROR)P.reject(o(p.reason));else throw new Error("Unexpected callback case");return}const A=this.actionHandler[p.action];if(!A)throw new Error(`Unknown action from worker: ${p.action}`);if(p.callbackId){const k=this.sourceName,P=p.sourceName;new Promise(function(g){g(A(p.data))}).then(function(g){_.postMessage({sourceName:k,targetName:P,callback:i.DATA,callbackId:p.callbackId,data:g})},function(g){_.postMessage({sourceName:k,targetName:P,callback:i.ERROR,callbackId:p.callbackId,reason:o(g)})});return}if(p.streamId){J(this,S,Cs).call(this,p);return}A(p.data)},_.addEventListener("message",this._onComObjOnMessage)}on(c,b){const _=this.actionHandler;if(_[c])throw new Error(`There is already an actionName called "${c}"`);_[c]=b}send(c,b,_){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:c,data:b},_)}sendWithPromise(c,b,_){const f=this.callbackId++,p=new t.PromiseCapability;this.callbackCapabilities[f]=p;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:c,callbackId:f,data:b},_)}catch(A){p.reject(A)}return p.promise}sendWithStream(c,b,_,f){const p=this.streamId++,A=this.sourceName,k=this.targetName,P=this.comObj;return new ReadableStream({start:g=>{const R=new t.PromiseCapability;return this.streamControllers[p]={controller:g,startCall:R,pullCall:null,cancelCall:null,isClosed:!1},P.postMessage({sourceName:A,targetName:k,action:c,streamId:p,data:b,desiredSize:g.desiredSize},f),R.promise},pull:g=>{const R=new t.PromiseCapability;return this.streamControllers[p].pullCall=R,P.postMessage({sourceName:A,targetName:k,stream:a.PULL,streamId:p,desiredSize:g.desiredSize}),R.promise},cancel:g=>{(0,t.assert)(g instanceof Error,"cancel must have a valid reason");const R=new t.PromiseCapability;return this.streamControllers[p].cancelCall=R,this.streamControllers[p].isClosed=!0,P.postMessage({sourceName:A,targetName:k,stream:a.CANCEL,streamId:p,reason:o(g)}),R.promise}},_)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}S=new WeakSet,Cs=function(c){const b=c.streamId,_=this.sourceName,f=c.sourceName,p=this.comObj,A=this,k=this.actionHandler[c.action],P={enqueue(g,R=1,E){if(this.isCancelled)return;const C=this.desiredSize;this.desiredSize-=R,C>0&&this.desiredSize<=0&&(this.sinkCapability=new t.PromiseCapability,this.ready=this.sinkCapability.promise),p.postMessage({sourceName:_,targetName:f,stream:a.ENQUEUE,streamId:b,chunk:g},E)},close(){this.isCancelled||(this.isCancelled=!0,p.postMessage({sourceName:_,targetName:f,stream:a.CLOSE,streamId:b}),delete A.streamSinks[b])},error(g){(0,t.assert)(g instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,p.postMessage({sourceName:_,targetName:f,stream:a.ERROR,streamId:b,reason:o(g)}))},sinkCapability:new t.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:c.desiredSize,ready:null};P.sinkCapability.resolve(),P.ready=P.sinkCapability.promise,this.streamSinks[b]=P,new Promise(function(g){g(k(c.data,P))}).then(function(){p.postMessage({sourceName:_,targetName:f,stream:a.START_COMPLETE,streamId:b,success:!0})},function(g){p.postMessage({sourceName:_,targetName:f,stream:a.START_COMPLETE,streamId:b,reason:o(g)})})},Ts=function(c){const b=c.streamId,_=this.sourceName,f=c.sourceName,p=this.comObj,A=this.streamControllers[b],k=this.streamSinks[b];switch(c.stream){case a.START_COMPLETE:c.success?A.startCall.resolve():A.startCall.reject(o(c.reason));break;case a.PULL_COMPLETE:c.success?A.pullCall.resolve():A.pullCall.reject(o(c.reason));break;case a.PULL:if(!k){p.postMessage({sourceName:_,targetName:f,stream:a.PULL_COMPLETE,streamId:b,success:!0});break}k.desiredSize<=0&&c.desiredSize>0&&k.sinkCapability.resolve(),k.desiredSize=c.desiredSize,new Promise(function(P){var g;P((g=k.onPull)==null?void 0:g.call(k))}).then(function(){p.postMessage({sourceName:_,targetName:f,stream:a.PULL_COMPLETE,streamId:b,success:!0})},function(P){p.postMessage({sourceName:_,targetName:f,stream:a.PULL_COMPLETE,streamId:b,reason:o(P)})});break;case a.ENQUEUE:if((0,t.assert)(A,"enqueue should have stream controller"),A.isClosed)break;A.controller.enqueue(c.chunk);break;case a.CLOSE:if((0,t.assert)(A,"close should have stream controller"),A.isClosed)break;A.isClosed=!0,A.controller.close(),J(this,S,St).call(this,A,b);break;case a.ERROR:(0,t.assert)(A,"error should have stream controller"),A.controller.error(o(c.reason)),J(this,S,St).call(this,A,b);break;case a.CANCEL_COMPLETE:c.success?A.cancelCall.resolve():A.cancelCall.reject(o(c.reason)),J(this,S,St).call(this,A,b);break;case a.CANCEL:if(!k)break;new Promise(function(P){var g;P((g=k.onCancel)==null?void 0:g.call(k,o(c.reason)))}).then(function(){p.postMessage({sourceName:_,targetName:f,stream:a.CANCEL_COMPLETE,streamId:b,success:!0})},function(P){p.postMessage({sourceName:_,targetName:f,stream:a.CANCEL_COMPLETE,streamId:b,reason:o(P)})}),k.sinkCapability.reject(o(c.reason)),k.isCancelled=!0,delete this.streamSinks[b];break;default:throw new Error("Unexpected stream case")}},St=async function(c,b){var _,f,p;await Promise.allSettled([(_=c.startCall)==null?void 0:_.promise,(f=c.pullCall)==null?void 0:f.promise,(p=c.cancelCall)==null?void 0:p.promise]),delete this.streamControllers[b]},e.MessageHandler=w},(r,e,s)=>{var a,o;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var t=s(1);class i{constructor({parsedData:S,rawData:y}){ne(this,a);ne(this,o);le(this,a,S),le(this,o,y)}getRaw(){return n(this,o)}get(S){return n(this,a).get(S)??null}getAll(){return(0,t.objectFromMap)(n(this,a))}has(S){return n(this,a).has(S)}}a=new WeakMap,o=new WeakMap,e.Metadata=i},(r,e,s)=>{var S,y,u,h,l,c,Jt;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var t=s(1),i=s(8);const a=Symbol("INTERNAL");class o{constructor(f,p){ne(this,S,!0);this.name=f,this.intent=p}get visible(){return n(this,S)}_setVisible(f,p){f!==a&&(0,t.unreachable)("Internal method `_setVisible` called."),le(this,S,p)}}S=new WeakMap;class w{constructor(f){ne(this,c);ne(this,y,null);ne(this,u,new Map);ne(this,h,null);ne(this,l,null);if(this.name=null,this.creator=null,f!==null){this.name=f.name,this.creator=f.creator,le(this,l,f.order);for(const p of f.groups)n(this,u).set(p.id,new o(p.name,p.intent));if(f.baseState==="OFF")for(const p of n(this,u).values())p._setVisible(a,!1);for(const p of f.on)n(this,u).get(p)._setVisible(a,!0);for(const p of f.off)n(this,u).get(p)._setVisible(a,!1);le(this,h,this.getHash())}}isVisible(f){if(n(this,u).size===0)return!0;if(!f)return(0,t.warn)("Optional content group not defined."),!0;if(f.type==="OCG")return n(this,u).has(f.id)?n(this,u).get(f.id).visible:((0,t.warn)(`Optional content group not found: ${f.id}`),!0);if(f.type==="OCMD"){if(f.expression)return J(this,c,Jt).call(this,f.expression);if(!f.policy||f.policy==="AnyOn"){for(const p of f.ids){if(!n(this,u).has(p))return(0,t.warn)(`Optional content group not found: ${p}`),!0;if(n(this,u).get(p).visible)return!0}return!1}else if(f.policy==="AllOn"){for(const p of f.ids){if(!n(this,u).has(p))return(0,t.warn)(`Optional content group not found: ${p}`),!0;if(!n(this,u).get(p).visible)return!1}return!0}else if(f.policy==="AnyOff"){for(const p of f.ids){if(!n(this,u).has(p))return(0,t.warn)(`Optional content group not found: ${p}`),!0;if(!n(this,u).get(p).visible)return!0}return!1}else if(f.policy==="AllOff"){for(const p of f.ids){if(!n(this,u).has(p))return(0,t.warn)(`Optional content group not found: ${p}`),!0;if(n(this,u).get(p).visible)return!1}return!0}return(0,t.warn)(`Unknown optional content policy ${f.policy}.`),!0}return(0,t.warn)(`Unknown group type ${f.type}.`),!0}setVisibility(f,p=!0){if(!n(this,u).has(f)){(0,t.warn)(`Optional content group not found: ${f}`);return}n(this,u).get(f)._setVisible(a,!!p),le(this,y,null)}get hasInitialVisibility(){return n(this,h)===null||this.getHash()===n(this,h)}getOrder(){return n(this,u).size?n(this,l)?n(this,l).slice():[...n(this,u).keys()]:null}getGroups(){return n(this,u).size>0?(0,t.objectFromMap)(n(this,u)):null}getGroup(f){return n(this,u).get(f)||null}getHash(){if(n(this,y)!==null)return n(this,y);const f=new i.MurmurHash3_64;for(const[p,A]of n(this,u))f.update(`${p}:${A.visible}`);return le(this,y,f.hexdigest())}}y=new WeakMap,u=new WeakMap,h=new WeakMap,l=new WeakMap,c=new WeakSet,Jt=function(f){const p=f.length;if(p<2)return!0;const A=f[0];for(let k=1;k<p;k++){const P=f[k];let g;if(Array.isArray(P))g=J(this,c,Jt).call(this,P);else if(n(this,u).has(P))g=n(this,u).get(P).visible;else return(0,t.warn)(`Optional content group not found: ${P}`),!0;switch(A){case"And":if(!g)return!1;break;case"Or":if(g)return!0;break;case"Not":return!g;default:return!0}}return A==="And"},e.OptionalContentConfig=w},(r,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var t=s(1),i=s(6);class a{constructor({length:y,initialData:u,progressiveDone:h=!1,contentDispositionFilename:l=null,disableRange:c=!1,disableStream:b=!1},_){if((0,t.assert)(_,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=h,this._contentDispositionFilename=l,(u==null?void 0:u.length)>0){const f=u instanceof Uint8Array&&u.byteLength===u.buffer.byteLength?u.buffer:new Uint8Array(u).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=_,this._isStreamingSupported=!b,this._isRangeSupported=!c,this._contentLength=y,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((f,p)=>{this._onReceiveData({begin:f,chunk:p})}),this._pdfDataRangeTransport.addProgressListener((f,p)=>{this._onProgress({loaded:f,total:p})}),this._pdfDataRangeTransport.addProgressiveReadListener(f=>{this._onReceiveData({chunk:f})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:y,chunk:u}){const h=u instanceof Uint8Array&&u.byteLength===u.buffer.byteLength?u.buffer:new Uint8Array(u).buffer;if(y===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(h):this._queuedChunks.push(h);else{const l=this._rangeReaders.some(function(c){return c._begin!==y?!1:(c._enqueue(h),!0)});(0,t.assert)(l,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var y;return((y=this._fullRequestReader)==null?void 0:y._loaded)??0}_onProgress(y){var u,h,l,c;y.total===void 0?(h=(u=this._rangeReaders[0])==null?void 0:u.onProgress)==null||h.call(u,{loaded:y.loaded}):(c=(l=this._fullRequestReader)==null?void 0:l.onProgress)==null||c.call(l,{loaded:y.loaded,total:y.total})}_onProgressiveDone(){var y;(y=this._fullRequestReader)==null||y.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(y){const u=this._rangeReaders.indexOf(y);u>=0&&this._rangeReaders.splice(u,1)}getFullReader(){(0,t.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const y=this._queuedChunks;return this._queuedChunks=null,new o(this,y,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(y,u){if(u<=this._progressiveDataLength)return null;const h=new w(this,y,u);return this._pdfDataRangeTransport.requestDataRange(y,u),this._rangeReaders.push(h),h}cancelAllRequests(y){var u;(u=this._fullRequestReader)==null||u.cancel(y);for(const h of this._rangeReaders.slice(0))h.cancel(y);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=a;class o{constructor(y,u,h=!1,l=null){this._stream=y,this._done=h||!1,this._filename=(0,i.isPdfFile)(l)?l:null,this._queuedChunks=u||[],this._loaded=0;for(const c of this._queuedChunks)this._loaded+=c.byteLength;this._requests=[],this._headersReady=Promise.resolve(),y._fullRequestReader=this,this.onProgress=null}_enqueue(y){this._done||(this._requests.length>0?this._requests.shift().resolve({value:y,done:!1}):this._queuedChunks.push(y),this._loaded+=y.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const y=new t.PromiseCapability;return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class w{constructor(y,u,h){this._stream=y,this._begin=u,this._end=h,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(y){if(!this._done){if(this._requests.length===0)this._queuedChunk=y;else{this._requests.shift().resolve({value:y,done:!1});for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const u=this._queuedChunk;return this._queuedChunk=null,{value:u,done:!1}}if(this._done)return{value:void 0,done:!0};const y=new t.PromiseCapability;return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(r,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var t=s(1),i=s(20);function a(h,l,c){return{method:"GET",headers:h,signal:c.signal,mode:"cors",credentials:l?"include":"same-origin",redirect:"follow"}}function o(h){const l=new Headers;for(const c in h){const b=h[c];b!==void 0&&l.append(c,b)}return l}function w(h){return h instanceof Uint8Array?h.buffer:h instanceof ArrayBuffer?h:((0,t.warn)(`getArrayBuffer - unexpected data format: ${h}`),new Uint8Array(h).buffer)}class S{constructor(l){this.source=l,this.isHttp=/^https?:/i.test(l.url),this.httpHeaders=this.isHttp&&l.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var l;return((l=this._fullRequestReader)==null?void 0:l._loaded)??0}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new y(this),this._fullRequestReader}getRangeReader(l,c){if(c<=this._progressiveDataLength)return null;const b=new u(this,l,c);return this._rangeRequestReaders.push(b),b}cancelAllRequests(l){var c;(c=this._fullRequestReader)==null||c.cancel(l);for(const b of this._rangeRequestReaders.slice(0))b.cancel(l)}}e.PDFFetchStream=S;class y{constructor(l){this._stream=l,this._reader=null,this._loaded=0,this._filename=null;const c=l.source;this._withCredentials=c.withCredentials||!1,this._contentLength=c.length,this._headersCapability=new t.PromiseCapability,this._disableRange=c.disableRange||!1,this._rangeChunkSize=c.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!c.disableStream,this._isRangeSupported=!c.disableRange,this._headers=o(this._stream.httpHeaders);const b=c.url;fetch(b,a(this._headers,this._withCredentials,this._abortController)).then(_=>{if(!(0,i.validateResponseStatus)(_.status))throw(0,i.createResponseStatusError)(_.status,b);this._reader=_.body.getReader(),this._headersCapability.resolve();const f=k=>_.headers.get(k),{allowRangeRequests:p,suggestedLength:A}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:f,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=p,this._contentLength=A||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(f),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new t.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var b;await this._headersCapability.promise;const{value:l,done:c}=await this._reader.read();return c?{value:l,done:c}:(this._loaded+=l.byteLength,(b=this.onProgress)==null||b.call(this,{loaded:this._loaded,total:this._contentLength}),{value:w(l),done:!1})}cancel(l){var c;(c=this._reader)==null||c.cancel(l),this._abortController.abort()}}class u{constructor(l,c,b){this._stream=l,this._reader=null,this._loaded=0;const _=l.source;this._withCredentials=_.withCredentials||!1,this._readCapability=new t.PromiseCapability,this._isStreamingSupported=!_.disableStream,this._abortController=new AbortController,this._headers=o(this._stream.httpHeaders),this._headers.append("Range",`bytes=${c}-${b-1}`);const f=_.url;fetch(f,a(this._headers,this._withCredentials,this._abortController)).then(p=>{if(!(0,i.validateResponseStatus)(p.status))throw(0,i.createResponseStatusError)(p.status,f);this._readCapability.resolve(),this._reader=p.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var b;await this._readCapability.promise;const{value:l,done:c}=await this._reader.read();return c?{value:l,done:c}:(this._loaded+=l.byteLength,(b=this.onProgress)==null||b.call(this,{loaded:this._loaded}),{value:w(l),done:!1})}cancel(l){var c;(c=this._reader)==null||c.cancel(l),this._abortController.abort()}}},(r,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=S,e.extractFilenameFromHeader=w,e.validateRangeRequestCapabilities=o,e.validateResponseStatus=y;var t=s(1),i=s(21),a=s(6);function o({getResponseHeader:u,isHttp:h,rangeChunkSize:l,disableRange:c}){const b={allowRangeRequests:!1,suggestedLength:void 0},_=parseInt(u("Content-Length"),10);return!Number.isInteger(_)||(b.suggestedLength=_,_<=2*l)||c||!h||u("Accept-Ranges")!=="bytes"||(u("Content-Encoding")||"identity")!=="identity"||(b.allowRangeRequests=!0),b}function w(u){const h=u("Content-Disposition");if(h){let l=(0,i.getFilenameFromContentDispositionHeader)(h);if(l.includes("%"))try{l=decodeURIComponent(l)}catch{}if((0,a.isPdfFile)(l))return l}return null}function S(u,h){return u===404||u===0&&h.startsWith("file:")?new t.MissingPDFException('Missing PDF "'+h+'".'):new t.UnexpectedResponseException(`Unexpected server response (${u}) while retrieving PDF "${h}".`,u)}function y(u){return u===200||u===206}},(r,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=i;var t=s(1);function i(a){let o=!0,w=S("filename\\*","i").exec(a);if(w){w=w[1];let _=l(w);return _=unescape(_),_=c(_),_=b(_),u(_)}if(w=h(a),w){const _=b(w);return u(_)}if(w=S("filename","i").exec(a),w){w=w[1];let _=l(w);return _=b(_),u(_)}function S(_,f){return new RegExp("(?:^|;)\\s*"+_+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function y(_,f){if(_){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const p=new TextDecoder(_,{fatal:!0}),A=(0,t.stringToBytes)(f);f=p.decode(A),o=!1}catch{}}return f}function u(_){return o&&/[\x80-\xff]/.test(_)&&(_=y("utf-8",_),o&&(_=y("iso-8859-1",_))),_}function h(_){const f=[];let p;const A=S("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=A.exec(_))!==null;){let[,P,g,R]=p;if(P=parseInt(P,10),P in f){if(P===0)break;continue}f[P]=[g,R]}const k=[];for(let P=0;P<f.length&&P in f;++P){let[g,R]=f[P];R=l(R),g&&(R=unescape(R),P===0&&(R=c(R))),k.push(R)}return k.join("")}function l(_){if(_.startsWith('"')){const f=_.slice(1).split('\\"');for(let p=0;p<f.length;++p){const A=f[p].indexOf('"');A!==-1&&(f[p]=f[p].slice(0,A),f.length=p+1),f[p]=f[p].replaceAll(/\\(.)/g,"$1")}_=f.join('"')}return _}function c(_){const f=_.indexOf("'");if(f===-1)return _;const p=_.slice(0,f),k=_.slice(f+1).replace(/^[^']*'/,"");return y(p,k)}function b(_){return!_.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(_)?_:_.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,p,A,k){if(A==="q"||A==="Q")return k=k.replaceAll("_"," "),k=k.replaceAll(/=([0-9a-fA-F]{2})/g,function(P,g){return String.fromCharCode(parseInt(g,16))}),y(p,k);try{k=atob(k)}catch{}return y(p,k)})}return""}},(r,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var t=s(1),i=s(20);const a=200,o=206;function w(l){const c=l.response;return typeof c!="string"?c:(0,t.stringToBytes)(c).buffer}class S{constructor(c,b={}){this.url=c,this.isHttp=/^https?:/i.test(c),this.httpHeaders=this.isHttp&&b.httpHeaders||Object.create(null),this.withCredentials=b.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(c,b,_){const f={begin:c,end:b};for(const p in _)f[p]=_[p];return this.request(f)}requestFull(c){return this.request(c)}request(c){const b=new XMLHttpRequest,_=this.currXhrId++,f=this.pendingRequests[_]={xhr:b};b.open("GET",this.url),b.withCredentials=this.withCredentials;for(const p in this.httpHeaders){const A=this.httpHeaders[p];A!==void 0&&b.setRequestHeader(p,A)}return this.isHttp&&"begin"in c&&"end"in c?(b.setRequestHeader("Range",`bytes=${c.begin}-${c.end-1}`),f.expectedStatus=o):f.expectedStatus=a,b.responseType="arraybuffer",c.onError&&(b.onerror=function(p){c.onError(b.status)}),b.onreadystatechange=this.onStateChange.bind(this,_),b.onprogress=this.onProgress.bind(this,_),f.onHeadersReceived=c.onHeadersReceived,f.onDone=c.onDone,f.onError=c.onError,f.onProgress=c.onProgress,b.send(null),_}onProgress(c,b){var f;const _=this.pendingRequests[c];_&&((f=_.onProgress)==null||f.call(_,b))}onStateChange(c,b){var P,g,R;const _=this.pendingRequests[c];if(!_)return;const f=_.xhr;if(f.readyState>=2&&_.onHeadersReceived&&(_.onHeadersReceived(),delete _.onHeadersReceived),f.readyState!==4||!(c in this.pendingRequests))return;if(delete this.pendingRequests[c],f.status===0&&this.isHttp){(P=_.onError)==null||P.call(_,f.status);return}const p=f.status||a;if(!(p===a&&_.expectedStatus===o)&&p!==_.expectedStatus){(g=_.onError)==null||g.call(_,f.status);return}const k=w(f);if(p===o){const E=f.getResponseHeader("Content-Range"),C=/bytes (\d+)-(\d+)\/(\d+)/.exec(E);_.onDone({begin:parseInt(C[1],10),chunk:k})}else k?_.onDone({begin:0,chunk:k}):(R=_.onError)==null||R.call(_,f.status)}getRequestXhr(c){return this.pendingRequests[c].xhr}isPendingRequest(c){return c in this.pendingRequests}abortRequest(c){const b=this.pendingRequests[c].xhr;delete this.pendingRequests[c],b.abort()}}class y{constructor(c){this._source=c,this._manager=new S(c.url,{httpHeaders:c.httpHeaders,withCredentials:c.withCredentials}),this._rangeChunkSize=c.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(c){const b=this._rangeRequestReaders.indexOf(c);b>=0&&this._rangeRequestReaders.splice(b,1)}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new u(this._manager,this._source),this._fullRequestReader}getRangeReader(c,b){const _=new h(this._manager,c,b);return _.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(_),_}cancelAllRequests(c){var b;(b=this._fullRequestReader)==null||b.cancel(c);for(const _ of this._rangeRequestReaders.slice(0))_.cancel(c)}}e.PDFNetworkStream=y;class u{constructor(c,b){this._manager=c;const _={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=b.url,this._fullRequestId=c.requestFull(_),this._headersReceivedCapability=new t.PromiseCapability,this._disableRange=b.disableRange||!1,this._contentLength=b.length,this._rangeChunkSize=b.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const c=this._fullRequestId,b=this._manager.getRequestXhr(c),_=A=>b.getResponseHeader(A),{allowRangeRequests:f,suggestedLength:p}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:_,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});f&&(this._isRangeSupported=!0),this._contentLength=p||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(_),this._isRangeSupported&&this._manager.abortRequest(c),this._headersReceivedCapability.resolve()}_onDone(c){if(c&&(this._requests.length>0?this._requests.shift().resolve({value:c.chunk,done:!1}):this._cachedChunks.push(c.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(c){this._storedError=(0,i.createResponseStatusError)(c,this._url),this._headersReceivedCapability.reject(this._storedError);for(const b of this._requests)b.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(c){var b;(b=this.onProgress)==null||b.call(this,{loaded:c.loaded,total:c.lengthComputable?c.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const c=new t.PromiseCapability;return this._requests.push(c),c.promise}cancel(c){this._done=!0,this._headersReceivedCapability.reject(c);for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class h{constructor(c,b,_){this._manager=c;const f={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=c.url,this._requestId=c.requestRange(b,_,f),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var c;(c=this.onClosed)==null||c.call(this,this)}_onDone(c){const b=c.chunk;this._requests.length>0?this._requests.shift().resolve({value:b,done:!1}):this._queuedChunk=b,this._done=!0;for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(c){this._storedError=(0,i.createResponseStatusError)(c,this._url);for(const b of this._requests)b.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(c){var b;this.isStreamingSupported||(b=this.onProgress)==null||b.call(this,{loaded:c.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const b=this._queuedChunk;return this._queuedChunk=null,{value:b,done:!1}}if(this._done)return{value:void 0,done:!0};const c=new t.PromiseCapability;return this._requests.push(c),c.promise}cancel(c){this._done=!0;for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(r,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var t=s(1),i=s(20);const a=/^file:\/\/\/[a-zA-Z]:\//;function o(_){const f=require$$5,p=f.parse(_);return p.protocol==="file:"||p.host?p:/^[a-z]:[/\\]/i.test(_)?f.parse(`file:///${_}`):(p.host||(p.protocol="file:"),p)}class w{constructor(f){this.source=f,this.url=o(f.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&f.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new c(this):new h(this),this._fullRequestReader}getRangeReader(f,p){if(p<=this._progressiveDataLength)return null;const A=this.isFsUrl?new b(this,f,p):new l(this,f,p);return this._rangeRequestReaders.push(A),A}cancelAllRequests(f){var p;(p=this._fullRequestReader)==null||p.cancel(f);for(const A of this._rangeRequestReaders.slice(0))A.cancel(f)}}e.PDFNodeStream=w;class S{constructor(f){this._url=f.url,this._done=!1,this._storedError=null,this.onProgress=null;const p=f.source;this._contentLength=p.length,this._loaded=0,this._filename=null,this._disableRange=p.disableRange||!1,this._rangeChunkSize=p.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!p.disableStream,this._isRangeSupported=!p.disableRange,this._readableStream=null,this._readCapability=new t.PromiseCapability,this._headersCapability=new t.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var A;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const f=this._readableStream.read();return f===null?(this._readCapability=new t.PromiseCapability,this.read()):(this._loaded+=f.length,(A=this.onProgress)==null||A.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(f).buffer,done:!1})}cancel(f){if(!this._readableStream){this._error(f);return}this._readableStream.destroy(f)}_error(f){this._storedError=f,this._readCapability.resolve()}_setReadableStream(f){this._readableStream=f,f.on("readable",()=>{this._readCapability.resolve()}),f.on("end",()=>{f.destroy(),this._done=!0,this._readCapability.resolve()}),f.on("error",p=>{this._error(p)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new t.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class y{constructor(f){this._url=f.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new t.PromiseCapability;const p=f.source;this._isStreamingSupported=!p.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var A;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const f=this._readableStream.read();return f===null?(this._readCapability=new t.PromiseCapability,this.read()):(this._loaded+=f.length,(A=this.onProgress)==null||A.call(this,{loaded:this._loaded}),{value:new Uint8Array(f).buffer,done:!1})}cancel(f){if(!this._readableStream){this._error(f);return}this._readableStream.destroy(f)}_error(f){this._storedError=f,this._readCapability.resolve()}_setReadableStream(f){this._readableStream=f,f.on("readable",()=>{this._readCapability.resolve()}),f.on("end",()=>{f.destroy(),this._done=!0,this._readCapability.resolve()}),f.on("error",p=>{this._error(p)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function u(_,f){return{protocol:_.protocol,auth:_.auth,host:_.hostname,port:_.port,path:_.path,method:"GET",headers:f}}class h extends S{constructor(f){super(f);const p=A=>{if(A.statusCode===404){const R=new t.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=R,this._headersCapability.reject(R);return}this._headersCapability.resolve(),this._setReadableStream(A);const k=R=>this._readableStream.headers[R.toLowerCase()],{allowRangeRequests:P,suggestedLength:g}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:k,isHttp:f.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=P,this._contentLength=g||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(k)};if(this._request=null,this._url.protocol==="http:"){const A=require$$5;this._request=A.request(u(this._url,f.httpHeaders),p)}else{const A=require$$5;this._request=A.request(u(this._url,f.httpHeaders),p)}this._request.on("error",A=>{this._storedError=A,this._headersCapability.reject(A)}),this._request.end()}}class l extends y{constructor(f,p,A){super(f),this._httpHeaders={};for(const P in f.httpHeaders){const g=f.httpHeaders[P];g!==void 0&&(this._httpHeaders[P]=g)}this._httpHeaders.Range=`bytes=${p}-${A-1}`;const k=P=>{if(P.statusCode===404){const g=new t.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=g;return}this._setReadableStream(P)};if(this._request=null,this._url.protocol==="http:"){const P=require$$5;this._request=P.request(u(this._url,this._httpHeaders),k)}else{const P=require$$5;this._request=P.request(u(this._url,this._httpHeaders),k)}this._request.on("error",P=>{this._storedError=P}),this._request.end()}}class c extends S{constructor(f){super(f);let p=decodeURIComponent(this._url.path);a.test(this._url.href)&&(p=p.replace(/^\//,""));const A=require$$5;A.lstat(p,(k,P)=>{if(k){k.code==="ENOENT"&&(k=new t.MissingPDFException(`Missing PDF "${p}".`)),this._storedError=k,this._headersCapability.reject(k);return}this._contentLength=P.size,this._setReadableStream(A.createReadStream(p)),this._headersCapability.resolve()})}}class b extends y{constructor(f,p,A){super(f);let k=decodeURIComponent(this._url.path);a.test(this._url.href)&&(k=k.replace(/^\//,""));const P=require$$5;this._setReadableStream(P.createReadStream(k,{start:p,end:A-1}))}}},(r,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var t=s(6),i=s(1);const a={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},o="http://www.w3.org/XML/1998/namespace",w="http://www.w3.org/1999/xlink",S=["butt","round","square"],y=["miter","round","bevel"],u=function(P,g="",R=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!R)return URL.createObjectURL(new Blob([P],{type:g}));const E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let C=`data:${g};base64,`;for(let j=0,z=P.length;j<z;j+=3){const v=P[j]&255,T=P[j+1]&255,O=P[j+2]&255,se=v>>2,V=(v&3)<<4|T>>4,Q=j+1<z?(T&15)<<2|O>>6:64,K=j+2<z?O&63:64;C+=E[se]+E[V]+E[Q]+E[K]}return C},h=function(){const P=new Uint8Array([137,80,78,71,13,10,26,10]),g=12,R=new Int32Array(256);for(let O=0;O<256;O++){let se=O;for(let V=0;V<8;V++)se=se&1?3988292384^se>>1&2147483647:se>>1&2147483647;R[O]=se}function E(O,se,V){let Q=-1;for(let K=se;K<V;K++){const ue=(Q^O[K])&255,D=R[ue];Q=Q>>>8^D}return Q^-1}function C(O,se,V,Q){let K=Q;const ue=se.length;V[K]=ue>>24&255,V[K+1]=ue>>16&255,V[K+2]=ue>>8&255,V[K+3]=ue&255,K+=4,V[K]=O.charCodeAt(0)&255,V[K+1]=O.charCodeAt(1)&255,V[K+2]=O.charCodeAt(2)&255,V[K+3]=O.charCodeAt(3)&255,K+=4,V.set(se,K),K+=se.length;const D=E(V,Q+4,K);V[K]=D>>24&255,V[K+1]=D>>16&255,V[K+2]=D>>8&255,V[K+3]=D&255}function j(O,se,V){let Q=1,K=0;for(let ue=se;ue<V;++ue)Q=(Q+(O[ue]&255))%65521,K=(K+Q)%65521;return K<<16|Q}function z(O){if(!i.isNodeJS)return v(O);try{const se=parseInt(process.versions.node)>=8?O:Buffer.from(O),V=require$$5.deflateSync(se,{level:9});return V instanceof Uint8Array?V:new Uint8Array(V)}catch(se){(0,i.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+se)}return v(O)}function v(O){let se=O.length;const V=65535,Q=Math.ceil(se/V),K=new Uint8Array(2+se+Q*5+4);let ue=0;K[ue++]=120,K[ue++]=156;let D=0;for(;se>V;)K[ue++]=0,K[ue++]=255,K[ue++]=255,K[ue++]=0,K[ue++]=0,K.set(O.subarray(D,D+V),ue),ue+=V,D+=V,se-=V;K[ue++]=1,K[ue++]=se&255,K[ue++]=se>>8&255,K[ue++]=~se&65535&255,K[ue++]=(~se&65535)>>8&255,K.set(O.subarray(D),ue),ue+=O.length-D;const q=j(O,0,O.length);return K[ue++]=q>>24&255,K[ue++]=q>>16&255,K[ue++]=q>>8&255,K[ue++]=q&255,K}function T(O,se,V,Q){const K=O.width,ue=O.height;let D,q,ee;const F=O.data;switch(se){case i.ImageKind.GRAYSCALE_1BPP:q=0,D=1,ee=K+7>>3;break;case i.ImageKind.RGB_24BPP:q=2,D=8,ee=K*3;break;case i.ImageKind.RGBA_32BPP:q=6,D=8,ee=K*4;break;default:throw new Error("invalid format")}const d=new Uint8Array((1+ee)*ue);let x=0,N=0;for(let me=0;me<ue;++me)d[x++]=0,d.set(F.subarray(N,N+ee),x),N+=ee,x+=ee;if(se===i.ImageKind.GRAYSCALE_1BPP&&Q){x=0;for(let me=0;me<ue;me++){x++;for(let xe=0;xe<ee;xe++)d[x++]^=255}}const B=new Uint8Array([K>>24&255,K>>16&255,K>>8&255,K&255,ue>>24&255,ue>>16&255,ue>>8&255,ue&255,D,q,0,0,0]),G=z(d),W=P.length+g*3+B.length+G.length,Y=new Uint8Array(W);let ce=0;return Y.set(P,ce),ce+=P.length,C("IHDR",B,Y,ce),ce+=g+B.length,C("IDATA",G,Y,ce),ce+=g+G.length,C("IEND",new Uint8Array(0),Y,ce),u(Y,"image/png",V)}return function(se,V,Q){const K=se.kind===void 0?i.ImageKind.GRAYSCALE_1BPP:se.kind;return T(se,K,V,Q)}}();class l{constructor(){this.fontSizeScale=1,this.fontWeight=a.fontWeight,this.fontSize=0,this.textMatrix=i.IDENTITY_MATRIX,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=i.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=a.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(g,R){this.x=g,this.y=R}}function c(P){let g=[];const R=[];for(const E of P){if(E.fn==="save"){g.push({fnId:92,fn:"group",items:[]}),R.push(g),g=g.at(-1).items;continue}E.fn==="restore"?g=R.pop():g.push(E)}return g}function b(P){if(Number.isInteger(P))return P.toString();const g=P.toFixed(10);let R=g.length-1;if(g[R]!=="0")return g;do R--;while(g[R]==="0");return g.substring(0,g[R]==="."?R:R+1)}function _(P){if(P[4]===0&&P[5]===0){if(P[1]===0&&P[2]===0)return P[0]===1&&P[3]===1?"":`scale(${b(P[0])} ${b(P[3])})`;if(P[0]===P[3]&&P[1]===-P[2]){const g=Math.acos(P[0])*180/Math.PI;return`rotate(${b(g)})`}}else if(P[0]===1&&P[1]===0&&P[2]===0&&P[3]===1)return`translate(${b(P[4])} ${b(P[5])})`;return`matrix(${b(P[0])} ${b(P[1])} ${b(P[2])} ${b(P[3])} ${b(P[4])} ${b(P[5])})`}let f=0,p=0,A=0;class k{constructor(g,R,E=!1){(0,t.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new t.DOMSVGFactory,this.current=new l,this.transformMatrix=i.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=g,this.objs=R,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!E,this._operatorIdMapping=[];for(const C in i.OPS)this._operatorIdMapping[i.OPS[C]]=C}getObject(g,R=null){return typeof g=="string"?g.startsWith("g_")?this.commonObjs.get(g):this.objs.get(g):R}save(){this.transformStack.push(this.transformMatrix);const g=this.current;this.extraStack.push(g),this.current=g.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(g){this.save(),this.executeOpTree(g),this.restore()}loadDependencies(g){const R=g.fnArray,E=g.argsArray;for(let C=0,j=R.length;C<j;C++)if(R[C]===i.OPS.dependency)for(const z of E[C]){const v=z.startsWith("g_")?this.commonObjs:this.objs,T=new Promise(O=>{v.get(z,O)});this.current.dependencies.push(T)}return Promise.all(this.current.dependencies)}transform(g,R,E,C,j,z){const v=[g,R,E,C,j,z];this.transformMatrix=i.Util.transform(this.transformMatrix,v),this.tgrp=null}getSVG(g,R){this.viewport=R;const E=this._initialize(R);return this.loadDependencies(g).then(()=>(this.transformMatrix=i.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(g)),E))}convertOpList(g){const R=this._operatorIdMapping,E=g.argsArray,C=g.fnArray,j=[];for(let z=0,v=C.length;z<v;z++){const T=C[z];j.push({fnId:T,fn:R[T],args:E[z]})}return c(j)}executeOpTree(g){for(const R of g){const E=R.fn,C=R.fnId,j=R.args;switch(C|0){case i.OPS.beginText:this.beginText();break;case i.OPS.dependency:break;case i.OPS.setLeading:this.setLeading(j);break;case i.OPS.setLeadingMoveText:this.setLeadingMoveText(j[0],j[1]);break;case i.OPS.setFont:this.setFont(j);break;case i.OPS.showText:this.showText(j[0]);break;case i.OPS.showSpacedText:this.showText(j[0]);break;case i.OPS.endText:this.endText();break;case i.OPS.moveText:this.moveText(j[0],j[1]);break;case i.OPS.setCharSpacing:this.setCharSpacing(j[0]);break;case i.OPS.setWordSpacing:this.setWordSpacing(j[0]);break;case i.OPS.setHScale:this.setHScale(j[0]);break;case i.OPS.setTextMatrix:this.setTextMatrix(j[0],j[1],j[2],j[3],j[4],j[5]);break;case i.OPS.setTextRise:this.setTextRise(j[0]);break;case i.OPS.setTextRenderingMode:this.setTextRenderingMode(j[0]);break;case i.OPS.setLineWidth:this.setLineWidth(j[0]);break;case i.OPS.setLineJoin:this.setLineJoin(j[0]);break;case i.OPS.setLineCap:this.setLineCap(j[0]);break;case i.OPS.setMiterLimit:this.setMiterLimit(j[0]);break;case i.OPS.setFillRGBColor:this.setFillRGBColor(j[0],j[1],j[2]);break;case i.OPS.setStrokeRGBColor:this.setStrokeRGBColor(j[0],j[1],j[2]);break;case i.OPS.setStrokeColorN:this.setStrokeColorN(j);break;case i.OPS.setFillColorN:this.setFillColorN(j);break;case i.OPS.shadingFill:this.shadingFill(j[0]);break;case i.OPS.setDash:this.setDash(j[0],j[1]);break;case i.OPS.setRenderingIntent:this.setRenderingIntent(j[0]);break;case i.OPS.setFlatness:this.setFlatness(j[0]);break;case i.OPS.setGState:this.setGState(j[0]);break;case i.OPS.fill:this.fill();break;case i.OPS.eoFill:this.eoFill();break;case i.OPS.stroke:this.stroke();break;case i.OPS.fillStroke:this.fillStroke();break;case i.OPS.eoFillStroke:this.eoFillStroke();break;case i.OPS.clip:this.clip("nonzero");break;case i.OPS.eoClip:this.clip("evenodd");break;case i.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case i.OPS.paintImageXObject:this.paintImageXObject(j[0]);break;case i.OPS.paintInlineImageXObject:this.paintInlineImageXObject(j[0]);break;case i.OPS.paintImageMaskXObject:this.paintImageMaskXObject(j[0]);break;case i.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(j[0],j[1]);break;case i.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case i.OPS.closePath:this.closePath();break;case i.OPS.closeStroke:this.closeStroke();break;case i.OPS.closeFillStroke:this.closeFillStroke();break;case i.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case i.OPS.nextLine:this.nextLine();break;case i.OPS.transform:this.transform(j[0],j[1],j[2],j[3],j[4],j[5]);break;case i.OPS.constructPath:this.constructPath(j[0],j[1]);break;case i.OPS.endPath:this.endPath();break;case 92:this.group(R.items);break;default:(0,i.warn)(`Unimplemented operator ${E}`);break}}}setWordSpacing(g){this.current.wordSpacing=g}setCharSpacing(g){this.current.charSpacing=g}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(g,R,E,C,j,z){const v=this.current;v.textMatrix=v.lineMatrix=[g,R,E,C,j,z],v.textMatrixScale=Math.hypot(g,R),v.x=v.lineX=0,v.y=v.lineY=0,v.xcoords=[],v.ycoords=[],v.tspan=this.svgFactory.createElement("svg:tspan"),v.tspan.setAttributeNS(null,"font-family",v.fontFamily),v.tspan.setAttributeNS(null,"font-size",`${b(v.fontSize)}px`),v.tspan.setAttributeNS(null,"y",b(-v.y)),v.txtElement=this.svgFactory.createElement("svg:text"),v.txtElement.append(v.tspan)}beginText(){const g=this.current;g.x=g.lineX=0,g.y=g.lineY=0,g.textMatrix=i.IDENTITY_MATRIX,g.lineMatrix=i.IDENTITY_MATRIX,g.textMatrixScale=1,g.tspan=this.svgFactory.createElement("svg:tspan"),g.txtElement=this.svgFactory.createElement("svg:text"),g.txtgrp=this.svgFactory.createElement("svg:g"),g.xcoords=[],g.ycoords=[]}moveText(g,R){const E=this.current;E.x=E.lineX+=g,E.y=E.lineY+=R,E.xcoords=[],E.ycoords=[],E.tspan=this.svgFactory.createElement("svg:tspan"),E.tspan.setAttributeNS(null,"font-family",E.fontFamily),E.tspan.setAttributeNS(null,"font-size",`${b(E.fontSize)}px`),E.tspan.setAttributeNS(null,"y",b(-E.y))}showText(g){const R=this.current,E=R.font,C=R.fontSize;if(C===0)return;const j=R.fontSizeScale,z=R.charSpacing,v=R.wordSpacing,T=R.fontDirection,O=R.textHScale*T,se=E.vertical,V=se?1:-1,Q=E.defaultVMetrics,K=C*R.fontMatrix[0];let ue=0;for(const ee of g){if(ee===null){ue+=T*v;continue}else if(typeof ee=="number"){ue+=V*ee*C/1e3;continue}const F=(ee.isSpace?v:0)+z,d=ee.fontChar;let x,N,B=ee.width;if(se){let W;const Y=ee.vmetric||Q;W=ee.vmetric?Y[1]:B*.5,W=-W*K;const ce=Y[2]*K;B=Y?-Y[0]:B,x=W/j,N=(ue+ce)/j}else x=ue/j,N=0;(ee.isInFont||E.missingFile)&&(R.xcoords.push(R.x+x),se&&R.ycoords.push(-R.y+N),R.tspan.textContent+=d);const G=se?B*K-F*T:B*K+F*T;ue+=G}R.tspan.setAttributeNS(null,"x",R.xcoords.map(b).join(" ")),se?R.tspan.setAttributeNS(null,"y",R.ycoords.map(b).join(" ")):R.tspan.setAttributeNS(null,"y",b(-R.y)),se?R.y-=ue:R.x+=ue*O,R.tspan.setAttributeNS(null,"font-family",R.fontFamily),R.tspan.setAttributeNS(null,"font-size",`${b(R.fontSize)}px`),R.fontStyle!==a.fontStyle&&R.tspan.setAttributeNS(null,"font-style",R.fontStyle),R.fontWeight!==a.fontWeight&&R.tspan.setAttributeNS(null,"font-weight",R.fontWeight);const D=R.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;if(D===i.TextRenderingMode.FILL||D===i.TextRenderingMode.FILL_STROKE?(R.fillColor!==a.fillColor&&R.tspan.setAttributeNS(null,"fill",R.fillColor),R.fillAlpha<1&&R.tspan.setAttributeNS(null,"fill-opacity",R.fillAlpha)):R.textRenderingMode===i.TextRenderingMode.ADD_TO_PATH?R.tspan.setAttributeNS(null,"fill","transparent"):R.tspan.setAttributeNS(null,"fill","none"),D===i.TextRenderingMode.STROKE||D===i.TextRenderingMode.FILL_STROKE){const ee=1/(R.textMatrixScale||1);this._setStrokeAttributes(R.tspan,ee)}let q=R.textMatrix;R.textRise!==0&&(q=q.slice(),q[5]+=R.textRise),R.txtElement.setAttributeNS(null,"transform",`${_(q)} scale(${b(O)}, -1)`),R.txtElement.setAttributeNS(o,"xml:space","preserve"),R.txtElement.append(R.tspan),R.txtgrp.append(R.txtElement),this._ensureTransformGroup().append(R.txtElement)}setLeadingMoveText(g,R){this.setLeading(-R),this.moveText(g,R)}addFontStyle(g){if(!g.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const R=u(g.data,g.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${g.loadedName}"; src: url(${R}); }
`}setFont(g){const R=this.current,E=this.commonObjs.get(g[0]);let C=g[1];R.font=E,this.embedFonts&&!E.missingFile&&!this.embeddedFonts[E.loadedName]&&(this.addFontStyle(E),this.embeddedFonts[E.loadedName]=E),R.fontMatrix=E.fontMatrix||i.FONT_IDENTITY_MATRIX;let j="normal";E.black?j="900":E.bold&&(j="bold");const z=E.italic?"italic":"normal";C<0?(C=-C,R.fontDirection=-1):R.fontDirection=1,R.fontSize=C,R.fontFamily=E.loadedName,R.fontWeight=j,R.fontStyle=z,R.tspan=this.svgFactory.createElement("svg:tspan"),R.tspan.setAttributeNS(null,"y",b(-R.y)),R.xcoords=[],R.ycoords=[]}endText(){var R;const g=this.current;g.textRenderingMode&i.TextRenderingMode.ADD_TO_PATH_FLAG&&((R=g.txtElement)!=null&&R.hasChildNodes())&&(g.element=g.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(g){g>0&&(this.current.lineWidth=g)}setLineCap(g){this.current.lineCap=S[g]}setLineJoin(g){this.current.lineJoin=y[g]}setMiterLimit(g){this.current.miterLimit=g}setStrokeAlpha(g){this.current.strokeAlpha=g}setStrokeRGBColor(g,R,E){this.current.strokeColor=i.Util.makeHexColor(g,R,E)}setFillAlpha(g){this.current.fillAlpha=g}setFillRGBColor(g,R,E){this.current.fillColor=i.Util.makeHexColor(g,R,E),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(g){this.current.strokeColor=this._makeColorN_Pattern(g)}setFillColorN(g){this.current.fillColor=this._makeColorN_Pattern(g)}shadingFill(g){const{width:R,height:E}=this.viewport,C=i.Util.inverseTransform(this.transformMatrix),[j,z,v,T]=i.Util.getAxialAlignedBoundingBox([0,0,R,E],C),O=this.svgFactory.createElement("svg:rect");O.setAttributeNS(null,"x",j),O.setAttributeNS(null,"y",z),O.setAttributeNS(null,"width",v-j),O.setAttributeNS(null,"height",T-z),O.setAttributeNS(null,"fill",this._makeShadingPattern(g)),this.current.fillAlpha<1&&O.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(O)}_makeColorN_Pattern(g){return g[0]==="TilingPattern"?this._makeTilingPattern(g):this._makeShadingPattern(g)}_makeTilingPattern(g){const R=g[1],E=g[2],C=g[3]||i.IDENTITY_MATRIX,[j,z,v,T]=g[4],O=g[5],se=g[6],V=g[7],Q=`shading${A++}`,[K,ue,D,q]=i.Util.normalizeRect([...i.Util.applyTransform([j,z],C),...i.Util.applyTransform([v,T],C)]),[ee,F]=i.Util.singularValueDecompose2dScale(C),d=O*ee,x=se*F,N=this.svgFactory.createElement("svg:pattern");N.setAttributeNS(null,"id",Q),N.setAttributeNS(null,"patternUnits","userSpaceOnUse"),N.setAttributeNS(null,"width",d),N.setAttributeNS(null,"height",x),N.setAttributeNS(null,"x",`${K}`),N.setAttributeNS(null,"y",`${ue}`);const B=this.svg,G=this.transformMatrix,W=this.current.fillColor,Y=this.current.strokeColor,ce=this.svgFactory.create(D-K,q-ue);if(this.svg=ce,this.transformMatrix=C,V===2){const me=i.Util.makeHexColor(...R);this.current.fillColor=me,this.current.strokeColor=me}return this.executeOpTree(this.convertOpList(E)),this.svg=B,this.transformMatrix=G,this.current.fillColor=W,this.current.strokeColor=Y,N.append(ce.childNodes[0]),this.defs.append(N),`url(#${Q})`}_makeShadingPattern(g){switch(typeof g=="string"&&(g=this.objs.get(g)),g[0]){case"RadialAxial":const R=`shading${A++}`,E=g[3];let C;switch(g[1]){case"axial":const j=g[4],z=g[5];C=this.svgFactory.createElement("svg:linearGradient"),C.setAttributeNS(null,"id",R),C.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),C.setAttributeNS(null,"x1",j[0]),C.setAttributeNS(null,"y1",j[1]),C.setAttributeNS(null,"x2",z[0]),C.setAttributeNS(null,"y2",z[1]);break;case"radial":const v=g[4],T=g[5],O=g[6],se=g[7];C=this.svgFactory.createElement("svg:radialGradient"),C.setAttributeNS(null,"id",R),C.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),C.setAttributeNS(null,"cx",T[0]),C.setAttributeNS(null,"cy",T[1]),C.setAttributeNS(null,"r",se),C.setAttributeNS(null,"fx",v[0]),C.setAttributeNS(null,"fy",v[1]),C.setAttributeNS(null,"fr",O);break;default:throw new Error(`Unknown RadialAxial type: ${g[1]}`)}for(const j of E){const z=this.svgFactory.createElement("svg:stop");z.setAttributeNS(null,"offset",j[0]),z.setAttributeNS(null,"stop-color",j[1]),C.append(z)}return this.defs.append(C),`url(#${R})`;case"Mesh":return(0,i.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${g[0]}`)}}setDash(g,R){this.current.dashArray=g,this.current.dashPhase=R}constructPath(g,R){const E=this.current;let C=E.x,j=E.y,z=[],v=0;for(const T of g)switch(T|0){case i.OPS.rectangle:C=R[v++],j=R[v++];const O=R[v++],se=R[v++],V=C+O,Q=j+se;z.push("M",b(C),b(j),"L",b(V),b(j),"L",b(V),b(Q),"L",b(C),b(Q),"Z");break;case i.OPS.moveTo:C=R[v++],j=R[v++],z.push("M",b(C),b(j));break;case i.OPS.lineTo:C=R[v++],j=R[v++],z.push("L",b(C),b(j));break;case i.OPS.curveTo:C=R[v+4],j=R[v+5],z.push("C",b(R[v]),b(R[v+1]),b(R[v+2]),b(R[v+3]),b(C),b(j)),v+=6;break;case i.OPS.curveTo2:z.push("C",b(C),b(j),b(R[v]),b(R[v+1]),b(R[v+2]),b(R[v+3])),C=R[v+2],j=R[v+3],v+=4;break;case i.OPS.curveTo3:C=R[v+2],j=R[v+3],z.push("C",b(R[v]),b(R[v+1]),b(C),b(j),b(C),b(j)),v+=4;break;case i.OPS.closePath:z.push("Z");break}z=z.join(" "),E.path&&g.length>0&&g[0]!==i.OPS.rectangle&&g[0]!==i.OPS.moveTo?z=E.path.getAttributeNS(null,"d")+z:(E.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(E.path)),E.path.setAttributeNS(null,"d",z),E.path.setAttributeNS(null,"fill","none"),E.element=E.path,E.setCurrentPoint(C,j)}endPath(){const g=this.current;if(g.path=null,!this.pendingClip)return;if(!g.element){this.pendingClip=null;return}const R=`clippath${f++}`,E=this.svgFactory.createElement("svg:clipPath");E.setAttributeNS(null,"id",R),E.setAttributeNS(null,"transform",_(this.transformMatrix));const C=g.element.cloneNode(!0);if(this.pendingClip==="evenodd"?C.setAttributeNS(null,"clip-rule","evenodd"):C.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,E.append(C),this.defs.append(E),g.activeClipUrl){g.clipGroup=null;for(const j of this.extraStack)j.clipGroup=null;E.setAttributeNS(null,"clip-path",g.activeClipUrl)}g.activeClipUrl=`url(#${R})`,this.tgrp=null}clip(g){this.pendingClip=g}closePath(){const g=this.current;if(g.path){const R=`${g.path.getAttributeNS(null,"d")}Z`;g.path.setAttributeNS(null,"d",R)}}setLeading(g){this.current.leading=-g}setTextRise(g){this.current.textRise=g}setTextRenderingMode(g){this.current.textRenderingMode=g}setHScale(g){this.current.textHScale=g/100}setRenderingIntent(g){}setFlatness(g){}setGState(g){for(const[R,E]of g)switch(R){case"LW":this.setLineWidth(E);break;case"LC":this.setLineCap(E);break;case"LJ":this.setLineJoin(E);break;case"ML":this.setMiterLimit(E);break;case"D":this.setDash(E[0],E[1]);break;case"RI":this.setRenderingIntent(E);break;case"FL":this.setFlatness(E);break;case"Font":this.setFont(E);break;case"CA":this.setStrokeAlpha(E);break;case"ca":this.setFillAlpha(E);break;default:(0,i.warn)(`Unimplemented graphic state operator ${R}`);break}}fill(){const g=this.current;g.element&&(g.element.setAttributeNS(null,"fill",g.fillColor),g.element.setAttributeNS(null,"fill-opacity",g.fillAlpha),this.endPath())}stroke(){const g=this.current;g.element&&(this._setStrokeAttributes(g.element),g.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(g,R=1){const E=this.current;let C=E.dashArray;R!==1&&C.length>0&&(C=C.map(function(j){return R*j})),g.setAttributeNS(null,"stroke",E.strokeColor),g.setAttributeNS(null,"stroke-opacity",E.strokeAlpha),g.setAttributeNS(null,"stroke-miterlimit",b(E.miterLimit)),g.setAttributeNS(null,"stroke-linecap",E.lineCap),g.setAttributeNS(null,"stroke-linejoin",E.lineJoin),g.setAttributeNS(null,"stroke-width",b(R*E.lineWidth)+"px"),g.setAttributeNS(null,"stroke-dasharray",C.map(b).join(" ")),g.setAttributeNS(null,"stroke-dashoffset",b(R*E.dashPhase)+"px")}eoFill(){var g;(g=this.current.element)==null||g.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var g;(g=this.current.element)==null||g.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const g=this.svgFactory.createElement("svg:rect");g.setAttributeNS(null,"x","0"),g.setAttributeNS(null,"y","0"),g.setAttributeNS(null,"width","1px"),g.setAttributeNS(null,"height","1px"),g.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(g)}paintImageXObject(g){const R=this.getObject(g);if(!R){(0,i.warn)(`Dependent image with object ID ${g} is not ready yet`);return}this.paintInlineImageXObject(R)}paintInlineImageXObject(g,R){const E=g.width,C=g.height,j=h(g,this.forceDataSchema,!!R),z=this.svgFactory.createElement("svg:rect");z.setAttributeNS(null,"x","0"),z.setAttributeNS(null,"y","0"),z.setAttributeNS(null,"width",b(E)),z.setAttributeNS(null,"height",b(C)),this.current.element=z,this.clip("nonzero");const v=this.svgFactory.createElement("svg:image");v.setAttributeNS(w,"xlink:href",j),v.setAttributeNS(null,"x","0"),v.setAttributeNS(null,"y",b(-C)),v.setAttributeNS(null,"width",b(E)+"px"),v.setAttributeNS(null,"height",b(C)+"px"),v.setAttributeNS(null,"transform",`scale(${b(1/E)} ${b(-1/C)})`),R?R.append(v):this._ensureTransformGroup().append(v)}paintImageMaskXObject(g){const R=this.getObject(g.data,g);if(R.bitmap){(0,i.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const E=this.current,C=R.width,j=R.height,z=E.fillColor;E.maskId=`mask${p++}`;const v=this.svgFactory.createElement("svg:mask");v.setAttributeNS(null,"id",E.maskId);const T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x","0"),T.setAttributeNS(null,"y","0"),T.setAttributeNS(null,"width",b(C)),T.setAttributeNS(null,"height",b(j)),T.setAttributeNS(null,"fill",z),T.setAttributeNS(null,"mask",`url(#${E.maskId})`),this.defs.append(v),this._ensureTransformGroup().append(T),this.paintInlineImageXObject(R,v)}paintFormXObjectBegin(g,R){if(Array.isArray(g)&&g.length===6&&this.transform(g[0],g[1],g[2],g[3],g[4],g[5]),R){const E=R[2]-R[0],C=R[3]-R[1],j=this.svgFactory.createElement("svg:rect");j.setAttributeNS(null,"x",R[0]),j.setAttributeNS(null,"y",R[1]),j.setAttributeNS(null,"width",b(E)),j.setAttributeNS(null,"height",b(C)),this.current.element=j,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(g){const R=this.svgFactory.create(g.width,g.height),E=this.svgFactory.createElement("svg:defs");R.append(E),this.defs=E;const C=this.svgFactory.createElement("svg:g");return C.setAttributeNS(null,"transform",_(g.transform)),R.append(C),this.svg=C,R}_ensureClipGroup(){if(!this.current.clipGroup){const g=this.svgFactory.createElement("svg:g");g.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(g),this.current.clipGroup=g}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",_(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=k},(r,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class s{static textContent(i){const a=[],o={items:a,styles:Object.create(null)};function w(S){var h;if(!S)return;let y=null;const u=S.name;if(u==="#text")y=S.value;else if(s.shouldBuildText(u))(h=S==null?void 0:S.attributes)!=null&&h.textContent?y=S.attributes.textContent:S.value&&(y=S.value);else return;if(y!==null&&a.push({str:y}),!!S.children)for(const l of S.children)w(l)}return w(i),o}static shouldBuildText(i){return!(i==="textarea"||i==="input"||i==="option"||i==="select")}}e.XfaText=s},(r,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=_,e.updateTextLayer=f;var t=s(1),i=s(6);const a=1e5,o=30,w=.8,S=new Map;function y(p,A){let k;if(A&&t.FeatureTest.isOffscreenCanvasSupported)k=new OffscreenCanvas(p,p).getContext("2d",{alpha:!1});else{const P=document.createElement("canvas");P.width=P.height=p,k=P.getContext("2d",{alpha:!1})}return k}function u(p,A){const k=S.get(p);if(k)return k;const P=y(o,A);P.font=`${o}px ${p}`;const g=P.measureText("");let R=g.fontBoundingBoxAscent,E=Math.abs(g.fontBoundingBoxDescent);if(R){const j=R/(R+E);return S.set(p,j),P.canvas.width=P.canvas.height=0,j}P.strokeStyle="red",P.clearRect(0,0,o,o),P.strokeText("g",0,0);let C=P.getImageData(0,0,o,o).data;E=0;for(let j=C.length-1-3;j>=0;j-=4)if(C[j]>0){E=Math.ceil(j/4/o);break}P.clearRect(0,0,o,o),P.strokeText("A",0,o),C=P.getImageData(0,0,o,o).data,R=0;for(let j=0,z=C.length;j<z;j+=4)if(C[j]>0){R=o-Math.floor(j/4/o);break}if(P.canvas.width=P.canvas.height=0,R){const j=R/(R+E);return S.set(p,j),j}return S.set(p,w),w}function h(p,A,k){const P=document.createElement("span"),g={angle:0,canvasWidth:0,hasText:A.str!=="",hasEOL:A.hasEOL,fontSize:0};p._textDivs.push(P);const R=t.Util.transform(p._transform,A.transform);let E=Math.atan2(R[1],R[0]);const C=k[A.fontName];C.vertical&&(E+=Math.PI/2);const j=Math.hypot(R[2],R[3]),z=j*u(C.fontFamily,p._isOffscreenCanvasSupported);let v,T;E===0?(v=R[4],T=R[5]-z):(v=R[4]+z*Math.sin(E),T=R[5]-z*Math.cos(E));const O="calc(var(--scale-factor)*",se=P.style;p._container===p._rootContainer?(se.left=`${(100*v/p._pageWidth).toFixed(2)}%`,se.top=`${(100*T/p._pageHeight).toFixed(2)}%`):(se.left=`${O}${v.toFixed(2)}px)`,se.top=`${O}${T.toFixed(2)}px)`),se.fontSize=`${O}${j.toFixed(2)}px)`,se.fontFamily=C.fontFamily,g.fontSize=j,P.setAttribute("role","presentation"),P.textContent=A.str,P.dir=A.dir,p._fontInspectorEnabled&&(P.dataset.fontName=A.fontName),E!==0&&(g.angle=E*(180/Math.PI));let V=!1;if(A.str.length>1)V=!0;else if(A.str!==" "&&A.transform[0]!==A.transform[3]){const Q=Math.abs(A.transform[0]),K=Math.abs(A.transform[3]);Q!==K&&Math.max(Q,K)/Math.min(Q,K)>1.5&&(V=!0)}V&&(g.canvasWidth=C.vertical?A.height:A.width),p._textDivProperties.set(P,g),p._isReadableStream&&p._layoutText(P)}function l(p){const{div:A,scale:k,properties:P,ctx:g,prevFontSize:R,prevFontFamily:E}=p,{style:C}=A;let j="";if(P.canvasWidth!==0&&P.hasText){const{fontFamily:z}=C,{canvasWidth:v,fontSize:T}=P;(R!==T||E!==z)&&(g.font=`${T*k}px ${z}`,p.prevFontSize=T,p.prevFontFamily=z);const{width:O}=g.measureText(A.textContent);O>0&&(j=`scaleX(${v*k/O})`)}P.angle!==0&&(j=`rotate(${P.angle}deg) ${j}`),j.length>0&&(C.transform=j)}function c(p){if(p._canceled)return;const A=p._textDivs,k=p._capability;if(A.length>a){k.resolve();return}if(!p._isReadableStream)for(const g of A)p._layoutText(g);k.resolve()}class b{constructor({textContentSource:A,container:k,viewport:P,textDivs:g,textDivProperties:R,textContentItemsStr:E,isOffscreenCanvasSupported:C}){var O;this._textContentSource=A,this._isReadableStream=A instanceof ReadableStream,this._container=this._rootContainer=k,this._textDivs=g||[],this._textContentItemsStr=E||[],this._isOffscreenCanvasSupported=C,this._fontInspectorEnabled=!!((O=globalThis.FontInspector)!=null&&O.enabled),this._reader=null,this._textDivProperties=R||new WeakMap,this._canceled=!1,this._capability=new t.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:P.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:y(0,C)};const{pageWidth:j,pageHeight:z,pageX:v,pageY:T}=P.rawDims;this._transform=[1,0,0,-1,-v,T+z],this._pageWidth=j,this._pageHeight=z,(0,i.setLayerDimensions)(k,P),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new t.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new t.AbortException("TextLayer task cancelled."))}_processItems(A,k){for(const P of A){if(P.str===void 0){if(P.type==="beginMarkedContentProps"||P.type==="beginMarkedContent"){const g=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),P.id!==null&&this._container.setAttribute("id",`${P.id}`),g.append(this._container)}else P.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(P.str),h(this,P,k)}}_layoutText(A){const k=this._layoutTextParams.properties=this._textDivProperties.get(A);if(this._layoutTextParams.div=A,l(this._layoutTextParams),k.hasText&&this._container.append(A),k.hasEOL){const P=document.createElement("br");P.setAttribute("role","presentation"),this._container.append(P)}}_render(){const A=new t.PromiseCapability;let k=Object.create(null);if(this._isReadableStream){const P=()=>{this._reader.read().then(({value:g,done:R})=>{if(R){A.resolve();return}Object.assign(k,g.styles),this._processItems(g.items,k),P()},A.reject)};this._reader=this._textContentSource.getReader(),P()}else if(this._textContentSource){const{items:P,styles:g}=this._textContentSource;this._processItems(P,g),A.resolve()}else throw new Error('No "textContentSource" parameter specified.');A.promise.then(()=>{k=null,c(this)},this._capability.reject)}}e.TextLayerRenderTask=b;function _(p){!p.textContentSource&&(p.textContent||p.textContentStream)&&((0,i.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),p.textContentSource=p.textContent||p.textContentStream);const{container:A,viewport:k}=p,P=getComputedStyle(A),g=P.getPropertyValue("visibility"),R=parseFloat(P.getPropertyValue("--scale-factor"));g==="visible"&&(!R||Math.abs(R-k.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const E=new b(p);return E._render(),E}function f({container:p,viewport:A,textDivs:k,textDivProperties:P,isOffscreenCanvasSupported:g,mustRotate:R=!0,mustRescale:E=!0}){if(R&&(0,i.setLayerDimensions)(p,{rotation:A.rotation}),E){const C=y(0,g),z={prevFontSize:null,prevFontFamily:null,div:null,scale:A.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:C};for(const v of k)z.properties=P.get(v),z.div=v,l(z)}}},(r,e,s)=>{var u,h,l,c,b,_,f,p,A,k,P,Zt,_t,Qt,es;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var t=s(1),i=s(4),a=s(28),o=s(33),w=s(6),S=s(34);const j=class j{constructor({uiManager:v,pageIndex:T,div:O,accessibilityManager:se,annotationLayer:V,viewport:Q,l10n:K}){ne(this,P);ne(this,u);ne(this,h,!1);ne(this,l,null);ne(this,c,this.pointerup.bind(this));ne(this,b,this.pointerdown.bind(this));ne(this,_,new Map);ne(this,f,!1);ne(this,p,!1);ne(this,A,!1);ne(this,k);const ue=[a.FreeTextEditor,o.InkEditor,S.StampEditor];if(!j._initialized){j._initialized=!0;for(const D of ue)D.initialize(K)}v.registerEditorTypes(ue),le(this,k,v),this.pageIndex=T,this.div=O,le(this,u,se),le(this,l,V),this.viewport=Q,n(this,k).addLayer(this)}get isEmpty(){return n(this,_).size===0}updateToolbar(v){n(this,k).updateToolbar(v)}updateMode(v=n(this,k).getMode()){J(this,P,es).call(this),v===t.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),v!==t.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",v===t.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",v===t.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",v===t.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(v){if(!v&&n(this,k).getMode()!==t.AnnotationEditorType.INK)return;if(!v){for(const O of n(this,_).values())if(O.isEmpty()){O.setInBackground();return}}J(this,P,_t).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(v){n(this,k).setEditingState(v)}addCommands(v){n(this,k).addCommands(v)}enable(){this.div.style.pointerEvents="auto";const v=new Set;for(const O of n(this,_).values())O.enableEditing(),O.annotationElementId&&v.add(O.annotationElementId);if(!n(this,l))return;const T=n(this,l).getEditableAnnotations();for(const O of T){if(O.hide(),n(this,k).isDeletedAnnotationElement(O.data.id)||v.has(O.data.id))continue;const se=this.deserialize(O);se&&(this.addOrRebuild(se),se.enableEditing())}}disable(){var T;le(this,A,!0),this.div.style.pointerEvents="none";const v=new Set;for(const O of n(this,_).values()){if(O.disableEditing(),!O.annotationElementId||O.serialize()!==null){v.add(O.annotationElementId);continue}(T=this.getEditableAnnotation(O.annotationElementId))==null||T.show(),O.remove()}if(n(this,l)){const O=n(this,l).getEditableAnnotations();for(const se of O){const{id:V}=se.data;v.has(V)||n(this,k).isDeletedAnnotationElement(V)||se.show()}}J(this,P,es).call(this),this.isEmpty&&(this.div.hidden=!0),le(this,A,!1)}getEditableAnnotation(v){var T;return((T=n(this,l))==null?void 0:T.getEditableAnnotation(v))||null}setActiveEditor(v){n(this,k).getActive()!==v&&n(this,k).setActiveEditor(v)}enableClick(){this.div.addEventListener("pointerdown",n(this,b)),this.div.addEventListener("pointerup",n(this,c))}disableClick(){this.div.removeEventListener("pointerdown",n(this,b)),this.div.removeEventListener("pointerup",n(this,c))}attach(v){n(this,_).set(v.id,v);const{annotationElementId:T}=v;T&&n(this,k).isDeletedAnnotationElement(T)&&n(this,k).removeDeletedAnnotationElement(v)}detach(v){var T;n(this,_).delete(v.id),(T=n(this,u))==null||T.removePointerInTextLayer(v.contentDiv),!n(this,A)&&v.annotationElementId&&n(this,k).addDeletedAnnotationElement(v)}remove(v){this.detach(v),n(this,k).removeEditor(v),v.div.contains(document.activeElement)&&setTimeout(()=>{n(this,k).focusMainContainer()},0),v.div.remove(),v.isAttachedToDOM=!1,n(this,p)||this.addInkEditorIfNeeded(!1)}changeParent(v){var T;v.parent!==this&&(v.annotationElementId&&(n(this,k).addDeletedAnnotationElement(v.annotationElementId),i.AnnotationEditor.deleteAnnotationElement(v),v.annotationElementId=null),this.attach(v),(T=v.parent)==null||T.detach(v),v.setParent(this),v.div&&v.isAttachedToDOM&&(v.div.remove(),this.div.append(v.div)))}add(v){if(this.changeParent(v),n(this,k).addEditor(v),this.attach(v),!v.isAttachedToDOM){const T=v.render();this.div.append(T),v.isAttachedToDOM=!0}v.fixAndSetPosition(),v.onceAdded(),n(this,k).addToAnnotationStorage(v)}moveEditorInDOM(v){var O;if(!v.isAttachedToDOM)return;const{activeElement:T}=document;v.div.contains(T)&&(v._focusEventsAllowed=!1,setTimeout(()=>{v.div.contains(document.activeElement)?v._focusEventsAllowed=!0:(v.div.addEventListener("focusin",()=>{v._focusEventsAllowed=!0},{once:!0}),T.focus())},0)),v._structTreeParentId=(O=n(this,u))==null?void 0:O.moveElementInDOM(this.div,v.div,v.contentDiv,!0)}addOrRebuild(v){v.needsToBeRebuilt()?v.rebuild():this.add(v)}addUndoableEditor(v){const T=()=>v._uiManager.rebuild(v),O=()=>{v.remove()};this.addCommands({cmd:T,undo:O,mustExec:!1})}getNextId(){return n(this,k).getId()}pasteEditor(v,T){n(this,k).updateToolbar(v),n(this,k).updateMode(v);const{offsetX:O,offsetY:se}=J(this,P,Qt).call(this),V=this.getNextId(),Q=J(this,P,Zt).call(this,{parent:this,id:V,x:O,y:se,uiManager:n(this,k),isCentered:!0,...T});Q&&this.add(Q)}deserialize(v){switch(v.annotationType??v.annotationEditorType){case t.AnnotationEditorType.FREETEXT:return a.FreeTextEditor.deserialize(v,this,n(this,k));case t.AnnotationEditorType.INK:return o.InkEditor.deserialize(v,this,n(this,k));case t.AnnotationEditorType.STAMP:return S.StampEditor.deserialize(v,this,n(this,k))}return null}addNewEditor(){J(this,P,_t).call(this,J(this,P,Qt).call(this),!0)}setSelected(v){n(this,k).setSelected(v)}toggleSelected(v){n(this,k).toggleSelected(v)}isSelected(v){return n(this,k).isSelected(v)}unselect(v){n(this,k).unselect(v)}pointerup(v){const{isMac:T}=t.FeatureTest.platform;if(!(v.button!==0||v.ctrlKey&&T)&&v.target===this.div&&n(this,f)){if(le(this,f,!1),!n(this,h)){le(this,h,!0);return}if(n(this,k).getMode()===t.AnnotationEditorType.STAMP){n(this,k).unselectAll();return}J(this,P,_t).call(this,v,!1)}}pointerdown(v){if(n(this,f)){le(this,f,!1);return}const{isMac:T}=t.FeatureTest.platform;if(v.button!==0||v.ctrlKey&&T||v.target!==this.div)return;le(this,f,!0);const O=n(this,k).getActive();le(this,h,!O||O.isEmpty())}findNewParent(v,T,O){const se=n(this,k).findParent(T,O);return se===null||se===this?!1:(se.changeParent(v),!0)}destroy(){var v,T;((v=n(this,k).getActive())==null?void 0:v.parent)===this&&(n(this,k).commitOrRemove(),n(this,k).setActiveEditor(null));for(const O of n(this,_).values())(T=n(this,u))==null||T.removePointerInTextLayer(O.contentDiv),O.setParent(null),O.isAttachedToDOM=!1,O.div.remove();this.div=null,n(this,_).clear(),n(this,k).removeLayer(this)}render({viewport:v}){this.viewport=v,(0,w.setLayerDimensions)(this.div,v);for(const T of n(this,k).getEditors(this.pageIndex))this.add(T);this.updateMode()}update({viewport:v}){n(this,k).commitOrRemove(),this.viewport=v,(0,w.setLayerDimensions)(this.div,{rotation:v.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:v,pageHeight:T}=this.viewport.rawDims;return[v,T]}};u=new WeakMap,h=new WeakMap,l=new WeakMap,c=new WeakMap,b=new WeakMap,_=new WeakMap,f=new WeakMap,p=new WeakMap,A=new WeakMap,k=new WeakMap,P=new WeakSet,Zt=function(v){switch(n(this,k).getMode()){case t.AnnotationEditorType.FREETEXT:return new a.FreeTextEditor(v);case t.AnnotationEditorType.INK:return new o.InkEditor(v);case t.AnnotationEditorType.STAMP:return new S.StampEditor(v)}return null},_t=function(v,T){const O=this.getNextId(),se=J(this,P,Zt).call(this,{parent:this,id:O,x:v.offsetX,y:v.offsetY,uiManager:n(this,k),isCentered:T});return se&&this.add(se),se},Qt=function(){const{x:v,y:T,width:O,height:se}=this.div.getBoundingClientRect(),V=Math.max(0,v),Q=Math.max(0,T),K=Math.min(window.innerWidth,v+O),ue=Math.min(window.innerHeight,T+se),D=(V+K)/2-v,q=(Q+ue)/2-T,[ee,F]=this.viewport.rotation%180===0?[D,q]:[q,D];return{offsetX:ee,offsetY:F}},es=function(){le(this,p,!0);for(const v of n(this,_).values())v.isEmpty()&&v.remove();le(this,p,!1)},Je(j,"_initialized",!1);let y=j;e.AnnotationEditorLayer=y},(r,e,s)=>{var S,y,u,h,l,c,b,_,f,p,ws,Ns,Ps,gt,ts,Ms,ss;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var t=s(1),i=s(5),a=s(4),o=s(29);const j=class j extends a.AnnotationEditor{constructor(T){super({...T,name:"freeTextEditor"});ne(this,p);ne(this,S,this.editorDivBlur.bind(this));ne(this,y,this.editorDivFocus.bind(this));ne(this,u,this.editorDivInput.bind(this));ne(this,h,this.editorDivKeydown.bind(this));ne(this,l);ne(this,c,"");ne(this,b,`${this.id}-editor`);ne(this,_);ne(this,f,null);le(this,l,T.color||j._defaultColor||a.AnnotationEditor._defaultLineColor),le(this,_,T.fontSize||j._defaultFontSize)}static get _keyboardManager(){const T=j.prototype,O=Q=>Q.isEmpty(),se=i.AnnotationEditorUIManager.TRANSLATE_SMALL,V=i.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,t.shadow)(this,"_keyboardManager",new i.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],T.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],T.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],T._translateEmpty,{args:[-se,0],checker:O}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],T._translateEmpty,{args:[-V,0],checker:O}],[["ArrowRight","mac+ArrowRight"],T._translateEmpty,{args:[se,0],checker:O}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],T._translateEmpty,{args:[V,0],checker:O}],[["ArrowUp","mac+ArrowUp"],T._translateEmpty,{args:[0,-se],checker:O}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],T._translateEmpty,{args:[0,-V],checker:O}],[["ArrowDown","mac+ArrowDown"],T._translateEmpty,{args:[0,se],checker:O}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],T._translateEmpty,{args:[0,V],checker:O}]]))}static initialize(T){a.AnnotationEditor.initialize(T,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const O=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(O.getPropertyValue("--freetext-padding"))}static updateDefaultParams(T,O){switch(T){case t.AnnotationEditorParamsType.FREETEXT_SIZE:j._defaultFontSize=O;break;case t.AnnotationEditorParamsType.FREETEXT_COLOR:j._defaultColor=O;break}}updateParams(T,O){switch(T){case t.AnnotationEditorParamsType.FREETEXT_SIZE:J(this,p,ws).call(this,O);break;case t.AnnotationEditorParamsType.FREETEXT_COLOR:J(this,p,Ns).call(this,O);break}}static get defaultPropertiesToUpdate(){return[[t.AnnotationEditorParamsType.FREETEXT_SIZE,j._defaultFontSize],[t.AnnotationEditorParamsType.FREETEXT_COLOR,j._defaultColor||a.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[t.AnnotationEditorParamsType.FREETEXT_SIZE,n(this,_)],[t.AnnotationEditorParamsType.FREETEXT_COLOR,n(this,l)]]}_translateEmpty(T,O){this._uiManager.translateSelectedEditors(T,O,!0)}getInitialTranslation(){const T=this.parentScale;return[-j._internalPadding*T,-(j._internalPadding+n(this,_))*T]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(t.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",n(this,h)),this.editorDiv.addEventListener("focus",n(this,y)),this.editorDiv.addEventListener("blur",n(this,S)),this.editorDiv.addEventListener("input",n(this,u)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",n(this,b)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",n(this,h)),this.editorDiv.removeEventListener("focus",n(this,y)),this.editorDiv.removeEventListener("blur",n(this,S)),this.editorDiv.removeEventListener("input",n(this,u)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(T){this._focusEventsAllowed&&(super.focusin(T),T.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var T;if(this.width){J(this,p,ss).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(T=this._initialOptions)!=null&&T.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const T=n(this,c),O=le(this,c,J(this,p,Ps).call(this).trimEnd());if(T===O)return;const se=V=>{if(le(this,c,V),!V){this.remove();return}J(this,p,ts).call(this),this._uiManager.rebuild(this),J(this,p,gt).call(this)};this.addCommands({cmd:()=>{se(O)},undo:()=>{se(T)},mustExec:!1}),J(this,p,gt).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(T){this.enterInEditMode()}keydown(T){T.target===this.div&&T.key==="Enter"&&(this.enterInEditMode(),T.preventDefault())}editorDivKeydown(T){j._keyboardManager.exec(this,T)}editorDivFocus(T){this.isEditing=!0}editorDivBlur(T){this.isEditing=!1}editorDivInput(T){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let T,O;this.width&&(T=this.x,O=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",n(this,b)),this.enableEditing(),a.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(V=>{var Q;return(Q=this.editorDiv)==null?void 0:Q.setAttribute("aria-label",V)}),a.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(V=>{var Q;return(Q=this.editorDiv)==null?void 0:Q.setAttribute("default-content",V)}),this.editorDiv.contentEditable=!0;const{style:se}=this.editorDiv;if(se.fontSize=`calc(${n(this,_)}px * var(--scale-factor))`,se.color=n(this,l),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,i.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[V,Q]=this.parentDimensions;if(this.annotationElementId){const{position:K}=n(this,f);let[ue,D]=this.getInitialTranslation();[ue,D]=this.pageTranslationToScreen(ue,D);const[q,ee]=this.pageDimensions,[F,d]=this.pageTranslation;let x,N;switch(this.rotation){case 0:x=T+(K[0]-F)/q,N=O+this.height-(K[1]-d)/ee;break;case 90:x=T+(K[0]-F)/q,N=O-(K[1]-d)/ee,[ue,D]=[D,-ue];break;case 180:x=T-this.width+(K[0]-F)/q,N=O-(K[1]-d)/ee,[ue,D]=[-ue,-D];break;case 270:x=T+(K[0]-F-this.height*ee)/q,N=O+(K[1]-d-this.width*q)/ee,[ue,D]=[-D,ue];break}this.setAt(x*V,N*Q,ue,D)}else this.setAt(T*V,O*Q,this.width*V,this.height*Q);J(this,p,ts).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(T,O,se){let V=null;if(T instanceof o.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:K,fontColor:ue},rect:D,rotation:q,id:ee},textContent:F,textPosition:d,parent:{page:{pageNumber:x}}}=T;if(!F||F.length===0)return null;V=T={annotationType:t.AnnotationEditorType.FREETEXT,color:Array.from(ue),fontSize:K,value:F.join(`
`),position:d,pageIndex:x-1,rect:D,rotation:q,id:ee,deleted:!1}}const Q=super.deserialize(T,O,se);return le(Q,_,T.fontSize),le(Q,l,t.Util.makeHexColor(...T.color)),le(Q,c,T.value),Q.annotationElementId=T.id||null,le(Q,f,V),Q}serialize(T=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const O=j._internalPadding*this.parentScale,se=this.getRect(O,O),V=a.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:n(this,l)),Q={annotationType:t.AnnotationEditorType.FREETEXT,color:V,fontSize:n(this,_),value:n(this,c),pageIndex:this.pageIndex,rect:se,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return T?Q:this.annotationElementId&&!J(this,p,Ms).call(this,Q)?null:(Q.id=this.annotationElementId,Q)}};S=new WeakMap,y=new WeakMap,u=new WeakMap,h=new WeakMap,l=new WeakMap,c=new WeakMap,b=new WeakMap,_=new WeakMap,f=new WeakMap,p=new WeakSet,ws=function(T){const O=V=>{this.editorDiv.style.fontSize=`calc(${V}px * var(--scale-factor))`,this.translate(0,-(V-n(this,_))*this.parentScale),le(this,_,V),J(this,p,gt).call(this)},se=n(this,_);this.addCommands({cmd:()=>{O(T)},undo:()=>{O(se)},mustExec:!0,type:t.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Ns=function(T){const O=n(this,l);this.addCommands({cmd:()=>{le(this,l,this.editorDiv.style.color=T)},undo:()=>{le(this,l,this.editorDiv.style.color=O)},mustExec:!0,type:t.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ps=function(){const T=this.editorDiv.getElementsByTagName("div");if(T.length===0)return this.editorDiv.innerText;const O=[];for(const se of T)O.push(se.innerText.replace(/\r\n?|\n/,""));return O.join(`
`)},gt=function(){const[T,O]=this.parentDimensions;let se;if(this.isAttachedToDOM)se=this.div.getBoundingClientRect();else{const{currentLayer:V,div:Q}=this,K=Q.style.display;Q.style.display="hidden",V.div.append(this.div),se=Q.getBoundingClientRect(),Q.remove(),Q.style.display=K}this.rotation%180===this.parentRotation%180?(this.width=se.width/T,this.height=se.height/O):(this.width=se.height/T,this.height=se.width/O),this.fixAndSetPosition()},ts=function(){if(this.editorDiv.replaceChildren(),!!n(this,c))for(const T of n(this,c).split(`
`)){const O=document.createElement("div");O.append(T?document.createTextNode(T):document.createElement("br")),this.editorDiv.append(O)}},Ms=function(T){const{value:O,fontSize:se,color:V,rect:Q,pageIndex:K}=n(this,f);return T.value!==O||T.fontSize!==se||T.rect.some((ue,D)=>Math.abs(ue-Q[D])>=1)||T.color.some((ue,D)=>ue!==V[D])||T.pageIndex!==K},ss=function(T=!1){if(!this.annotationElementId)return;if(J(this,p,gt).call(this),!T&&(this.width===0||this.height===0)){setTimeout(()=>J(this,p,ss).call(this,!0),0);return}const O=j._internalPadding*this.parentScale;n(this,f).rect=this.getRect(O,O)},Je(j,"_freeTextDefaultContent",""),Je(j,"_internalPadding",0),Je(j,"_defaultColor",null),Je(j,"_defaultFontSize",10),Je(j,"_type","freetext");let w=j;e.FreeTextEditor=w},(r,e,s)=>{var N,G,at,ks,ce,me,xe,be,ye,Re,ie,ae,M,H,Z,re,fe,je,Ae,te,Te,_e,Fs,Ct,rs,ns,ze,Xe,Ye,Ee,oe,de,Pe,as,Ve,U,ge,Ce,Is,os;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var t=s(1),i=s(6),a=s(3),o=s(30),w=s(31),S=s(32);const y=1e3,u=9,h=new WeakSet;function l(Ne){return{width:Ne[2]-Ne[0],height:Ne[3]-Ne[1]}}class c{static create(L){switch(L.data.annotationType){case t.AnnotationType.LINK:return new _(L);case t.AnnotationType.TEXT:return new f(L);case t.AnnotationType.WIDGET:switch(L.data.fieldType){case"Tx":return new A(L);case"Btn":return L.data.radioButton?new g(L):L.data.checkBox?new P(L):new R(L);case"Ch":return new E(L);case"Sig":return new k(L)}return new p(L);case t.AnnotationType.POPUP:return new C(L);case t.AnnotationType.FREETEXT:return new z(L);case t.AnnotationType.LINE:return new v(L);case t.AnnotationType.SQUARE:return new T(L);case t.AnnotationType.CIRCLE:return new O(L);case t.AnnotationType.POLYLINE:return new se(L);case t.AnnotationType.CARET:return new Q(L);case t.AnnotationType.INK:return new K(L);case t.AnnotationType.POLYGON:return new V(L);case t.AnnotationType.HIGHLIGHT:return new ue(L);case t.AnnotationType.UNDERLINE:return new D(L);case t.AnnotationType.SQUIGGLY:return new q(L);case t.AnnotationType.STRIKEOUT:return new ee(L);case t.AnnotationType.STAMP:return new F(L);case t.AnnotationType.FILEATTACHMENT:return new d(L);default:return new b(L)}}}const B=class B{constructor(L,{isRenderable:I=!1,ignoreBorder:$=!1,createQuadrilaterals:he=!1}={}){ne(this,N,!1);this.isRenderable=I,this.data=L.data,this.layer=L.layer,this.linkService=L.linkService,this.downloadManager=L.downloadManager,this.imageResourcesPath=L.imageResourcesPath,this.renderForms=L.renderForms,this.svgFactory=L.svgFactory,this.annotationStorage=L.annotationStorage,this.enableScripting=L.enableScripting,this.hasJSActions=L.hasJSActions,this._fieldObjects=L.fieldObjects,this.parent=L.parent,I&&(this.container=this._createContainer($)),he&&this._createQuadrilaterals()}static _hasPopupData({titleObj:L,contentsObj:I,richText:$}){return!!(L!=null&&L.str||I!=null&&I.str||$!=null&&$.str)}get hasPopupData(){return B._hasPopupData(this.data)}_createContainer(L){const{data:I,parent:{page:$,viewport:he}}=this,pe=document.createElement("section");pe.setAttribute("data-annotation-id",I.id),this instanceof p||(pe.tabIndex=y),pe.style.zIndex=this.parent.zIndex++,this.data.popupRef&&pe.setAttribute("aria-haspopup","dialog"),I.noRotate&&pe.classList.add("norotate");const{pageWidth:ve,pageHeight:Se,pageX:De,pageY:ke}=he.rawDims;if(!I.rect||this instanceof C){const{rotation:Ge}=I;return!I.hasOwnCanvas&&Ge!==0&&this.setRotation(Ge,pe),pe}const{width:we,height:He}=l(I.rect),Fe=t.Util.normalizeRect([I.rect[0],$.view[3]-I.rect[1]+$.view[1],I.rect[2],$.view[3]-I.rect[3]+$.view[1]]);if(!L&&I.borderStyle.width>0){pe.style.borderWidth=`${I.borderStyle.width}px`;const Ge=I.borderStyle.horizontalCornerRadius,Ue=I.borderStyle.verticalCornerRadius;if(Ge>0||Ue>0){const Ze=`calc(${Ge}px * var(--scale-factor)) / calc(${Ue}px * var(--scale-factor))`;pe.style.borderRadius=Ze}else if(this instanceof g){const Ze=`calc(${we}px * var(--scale-factor)) / calc(${He}px * var(--scale-factor))`;pe.style.borderRadius=Ze}switch(I.borderStyle.style){case t.AnnotationBorderStyleType.SOLID:pe.style.borderStyle="solid";break;case t.AnnotationBorderStyleType.DASHED:pe.style.borderStyle="dashed";break;case t.AnnotationBorderStyleType.BEVELED:(0,t.warn)("Unimplemented border style: beveled");break;case t.AnnotationBorderStyleType.INSET:(0,t.warn)("Unimplemented border style: inset");break;case t.AnnotationBorderStyleType.UNDERLINE:pe.style.borderBottomStyle="solid";break}const $e=I.borderColor||null;$e?(le(this,N,!0),pe.style.borderColor=t.Util.makeHexColor($e[0]|0,$e[1]|0,$e[2]|0)):pe.style.borderWidth=0}pe.style.left=`${100*(Fe[0]-De)/ve}%`,pe.style.top=`${100*(Fe[1]-ke)/Se}%`;const{rotation:Oe}=I;return I.hasOwnCanvas||Oe===0?(pe.style.width=`${100*we/ve}%`,pe.style.height=`${100*He/Se}%`):this.setRotation(Oe,pe),pe}setRotation(L,I=this.container){if(!this.data.rect)return;const{pageWidth:$,pageHeight:he}=this.parent.viewport.rawDims,{width:pe,height:ve}=l(this.data.rect);let Se,De;L%180===0?(Se=100*pe/$,De=100*ve/he):(Se=100*ve/$,De=100*pe/he),I.style.width=`${Se}%`,I.style.height=`${De}%`,I.setAttribute("data-main-rotation",(360-L)%360)}get _commonActions(){const L=(I,$,he)=>{const pe=he.detail[I],ve=pe[0],Se=pe.slice(1);he.target.style[$]=o.ColorConverters[`${ve}_HTML`](Se),this.annotationStorage.setValue(this.data.id,{[$]:o.ColorConverters[`${ve}_rgb`](Se)})};return(0,t.shadow)(this,"_commonActions",{display:I=>{const{display:$}=I.detail,he=$%2===1;this.container.style.visibility=he?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:he,noPrint:$===1||$===2})},print:I=>{this.annotationStorage.setValue(this.data.id,{noPrint:!I.detail.print})},hidden:I=>{const{hidden:$}=I.detail;this.container.style.visibility=$?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:$,noView:$})},focus:I=>{setTimeout(()=>I.target.focus({preventScroll:!1}),0)},userName:I=>{I.target.title=I.detail.userName},readonly:I=>{I.target.disabled=I.detail.readonly},required:I=>{this._setRequired(I.target,I.detail.required)},bgColor:I=>{L("bgColor","backgroundColor",I)},fillColor:I=>{L("fillColor","backgroundColor",I)},fgColor:I=>{L("fgColor","color",I)},textColor:I=>{L("textColor","color",I)},borderColor:I=>{L("borderColor","borderColor",I)},strokeColor:I=>{L("strokeColor","borderColor",I)},rotation:I=>{const $=I.detail.rotation;this.setRotation($),this.annotationStorage.setValue(this.data.id,{rotation:$})}})}_dispatchEventFromSandbox(L,I){const $=this._commonActions;for(const he of Object.keys(I.detail)){const pe=L[he]||$[he];pe==null||pe(I)}}_setDefaultPropertiesFromJS(L){if(!this.enableScripting)return;const I=this.annotationStorage.getRawValue(this.data.id);if(!I)return;const $=this._commonActions;for(const[he,pe]of Object.entries(I)){const ve=$[he];if(ve){const Se={detail:{[he]:pe},target:L};ve(Se),delete I[he]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:L}=this.data;if(!L)return;const[I,$,he,pe]=this.data.rect;if(L.length===1){const[,{x:Ue,y:$e},{x:Ze,y:et}]=L[0];if(he===Ue&&pe===$e&&I===Ze&&$===et)return}const{style:ve}=this.container;let Se;if(n(this,N)){const{borderColor:Ue,borderWidth:$e}=ve;ve.borderWidth=0,Se=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Ue}" stroke-width="${$e}">`],this.container.classList.add("hasBorder")}const De=he-I,ke=pe-$,{svgFactory:we}=this,He=we.createElement("svg");He.classList.add("quadrilateralsContainer"),He.setAttribute("width",0),He.setAttribute("height",0);const Fe=we.createElement("defs");He.append(Fe);const Oe=we.createElement("clipPath"),Ge=`clippath_${this.data.id}`;Oe.setAttribute("id",Ge),Oe.setAttribute("clipPathUnits","objectBoundingBox"),Fe.append(Oe);for(const[,{x:Ue,y:$e},{x:Ze,y:et}]of L){const Qe=we.createElement("rect"),st=(Ze-I)/De,rt=(pe-$e)/ke,nt=(Ue-Ze)/De,fs=($e-et)/ke;Qe.setAttribute("x",st),Qe.setAttribute("y",rt),Qe.setAttribute("width",nt),Qe.setAttribute("height",fs),Oe.append(Qe),Se==null||Se.push(`<rect vector-effect="non-scaling-stroke" x="${st}" y="${rt}" width="${nt}" height="${fs}"/>`)}n(this,N)&&(Se.push("</g></svg>')"),ve.backgroundImage=Se.join("")),this.container.append(He),this.container.style.clipPath=`url(#${Ge})`}_createPopup(){const{container:L,data:I}=this;L.setAttribute("aria-haspopup","dialog");const $=new C({data:{color:I.color,titleObj:I.titleObj,modificationDate:I.modificationDate,contentsObj:I.contentsObj,richText:I.richText,parentRect:I.rect,borderStyle:0,id:`popup_${I.id}`,rotation:I.rotation},parent:this.parent,elements:[this]});this.parent.div.append($.render())}render(){(0,t.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(L,I=null){const $=[];if(this._fieldObjects){const he=this._fieldObjects[L];if(he)for(const{page:pe,id:ve,exportValues:Se}of he){if(pe===-1||ve===I)continue;const De=typeof Se=="string"?Se:null,ke=document.querySelector(`[data-element-id="${ve}"]`);if(ke&&!h.has(ke)){(0,t.warn)(`_getElementsByName - element not allowed: ${ve}`);continue}$.push({id:ve,exportValue:De,domElement:ke})}return $}for(const he of document.getElementsByName(L)){const{exportValue:pe}=he,ve=he.getAttribute("data-element-id");ve!==I&&h.has(he)&&$.push({id:ve,exportValue:pe,domElement:he})}return $}show(){var L;this.container&&(this.container.hidden=!1),(L=this.popup)==null||L.maybeShow()}hide(){var L;this.container&&(this.container.hidden=!0),(L=this.popup)==null||L.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const L=this.getElementsToTriggerPopup();if(Array.isArray(L))for(const I of L)I.classList.add("highlightArea");else L.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:L,data:{id:I}}=this;this.container.addEventListener("dblclick",()=>{var $;($=this.linkService.eventBus)==null||$.dispatch("switchannotationeditormode",{source:this,mode:L,editId:I})})}};N=new WeakMap;let b=B;class _ extends b{constructor(I,$=null){super(I,{isRenderable:!0,ignoreBorder:!!($!=null&&$.ignoreBorder),createQuadrilaterals:!0});ne(this,G);this.isTooltipOnly=I.data.isTooltipOnly}render(){const{data:I,linkService:$}=this,he=document.createElement("a");he.setAttribute("data-element-id",I.id);let pe=!1;return I.url?($.addLinkAttributes(he,I.url,I.newWindow),pe=!0):I.action?(this._bindNamedAction(he,I.action),pe=!0):I.attachment?(this._bindAttachment(he,I.attachment),pe=!0):I.setOCGState?(J(this,G,ks).call(this,he,I.setOCGState),pe=!0):I.dest?(this._bindLink(he,I.dest),pe=!0):(I.actions&&(I.actions.Action||I.actions["Mouse Up"]||I.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(he,I),pe=!0),I.resetForm?(this._bindResetFormAction(he,I.resetForm),pe=!0):this.isTooltipOnly&&!pe&&(this._bindLink(he,""),pe=!0)),this.container.classList.add("linkAnnotation"),pe&&this.container.append(he),this.container}_bindLink(I,$){I.href=this.linkService.getDestinationHash($),I.onclick=()=>($&&this.linkService.goToDestination($),!1),($||$==="")&&J(this,G,at).call(this)}_bindNamedAction(I,$){I.href=this.linkService.getAnchorUrl(""),I.onclick=()=>(this.linkService.executeNamedAction($),!1),J(this,G,at).call(this)}_bindAttachment(I,$){I.href=this.linkService.getAnchorUrl(""),I.onclick=()=>{var he;return(he=this.downloadManager)==null||he.openOrDownloadData(this.container,$.content,$.filename),!1},J(this,G,at).call(this)}_bindJSAction(I,$){I.href=this.linkService.getAnchorUrl("");const he=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const pe of Object.keys($.actions)){const ve=he.get(pe);ve&&(I[ve]=()=>{var Se;return(Se=this.linkService.eventBus)==null||Se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:$.id,name:pe}}),!1})}I.onclick||(I.onclick=()=>!1),J(this,G,at).call(this)}_bindResetFormAction(I,$){const he=I.onclick;if(he||(I.href=this.linkService.getAnchorUrl("")),J(this,G,at).call(this),!this._fieldObjects){(0,t.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),he||(I.onclick=()=>!1);return}I.onclick=()=>{var He;he==null||he();const{fields:pe,refs:ve,include:Se}=$,De=[];if(pe.length!==0||ve.length!==0){const Fe=new Set(ve);for(const Oe of pe){const Ge=this._fieldObjects[Oe]||[];for(const{id:Ue}of Ge)Fe.add(Ue)}for(const Oe of Object.values(this._fieldObjects))for(const Ge of Oe)Fe.has(Ge.id)===Se&&De.push(Ge)}else for(const Fe of Object.values(this._fieldObjects))De.push(...Fe);const ke=this.annotationStorage,we=[];for(const Fe of De){const{id:Oe}=Fe;switch(we.push(Oe),Fe.type){case"text":{const Ue=Fe.defaultValue||"";ke.setValue(Oe,{value:Ue});break}case"checkbox":case"radiobutton":{const Ue=Fe.defaultValue===Fe.exportValues;ke.setValue(Oe,{value:Ue});break}case"combobox":case"listbox":{const Ue=Fe.defaultValue||"";ke.setValue(Oe,{value:Ue});break}default:continue}const Ge=document.querySelector(`[data-element-id="${Oe}"]`);if(Ge){if(!h.has(Ge)){(0,t.warn)(`_bindResetFormAction - element not allowed: ${Oe}`);continue}}else continue;Ge.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((He=this.linkService.eventBus)==null||He.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:we,name:"ResetForm"}})),!1}}}G=new WeakSet,at=function(){this.container.setAttribute("data-internal-link","")},ks=function(I,$){I.href=this.linkService.getAnchorUrl(""),I.onclick=()=>(this.linkService.executeSetOCGState($),!1),J(this,G,at).call(this)};class f extends b{constructor(L){super(L,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const L=document.createElement("img");return L.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",L.alt="[{{type}} Annotation]",L.dataset.l10nId="text_annotation_type",L.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(L),this.container}}class p extends b{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(L){var I;this.data.hasOwnCanvas&&(((I=L.previousSibling)==null?void 0:I.nodeName)==="CANVAS"&&(L.previousSibling.hidden=!0),L.hidden=!1)}_getKeyModifier(L){const{isWin:I,isMac:$}=t.FeatureTest.platform;return I&&L.ctrlKey||$&&L.metaKey}_setEventListener(L,I,$,he,pe){$.includes("mouse")?L.addEventListener($,ve=>{var Se;(Se=this.linkService.eventBus)==null||Se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:he,value:pe(ve),shift:ve.shiftKey,modifier:this._getKeyModifier(ve)}})}):L.addEventListener($,ve=>{var Se;if($==="blur"){if(!I.focused||!ve.relatedTarget)return;I.focused=!1}else if($==="focus"){if(I.focused)return;I.focused=!0}pe&&((Se=this.linkService.eventBus)==null||Se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:he,value:pe(ve)}}))})}_setEventListeners(L,I,$,he){var pe,ve,Se;for(const[De,ke]of $)(ke==="Action"||(pe=this.data.actions)!=null&&pe[ke])&&((ke==="Focus"||ke==="Blur")&&(I||(I={focused:!1})),this._setEventListener(L,I,De,ke,he),ke==="Focus"&&!((ve=this.data.actions)!=null&&ve.Blur)?this._setEventListener(L,I,"blur","Blur",null):ke==="Blur"&&!((Se=this.data.actions)!=null&&Se.Focus)&&this._setEventListener(L,I,"focus","Focus",null))}_setBackgroundColor(L){const I=this.data.backgroundColor||null;L.style.backgroundColor=I===null?"transparent":t.Util.makeHexColor(I[0],I[1],I[2])}_setTextStyle(L){const I=["left","center","right"],{fontColor:$}=this.data.defaultAppearanceData,he=this.data.defaultAppearanceData.fontSize||u,pe=L.style;let ve;const Se=2,De=ke=>Math.round(10*ke)/10;if(this.data.multiLine){const ke=Math.abs(this.data.rect[3]-this.data.rect[1]-Se),we=Math.round(ke/(t.LINE_FACTOR*he))||1,He=ke/we;ve=Math.min(he,De(He/t.LINE_FACTOR))}else{const ke=Math.abs(this.data.rect[3]-this.data.rect[1]-Se);ve=Math.min(he,De(ke/t.LINE_FACTOR))}pe.fontSize=`calc(${ve}px * var(--scale-factor))`,pe.color=t.Util.makeHexColor($[0],$[1],$[2]),this.data.textAlignment!==null&&(pe.textAlign=I[this.data.textAlignment])}_setRequired(L,I){I?L.setAttribute("required",!0):L.removeAttribute("required"),L.setAttribute("aria-required",I)}}class A extends p{constructor(L){const I=L.renderForms||!L.data.hasAppearance&&!!L.data.fieldValue;super(L,{isRenderable:I})}setPropertyOnSiblings(L,I,$,he){const pe=this.annotationStorage;for(const ve of this._getElementsByName(L.name,L.id))ve.domElement&&(ve.domElement[I]=$),pe.setValue(ve.id,{[he]:$})}render(){var he,pe;const L=this.annotationStorage,I=this.data.id;this.container.classList.add("textWidgetAnnotation");let $=null;if(this.renderForms){const ve=L.getValue(I,{value:this.data.fieldValue});let Se=ve.value||"";const De=L.getValue(I,{charLimit:this.data.maxLen}).charLimit;De&&Se.length>De&&(Se=Se.slice(0,De));let ke=ve.formattedValue||((he=this.data.textContent)==null?void 0:he.join(`
`))||null;ke&&this.data.comb&&(ke=ke.replaceAll(/\s+/g,""));const we={userValue:Se,formattedValue:ke,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?($=document.createElement("textarea"),$.textContent=ke??Se,this.data.doNotScroll&&($.style.overflowY="hidden")):($=document.createElement("input"),$.type="text",$.setAttribute("value",ke??Se),this.data.doNotScroll&&($.style.overflowX="hidden")),this.data.hasOwnCanvas&&($.hidden=!0),h.add($),$.setAttribute("data-element-id",I),$.disabled=this.data.readOnly,$.name=this.data.fieldName,$.tabIndex=y,this._setRequired($,this.data.required),De&&($.maxLength=De),$.addEventListener("input",Fe=>{L.setValue(I,{value:Fe.target.value}),this.setPropertyOnSiblings($,"value",Fe.target.value,"value"),we.formattedValue=null}),$.addEventListener("resetform",Fe=>{const Oe=this.data.defaultFieldValue??"";$.value=we.userValue=Oe,we.formattedValue=null});let He=Fe=>{const{formattedValue:Oe}=we;Oe!=null&&(Fe.target.value=Oe),Fe.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){$.addEventListener("focus",Oe=>{if(we.focused)return;const{target:Ge}=Oe;we.userValue&&(Ge.value=we.userValue),we.lastCommittedValue=Ge.value,we.commitKey=1,we.focused=!0}),$.addEventListener("updatefromsandbox",Oe=>{this.showElementAndHideCanvas(Oe.target);const Ge={value(Ue){we.userValue=Ue.detail.value??"",L.setValue(I,{value:we.userValue.toString()}),Ue.target.value=we.userValue},formattedValue(Ue){const{formattedValue:$e}=Ue.detail;we.formattedValue=$e,$e!=null&&Ue.target!==document.activeElement&&(Ue.target.value=$e),L.setValue(I,{formattedValue:$e})},selRange(Ue){Ue.target.setSelectionRange(...Ue.detail.selRange)},charLimit:Ue=>{var Qe;const{charLimit:$e}=Ue.detail,{target:Ze}=Ue;if($e===0){Ze.removeAttribute("maxLength");return}Ze.setAttribute("maxLength",$e);let et=we.userValue;!et||et.length<=$e||(et=et.slice(0,$e),Ze.value=we.userValue=et,L.setValue(I,{value:et}),(Qe=this.linkService.eventBus)==null||Qe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:et,willCommit:!0,commitKey:1,selStart:Ze.selectionStart,selEnd:Ze.selectionEnd}}))}};this._dispatchEventFromSandbox(Ge,Oe)}),$.addEventListener("keydown",Oe=>{var $e;we.commitKey=1;let Ge=-1;if(Oe.key==="Escape"?Ge=0:Oe.key==="Enter"&&!this.data.multiLine?Ge=2:Oe.key==="Tab"&&(we.commitKey=3),Ge===-1)return;const{value:Ue}=Oe.target;we.lastCommittedValue!==Ue&&(we.lastCommittedValue=Ue,we.userValue=Ue,($e=this.linkService.eventBus)==null||$e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:Ue,willCommit:!0,commitKey:Ge,selStart:Oe.target.selectionStart,selEnd:Oe.target.selectionEnd}}))});const Fe=He;He=null,$.addEventListener("blur",Oe=>{var Ue;if(!we.focused||!Oe.relatedTarget)return;we.focused=!1;const{value:Ge}=Oe.target;we.userValue=Ge,we.lastCommittedValue!==Ge&&((Ue=this.linkService.eventBus)==null||Ue.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:Ge,willCommit:!0,commitKey:we.commitKey,selStart:Oe.target.selectionStart,selEnd:Oe.target.selectionEnd}})),Fe(Oe)}),(pe=this.data.actions)!=null&&pe.Keystroke&&$.addEventListener("beforeinput",Oe=>{var rt;we.lastCommittedValue=null;const{data:Ge,target:Ue}=Oe,{value:$e,selectionStart:Ze,selectionEnd:et}=Ue;let Qe=Ze,st=et;switch(Oe.inputType){case"deleteWordBackward":{const nt=$e.substring(0,Ze).match(/\w*[^\w]*$/);nt&&(Qe-=nt[0].length);break}case"deleteWordForward":{const nt=$e.substring(Ze).match(/^[^\w]*\w*/);nt&&(st+=nt[0].length);break}case"deleteContentBackward":Ze===et&&(Qe-=1);break;case"deleteContentForward":Ze===et&&(st+=1);break}Oe.preventDefault(),(rt=this.linkService.eventBus)==null||rt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:$e,change:Ge||"",willCommit:!1,selStart:Qe,selEnd:st}})}),this._setEventListeners($,we,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Oe=>Oe.target.value)}if(He&&$.addEventListener("blur",He),this.data.comb){const Oe=(this.data.rect[2]-this.data.rect[0])/De;$.classList.add("comb"),$.style.letterSpacing=`calc(${Oe}px * var(--scale-factor) - 1ch)`}}else $=document.createElement("div"),$.textContent=this.data.fieldValue,$.style.verticalAlign="middle",$.style.display="table-cell";return this._setTextStyle($),this._setBackgroundColor($),this._setDefaultPropertiesFromJS($),this.container.append($),this.container}}class k extends p{constructor(L){super(L,{isRenderable:!!L.data.hasOwnCanvas})}}class P extends p{constructor(L){super(L,{isRenderable:L.renderForms})}render(){const L=this.annotationStorage,I=this.data,$=I.id;let he=L.getValue($,{value:I.exportValue===I.fieldValue}).value;typeof he=="string"&&(he=he!=="Off",L.setValue($,{value:he})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const pe=document.createElement("input");return h.add(pe),pe.setAttribute("data-element-id",$),pe.disabled=I.readOnly,this._setRequired(pe,this.data.required),pe.type="checkbox",pe.name=I.fieldName,he&&pe.setAttribute("checked",!0),pe.setAttribute("exportValue",I.exportValue),pe.tabIndex=y,pe.addEventListener("change",ve=>{const{name:Se,checked:De}=ve.target;for(const ke of this._getElementsByName(Se,$)){const we=De&&ke.exportValue===I.exportValue;ke.domElement&&(ke.domElement.checked=we),L.setValue(ke.id,{value:we})}L.setValue($,{value:De})}),pe.addEventListener("resetform",ve=>{const Se=I.defaultFieldValue||"Off";ve.target.checked=Se===I.exportValue}),this.enableScripting&&this.hasJSActions&&(pe.addEventListener("updatefromsandbox",ve=>{const Se={value(De){De.target.checked=De.detail.value!=="Off",L.setValue($,{value:De.target.checked})}};this._dispatchEventFromSandbox(Se,ve)}),this._setEventListeners(pe,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ve=>ve.target.checked)),this._setBackgroundColor(pe),this._setDefaultPropertiesFromJS(pe),this.container.append(pe),this.container}}class g extends p{constructor(L){super(L,{isRenderable:L.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const L=this.annotationStorage,I=this.data,$=I.id;let he=L.getValue($,{value:I.fieldValue===I.buttonValue}).value;typeof he=="string"&&(he=he!==I.buttonValue,L.setValue($,{value:he}));const pe=document.createElement("input");if(h.add(pe),pe.setAttribute("data-element-id",$),pe.disabled=I.readOnly,this._setRequired(pe,this.data.required),pe.type="radio",pe.name=I.fieldName,he&&pe.setAttribute("checked",!0),pe.tabIndex=y,pe.addEventListener("change",ve=>{const{name:Se,checked:De}=ve.target;for(const ke of this._getElementsByName(Se,$))L.setValue(ke.id,{value:!1});L.setValue($,{value:De})}),pe.addEventListener("resetform",ve=>{const Se=I.defaultFieldValue;ve.target.checked=Se!=null&&Se===I.buttonValue}),this.enableScripting&&this.hasJSActions){const ve=I.buttonValue;pe.addEventListener("updatefromsandbox",Se=>{const De={value:ke=>{const we=ve===ke.detail.value;for(const He of this._getElementsByName(ke.target.name)){const Fe=we&&He.id===$;He.domElement&&(He.domElement.checked=Fe),L.setValue(He.id,{value:Fe})}}};this._dispatchEventFromSandbox(De,Se)}),this._setEventListeners(pe,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Se=>Se.target.checked)}return this._setBackgroundColor(pe),this._setDefaultPropertiesFromJS(pe),this.container.append(pe),this.container}}class R extends _{constructor(L){super(L,{ignoreBorder:L.data.hasAppearance})}render(){const L=super.render();L.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(L.title=this.data.alternativeText);const I=L.lastChild;return this.enableScripting&&this.hasJSActions&&I&&(this._setDefaultPropertiesFromJS(I),I.addEventListener("updatefromsandbox",$=>{this._dispatchEventFromSandbox({},$)})),L}}class E extends p{constructor(L){super(L,{isRenderable:L.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const L=this.annotationStorage,I=this.data.id,$=L.getValue(I,{value:this.data.fieldValue}),he=document.createElement("select");h.add(he),he.setAttribute("data-element-id",I),he.disabled=this.data.readOnly,this._setRequired(he,this.data.required),he.name=this.data.fieldName,he.tabIndex=y;let pe=this.data.combo&&this.data.options.length>0;this.data.combo||(he.size=this.data.options.length,this.data.multiSelect&&(he.multiple=!0)),he.addEventListener("resetform",we=>{const He=this.data.defaultFieldValue;for(const Fe of he.options)Fe.selected=Fe.value===He});for(const we of this.data.options){const He=document.createElement("option");He.textContent=we.displayValue,He.value=we.exportValue,$.value.includes(we.exportValue)&&(He.setAttribute("selected",!0),pe=!1),he.append(He)}let ve=null;if(pe){const we=document.createElement("option");we.value=" ",we.setAttribute("hidden",!0),we.setAttribute("selected",!0),he.prepend(we),ve=()=>{we.remove(),he.removeEventListener("input",ve),ve=null},he.addEventListener("input",ve)}const Se=we=>{const He=we?"value":"textContent",{options:Fe,multiple:Oe}=he;return Oe?Array.prototype.filter.call(Fe,Ge=>Ge.selected).map(Ge=>Ge[He]):Fe.selectedIndex===-1?null:Fe[Fe.selectedIndex][He]};let De=Se(!1);const ke=we=>{const He=we.target.options;return Array.prototype.map.call(He,Fe=>({displayValue:Fe.textContent,exportValue:Fe.value}))};return this.enableScripting&&this.hasJSActions?(he.addEventListener("updatefromsandbox",we=>{const He={value(Fe){ve==null||ve();const Oe=Fe.detail.value,Ge=new Set(Array.isArray(Oe)?Oe:[Oe]);for(const Ue of he.options)Ue.selected=Ge.has(Ue.value);L.setValue(I,{value:Se(!0)}),De=Se(!1)},multipleSelection(Fe){he.multiple=!0},remove(Fe){const Oe=he.options,Ge=Fe.detail.remove;Oe[Ge].selected=!1,he.remove(Ge),Oe.length>0&&Array.prototype.findIndex.call(Oe,$e=>$e.selected)===-1&&(Oe[0].selected=!0),L.setValue(I,{value:Se(!0),items:ke(Fe)}),De=Se(!1)},clear(Fe){for(;he.length!==0;)he.remove(0);L.setValue(I,{value:null,items:[]}),De=Se(!1)},insert(Fe){const{index:Oe,displayValue:Ge,exportValue:Ue}=Fe.detail.insert,$e=he.children[Oe],Ze=document.createElement("option");Ze.textContent=Ge,Ze.value=Ue,$e?$e.before(Ze):he.append(Ze),L.setValue(I,{value:Se(!0),items:ke(Fe)}),De=Se(!1)},items(Fe){const{items:Oe}=Fe.detail;for(;he.length!==0;)he.remove(0);for(const Ge of Oe){const{displayValue:Ue,exportValue:$e}=Ge,Ze=document.createElement("option");Ze.textContent=Ue,Ze.value=$e,he.append(Ze)}he.options.length>0&&(he.options[0].selected=!0),L.setValue(I,{value:Se(!0),items:ke(Fe)}),De=Se(!1)},indices(Fe){const Oe=new Set(Fe.detail.indices);for(const Ge of Fe.target.options)Ge.selected=Oe.has(Ge.index);L.setValue(I,{value:Se(!0)}),De=Se(!1)},editable(Fe){Fe.target.disabled=!Fe.detail.editable}};this._dispatchEventFromSandbox(He,we)}),he.addEventListener("input",we=>{var Fe;const He=Se(!0);L.setValue(I,{value:He}),we.preventDefault(),(Fe=this.linkService.eventBus)==null||Fe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:De,changeEx:He,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(he,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],we=>we.target.value)):he.addEventListener("input",function(we){L.setValue(I,{value:Se(!0)})}),this.data.combo&&this._setTextStyle(he),this._setBackgroundColor(he),this._setDefaultPropertiesFromJS(he),this.container.append(he),this.container}}class C extends b{constructor(L){const{data:I,elements:$}=L;super(L,{isRenderable:b._hasPopupData(I)}),this.elements=$}render(){this.container.classList.add("popupAnnotation");const L=new j({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),I=[];for(const $ of this.elements)$.popup=L,I.push($.data.id),$.addHighlightArea();return this.container.setAttribute("aria-controls",I.map($=>`${t.AnnotationPrefix}${$}`).join(",")),this.container}}class j{constructor({container:L,color:I,elements:$,titleObj:he,modificationDate:pe,contentsObj:ve,richText:Se,parent:De,rect:ke,parentRect:we,open:He}){ne(this,_e);ne(this,ce,null);ne(this,me,J(this,_e,Fs).bind(this));ne(this,xe,J(this,_e,ns).bind(this));ne(this,be,J(this,_e,rs).bind(this));ne(this,ye,J(this,_e,Ct).bind(this));ne(this,Re,null);ne(this,ie,null);ne(this,ae,null);ne(this,M,null);ne(this,H,null);ne(this,Z,null);ne(this,re,!1);ne(this,fe,null);ne(this,je,null);ne(this,Ae,null);ne(this,te,null);ne(this,Te,!1);var Oe;le(this,ie,L),le(this,te,he),le(this,ae,ve),le(this,Ae,Se),le(this,H,De),le(this,Re,I),le(this,je,ke),le(this,Z,we),le(this,M,$);const Fe=i.PDFDateString.toDateObject(pe);Fe&&le(this,ce,De.l10n.get("annotation_date_string",{date:Fe.toLocaleDateString(),time:Fe.toLocaleTimeString()})),this.trigger=$.flatMap(Ge=>Ge.getElementsToTriggerPopup());for(const Ge of this.trigger)Ge.addEventListener("click",n(this,ye)),Ge.addEventListener("mouseenter",n(this,be)),Ge.addEventListener("mouseleave",n(this,xe)),Ge.classList.add("popupTriggerArea");for(const Ge of $)(Oe=Ge.container)==null||Oe.addEventListener("keydown",n(this,me));n(this,ie).hidden=!0,He&&J(this,_e,Ct).call(this)}render(){if(n(this,fe))return;const{page:{view:L},viewport:{rawDims:{pageWidth:I,pageHeight:$,pageX:he,pageY:pe}}}=n(this,H),ve=le(this,fe,document.createElement("div"));if(ve.className="popup",n(this,Re)){const Qe=ve.style.outlineColor=t.Util.makeHexColor(...n(this,Re));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?ve.style.backgroundColor=`color-mix(in srgb, ${Qe} 30%, white)`:ve.style.backgroundColor=t.Util.makeHexColor(...n(this,Re).map(rt=>Math.floor(.7*(255-rt)+rt)))}const Se=document.createElement("span");Se.className="header";const De=document.createElement("h1");if(Se.append(De),{dir:De.dir,str:De.textContent}=n(this,te),ve.append(Se),n(this,ce)){const Qe=document.createElement("span");Qe.classList.add("popupDate"),n(this,ce).then(st=>{Qe.textContent=st}),Se.append(Qe)}const ke=n(this,ae),we=n(this,Ae);if(we!=null&&we.str&&(!(ke!=null&&ke.str)||ke.str===we.str))S.XfaLayer.render({xfaHtml:we.html,intent:"richText",div:ve}),ve.lastChild.classList.add("richText","popupContent");else{const Qe=this._formatContents(ke);ve.append(Qe)}let He=!!n(this,Z),Fe=He?n(this,Z):n(this,je);for(const Qe of n(this,M))if(!Fe||t.Util.intersect(Qe.data.rect,Fe)!==null){Fe=Qe.data.rect,He=!0;break}const Oe=t.Util.normalizeRect([Fe[0],L[3]-Fe[1]+L[1],Fe[2],L[3]-Fe[3]+L[1]]),Ue=He?Fe[2]-Fe[0]+5:0,$e=Oe[0]+Ue,Ze=Oe[1],{style:et}=n(this,ie);et.left=`${100*($e-he)/I}%`,et.top=`${100*(Ze-pe)/$}%`,n(this,ie).append(ve)}_formatContents({str:L,dir:I}){const $=document.createElement("p");$.classList.add("popupContent"),$.dir=I;const he=L.split(/(?:\r\n?|\n)/);for(let pe=0,ve=he.length;pe<ve;++pe){const Se=he[pe];$.append(document.createTextNode(Se)),pe<ve-1&&$.append(document.createElement("br"))}return $}forceHide(){le(this,Te,this.isVisible),n(this,Te)&&(n(this,ie).hidden=!0)}maybeShow(){n(this,Te)&&(le(this,Te,!1),n(this,ie).hidden=!1)}get isVisible(){return n(this,ie).hidden===!1}}ce=new WeakMap,me=new WeakMap,xe=new WeakMap,be=new WeakMap,ye=new WeakMap,Re=new WeakMap,ie=new WeakMap,ae=new WeakMap,M=new WeakMap,H=new WeakMap,Z=new WeakMap,re=new WeakMap,fe=new WeakMap,je=new WeakMap,Ae=new WeakMap,te=new WeakMap,Te=new WeakMap,_e=new WeakSet,Fs=function(L){L.altKey||L.shiftKey||L.ctrlKey||L.metaKey||(L.key==="Enter"||L.key==="Escape"&&n(this,re))&&J(this,_e,Ct).call(this)},Ct=function(){le(this,re,!n(this,re)),n(this,re)?(J(this,_e,rs).call(this),n(this,ie).addEventListener("click",n(this,ye)),n(this,ie).addEventListener("keydown",n(this,me))):(J(this,_e,ns).call(this),n(this,ie).removeEventListener("click",n(this,ye)),n(this,ie).removeEventListener("keydown",n(this,me)))},rs=function(){n(this,fe)||this.render(),this.isVisible?n(this,re)&&n(this,ie).classList.add("focused"):(n(this,ie).hidden=!1,n(this,ie).style.zIndex=parseInt(n(this,ie).style.zIndex)+1e3)},ns=function(){n(this,ie).classList.remove("focused"),!(n(this,re)||!this.isVisible)&&(n(this,ie).hidden=!0,n(this,ie).style.zIndex=parseInt(n(this,ie).style.zIndex)-1e3)};class z extends b{constructor(L){super(L,{isRenderable:!0,ignoreBorder:!0}),this.textContent=L.data.textContent,this.textPosition=L.data.textPosition,this.annotationEditorType=t.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const L=document.createElement("div");L.classList.add("annotationTextContent"),L.setAttribute("role","comment");for(const I of this.textContent){const $=document.createElement("span");$.textContent=I,L.append($)}this.container.append(L)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=z;class v extends b{constructor(I){super(I,{isRenderable:!0,ignoreBorder:!0});ne(this,ze,null)}render(){this.container.classList.add("lineAnnotation");const I=this.data,{width:$,height:he}=l(I.rect),pe=this.svgFactory.create($,he,!0),ve=le(this,ze,this.svgFactory.createElement("svg:line"));return ve.setAttribute("x1",I.rect[2]-I.lineCoordinates[0]),ve.setAttribute("y1",I.rect[3]-I.lineCoordinates[1]),ve.setAttribute("x2",I.rect[2]-I.lineCoordinates[2]),ve.setAttribute("y2",I.rect[3]-I.lineCoordinates[3]),ve.setAttribute("stroke-width",I.borderStyle.width||1),ve.setAttribute("stroke","transparent"),ve.setAttribute("fill","transparent"),pe.append(ve),this.container.append(pe),!I.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return n(this,ze)}addHighlightArea(){this.container.classList.add("highlightArea")}}ze=new WeakMap;class T extends b{constructor(I){super(I,{isRenderable:!0,ignoreBorder:!0});ne(this,Xe,null)}render(){this.container.classList.add("squareAnnotation");const I=this.data,{width:$,height:he}=l(I.rect),pe=this.svgFactory.create($,he,!0),ve=I.borderStyle.width,Se=le(this,Xe,this.svgFactory.createElement("svg:rect"));return Se.setAttribute("x",ve/2),Se.setAttribute("y",ve/2),Se.setAttribute("width",$-ve),Se.setAttribute("height",he-ve),Se.setAttribute("stroke-width",ve||1),Se.setAttribute("stroke","transparent"),Se.setAttribute("fill","transparent"),pe.append(Se),this.container.append(pe),!I.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return n(this,Xe)}addHighlightArea(){this.container.classList.add("highlightArea")}}Xe=new WeakMap;class O extends b{constructor(I){super(I,{isRenderable:!0,ignoreBorder:!0});ne(this,Ye,null)}render(){this.container.classList.add("circleAnnotation");const I=this.data,{width:$,height:he}=l(I.rect),pe=this.svgFactory.create($,he,!0),ve=I.borderStyle.width,Se=le(this,Ye,this.svgFactory.createElement("svg:ellipse"));return Se.setAttribute("cx",$/2),Se.setAttribute("cy",he/2),Se.setAttribute("rx",$/2-ve/2),Se.setAttribute("ry",he/2-ve/2),Se.setAttribute("stroke-width",ve||1),Se.setAttribute("stroke","transparent"),Se.setAttribute("fill","transparent"),pe.append(Se),this.container.append(pe),!I.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return n(this,Ye)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ye=new WeakMap;class se extends b{constructor(I){super(I,{isRenderable:!0,ignoreBorder:!0});ne(this,Ee,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const I=this.data,{width:$,height:he}=l(I.rect),pe=this.svgFactory.create($,he,!0);let ve=[];for(const De of I.vertices){const ke=De.x-I.rect[0],we=I.rect[3]-De.y;ve.push(ke+","+we)}ve=ve.join(" ");const Se=le(this,Ee,this.svgFactory.createElement(this.svgElementName));return Se.setAttribute("points",ve),Se.setAttribute("stroke-width",I.borderStyle.width||1),Se.setAttribute("stroke","transparent"),Se.setAttribute("fill","transparent"),pe.append(Se),this.container.append(pe),!I.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return n(this,Ee)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ee=new WeakMap;class V extends se{constructor(L){super(L),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Q extends b{constructor(L){super(L,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class K extends b{constructor(I){super(I,{isRenderable:!0,ignoreBorder:!0});ne(this,oe,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=t.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const I=this.data,{width:$,height:he}=l(I.rect),pe=this.svgFactory.create($,he,!0);for(const ve of I.inkLists){let Se=[];for(const ke of ve){const we=ke.x-I.rect[0],He=I.rect[3]-ke.y;Se.push(`${we},${He}`)}Se=Se.join(" ");const De=this.svgFactory.createElement(this.svgElementName);n(this,oe).push(De),De.setAttribute("points",Se),De.setAttribute("stroke-width",I.borderStyle.width||1),De.setAttribute("stroke","transparent"),De.setAttribute("fill","transparent"),!I.popupRef&&this.hasPopupData&&this._createPopup(),pe.append(De)}return this.container.append(pe),this.container}getElementsToTriggerPopup(){return n(this,oe)}addHighlightArea(){this.container.classList.add("highlightArea")}}oe=new WeakMap,e.InkAnnotationElement=K;class ue extends b{constructor(L){super(L,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class D extends b{constructor(L){super(L,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class q extends b{constructor(L){super(L,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class ee extends b{constructor(L){super(L,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class F extends b{constructor(L){super(L,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=F;class d extends b{constructor(I){var pe;super(I,{isRenderable:!0});ne(this,Pe);ne(this,de,null);const{filename:$,content:he}=this.data.file;this.filename=(0,i.getFilenameFromUrl)($,!0),this.content=he,(pe=this.linkService.eventBus)==null||pe.dispatch("fileattachmentannotation",{source:this,filename:$,content:he})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:I,data:$}=this;let he;$.hasAppearance||$.fillAlpha===0?he=document.createElement("div"):(he=document.createElement("img"),he.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test($.name)?"paperclip":"pushpin"}.svg`,$.fillAlpha&&$.fillAlpha<1&&(he.style=`filter: opacity(${Math.round($.fillAlpha*100)}%);`)),he.addEventListener("dblclick",J(this,Pe,as).bind(this)),le(this,de,he);const{isMac:pe}=t.FeatureTest.platform;return I.addEventListener("keydown",ve=>{ve.key==="Enter"&&(pe?ve.metaKey:ve.ctrlKey)&&J(this,Pe,as).call(this)}),!$.popupRef&&this.hasPopupData?this._createPopup():he.classList.add("popupTriggerArea"),I.append(he),I}getElementsToTriggerPopup(){return n(this,de)}addHighlightArea(){this.container.classList.add("highlightArea")}}de=new WeakMap,Pe=new WeakSet,as=function(){var I;(I=this.downloadManager)==null||I.openOrDownloadData(this.container,this.content,this.filename)};class x{constructor({div:L,accessibilityManager:I,annotationCanvasMap:$,l10n:he,page:pe,viewport:ve}){ne(this,Ce);ne(this,Ve,null);ne(this,U,null);ne(this,ge,new Map);this.div=L,le(this,Ve,I),le(this,U,$),this.l10n=he,this.page=pe,this.viewport=ve,this.zIndex=0,this.l10n||(this.l10n=w.NullL10n)}async render(L){const{annotations:I}=L,$=this.div;(0,i.setLayerDimensions)($,this.viewport);const he=new Map,pe={data:null,layer:$,linkService:L.linkService,downloadManager:L.downloadManager,imageResourcesPath:L.imageResourcesPath||"",renderForms:L.renderForms!==!1,svgFactory:new i.DOMSVGFactory,annotationStorage:L.annotationStorage||new a.AnnotationStorage,enableScripting:L.enableScripting===!0,hasJSActions:L.hasJSActions,fieldObjects:L.fieldObjects,parent:this,elements:null};for(const ve of I){if(ve.noHTML)continue;const Se=ve.annotationType===t.AnnotationType.POPUP;if(Se){const we=he.get(ve.id);if(!we)continue;pe.elements=we}else{const{width:we,height:He}=l(ve.rect);if(we<=0||He<=0)continue}pe.data=ve;const De=c.create(pe);if(!De.isRenderable)continue;if(!Se&&ve.popupRef){const we=he.get(ve.popupRef);we?we.push(De):he.set(ve.popupRef,[De])}De.annotationEditorType>0&&n(this,ge).set(De.data.id,De);const ke=De.render();ve.hidden&&(ke.style.visibility="hidden"),J(this,Ce,Is).call(this,ke,ve.id)}J(this,Ce,os).call(this),await this.l10n.translate($)}update({viewport:L}){const I=this.div;this.viewport=L,(0,i.setLayerDimensions)(I,{rotation:L.rotation}),J(this,Ce,os).call(this),I.hidden=!1}getEditableAnnotations(){return Array.from(n(this,ge).values())}getEditableAnnotation(L){return n(this,ge).get(L)}}Ve=new WeakMap,U=new WeakMap,ge=new WeakMap,Ce=new WeakSet,Is=function(L,I){var he;const $=L.firstChild||L;$.id=`${t.AnnotationPrefix}${I}`,this.div.append(L),(he=n(this,Ve))==null||he.moveElementInDOM(this.div,L,$,!1)},os=function(){if(!n(this,U))return;const L=this.div;for(const[I,$]of n(this,U)){const he=L.querySelector(`[data-annotation-id="${I}"]`);if(!he)continue;const{firstChild:pe}=he;pe?pe.nodeName==="CANVAS"?pe.replaceWith($):pe.before($):he.append($)}n(this,U).clear()},e.AnnotationLayer=x},(r,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function s(a){return Math.floor(Math.max(0,Math.min(1,a))*255).toString(16).padStart(2,"0")}function t(a){return Math.max(0,Math.min(255,255*a))}class i{static CMYK_G([o,w,S,y]){return["G",1-Math.min(1,.3*o+.59*S+.11*w+y)]}static G_CMYK([o]){return["CMYK",0,0,0,1-o]}static G_RGB([o]){return["RGB",o,o,o]}static G_rgb([o]){return o=t(o),[o,o,o]}static G_HTML([o]){const w=s(o);return`#${w}${w}${w}`}static RGB_G([o,w,S]){return["G",.3*o+.59*w+.11*S]}static RGB_rgb(o){return o.map(t)}static RGB_HTML(o){return`#${o.map(s).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([o,w,S,y]){return["RGB",1-Math.min(1,o+y),1-Math.min(1,S+y),1-Math.min(1,w+y)]}static CMYK_rgb([o,w,S,y]){return[t(1-Math.min(1,o+y)),t(1-Math.min(1,S+y)),t(1-Math.min(1,w+y))]}static CMYK_HTML(o){const w=this.CMYK_RGB(o).slice(1);return this.RGB_HTML(w)}static RGB_CMYK([o,w,S]){const y=1-o,u=1-w,h=1-S,l=Math.min(y,u,h);return["CMYK",y,u,h,l]}}e.ColorConverters=i},(r,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=t;const s={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};s.print_progress_percent="{{progress}}%";function t(o,w){switch(o){case"find_match_count":o=`find_match_count[${w.total===1?"one":"other"}]`;break;case"find_match_count_limit":o=`find_match_count_limit[${w.limit===1?"one":"other"}]`;break}return s[o]||""}function i(o,w){return w?o.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(S,y)=>y in w?w[y]:"{{"+y+"}}"):o}const a={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(o,w=null,S=t(o,w)){return i(S,w)},async translate(o){}};e.NullL10n=a},(r,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var t=s(25);class i{static setupStorage(o,w,S,y,u){const h=y.getValue(w,{value:null});switch(S.name){case"textarea":if(h.value!==null&&(o.textContent=h.value),u==="print")break;o.addEventListener("input",l=>{y.setValue(w,{value:l.target.value})});break;case"input":if(S.attributes.type==="radio"||S.attributes.type==="checkbox"){if(h.value===S.attributes.xfaOn?o.setAttribute("checked",!0):h.value===S.attributes.xfaOff&&o.removeAttribute("checked"),u==="print")break;o.addEventListener("change",l=>{y.setValue(w,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(h.value!==null&&o.setAttribute("value",h.value),u==="print")break;o.addEventListener("input",l=>{y.setValue(w,{value:l.target.value})})}break;case"select":if(h.value!==null){o.setAttribute("value",h.value);for(const l of S.children)l.attributes.value===h.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}o.addEventListener("input",l=>{const c=l.target.options,b=c.selectedIndex===-1?"":c[c.selectedIndex].value;y.setValue(w,{value:b})});break}}static setAttributes({html:o,element:w,storage:S=null,intent:y,linkService:u}){const{attributes:h}=w,l=o instanceof HTMLAnchorElement;h.type==="radio"&&(h.name=`${h.name}-${y}`);for(const[c,b]of Object.entries(h))if(b!=null)switch(c){case"class":b.length&&o.setAttribute(c,b.join(" "));break;case"dataId":break;case"id":o.setAttribute("data-element-id",b);break;case"style":Object.assign(o.style,b);break;case"textContent":o.textContent=b;break;default:(!l||c!=="href"&&c!=="newWindow")&&o.setAttribute(c,b)}l&&u.addLinkAttributes(o,h.href,h.newWindow),S&&h.dataId&&this.setupStorage(o,h.dataId,w,S)}static render(o){var _;const w=o.annotationStorage,S=o.linkService,y=o.xfaHtml,u=o.intent||"display",h=document.createElement(y.name);y.attributes&&this.setAttributes({html:h,element:y,intent:u,linkService:S});const l=[[y,-1,h]],c=o.div;if(c.append(h),o.viewport){const f=`matrix(${o.viewport.transform.join(",")})`;c.style.transform=f}u!=="richText"&&c.setAttribute("class","xfaLayer xfaFont");const b=[];for(;l.length>0;){const[f,p,A]=l.at(-1);if(p+1===f.children.length){l.pop();continue}const k=f.children[++l.at(-1)[1]];if(k===null)continue;const{name:P}=k;if(P==="#text"){const R=document.createTextNode(k.value);b.push(R),A.append(R);continue}const g=(_=k==null?void 0:k.attributes)!=null&&_.xmlns?document.createElementNS(k.attributes.xmlns,P):document.createElement(P);if(A.append(g),k.attributes&&this.setAttributes({html:g,element:k,storage:w,intent:u,linkService:S}),k.children&&k.children.length>0)l.push([k,-1,g]);else if(k.value){const R=document.createTextNode(k.value);t.XfaText.shouldBuildText(P)&&b.push(R),g.append(R)}}for(const f of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:b}}static update(o){const w=`matrix(${o.viewport.transform.join(",")})`;o.div.style.transform=w,o.div.hidden=!1}}e.XfaLayer=i},(r,e,s)=>{var y,u,h,l,c,b,_,f,p,A,k,P,g,R,E,Ds,Os,Ls,zs,ls,Bs,cs,Gs,Ws,Hs,Us,Vs,it,ds,Tt,wt,dt,us,Nt,G,qs,hs,Ks,Xs,ps,Pt,ut;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var t=s(1),i=s(4),a=s(29),o=s(6),w=s(5);const Re=class Re extends i.AnnotationEditor{constructor(M){super({...M,name:"inkEditor"});ne(this,E);ne(this,y,0);ne(this,u,0);ne(this,h,this.canvasPointermove.bind(this));ne(this,l,this.canvasPointerleave.bind(this));ne(this,c,this.canvasPointerup.bind(this));ne(this,b,this.canvasPointerdown.bind(this));ne(this,_,new Path2D);ne(this,f,!1);ne(this,p,!1);ne(this,A,!1);ne(this,k,null);ne(this,P,0);ne(this,g,0);ne(this,R,null);this.color=M.color||null,this.thickness=M.thickness||null,this.opacity=M.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(M){i.AnnotationEditor.initialize(M,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(M,H){switch(M){case t.AnnotationEditorParamsType.INK_THICKNESS:Re._defaultThickness=H;break;case t.AnnotationEditorParamsType.INK_COLOR:Re._defaultColor=H;break;case t.AnnotationEditorParamsType.INK_OPACITY:Re._defaultOpacity=H/100;break}}updateParams(M,H){switch(M){case t.AnnotationEditorParamsType.INK_THICKNESS:J(this,E,Ds).call(this,H);break;case t.AnnotationEditorParamsType.INK_COLOR:J(this,E,Os).call(this,H);break;case t.AnnotationEditorParamsType.INK_OPACITY:J(this,E,Ls).call(this,H);break}}static get defaultPropertiesToUpdate(){return[[t.AnnotationEditorParamsType.INK_THICKNESS,Re._defaultThickness],[t.AnnotationEditorParamsType.INK_COLOR,Re._defaultColor||i.AnnotationEditor._defaultLineColor],[t.AnnotationEditorParamsType.INK_OPACITY,Math.round(Re._defaultOpacity*100)]]}get propertiesToUpdate(){return[[t.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Re._defaultThickness],[t.AnnotationEditorParamsType.INK_COLOR,this.color||Re._defaultColor||i.AnnotationEditor._defaultLineColor],[t.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Re._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(J(this,E,Tt).call(this),J(this,E,wt).call(this)),this.isAttachedToDOM||(this.parent.add(this),J(this,E,dt).call(this)),J(this,E,ut).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,n(this,k).disconnect(),le(this,k,null),super.remove())}setParent(M){!this.parent&&M?this._uiManager.removeShouldRescale(this):this.parent&&M===null&&this._uiManager.addShouldRescale(this),super.setParent(M)}onScaleChanging(){const[M,H]=this.parentDimensions,Z=this.width*M,re=this.height*H;this.setDimensions(Z,re)}enableEditMode(){n(this,f)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",n(this,b)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",n(this,b)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){n(this,f)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),le(this,f,!0),this.div.classList.add("disabled"),J(this,E,ut).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(M){this._focusEventsAllowed&&(super.focusin(M),this.enableEditMode())}canvasPointerdown(M){M.button!==0||!this.isInEditMode()||n(this,f)||(this.setInForeground(),M.preventDefault(),M.type!=="mouse"&&this.div.focus(),J(this,E,Bs).call(this,M.offsetX,M.offsetY))}canvasPointermove(M){M.preventDefault(),J(this,E,cs).call(this,M.offsetX,M.offsetY)}canvasPointerup(M){M.preventDefault(),J(this,E,ds).call(this,M)}canvasPointerleave(M){J(this,E,ds).call(this,M)}get isResizable(){return!this.isEmpty()&&n(this,f)}render(){if(this.div)return this.div;let M,H;this.width&&(M=this.x,H=this.y),super.render(),i.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Ae=>{var te;return(te=this.div)==null?void 0:te.setAttribute("aria-label",Ae)});const[Z,re,fe,je]=J(this,E,zs).call(this);if(this.setAt(Z,re,0,0),this.setDims(fe,je),J(this,E,Tt).call(this),this.width){const[Ae,te]=this.parentDimensions;this.setAspectRatio(this.width*Ae,this.height*te),this.setAt(M*Ae,H*te,this.width*Ae,this.height*te),le(this,A,!0),J(this,E,dt).call(this),this.setDims(this.width*Ae,this.height*te),J(this,E,it).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return J(this,E,wt).call(this),this.div}setDimensions(M,H){const Z=Math.round(M),re=Math.round(H);if(n(this,P)===Z&&n(this,g)===re)return;le(this,P,Z),le(this,g,re),this.canvas.style.visibility="hidden";const[fe,je]=this.parentDimensions;this.width=M/fe,this.height=H/je,this.fixAndSetPosition(),n(this,f)&&J(this,E,us).call(this,M,H),J(this,E,dt).call(this),J(this,E,it).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(M,H,Z){var ze,Xe,Ye;if(M instanceof a.InkAnnotationElement)return null;const re=super.deserialize(M,H,Z);re.thickness=M.thickness,re.color=t.Util.makeHexColor(...M.color),re.opacity=M.opacity;const[fe,je]=re.pageDimensions,Ae=re.width*fe,te=re.height*je,Te=re.parentScale,_e=M.thickness/2;le(re,f,!0),le(re,P,Math.round(Ae)),le(re,g,Math.round(te));const{paths:We,rect:Be,rotation:Ke}=M;for(let{bezier:Ee}of We){Ee=J(ze=Re,G,Ks).call(ze,Ee,Be,Ke);const oe=[];re.paths.push(oe);let de=Te*(Ee[0]-_e),Pe=Te*(Ee[1]-_e);for(let Ve=2,U=Ee.length;Ve<U;Ve+=6){const ge=Te*(Ee[Ve]-_e),Ce=Te*(Ee[Ve+1]-_e),Ie=Te*(Ee[Ve+2]-_e),Le=Te*(Ee[Ve+3]-_e),Ne=Te*(Ee[Ve+4]-_e),L=Te*(Ee[Ve+5]-_e);oe.push([[de,Pe],[ge,Ce],[Ie,Le],[Ne,L]]),de=Ne,Pe=L}const qe=J(this,G,qs).call(this,oe);re.bezierPath2D.push(qe)}const Me=J(Xe=re,E,ps).call(Xe);return le(re,u,Math.max(i.AnnotationEditor.MIN_SIZE,Me[2]-Me[0])),le(re,y,Math.max(i.AnnotationEditor.MIN_SIZE,Me[3]-Me[1])),J(Ye=re,E,us).call(Ye,Ae,te),re}serialize(){if(this.isEmpty())return null;const M=this.getRect(0,0),H=i.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:t.AnnotationEditorType.INK,color:H,thickness:this.thickness,opacity:this.opacity,paths:J(this,E,Xs).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,M),pageIndex:this.pageIndex,rect:M,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};y=new WeakMap,u=new WeakMap,h=new WeakMap,l=new WeakMap,c=new WeakMap,b=new WeakMap,_=new WeakMap,f=new WeakMap,p=new WeakMap,A=new WeakMap,k=new WeakMap,P=new WeakMap,g=new WeakMap,R=new WeakMap,E=new WeakSet,Ds=function(M){const H=this.thickness;this.addCommands({cmd:()=>{this.thickness=M,J(this,E,ut).call(this)},undo:()=>{this.thickness=H,J(this,E,ut).call(this)},mustExec:!0,type:t.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Os=function(M){const H=this.color;this.addCommands({cmd:()=>{this.color=M,J(this,E,it).call(this)},undo:()=>{this.color=H,J(this,E,it).call(this)},mustExec:!0,type:t.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ls=function(M){M/=100;const H=this.opacity;this.addCommands({cmd:()=>{this.opacity=M,J(this,E,it).call(this)},undo:()=>{this.opacity=H,J(this,E,it).call(this)},mustExec:!0,type:t.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},zs=function(){const{parentRotation:M,parentDimensions:[H,Z]}=this;switch(M){case 90:return[0,Z,Z,H];case 180:return[H,Z,H,Z];case 270:return[H,0,Z,H];default:return[0,0,H,Z]}},ls=function(){const{ctx:M,color:H,opacity:Z,thickness:re,parentScale:fe,scaleFactor:je}=this;M.lineWidth=re*fe/je,M.lineCap="round",M.lineJoin="round",M.miterLimit=10,M.strokeStyle=`${H}${(0,w.opacityToHex)(Z)}`},Bs=function(M,H){this.canvas.addEventListener("contextmenu",o.noContextMenu),this.canvas.addEventListener("pointerleave",n(this,l)),this.canvas.addEventListener("pointermove",n(this,h)),this.canvas.addEventListener("pointerup",n(this,c)),this.canvas.removeEventListener("pointerdown",n(this,b)),this.isEditing=!0,n(this,A)||(le(this,A,!0),J(this,E,dt).call(this),this.thickness||(this.thickness=Re._defaultThickness),this.color||(this.color=Re._defaultColor||i.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Re._defaultOpacity)),this.currentPath.push([M,H]),le(this,p,!1),J(this,E,ls).call(this),le(this,R,()=>{J(this,E,Hs).call(this),n(this,R)&&window.requestAnimationFrame(n(this,R))}),window.requestAnimationFrame(n(this,R))},cs=function(M,H){const[Z,re]=this.currentPath.at(-1);if(this.currentPath.length>1&&M===Z&&H===re)return;const fe=this.currentPath;let je=n(this,_);if(fe.push([M,H]),le(this,p,!0),fe.length<=2){je.moveTo(...fe[0]),je.lineTo(M,H);return}fe.length===3&&(le(this,_,je=new Path2D),je.moveTo(...fe[0])),J(this,E,Us).call(this,je,...fe.at(-3),...fe.at(-2),M,H)},Gs=function(){if(this.currentPath.length===0)return;const M=this.currentPath.at(-1);n(this,_).lineTo(...M)},Ws=function(M,H){le(this,R,null),M=Math.min(Math.max(M,0),this.canvas.width),H=Math.min(Math.max(H,0),this.canvas.height),J(this,E,cs).call(this,M,H),J(this,E,Gs).call(this);let Z;if(this.currentPath.length!==1)Z=J(this,E,Vs).call(this);else{const te=[M,H];Z=[[te,te.slice(),te.slice(),te]]}const re=n(this,_),fe=this.currentPath;this.currentPath=[],le(this,_,new Path2D);const je=()=>{this.allRawPaths.push(fe),this.paths.push(Z),this.bezierPath2D.push(re),this.rebuild()},Ae=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(J(this,E,Tt).call(this),J(this,E,wt).call(this)),J(this,E,ut).call(this))};this.addCommands({cmd:je,undo:Ae,mustExec:!0})},Hs=function(){if(!n(this,p))return;le(this,p,!1);const M=Math.ceil(this.thickness*this.parentScale),H=this.currentPath.slice(-3),Z=H.map(je=>je[0]),re=H.map(je=>je[1]);Math.min(...Z)-M,Math.max(...Z)+M,Math.min(...re)-M,Math.max(...re)+M;const{ctx:fe}=this;fe.save(),fe.clearRect(0,0,this.canvas.width,this.canvas.height);for(const je of this.bezierPath2D)fe.stroke(je);fe.stroke(n(this,_)),fe.restore()},Us=function(M,H,Z,re,fe,je,Ae){const te=(H+re)/2,Te=(Z+fe)/2,_e=(re+je)/2,We=(fe+Ae)/2;M.bezierCurveTo(te+2*(re-te)/3,Te+2*(fe-Te)/3,_e+2*(re-_e)/3,We+2*(fe-We)/3,_e,We)},Vs=function(){const M=this.currentPath;if(M.length<=2)return[[M[0],M[0],M.at(-1),M.at(-1)]];const H=[];let Z,[re,fe]=M[0];for(Z=1;Z<M.length-2;Z++){const[Be,Ke]=M[Z],[Me,ze]=M[Z+1],Xe=(Be+Me)/2,Ye=(Ke+ze)/2,Ee=[re+2*(Be-re)/3,fe+2*(Ke-fe)/3],oe=[Xe+2*(Be-Xe)/3,Ye+2*(Ke-Ye)/3];H.push([[re,fe],Ee,oe,[Xe,Ye]]),[re,fe]=[Xe,Ye]}const[je,Ae]=M[Z],[te,Te]=M[Z+1],_e=[re+2*(je-re)/3,fe+2*(Ae-fe)/3],We=[te+2*(je-te)/3,Te+2*(Ae-Te)/3];return H.push([[re,fe],_e,We,[te,Te]]),H},it=function(){if(this.isEmpty()){J(this,E,Nt).call(this);return}J(this,E,ls).call(this);const{canvas:M,ctx:H}=this;H.setTransform(1,0,0,1,0,0),H.clearRect(0,0,M.width,M.height),J(this,E,Nt).call(this);for(const Z of this.bezierPath2D)H.stroke(Z)},ds=function(M){this.canvas.removeEventListener("pointerleave",n(this,l)),this.canvas.removeEventListener("pointermove",n(this,h)),this.canvas.removeEventListener("pointerup",n(this,c)),this.canvas.addEventListener("pointerdown",n(this,b)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",o.noContextMenu)},10),J(this,E,Ws).call(this,M.offsetX,M.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Tt=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",i.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(M=>{var H;return(H=this.canvas)==null?void 0:H.setAttribute("aria-label",M)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},wt=function(){le(this,k,new ResizeObserver(M=>{const H=M[0].contentRect;H.width&&H.height&&this.setDimensions(H.width,H.height)})),n(this,k).observe(this.div)},dt=function(){if(!n(this,A))return;const[M,H]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*M),this.canvas.height=Math.ceil(this.height*H),J(this,E,Nt).call(this)},us=function(M,H){const Z=J(this,E,Pt).call(this),re=(M-Z)/n(this,u),fe=(H-Z)/n(this,y);this.scaleFactor=Math.min(re,fe)},Nt=function(){const M=J(this,E,Pt).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+M,this.translationY*this.scaleFactor+M)},G=new WeakSet,qs=function(M){const H=new Path2D;for(let Z=0,re=M.length;Z<re;Z++){const[fe,je,Ae,te]=M[Z];Z===0&&H.moveTo(...fe),H.bezierCurveTo(je[0],je[1],Ae[0],Ae[1],te[0],te[1])}return H},hs=function(M,H,Z){const[re,fe,je,Ae]=H;switch(Z){case 0:for(let te=0,Te=M.length;te<Te;te+=2)M[te]+=re,M[te+1]=Ae-M[te+1];break;case 90:for(let te=0,Te=M.length;te<Te;te+=2){const _e=M[te];M[te]=M[te+1]+re,M[te+1]=_e+fe}break;case 180:for(let te=0,Te=M.length;te<Te;te+=2)M[te]=je-M[te],M[te+1]+=fe;break;case 270:for(let te=0,Te=M.length;te<Te;te+=2){const _e=M[te];M[te]=je-M[te+1],M[te+1]=Ae-_e}break;default:throw new Error("Invalid rotation")}return M},Ks=function(M,H,Z){const[re,fe,je,Ae]=H;switch(Z){case 0:for(let te=0,Te=M.length;te<Te;te+=2)M[te]-=re,M[te+1]=Ae-M[te+1];break;case 90:for(let te=0,Te=M.length;te<Te;te+=2){const _e=M[te];M[te]=M[te+1]-fe,M[te+1]=_e-re}break;case 180:for(let te=0,Te=M.length;te<Te;te+=2)M[te]=je-M[te],M[te+1]-=fe;break;case 270:for(let te=0,Te=M.length;te<Te;te+=2){const _e=M[te];M[te]=Ae-M[te+1],M[te+1]=je-_e}break;default:throw new Error("Invalid rotation")}return M},Xs=function(M,H,Z,re){var Te,_e;const fe=[],je=this.thickness/2,Ae=M*H+je,te=M*Z+je;for(const We of this.paths){const Be=[],Ke=[];for(let Me=0,ze=We.length;Me<ze;Me++){const[Xe,Ye,Ee,oe]=We[Me],de=M*Xe[0]+Ae,Pe=M*Xe[1]+te,qe=M*Ye[0]+Ae,Ve=M*Ye[1]+te,U=M*Ee[0]+Ae,ge=M*Ee[1]+te,Ce=M*oe[0]+Ae,Ie=M*oe[1]+te;Me===0&&(Be.push(de,Pe),Ke.push(de,Pe)),Be.push(qe,Ve,U,ge,Ce,Ie),Ke.push(qe,Ve),Me===ze-1&&Ke.push(Ce,Ie)}fe.push({bezier:J(Te=Re,G,hs).call(Te,Be,re,this.rotation),points:J(_e=Re,G,hs).call(_e,Ke,re,this.rotation)})}return fe},ps=function(){let M=1/0,H=-1/0,Z=1/0,re=-1/0;for(const fe of this.paths)for(const[je,Ae,te,Te]of fe){const _e=t.Util.bezierBoundingBox(...je,...Ae,...te,...Te);M=Math.min(M,_e[0]),Z=Math.min(Z,_e[1]),H=Math.max(H,_e[2]),re=Math.max(re,_e[3])}return[M,Z,H,re]},Pt=function(){return n(this,f)?Math.ceil(this.thickness*this.parentScale):0},ut=function(M=!1){if(this.isEmpty())return;if(!n(this,f)){J(this,E,it).call(this);return}const H=J(this,E,ps).call(this),Z=J(this,E,Pt).call(this);le(this,u,Math.max(i.AnnotationEditor.MIN_SIZE,H[2]-H[0])),le(this,y,Math.max(i.AnnotationEditor.MIN_SIZE,H[3]-H[1]));const re=Math.ceil(Z+n(this,u)*this.scaleFactor),fe=Math.ceil(Z+n(this,y)*this.scaleFactor),[je,Ae]=this.parentDimensions;this.width=re/je,this.height=fe/Ae,this.setAspectRatio(re,fe);const te=this.translationX,Te=this.translationY;this.translationX=-H[0],this.translationY=-H[1],J(this,E,dt).call(this),J(this,E,it).call(this),le(this,P,re),le(this,g,fe),this.setDims(re,fe);const _e=M?Z/this.scaleFactor/2:0;this.translate(te-this.translationX-_e,Te-this.translationY-_e)},ne(Re,G),Je(Re,"_defaultColor",null),Je(Re,"_defaultOpacity",1),Je(Re,"_defaultThickness",1),Je(Re,"_type","ink");let S=Re;e.InkEditor=S},(r,e,s)=>{var S,y,u,h,l,c,b,_,f,p,A,bt,vt,Mt,ms,$s,Ys,xs,kt,Js;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var t=s(1),i=s(4),a=s(6),o=s(29);const T=class T extends i.AnnotationEditor{constructor(V){super({...V,name:"stampEditor"});ne(this,A);ne(this,S,null);ne(this,y,null);ne(this,u,null);ne(this,h,null);ne(this,l,null);ne(this,c,null);ne(this,b,null);ne(this,_,null);ne(this,f,!1);ne(this,p,!1);le(this,h,V.bitmapUrl),le(this,l,V.bitmapFile)}static initialize(V){i.AnnotationEditor.initialize(V)}static get supportedTypes(){const V=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,t.shadow)(this,"supportedTypes",V.map(Q=>`image/${Q}`))}static get supportedTypesStr(){return(0,t.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(V){return this.supportedTypes.includes(V)}static paste(V,Q){Q.pasteEditor(t.AnnotationEditorType.STAMP,{bitmapFile:V.getAsFile()})}remove(){var V,Q;n(this,y)&&(le(this,S,null),this._uiManager.imageManager.deleteId(n(this,y)),(V=n(this,c))==null||V.remove(),le(this,c,null),(Q=n(this,b))==null||Q.disconnect(),le(this,b,null)),super.remove()}rebuild(){if(!this.parent){n(this,y)&&J(this,A,Mt).call(this);return}super.rebuild(),this.div!==null&&(n(this,y)&&J(this,A,Mt).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(n(this,u)||n(this,S)||n(this,h)||n(this,l))}get isResizable(){return!0}render(){if(this.div)return this.div;let V,Q;if(this.width&&(V=this.x,Q=this.y),super.render(),this.div.hidden=!0,n(this,S)?J(this,A,ms).call(this):J(this,A,Mt).call(this),this.width){const[K,ue]=this.parentDimensions;this.setAt(V*K,Q*ue,this.width*K,this.height*ue)}return this.div}static deserialize(V,Q,K){if(V instanceof o.StampAnnotationElement)return null;const ue=super.deserialize(V,Q,K),{rect:D,bitmapUrl:q,bitmapId:ee,isSvg:F,accessibilityData:d}=V;ee&&K.imageManager.isValidId(ee)?le(ue,y,ee):le(ue,h,q),le(ue,f,F);const[x,N]=ue.pageDimensions;return ue.width=(D[2]-D[0])/x,ue.height=(D[3]-D[1])/N,d&&(ue.altTextData=d),ue}serialize(V=!1,Q=null){if(this.isEmpty())return null;const K={annotationType:t.AnnotationEditorType.STAMP,bitmapId:n(this,y),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:n(this,f),structTreeParentId:this._structTreeParentId};if(V)return K.bitmapUrl=J(this,A,kt).call(this,!0),K.accessibilityData=this.altTextData,K;const{decorative:ue,altText:D}=this.altTextData;if(!ue&&D&&(K.accessibilityData={type:"Figure",alt:D}),Q===null)return K;Q.stamps||(Q.stamps=new Map);const q=n(this,f)?(K.rect[2]-K.rect[0])*(K.rect[3]-K.rect[1]):null;if(!Q.stamps.has(n(this,y)))Q.stamps.set(n(this,y),{area:q,serialized:K}),K.bitmap=J(this,A,kt).call(this,!1);else if(n(this,f)){const ee=Q.stamps.get(n(this,y));q>ee.area&&(ee.area=q,ee.serialized.bitmap.close(),ee.serialized.bitmap=J(this,A,kt).call(this,!1))}return K}};S=new WeakMap,y=new WeakMap,u=new WeakMap,h=new WeakMap,l=new WeakMap,c=new WeakMap,b=new WeakMap,_=new WeakMap,f=new WeakMap,p=new WeakMap,A=new WeakSet,bt=function(V,Q=!1){if(!V){this.remove();return}le(this,S,V.bitmap),Q||(le(this,y,V.id),le(this,f,V.isSvg)),J(this,A,ms).call(this)},vt=function(){le(this,u,null),this._uiManager.enableWaiting(!1),n(this,c)&&this.div.focus()},Mt=function(){if(n(this,y)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(n(this,y)).then(Q=>J(this,A,bt).call(this,Q,!0)).finally(()=>J(this,A,vt).call(this));return}if(n(this,h)){const Q=n(this,h);le(this,h,null),this._uiManager.enableWaiting(!0),le(this,u,this._uiManager.imageManager.getFromUrl(Q).then(K=>J(this,A,bt).call(this,K)).finally(()=>J(this,A,vt).call(this)));return}if(n(this,l)){const Q=n(this,l);le(this,l,null),this._uiManager.enableWaiting(!0),le(this,u,this._uiManager.imageManager.getFromFile(Q).then(K=>J(this,A,bt).call(this,K)).finally(()=>J(this,A,vt).call(this)));return}const V=document.createElement("input");V.type="file",V.accept=T.supportedTypesStr,le(this,u,new Promise(Q=>{V.addEventListener("change",async()=>{if(!V.files||V.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const K=await this._uiManager.imageManager.getFromFile(V.files[0]);J(this,A,bt).call(this,K)}Q()}),V.addEventListener("cancel",()=>{this.remove(),Q()})}).finally(()=>J(this,A,vt).call(this))),V.click()},ms=function(){const{div:V}=this;let{width:Q,height:K}=n(this,S);const[ue,D]=this.pageDimensions,q=.75;if(this.width)Q=this.width*ue,K=this.height*D;else if(Q>q*ue||K>q*D){const x=Math.min(q*ue/Q,q*D/K);Q*=x,K*=x}const[ee,F]=this.parentDimensions;this.setDims(Q*ee/ue,K*F/D),this._uiManager.enableWaiting(!1);const d=le(this,c,document.createElement("canvas"));V.append(d),V.hidden=!1,J(this,A,xs).call(this,Q,K),J(this,A,Js).call(this),n(this,p)||(this.parent.addUndoableEditor(this),le(this,p,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},$s=function(V,Q){var q;const[K,ue]=this.parentDimensions;this.width=V/K,this.height=Q/ue,this.setDims(V,Q),(q=this._initialOptions)!=null&&q.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,n(this,_)!==null&&clearTimeout(n(this,_)),le(this,_,setTimeout(()=>{le(this,_,null),J(this,A,xs).call(this,V,Q)},200))},Ys=function(V,Q){const{width:K,height:ue}=n(this,S);let D=K,q=ue,ee=n(this,S);for(;D>2*V||q>2*Q;){const F=D,d=q;D>2*V&&(D=D>=16384?Math.floor(D/2)-1:Math.ceil(D/2)),q>2*Q&&(q=q>=16384?Math.floor(q/2)-1:Math.ceil(q/2));const x=new OffscreenCanvas(D,q);x.getContext("2d").drawImage(ee,0,0,F,d,0,0,D,q),ee=x.transferToImageBitmap()}return ee},xs=function(V,Q){V=Math.ceil(V),Q=Math.ceil(Q);const K=n(this,c);if(!K||K.width===V&&K.height===Q)return;K.width=V,K.height=Q;const ue=n(this,f)?n(this,S):J(this,A,Ys).call(this,V,Q),D=K.getContext("2d");D.filter=this._uiManager.hcmFilter,D.drawImage(ue,0,0,ue.width,ue.height,0,0,V,Q)},kt=function(V){if(V){if(n(this,f)){const ue=this._uiManager.imageManager.getSvgUrl(n(this,y));if(ue)return ue}const Q=document.createElement("canvas");return{width:Q.width,height:Q.height}=n(this,S),Q.getContext("2d").drawImage(n(this,S),0,0),Q.toDataURL()}if(n(this,f)){const[Q,K]=this.pageDimensions,ue=Math.round(this.width*Q*a.PixelsPerInch.PDF_TO_CSS_UNITS),D=Math.round(this.height*K*a.PixelsPerInch.PDF_TO_CSS_UNITS),q=new OffscreenCanvas(ue,D);return q.getContext("2d").drawImage(n(this,S),0,0,n(this,S).width,n(this,S).height,0,0,ue,D),q.transferToImageBitmap()}return structuredClone(n(this,S))},Js=function(){le(this,b,new ResizeObserver(V=>{const Q=V[0].contentRect;Q.width&&Q.height&&J(this,A,$s).call(this,Q.width,Q.height)})),n(this,b).observe(this.div)},Je(T,"_type","stamp");let w=T;e.StampEditor=w}],__webpack_module_cache__={};function __w_pdfjs_require__(r){var e=__webpack_module_cache__[r];if(e!==void 0)return e.exports;var s=__webpack_module_cache__[r]={exports:{}};return __webpack_modules__[r](s,s.exports,__w_pdfjs_require__),s.exports}var __webpack_exports__={};return(()=>{var r=__webpack_exports__;Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(r,"AnnotationEditorLayer",{enumerable:!0,get:function(){return a.AnnotationEditorLayer}}),Object.defineProperty(r,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(r,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(r,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return o.AnnotationEditorUIManager}}),Object.defineProperty(r,"AnnotationLayer",{enumerable:!0,get:function(){return w.AnnotationLayer}}),Object.defineProperty(r,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(r,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(r,"DOMSVGFactory",{enumerable:!0,get:function(){return t.DOMSVGFactory}}),Object.defineProperty(r,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(r,"GlobalWorkerOptions",{enumerable:!0,get:function(){return S.GlobalWorkerOptions}}),Object.defineProperty(r,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(r,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(r,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(r,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(r,"PDFDataRangeTransport",{enumerable:!0,get:function(){return s.PDFDataRangeTransport}}),Object.defineProperty(r,"PDFDateString",{enumerable:!0,get:function(){return t.PDFDateString}}),Object.defineProperty(r,"PDFWorker",{enumerable:!0,get:function(){return s.PDFWorker}}),Object.defineProperty(r,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(r,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(r,"PixelsPerInch",{enumerable:!0,get:function(){return t.PixelsPerInch}}),Object.defineProperty(r,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(r,"RenderingCancelledException",{enumerable:!0,get:function(){return t.RenderingCancelledException}}),Object.defineProperty(r,"SVGGraphics",{enumerable:!0,get:function(){return s.SVGGraphics}}),Object.defineProperty(r,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(r,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(r,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(r,"XfaLayer",{enumerable:!0,get:function(){return y.XfaLayer}}),Object.defineProperty(r,"build",{enumerable:!0,get:function(){return s.build}}),Object.defineProperty(r,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(r,"getDocument",{enumerable:!0,get:function(){return s.getDocument}}),Object.defineProperty(r,"getFilenameFromUrl",{enumerable:!0,get:function(){return t.getFilenameFromUrl}}),Object.defineProperty(r,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return t.getPdfFilenameFromUrl}}),Object.defineProperty(r,"getXfaPageViewport",{enumerable:!0,get:function(){return t.getXfaPageViewport}}),Object.defineProperty(r,"isDataScheme",{enumerable:!0,get:function(){return t.isDataScheme}}),Object.defineProperty(r,"isPdfFile",{enumerable:!0,get:function(){return t.isPdfFile}}),Object.defineProperty(r,"loadScript",{enumerable:!0,get:function(){return t.loadScript}}),Object.defineProperty(r,"noContextMenu",{enumerable:!0,get:function(){return t.noContextMenu}}),Object.defineProperty(r,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(r,"renderTextLayer",{enumerable:!0,get:function(){return i.renderTextLayer}}),Object.defineProperty(r,"setLayerDimensions",{enumerable:!0,get:function(){return t.setLayerDimensions}}),Object.defineProperty(r,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(r,"updateTextLayer",{enumerable:!0,get:function(){return i.updateTextLayer}}),Object.defineProperty(r,"version",{enumerable:!0,get:function(){return s.version}});var e=__w_pdfjs_require__(1),s=__w_pdfjs_require__(2),t=__w_pdfjs_require__(6),i=__w_pdfjs_require__(26),a=__w_pdfjs_require__(27),o=__w_pdfjs_require__(5),w=__w_pdfjs_require__(29),S=__w_pdfjs_require__(14),y=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;pdfExports.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`;function detectPDFType(r,e){const s=r.toUpperCase(),t=e.toUpperCase();return t.includes("B03")||s.includes("TOPSIDE")||s.includes("RISER P5")||s.includes("RISER P6")?"B03_TOPSIDE":t.includes("B05")||s.includes("SUBSEA")||s.includes("PE_4")||s.includes("PE_EO")?"B05_SUBSEA":t.includes("PVT")||t.includes("CALIBRATION")||s.includes("K-FACTORS")||s.includes("MOLAR COMPOSITION")?"PVT_CALIBRATION":"UNKNOWN"}function extractDate(r,e){const s=e.match(/(\d{8})/);if(s){const i=s[1];return`${i.slice(0,4)}-${i.slice(4,6)}-${i.slice(6,8)}`}const t=r.match(/(\d{4})[/-](\d{2})[/-](\d{2})/);return t?`${t[1]}-${t[2]}-${t[3]}`:new Date().toISOString().split("T")[0]}function extractNumber(r,e){const s=r.match(e);if(s){const t=s[1].replace(",",".");return parseFloat(t)||0}return 0}function parseB03Topside(r,e){const s=extractDate(r,e);let t="13FT0367";(r.includes("P6")||r.includes("13FT0417"))&&(t="13FT0417");let i=extractNumber(r,/(?:oil|óleo)[\s:]+(\d+\.?\d*)/i),a=extractNumber(r,/(?:gas|gás)[\s:]+(\d+\.?\d*)/i),o=extractNumber(r,/(?:water|água)[\s:]+(\d+\.?\d*)/i);if(i===0){const l=r.match(/Oil\s+(\d+\.?\d*)/i);l&&(i=parseFloat(l[1])||0)}if(a===0){const l=r.match(/Gas\s+(\d+\.?\d*)/i);l&&(a=parseFloat(l[1])||0)}if(o===0){const l=r.match(/Water\s+(\d+\.?\d*)/i);l&&(o=parseFloat(l[1])||0)}const w=/(\d{3,5}\.?\d*)\s*(?:t|ton)/gi,S=[];let y;for(;(y=w.exec(r))!==null;)S.push(parseFloat(y[1]));S.length>=3&&i===0&&(i=S[0],a=S[1],o=S[2]||0);const u=i+a,h=u+o;return{date:s,source:"TOPSIDE",meterTag:t,oil:i,gas:a,water:o,hc:u,total:h,fileName:e}}function parseB05Subsea(r,e){const s=extractDate(r,e);let t="18FT1506";r.includes("PE_EO4")||r.includes("18FT1806")?t="18FT1806":r.includes("PE_EO105")||r.includes("18FT1706")?t="18FT1706":(r.includes("PE_EO10")||r.includes("18FT1406"))&&(t="18FT1406");let i=extractNumber(r,/(?:oil|óleo)[\s:]+(\d+\.?\d*)/i),a=extractNumber(r,/(?:gas|gás)[\s:]+(\d+\.?\d*)/i),o=extractNumber(r,/(?:water|água)[\s:]+(\d+\.?\d*)/i);if(a===0){const l=r.match(/(?:hc|hydrocarbon)[\s:]+(\d+\.?\d*)/i);l&&(i=parseFloat(l[1])||0)}const w=/(\d{3,5}\.?\d*)\s*(?:t|ton)/gi,S=[];let y;for(;(y=w.exec(r))!==null;)S.push(parseFloat(y[1]));S.length>=2&&i===0&&(i=S[0],o=S[1]||0);const u=i+a,h=u+o;return{date:s,source:"SUBSEA",meterTag:t,oil:i,gas:a,water:o,hc:u,total:h,fileName:e}}function parsePVTCalibration(r,e){const s=r.match(/(?:calibration|cal\.?)\s*(?:#|no\.?|number)?\s*(\d+)/i),t=s?parseInt(s[1]):0;let i="13FT0367",a="Riser P5";r.includes("13FT0417")&&(i="13FT0417",a="Riser P6");const o=extractDate(r,e),w=r.match(/end[:\s]+(\d{4}-\d{2}-\d{2})/i),S=w?w[1]:o,y=extractNumber(r,/mpfm.*?pressure[:\s]+(\d+\.?\d*)/i)||extractNumber(r,/pressure.*?mpfm[:\s]+(\d+\.?\d*)/i)||11505.73,u=extractNumber(r,/separator.*?pressure[:\s]+(\d+\.?\d*)/i)||extractNumber(r,/pressure.*?separator[:\s]+(\d+\.?\d*)/i)||8343.63,h=extractNumber(r,/mpfm.*?temp[:\s]+(\d+\.?\d*)/i)||extractNumber(r,/temp.*?mpfm[:\s]+(\d+\.?\d*)/i)||75.07,l=extractNumber(r,/separator.*?temp[:\s]+(\d+\.?\d*)/i)||extractNumber(r,/temp.*?separator[:\s]+(\d+\.?\d*)/i)||72.18,c=[{component:"N₂",molPercent:.575,molecularWeight:28.01},{component:"CO₂",molPercent:.02,molecularWeight:44.01},{component:"C₁",molPercent:62.183,molecularWeight:16.04},{component:"C₂",molPercent:8.069,molecularWeight:30.07},{component:"C₃",molPercent:5.047,molecularWeight:44.1},{component:"i-C₄",molPercent:1.069,molecularWeight:58.12},{component:"n-C₄",molPercent:1.858,molecularWeight:58.12},{component:"i-C₅",molPercent:.681,molecularWeight:72.15},{component:"n-C₅",molPercent:.788,molecularWeight:72.15},{component:"C₆",molPercent:1.112,molecularWeight:86.18},{component:"C₇",molPercent:1.138,molecularWeight:97.37},{component:"C₈",molPercent:1.657,molecularWeight:111.29},{component:"C₉",molPercent:1.472,molecularWeight:125.25},{component:"C₁₀+",molPercent:14.331,molecularWeight:289.64}],b=extractNumber(r,/k[_-]?oil.*?new[:\s]+(\d+\.?\d*)/i)||extractNumber(r,/new.*?k[_-]?oil[:\s]+(\d+\.?\d*)/i)||1.0908,_=extractNumber(r,/k[_-]?gas.*?new[:\s]+(\d+\.?\d*)/i)||extractNumber(r,/new.*?k[_-]?gas[:\s]+(\d+\.?\d*)/i)||1.09262,f=extractNumber(r,/k[_-]?water.*?new[:\s]+(\d+\.?\d*)/i)||1,p=extractNumber(r,/mpfm.*?oil.*?(\d{4,}\.?\d*)/i)||6365.07,A=extractNumber(r,/mpfm.*?gas.*?(\d{3,}\.?\d*)/i)||1476.18,k=extractNumber(r,/mpfm.*?water.*?(\d+\.?\d*)/i)||1.46,P=extractNumber(r,/separator.*?oil.*?(\d{4,}\.?\d*)/i)||6742.65,g=extractNumber(r,/separator.*?gas.*?(\d{3,}\.?\d*)/i)||1813.28,R=extractNumber(r,/separator.*?water.*?(\d+\.?\d*)/i)||24.93;return{calibrationNo:t,meterTag:i,meterName:a,startDate:o,endDate:S,pressure:{mpfm:y,separator:u},temperature:{mpfm:h,separator:l},composition:c,kFactors:{oil:{used:.94433,new:b},gas:{used:.96191,new:_},water:{used:1,new:f}},accumulatedMass:{mpfm:{oil:p,gas:A,water:k,hc:p+A},separator:{oil:P,gas:g,water:R,hc:P+g}},fileName:e}}async function extractTextFromPDF(r){const e=await r.arrayBuffer(),s=await pdfExports.getDocument({data:e}).promise;let t="";for(let i=1;i<=s.numPages;i++){const w=(await(await s.getPage(i)).getTextContent()).items.filter(S=>"str"in S).map(S=>S.str).join(" ");t+=w+`
`}return t}async function parsePDFFile(r){try{const e=await extractTextFromPDF(r),s=detectPDFType(e,r.name);switch(s){case"B03_TOPSIDE":return{success:!0,type:s,dailyData:parseB03Topside(e,r.name),fileName:r.name};case"B05_SUBSEA":return{success:!0,type:s,dailyData:parseB05Subsea(e,r.name),fileName:r.name};case"PVT_CALIBRATION":return{success:!0,type:s,calibrationData:parsePVTCalibration(e,r.name),fileName:r.name};default:return{success:!1,type:"UNKNOWN",error:"Tipo de PDF não reconhecido. Use arquivos B03 (Topside), B05 (Subsea) ou PVT Calibration.",fileName:r.name}}}catch(e){return{success:!1,type:"UNKNOWN",error:e instanceof Error?e.message:"Erro ao processar PDF",fileName:r.name}}}async function parsePDFBatch(r){const e=[];for(const s of r){const t=await parsePDFFile(s);e.push(t)}return e}const ImportDataModal=({isOpen:r,onClose:e})=>{const{importMonitoringData:s,addAlert:t,updateMeter:i,meters:a}=useAppStore(),[o,w]=reactExports.useState([]),[S,y]=reactExports.useState([]),[u,h]=reactExports.useState(!1),[l,c]=reactExports.useState(!1),b=reactExports.useRef(null),_=reactExports.useCallback(j=>{j.preventDefault(),c(!0)},[]),f=reactExports.useCallback(j=>{j.preventDefault(),c(!1)},[]),p=reactExports.useCallback(j=>{j.preventDefault(),c(!1);const z=Array.from(j.dataTransfer.files).filter(v=>v.type==="application/pdf"||v.name.endsWith(".pdf"));z.length>0&&w(v=>[...v,...z])},[]),A=j=>{const z=Array.from(j.target.files||[]).filter(v=>v.type==="application/pdf"||v.name.endsWith(".pdf"));z.length>0&&w(v=>[...v,...z]),b.current&&(b.current.value="")},k=j=>{w(z=>z.filter((v,T)=>T!==j)),y(z=>z.filter((v,T)=>T!==j))},P=async()=>{if(o.length!==0){h(!0),y([]);try{const j=await parsePDFBatch(o);y(j)}catch{t({type:"error",severity:"critical",message:"Erro ao processar arquivos PDF"})}finally{h(!1)}}},g=()=>{const j=S.filter(T=>T.success);if(j.length===0){t({type:"error",severity:"warning",message:"Nenhum dado válido para importar"});return}const z=new Map;j.forEach(T=>{if(T.dailyData){const O=T.dailyData.date,se=z.get(O)||{};T.dailyData.source==="TOPSIDE"?se.topside=T.dailyData:se.subsea=T.dailyData,z.set(O,se)}if(T.calibrationData){const O=a.find(se=>se.tag===T.calibrationData.meterTag);O&&(i(O.id,{kOil:T.calibrationData.kFactors.oil.new,kGas:T.calibrationData.kFactors.gas.new,kWater:T.calibrationData.kFactors.water.new,lastCalibration:T.calibrationData.endDate}),t({type:"success",severity:"info",message:`K-factors do medidor ${O.tag} atualizados pela calibração`,meterId:O.id,meterTag:O.tag}))}});const v=[];z.forEach((T,O)=>{const se=T.subsea,V=T.topside,Q=(se==null?void 0:se.oil)||0,K=(se==null?void 0:se.gas)||0,ue=(se==null?void 0:se.water)||0,D=Q+K,q=(V==null?void 0:V.oil)||0,ee=(V==null?void 0:V.gas)||0,F=(V==null?void 0:V.water)||0,d=q+ee,x=q*.98,N=ee*.99,B=F,G=x+N,W=D>0?(d-D)/D*100:0,Y=D+ue,ce=d+F,me=Y>0?(ce-Y)/Y*100:0,xe=Math.abs(W)>10?"FAIL":Math.abs(W)>7?"ALERT":"OK",be=Math.abs(me)>7?"FAIL":Math.abs(me)>5?"ALERT":"OK";v.push({id:`mon-${O}-${Date.now()}`,date:O,subOil:Q,subGas:K,subWater:ue,subHC:D,topOil:q,topGas:ee,topWater:F,topHC:d,sepOil:x,sepGas:N,sepWater:B,sepHC:G,hcBalTS:parseFloat(W.toFixed(2)),totalBalTS:parseFloat(me.toFixed(2)),hcBalancePercent:parseFloat(W.toFixed(2)),totalBalancePercent:parseFloat(me.toFixed(2)),hcStatus:xe,totalStatus:be,action:xe==="FAIL"||be==="FAIL"?"INVESTIGAR":"MONITORAR",subVsTS:parseFloat(W.toFixed(2)),topVsTS:0,topVsSub:parseFloat(((d-D)/(D||1)*100).toFixed(2))})}),v.length>0&&(s(v),t({type:"success",severity:"info",message:`${v.length} registro(s) de produção importado(s) com sucesso`})),R()},R=()=>{w([]),y([]),h(!1),e()},E=S.filter(j=>j.success).length,C=S.filter(j=>!j.success).length;return jsxRuntimeExports.jsx(Modal,{isOpen:r,onClose:R,title:"Importar Relatórios PDF",size:"lg",children:jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-blue-300",children:"Arraste e solte arquivos PDF ou clique para selecionar. São aceitos:"}),jsxRuntimeExports.jsxs("ul",{className:"text-xs text-blue-300/80 mt-2 space-y-1 ml-4",children:[jsxRuntimeExports.jsxs("li",{children:["• ",jsxRuntimeExports.jsx("strong",{children:"B03_MPFM_Daily"})," - Relatórios Topside (Riser P5/P6)"]}),jsxRuntimeExports.jsxs("li",{children:["• ",jsxRuntimeExports.jsx("strong",{children:"B05_MPFM_Daily"})," - Relatórios Subsea (PE_4, PE_EO)"]}),jsxRuntimeExports.jsxs("li",{children:["• ",jsxRuntimeExports.jsx("strong",{children:"PVTCalibration"})," - Relatórios de Calibração PVT"]})]})]}),jsxRuntimeExports.jsxs("div",{onDragOver:_,onDragLeave:f,onDrop:p,onClick:()=>{var j;return(j=b.current)==null?void 0:j.click()},className:cn("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-all",l?"border-blue-500 bg-blue-500/10":"border-zinc-600 hover:border-zinc-500 hover:bg-zinc-800/50"),children:[jsxRuntimeExports.jsx("input",{ref:b,type:"file",accept:".pdf",multiple:!0,onChange:A,className:"hidden","aria-label":"Select PDF files"}),jsxRuntimeExports.jsx(FileUp,{size:48,className:cn("mx-auto mb-3",l?"text-blue-400":"text-zinc-500")}),jsxRuntimeExports.jsx("p",{className:"text-zinc-300 font-medium",children:l?"Solte os arquivos aqui":"Arraste PDFs ou clique para selecionar"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Suporta múltiplos arquivos (importação em lote)"})]}),o.length>0&&jsxRuntimeExports.jsxs(Card,{className:"p-3 bg-zinc-800/50 max-h-48 overflow-y-auto",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsxs("span",{className:"text-sm font-medium text-zinc-300",children:[o.length," arquivo(s) selecionado(s)"]}),S.length>0&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[E>0&&jsxRuntimeExports.jsxs(Badge,{variant:"success",children:[E," OK"]}),C>0&&jsxRuntimeExports.jsxs(Badge,{variant:"error",children:[C," Erro"]})]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:o.map((j,z)=>{const v=S[z];return jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-2 bg-zinc-900/50 rounded",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[jsxRuntimeExports.jsx(FileText,{size:16,className:"text-zinc-400 flex-shrink-0"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-zinc-300 truncate",children:j.name})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[v&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:v.success?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(CheckCircle,{size:14,className:"text-emerald-400"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-emerald-400",children:v.type.replace("_"," ")})]}):jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(XCircle,{size:14,className:"text-red-400"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-red-400 max-w-32 truncate",children:v.error})]})}),jsxRuntimeExports.jsx("button",{type:"button",title:"Remover arquivo",onClick:T=>{T.stopPropagation(),k(z)},className:"p-1 text-zinc-500 hover:text-red-400 transition-colors",children:jsxRuntimeExports.jsx(Trash2,{size:14})})]})]},z)})})]}),S.length>0&&E>0&&jsxRuntimeExports.jsxs(Card,{className:"p-3 bg-emerald-500/10 border-emerald-500/30",children:[jsxRuntimeExports.jsxs("h4",{className:"text-sm font-medium text-emerald-400 mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Database,{size:16}),"Dados Prontos para Importação"]}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-emerald-300/80 space-y-1",children:[S.filter(j=>j.success&&j.dailyData).length>0&&jsxRuntimeExports.jsxs("p",{children:["• ",S.filter(j=>j.dailyData).length," registro(s) de produção diária"]}),S.filter(j=>j.success&&j.calibrationData).length>0&&jsxRuntimeExports.jsxs("p",{children:["• ",S.filter(j=>j.calibrationData).length," relatório(s) de calibração"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 pt-2 border-t border-zinc-800",children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",onClick:R,children:"Cancelar"}),S.length===0?jsxRuntimeExports.jsx(Button,{variant:"primary",onClick:P,disabled:o.length===0||u,children:u?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader2,{size:16,className:"animate-spin mr-2"}),"Processando..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Upload,{size:16,className:"mr-2"}),"Processar PDFs"]})}):jsxRuntimeExports.jsxs(Button,{variant:"primary",onClick:g,disabled:E===0,children:[jsxRuntimeExports.jsx(Database,{size:16,className:"mr-2"}),"Importar ",E," Registro(s)"]})]})]})})};function objectsToCSV(r,e){if(r.length===0)return"";const s=e||Object.keys(r[0]).map(a=>({key:a,header:String(a)})),t=s.map(a=>`"${a.header}"`).join(","),i=r.map(a=>s.map(o=>{const w=a[o.key];return w==null?"":typeof w=="string"?`"${w.replace(/"/g,'""')}"`:String(w)}).join(","));return[t,...i].join(`
`)}function downloadFile(r,e,s){const t=new Blob([r],{type:s}),i=URL.createObjectURL(t),a=document.createElement("a");a.href=i,a.download=e,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)}function exportMonitoringDataToCSV(r){const s=objectsToCSV(r,[{key:"date",header:"Data"},{key:"subOil",header:"Subsea Óleo (t)"},{key:"subGas",header:"Subsea Gás (t)"},{key:"subHC",header:"Subsea HC (t)"},{key:"topOil",header:"Topside Óleo (t)"},{key:"topGas",header:"Topside Gás (t)"},{key:"topHC",header:"Topside HC (t)"},{key:"sepOil",header:"Separador Óleo (t)"},{key:"sepGas",header:"Separador Gás (t)"},{key:"sepHC",header:"Separador HC (t)"},{key:"hcBalTS",header:"Balanço HC (%)"},{key:"totalBalTS",header:"Balanço Total (%)"},{key:"hcStatus",header:"Status HC"},{key:"action",header:"Ação"}]),t=new Date().toISOString().split("T")[0];downloadFile(s,`monitoramento_mpfm_${t}.csv`,"text/csv;charset=utf-8")}function exportMetersToCSV(r){const s=objectsToCSV(r,[{key:"tag",header:"TAG"},{key:"name",header:"Nome"},{key:"location",header:"Localização"},{key:"status",header:"Status"},{key:"manufacturer",header:"Fabricante"},{key:"model",header:"Modelo"},{key:"serialNumber",header:"Número de Série"},{key:"lastCalibration",header:"Última Calibração"},{key:"kOil",header:"K-Oil"},{key:"kGas",header:"K-Gas"},{key:"kWater",header:"K-Water"},{key:"daysToCalibration",header:"Dias para Calibração"}]),t=new Date().toISOString().split("T")[0];downloadFile(s,`medidores_mpfm_${t}.csv`,"text/csv;charset=utf-8")}function exportCalibrationEventsToCSV(r){const s=objectsToCSV(r,[{key:"id",header:"ID Evento"},{key:"meterTag",header:"TAG Medidor"},{key:"meterName",header:"Nome Medidor"},{key:"type",header:"Tipo"},{key:"status",header:"Status"},{key:"result",header:"Resultado"},{key:"startDate",header:"Data Início"},{key:"endDate",header:"Data Fim"},{key:"currentStep",header:"Etapa Atual"},{key:"progress",header:"Progresso (%)"},{key:"responsible",header:"Responsável"}]),t=new Date().toISOString().split("T")[0];downloadFile(s,`calibracoes_mpfm_${t}.csv`,"text/csv;charset=utf-8")}function exportAllDataToJSON(r,e){const s={version:"1.0.0",exportDate:new Date().toISOString(),...r},t=JSON.stringify(s,null,2),i=new Date().toISOString().split("T")[0];downloadFile(t,`${e||"mpfm_backup"}_${i}.json`,"application/json")}function generateCalibrationReport(r){const e=new Date().toLocaleString("pt-BR");return`
================================================================================
                    RELATÓRIO DE AVALIAÇÃO DE DESEMPENHO MPFM
                           CONFORME RANP 44/2015
================================================================================

ID do Evento: ${r.id}
Data de Emissão: ${e}

DADOS DO MEDIDOR
--------------------------------------------------------------------------------
TAG: ${r.meterTag}
Nome: ${r.meterName}
Tipo de Avaliação: ${r.type}

STATUS DA AVALIAÇÃO
--------------------------------------------------------------------------------
Status: ${r.status}
Resultado: ${r.result||"Pendente"}
Etapa Atual: ${r.currentStep}/7
Progresso: ${r.progress}%

PERÍODO
--------------------------------------------------------------------------------
Data de Início: ${r.startDate}
Data de Término: ${r.endDate||"Em andamento"}

RESPONSÁVEL
--------------------------------------------------------------------------------
${r.responsible}

================================================================================
                           FIM DO RELATÓRIO
================================================================================
`}function exportCalibrationReport(r){const e=generateCalibrationReport(r),s=new Date().toISOString().split("T")[0];downloadFile(e,`relatorio_${r.id}_${s}.txt`,"text/plain;charset=utf-8")}const ExportDataModal=({isOpen:r,onClose:e})=>{const{monitoringData:s,meters:t,calibrationEvents:i,selectedEvent:a}=useAppStore(),[o,w]=reactExports.useState("monitoring"),[S,y]=reactExports.useState("csv"),[u,h]=reactExports.useState(!1),l=async()=>{h(!0);try{switch(o){case"monitoring":S==="csv"?exportMonitoringDataToCSV(s):exportAllDataToJSON({monitoringData:s},"monitoring_data");break;case"meters":S==="csv"?exportMetersToCSV(t):exportAllDataToJSON({meters:t},"meters");break;case"calibration":S==="csv"?exportCalibrationEventsToCSV(i):exportAllDataToJSON({calibrationEvents:i},"calibration_events");break;case"all":exportAllDataToJSON({monitoringData:s,meters:t,calibrationEvents:i},"mpfm_monitor_backup");break;case"report":a&&exportCalibrationReport(a);break}e()}catch(c){console.error("Erro ao exportar:",c)}finally{h(!1)}};return jsxRuntimeExports.jsx(Modal,{isOpen:r,onClose:e,title:"Exportar Dados",size:"lg",children:jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"O que deseja exportar?"}),jsxRuntimeExports.jsx(Select,{value:o,onChange:c=>w(c.target.value),options:[{value:"monitoring",label:"Dados de Monitoramento"},{value:"meters",label:"Cadastro de Medidores"},{value:"calibration",label:"Eventos de Calibração"},{value:"all",label:"Backup Completo"},...a?[{value:"report",label:"Relatório de Calibração (Evento Selecionado)"}]:[]]})]}),o!=="all"&&o!=="report"&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Formato"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsxs("label",{className:"flex items-center",children:[jsxRuntimeExports.jsx("input",{type:"radio",name:"format",value:"csv",checked:S==="csv",onChange:c=>y(c.target.value),className:"mr-2"}),"CSV (Excel)"]}),jsxRuntimeExports.jsxs("label",{className:"flex items-center",children:[jsxRuntimeExports.jsx("input",{type:"radio",name:"format",value:"json",checked:S==="json",onChange:c=>y(c.target.value),className:"mr-2"}),"JSON"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Resumo"}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[o==="monitoring"&&jsxRuntimeExports.jsxs("p",{children:["📊 ",s.length," registros de monitoramento"]}),o==="meters"&&jsxRuntimeExports.jsxs("p",{children:["📍 ",t.length," medidores cadastrados"]}),o==="calibration"&&jsxRuntimeExports.jsxs("p",{children:["🔧 ",i.length," eventos de calibração"]}),o==="all"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("p",{children:["📊 ",s.length," registros de monitoramento"]}),jsxRuntimeExports.jsxs("p",{children:["📍 ",t.length," medidores"]}),jsxRuntimeExports.jsxs("p",{children:["🔧 ",i.length," eventos de calibração"]})]}),o==="report"&&a&&jsxRuntimeExports.jsxs("p",{children:["📄 Relatório para evento: ",a.id]})]})]}),o==="all"&&jsxRuntimeExports.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-yellow-700",children:"⚠️ O backup completo será exportado em formato JSON. Guarde este arquivo em local seguro para restauração futura."})}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",onClick:e,children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{type:"button",variant:"primary",onClick:l,disabled:u||o==="report"&&!a,children:u?"Exportando...":"Exportar"})]})]})})},NewCalibrationModal=({isOpen:r,onClose:e})=>{const{meters:s,addCalibrationEvent:t,setSelectedEvent:i}=useAppStore(),[a,o]=reactExports.useState(""),[w,S]=reactExports.useState("Periódica"),[y,u]=reactExports.useState(""),[h,l]=reactExports.useState({}),c=s.filter(p=>p.status==="active"),b=()=>{const p={};return a||(p.meterId="Selecione um medidor"),w||(p.type="Selecione o tipo de avaliação"),l(p),Object.keys(p).length===0},_=p=>{if(p.preventDefault(),!b())return;const A=s.find(P=>P.id===a);if(!A)return;const k=t(A,w);i(k),o(""),S("Periódica"),u(""),l({}),e()},f=()=>{o(""),S("Periódica"),u(""),l({}),e()};return jsxRuntimeExports.jsx(Modal,{isOpen:r,onClose:f,title:"Nova Avaliação de Calibração",size:"md",children:jsxRuntimeExports.jsxs("form",{onSubmit:_,className:"space-y-6",children:[c.length===0&&jsxRuntimeExports.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-yellow-700",children:"⚠️ Nenhum medidor ativo cadastrado. Adicione um medidor antes de criar uma avaliação de calibração."})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Select,{label:"Medidor MPFM *",value:a,onChange:p=>{o(p.target.value),l(A=>({...A,meterId:""}))},options:[{value:"",label:"Selecione um medidor..."},...c.map(p=>({value:p.id,label:`${p.tag} - ${p.name} (${p.location})`}))],error:h.meterId})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Select,{label:"Tipo de Avaliação *",value:w,onChange:p=>{S(p.target.value),l(A=>({...A,type:""}))},options:[{value:"Comissionamento",label:"Comissionamento - Primeira calibração do medidor"},{value:"Periódica",label:"Periódica - Calibração regular (anual)"},{value:"Especial",label:"Especial - Após manutenção ou alteração"},{value:"Investigação",label:"Investigação - Desvio detectado no monitoramento"}],error:h.type})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Input,{label:"Ordem de Serviço (Opcional)",placeholder:"Ex: OS-2024-001",value:y,onChange:p=>u(p.target.value)})}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Etapas da Avaliação"}),jsxRuntimeExports.jsxs("ol",{className:"text-xs text-blue-700 list-decimal list-inside space-y-1",children:[jsxRuntimeExports.jsx("li",{children:"Registro e Identificação"}),jsxRuntimeExports.jsx("li",{children:"Configuração PVT"}),jsxRuntimeExports.jsx("li",{children:"Totalizadores"}),jsxRuntimeExports.jsx("li",{children:"Cálculo K-Factors"}),jsxRuntimeExports.jsx("li",{children:"Balanço de Massas"}),jsxRuntimeExports.jsx("li",{children:"Monitoramento Pós"}),jsxRuntimeExports.jsx("li",{children:"Registro de Alarmes"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",onClick:f,children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{type:"submit",variant:"primary",disabled:c.length===0,children:"Iniciar Avaliação"})]})]})})};function useInitializeRealData(){const r=useAppStore(s=>s.meters),e=reactExports.useRef(!1);reactExports.useEffect(()=>{e.current||(e.current=!0,r.length===0&&(console.log("[MPFM] Inicializando medidores do FPSO Bacalhau..."),realMeters.forEach(s=>{useAppStore.setState(t=>({meters:[...t.meters,{...s,id:`meter-${s.tag}`}]}))})),console.log("[MPFM] Inicialização concluída! Importe PDFs para popular dados de produção."))},[r.length])}function App(){useInitializeRealData();const{showMeterModal:r,setShowMeterModal:e,showImportModal:s,setShowImportModal:t,showExportModal:i,setShowExportModal:a,showNewEventModal:o,setShowNewEventModal:w,editingMeter:S,setEditingMeter:y}=useAppStore(),u=()=>{e(!1),y(null)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Layout,{children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(Navigate,{to:"/monitoring",replace:!0})}),jsxRuntimeExports.jsx(Route,{path:"/monitoring",element:jsxRuntimeExports.jsx(MonitoringPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/calibration",element:jsxRuntimeExports.jsx(CalibrationPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/compliance",element:jsxRuntimeExports.jsx(CompliancePage,{})}),jsxRuntimeExports.jsx(Route,{path:"/desenquadramento",element:jsxRuntimeExports.jsx(Desenquadramento,{})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(Navigate,{to:"/monitoring",replace:!0})})]})}),jsxRuntimeExports.jsx(NewMeterModal,{isOpen:r,onClose:u,editingMeter:S}),jsxRuntimeExports.jsx(ImportDataModal,{isOpen:s,onClose:()=>t(!1)}),jsxRuntimeExports.jsx(ExportDataModal,{isOpen:i,onClose:()=>a(!1)}),jsxRuntimeExports.jsx(NewCalibrationModal,{isOpen:o,onClose:()=>w(!1)})]})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React$2.StrictMode,{children:jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsx(ToastProvider,{children:jsxRuntimeExports.jsx(App,{})})})}));
//# sourceMappingURL=index-Dtg5ZeFt.js.map
