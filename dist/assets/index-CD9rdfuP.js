var us=Object.defineProperty;var jr=e=>{throw TypeError(e)};var hs=(e,t,r)=>t in e?us(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var lt=(e,t,r)=>hs(e,typeof t!="symbol"?t+"":t,r),qt=(e,t,r)=>t.has(e)||jr("Cannot "+r);var y=(e,t,r)=>(qt(e,t,"read from private field"),r?r.call(e):t.get(e)),_e=(e,t,r)=>t.has(e)?jr("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Ee=(e,t,r,s)=>(qt(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),ce=(e,t,r)=>(qt(e,t,"access private method"),r);var At=(e,t,r,s)=>({set _(i){Ee(e,t,i,r)},get _(){return y(e,t,s)}});import{j as jsxRuntimeExports}from"./ui-DdXoV9Hu.js";import{a as reactDomExports,r as reactExports,g as getDefaultExportFromCjs,R as React$2,u as useLocation,b as useNavigate,d as getAugmentedNamespace,e as Routes,f as Route,N as Navigate,B as BrowserRouter}from"./vendor-D9FlTlAl.js";import{c as clsx,R as ResponsiveContainer,A as AreaChart,C as CartesianGrid,X as XAxis,Y as YAxis,T as Tooltip,a as ReferenceLine,b as Area,L as Legend,B as BarChart,d as Bar,e as LineChart,f as Line,g as Brush}from"./charts-B59FOlcs.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=r(i);fetch(i.href,n)}})();var client={},m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),createLucideIcon=(e,t)=>{const r=reactExports.forwardRef(({color:s="currentColor",size:i=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:o="",children:d,...l},c)=>reactExports.createElement("svg",{ref:c,...defaultAttributes,width:i,height:i,stroke:s,strokeWidth:a?Number(n)*24/Number(i):n,className:["lucide",`lucide-${toKebabCase(e)}`,o].join(" "),...l},[...t.map(([f,u])=>reactExports.createElement(f,u)),...Array.isArray(d)?d:[d]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Activity=createLucideIcon("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AlertCircle=createLucideIcon("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AlertTriangle=createLucideIcon("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ArrowDownRight=createLucideIcon("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ArrowUpRight=createLucideIcon("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BarChart3=createLucideIcon("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Beaker=createLucideIcon("Beaker",[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bell=createLucideIcon("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Calculator=createLucideIcon("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Calendar=createLucideIcon("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CheckCircle2=createLucideIcon("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CheckCircle=createLucideIcon("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Check=createLucideIcon("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronLeft=createLucideIcon("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronRight=createLucideIcon("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ClipboardList=createLucideIcon("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Clipboard=createLucideIcon("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Clock=createLucideIcon("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Database=createLucideIcon("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Download=createLucideIcon("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Droplets=createLucideIcon("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EyeOff=createLucideIcon("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eye=createLucideIcon("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileCheck=createLucideIcon("FileCheck",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileSpreadsheet=createLucideIcon("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileText=createLucideIcon("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileUp=createLucideIcon("FileUp",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Filter=createLucideIcon("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Flame=createLucideIcon("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FlaskConical=createLucideIcon("FlaskConical",[["path",{d:"M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2",key:"pzvekw"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M7 16h10",key:"wp8him"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gauge=createLucideIcon("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Info=createLucideIcon("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Layers=createLucideIcon("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Loader2=createLucideIcon("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Menu=createLucideIcon("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PenLine=createLucideIcon("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PenSquare=createLucideIcon("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Play=createLucideIcon("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Plus=createLucideIcon("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RefreshCw=createLucideIcon("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Save=createLucideIcon("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Send=createLucideIcon("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Settings=createLucideIcon("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sparkles=createLucideIcon("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Target=createLucideIcon("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Trash2=createLucideIcon("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TrendingUp=createLucideIcon("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Upload=createLucideIcon("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const User=createLucideIcon("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Waves=createLucideIcon("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XCircle=createLucideIcon("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=createLucideIcon("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),CLASS_PART_SEPARATOR="-",createClassGroupUtils=e=>{const t=createClassMap(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:a=>{const o=a.split(CLASS_PART_SEPARATOR);return o[0]===""&&o.length!==1&&o.shift(),getGroupRecursive(o,t)||getGroupIdForArbitraryProperty(a)},getConflictingClassGroupIds:(a,o)=>{const d=r[a]||[];return o&&s[a]?[...d,...s[a]]:d}}},getGroupRecursive=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const r=e[0],s=t.nextPart.get(r),i=s?getGroupRecursive(e.slice(1),s):void 0;if(i)return i;if(t.validators.length===0)return;const n=e.join(CLASS_PART_SEPARATOR);return(a=t.validators.find(({validator:o})=>o(n)))==null?void 0:a.classGroupId},arbitraryPropertyRegex=/^\[(.+)\]$/,getGroupIdForArbitraryProperty=e=>{if(arbitraryPropertyRegex.test(e)){const t=arbitraryPropertyRegex.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},createClassMap=e=>{const{theme:t,prefix:r}=e,s={nextPart:new Map,validators:[]};return getPrefixedClassGroupEntries(Object.entries(e.classGroups),r).forEach(([n,a])=>{processClassesRecursively(a,s,n,t)}),s},processClassesRecursively=(e,t,r,s)=>{e.forEach(i=>{if(typeof i=="string"){const n=i===""?t:getPart(t,i);n.classGroupId=r;return}if(typeof i=="function"){if(isThemeGetter(i)){processClassesRecursively(i(s),t,r,s);return}t.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([n,a])=>{processClassesRecursively(a,getPart(t,n),r,s)})})},getPart=(e,t)=>{let r=e;return t.split(CLASS_PART_SEPARATOR).forEach(s=>{r.nextPart.has(s)||r.nextPart.set(s,{nextPart:new Map,validators:[]}),r=r.nextPart.get(s)}),r},isThemeGetter=e=>e.isThemeGetter,getPrefixedClassGroupEntries=(e,t)=>t?e.map(([r,s])=>{const i=s.map(n=>typeof n=="string"?t+n:typeof n=="object"?Object.fromEntries(Object.entries(n).map(([a,o])=>[t+a,o])):n);return[r,i]}):e,createLruCache=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,s=new Map;const i=(n,a)=>{r.set(n,a),t++,t>e&&(t=0,s=r,r=new Map)};return{get(n){let a=r.get(n);if(a!==void 0)return a;if((a=s.get(n))!==void 0)return i(n,a),a},set(n,a){r.has(n)?r.set(n,a):i(n,a)}}},IMPORTANT_MODIFIER="!",createParseClassName=e=>{const{separator:t,experimentalParseClassName:r}=e,s=t.length===1,i=t[0],n=t.length,a=o=>{const d=[];let l=0,c=0,f;for(let x=0;x<o.length;x++){let E=o[x];if(l===0){if(E===i&&(s||o.slice(x,x+n)===t)){d.push(o.slice(c,x)),c=x+n;continue}if(E==="/"){f=x;continue}}E==="["?l++:E==="]"&&l--}const u=d.length===0?o:o.substring(c),h=u.startsWith(IMPORTANT_MODIFIER),g=h?u.substring(1):u,p=f&&f>c?f-c:void 0;return{modifiers:d,hasImportantModifier:h,baseClassName:g,maybePostfixModifierPosition:p}};return r?o=>r({className:o,parseClassName:a}):a},sortModifiers=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(s=>{s[0]==="["?(t.push(...r.sort(),s),r=[]):r.push(s)}),t.push(...r.sort()),t},createConfigUtils=e=>({cache:createLruCache(e.cacheSize),parseClassName:createParseClassName(e),...createClassGroupUtils(e)}),SPLIT_CLASSES_REGEX=/\s+/,mergeClassList=(e,t)=>{const{parseClassName:r,getClassGroupId:s,getConflictingClassGroupIds:i}=t,n=[],a=e.trim().split(SPLIT_CLASSES_REGEX);let o="";for(let d=a.length-1;d>=0;d-=1){const l=a[d],{modifiers:c,hasImportantModifier:f,baseClassName:u,maybePostfixModifierPosition:h}=r(l);let g=!!h,p=s(g?u.substring(0,h):u);if(!p){if(!g){o=l+(o.length>0?" "+o:o);continue}if(p=s(u),!p){o=l+(o.length>0?" "+o:o);continue}g=!1}const x=sortModifiers(c).join(":"),E=f?x+IMPORTANT_MODIFIER:x,S=E+p;if(n.includes(S))continue;n.push(S);const P=i(p,g);for(let F=0;F<P.length;++F){const A=P[F];n.push(E+A)}o=l+(o.length>0?" "+o:o)}return o};function twJoin(){let e=0,t,r,s="";for(;e<arguments.length;)(t=arguments[e++])&&(r=toValue(t))&&(s&&(s+=" "),s+=r);return s}const toValue=e=>{if(typeof e=="string")return e;let t,r="";for(let s=0;s<e.length;s++)e[s]&&(t=toValue(e[s]))&&(r&&(r+=" "),r+=t);return r};function createTailwindMerge(e,...t){let r,s,i,n=a;function a(d){const l=t.reduce((c,f)=>f(c),e());return r=createConfigUtils(l),s=r.cache.get,i=r.cache.set,n=o,o(d)}function o(d){const l=s(d);if(l)return l;const c=mergeClassList(d,r);return i(d,c),c}return function(){return n(twJoin.apply(null,arguments))}}const fromTheme=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},arbitraryValueRegex=/^\[(?:([a-z-]+):)?(.+)\]$/i,fractionRegex=/^\d+\/\d+$/,stringLengths=new Set(["px","full","screen"]),tshirtUnitRegex=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,lengthUnitRegex=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,colorFunctionRegex=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,shadowRegex=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,imageRegex=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,isLength=e=>isNumber(e)||stringLengths.has(e)||fractionRegex.test(e),isArbitraryLength=e=>getIsArbitraryValue(e,"length",isLengthOnly),isNumber=e=>!!e&&!Number.isNaN(Number(e)),isArbitraryNumber=e=>getIsArbitraryValue(e,"number",isNumber),isInteger=e=>!!e&&Number.isInteger(Number(e)),isPercent=e=>e.endsWith("%")&&isNumber(e.slice(0,-1)),isArbitraryValue=e=>arbitraryValueRegex.test(e),isTshirtSize=e=>tshirtUnitRegex.test(e),sizeLabels=new Set(["length","size","percentage"]),isArbitrarySize=e=>getIsArbitraryValue(e,sizeLabels,isNever),isArbitraryPosition=e=>getIsArbitraryValue(e,"position",isNever),imageLabels=new Set(["image","url"]),isArbitraryImage=e=>getIsArbitraryValue(e,imageLabels,isImage),isArbitraryShadow=e=>getIsArbitraryValue(e,"",isShadow),isAny=()=>!0,getIsArbitraryValue=(e,t,r)=>{const s=arbitraryValueRegex.exec(e);return s?s[1]?typeof t=="string"?s[1]===t:t.has(s[1]):r(s[2]):!1},isLengthOnly=e=>lengthUnitRegex.test(e)&&!colorFunctionRegex.test(e),isNever=()=>!1,isShadow=e=>shadowRegex.test(e),isImage=e=>imageRegex.test(e),getDefaultConfig=()=>{const e=fromTheme("colors"),t=fromTheme("spacing"),r=fromTheme("blur"),s=fromTheme("brightness"),i=fromTheme("borderColor"),n=fromTheme("borderRadius"),a=fromTheme("borderSpacing"),o=fromTheme("borderWidth"),d=fromTheme("contrast"),l=fromTheme("grayscale"),c=fromTheme("hueRotate"),f=fromTheme("invert"),u=fromTheme("gap"),h=fromTheme("gradientColorStops"),g=fromTheme("gradientColorStopPositions"),p=fromTheme("inset"),x=fromTheme("margin"),E=fromTheme("opacity"),S=fromTheme("padding"),P=fromTheme("saturate"),F=fromTheme("scale"),A=fromTheme("sepia"),C=fromTheme("skew"),_=fromTheme("space"),w=fromTheme("translate"),T=()=>["auto","contain","none"],M=()=>["auto","hidden","clip","visible","scroll"],R=()=>["auto",isArbitraryValue,t],k=()=>[isArbitraryValue,t],L=()=>["",isLength,isArbitraryLength],ae=()=>["auto",isNumber,isArbitraryValue],Q=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],oe=()=>["solid","dashed","dotted","double","none"],re=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],me=()=>["start","end","center","between","around","evenly","stretch"],H=()=>["","0",isArbitraryValue],ie=()=>["auto","avoid","all","avoid-page","page","left","right","column"],le=()=>[isNumber,isArbitraryValue];return{cacheSize:500,separator:":",theme:{colors:[isAny],spacing:[isLength,isArbitraryLength],blur:["none","",isTshirtSize,isArbitraryValue],brightness:le(),borderColor:[e],borderRadius:["none","","full",isTshirtSize,isArbitraryValue],borderSpacing:k(),borderWidth:L(),contrast:le(),grayscale:H(),hueRotate:le(),invert:H(),gap:k(),gradientColorStops:[e],gradientColorStopPositions:[isPercent,isArbitraryLength],inset:R(),margin:R(),opacity:le(),padding:k(),saturate:le(),scale:le(),sepia:H(),skew:le(),space:k(),translate:k()},classGroups:{aspect:[{aspect:["auto","square","video",isArbitraryValue]}],container:["container"],columns:[{columns:[isTshirtSize]}],"break-after":[{"break-after":ie()}],"break-before":[{"break-before":ie()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Q(),isArbitraryValue]}],overflow:[{overflow:M()}],"overflow-x":[{"overflow-x":M()}],"overflow-y":[{"overflow-y":M()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",isInteger,isArbitraryValue]}],basis:[{basis:R()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",isArbitraryValue]}],grow:[{grow:H()}],shrink:[{shrink:H()}],order:[{order:["first","last","none",isInteger,isArbitraryValue]}],"grid-cols":[{"grid-cols":[isAny]}],"col-start-end":[{col:["auto",{span:["full",isInteger,isArbitraryValue]},isArbitraryValue]}],"col-start":[{"col-start":ae()}],"col-end":[{"col-end":ae()}],"grid-rows":[{"grid-rows":[isAny]}],"row-start-end":[{row:["auto",{span:[isInteger,isArbitraryValue]},isArbitraryValue]}],"row-start":[{"row-start":ae()}],"row-end":[{"row-end":ae()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",isArbitraryValue]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",isArbitraryValue]}],gap:[{gap:[u]}],"gap-x":[{"gap-x":[u]}],"gap-y":[{"gap-y":[u]}],"justify-content":[{justify:["normal",...me()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...me(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...me(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[S]}],px:[{px:[S]}],py:[{py:[S]}],ps:[{ps:[S]}],pe:[{pe:[S]}],pt:[{pt:[S]}],pr:[{pr:[S]}],pb:[{pb:[S]}],pl:[{pl:[S]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[_]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[_]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",isArbitraryValue,t]}],"min-w":[{"min-w":[isArbitraryValue,t,"min","max","fit"]}],"max-w":[{"max-w":[isArbitraryValue,t,"none","full","min","max","fit","prose",{screen:[isTshirtSize]},isTshirtSize]}],h:[{h:[isArbitraryValue,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[isArbitraryValue,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[isArbitraryValue,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[isArbitraryValue,t,"auto","min","max","fit"]}],"font-size":[{text:["base",isTshirtSize,isArbitraryLength]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",isArbitraryNumber]}],"font-family":[{font:[isAny]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",isArbitraryValue]}],"line-clamp":[{"line-clamp":["none",isNumber,isArbitraryNumber]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",isLength,isArbitraryValue]}],"list-image":[{"list-image":["none",isArbitraryValue]}],"list-style-type":[{list:["none","disc","decimal",isArbitraryValue]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[E]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[E]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...oe(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",isLength,isArbitraryLength]}],"underline-offset":[{"underline-offset":["auto",isLength,isArbitraryValue]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:k()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",isArbitraryValue]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",isArbitraryValue]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[E]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Q(),isArbitraryPosition]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",isArbitrarySize]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},isArbitraryImage]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[n]}],"rounded-s":[{"rounded-s":[n]}],"rounded-e":[{"rounded-e":[n]}],"rounded-t":[{"rounded-t":[n]}],"rounded-r":[{"rounded-r":[n]}],"rounded-b":[{"rounded-b":[n]}],"rounded-l":[{"rounded-l":[n]}],"rounded-ss":[{"rounded-ss":[n]}],"rounded-se":[{"rounded-se":[n]}],"rounded-ee":[{"rounded-ee":[n]}],"rounded-es":[{"rounded-es":[n]}],"rounded-tl":[{"rounded-tl":[n]}],"rounded-tr":[{"rounded-tr":[n]}],"rounded-br":[{"rounded-br":[n]}],"rounded-bl":[{"rounded-bl":[n]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[E]}],"border-style":[{border:[...oe(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[E]}],"divide-style":[{divide:oe()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...oe()]}],"outline-offset":[{"outline-offset":[isLength,isArbitraryValue]}],"outline-w":[{outline:[isLength,isArbitraryLength]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:L()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[E]}],"ring-offset-w":[{"ring-offset":[isLength,isArbitraryLength]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",isTshirtSize,isArbitraryShadow]}],"shadow-color":[{shadow:[isAny]}],opacity:[{opacity:[E]}],"mix-blend":[{"mix-blend":[...re(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":re()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[s]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",isTshirtSize,isArbitraryValue]}],grayscale:[{grayscale:[l]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[f]}],saturate:[{saturate:[P]}],sepia:[{sepia:[A]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[l]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[E]}],"backdrop-saturate":[{"backdrop-saturate":[P]}],"backdrop-sepia":[{"backdrop-sepia":[A]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",isArbitraryValue]}],duration:[{duration:le()}],ease:[{ease:["linear","in","out","in-out",isArbitraryValue]}],delay:[{delay:le()}],animate:[{animate:["none","spin","ping","pulse","bounce",isArbitraryValue]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[F]}],"scale-x":[{"scale-x":[F]}],"scale-y":[{"scale-y":[F]}],rotate:[{rotate:[isInteger,isArbitraryValue]}],"translate-x":[{"translate-x":[w]}],"translate-y":[{"translate-y":[w]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",isArbitraryValue]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",isArbitraryValue]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":k()}],"scroll-mx":[{"scroll-mx":k()}],"scroll-my":[{"scroll-my":k()}],"scroll-ms":[{"scroll-ms":k()}],"scroll-me":[{"scroll-me":k()}],"scroll-mt":[{"scroll-mt":k()}],"scroll-mr":[{"scroll-mr":k()}],"scroll-mb":[{"scroll-mb":k()}],"scroll-ml":[{"scroll-ml":k()}],"scroll-p":[{"scroll-p":k()}],"scroll-px":[{"scroll-px":k()}],"scroll-py":[{"scroll-py":k()}],"scroll-ps":[{"scroll-ps":k()}],"scroll-pe":[{"scroll-pe":k()}],"scroll-pt":[{"scroll-pt":k()}],"scroll-pr":[{"scroll-pr":k()}],"scroll-pb":[{"scroll-pb":k()}],"scroll-pl":[{"scroll-pl":k()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",isArbitraryValue]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[isLength,isArbitraryLength,isArbitraryNumber]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},twMerge=createTailwindMerge(getDefaultConfig);function cn(...e){return twMerge(clsx(e))}function formatNumber(e,t=2){return e.toLocaleString("pt-BR",{minimumFractionDigits:t,maximumFractionDigits:t})}function formatDate(e,t="short"){const r=typeof e=="string"?new Date(e):e;return t==="long"?r.toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"}):r.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})}function formatDateTime(e){const t=typeof e=="string"?new Date(e):e;return`${formatDate(t)} ${t.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`}const modules=[{id:"monitoring",label:"Monitoramento SGM-FM",icon:Activity,description:"Variáveis críticas"},{id:"registro-diario",label:"Registro Diário",icon:ClipboardList,description:"Variáveis e gráficos"},{id:"calibration",label:"Avaliação de Desempenho",icon:Gauge,description:"Calibração MPFM"},{id:"compliance",label:"Conformidade ANP",icon:FileCheck,description:"RANP 44/2015"},{id:"desenquadramento",label:"Desenquadramento",icon:AlertTriangle,description:"Seção 10 RANP44"}];function Sidebar({activeModule:e,onModuleChange:t,collapsed:r}){return jsxRuntimeExports.jsxs("aside",{className:cn("bg-zinc-900 border-r border-zinc-800 flex flex-col transition-all duration-200 flex-shrink-0",r?"w-16":"w-56"),children:[jsxRuntimeExports.jsx("div",{className:"p-3 border-b border-zinc-800",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-700 rounded-lg flex items-center justify-center flex-shrink-0",children:jsxRuntimeExports.jsx(Droplets,{className:"w-6 h-6 text-white"})}),!r&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-bold text-sm",children:"MPFM Monitor"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-zinc-500",children:"FPSO Bacalhau"})]})]})}),jsxRuntimeExports.jsx("nav",{className:"flex-1 p-2 space-y-1",children:modules.map(s=>{const i=s.icon,n=e===s.id;return jsxRuntimeExports.jsxs("button",{onClick:()=>t(s.id),className:cn("w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition text-sm",n?"bg-blue-600 text-white":"hover:bg-zinc-800 text-zinc-400"),children:[jsxRuntimeExports.jsx(i,{className:"w-5 h-5 flex-shrink-0"}),!r&&jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsx("div",{className:"text-xs font-medium",children:s.label}),jsxRuntimeExports.jsx("div",{className:"text-[10px] opacity-60",children:s.description})]})]},s.id)})}),jsxRuntimeExports.jsx("div",{className:"p-3 border-t border-zinc-800",children:!r&&jsxRuntimeExports.jsxs("div",{className:"text-xs text-zinc-500",children:[jsxRuntimeExports.jsx("div",{children:"RANP 44/2015 ANP"}),jsxRuntimeExports.jsx("div",{className:"text-zinc-600",children:"v2.1.0"})]})})]})}const variantStyles$1={default:"bg-zinc-700 text-zinc-300",success:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",warning:"bg-amber-500/20 text-amber-400 border border-amber-500/30",error:"bg-red-500/20 text-red-400 border border-red-500/30",danger:"bg-red-500/20 text-red-400 border border-red-500/30",info:"bg-blue-500/20 text-blue-400 border border-blue-500/30",purple:"bg-purple-500/20 text-purple-400 border border-purple-500/30",secondary:"bg-zinc-600/20 text-zinc-300 border border-zinc-500/30",OK:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",ALERT:"bg-amber-500/20 text-amber-400 border border-amber-500/30",FAIL:"bg-red-500/20 text-red-400 border border-red-500/30",ERROR:"bg-red-500/20 text-red-400 border border-red-500/30",Dentro:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",Fora:"bg-red-500/20 text-red-400 border border-red-500/30",active:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",inactive:"bg-zinc-600/20 text-zinc-400 border border-zinc-500/30",TOPSIDE:"bg-purple-500/20 text-purple-400 border border-purple-500/30",SUBSEA:"bg-blue-500/20 text-blue-400 border border-blue-500/30",MONITORAR:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",INVESTIGAR:"bg-red-500/20 text-red-400 border border-red-500/30",Pendente:"bg-amber-500/20 text-amber-400 border border-amber-500/30",Parcial:"bg-blue-500/20 text-blue-400 border border-blue-500/30",Crítico:"bg-red-500/20 text-red-400 border border-red-500/30",Alerta:"bg-amber-500/20 text-amber-400 border border-amber-500/30",Aberto:"bg-red-500/20 text-red-400 border border-red-500/30","Em Investigação":"bg-amber-500/20 text-amber-400 border border-amber-500/30","Plano de Ação":"bg-blue-500/20 text-blue-400 border border-blue-500/30","Aguardando Validação":"bg-purple-500/20 text-purple-400 border border-purple-500/30",Concluído:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30","Enviado ANP":"bg-cyan-500/20 text-cyan-400 border border-cyan-500/30"},sizeStyles$2={sm:"px-1.5 py-0.5 text-[10px]",default:"px-2 py-0.5 text-xs"};function Badge({variant:e="default",size:t="default",children:r,className:s}){return jsxRuntimeExports.jsx("span",{className:cn("rounded-full font-medium inline-flex items-center",variantStyles$1[e],sizeStyles$2[t],s),children:r})}const variantStyles={primary:"bg-blue-600 hover:bg-blue-700 text-white",secondary:"bg-zinc-800 hover:bg-zinc-700 text-white border border-zinc-700",success:"bg-emerald-600 hover:bg-emerald-700 text-white",danger:"bg-red-600 hover:bg-red-700 text-white",ghost:"hover:bg-zinc-800 text-zinc-400",outline:"border border-zinc-600 hover:bg-zinc-800 text-zinc-300"},sizeStyles$1={xs:"px-2 py-1 text-xs",sm:"px-2 py-1.5 text-xs",default:"px-3 py-1.5 text-sm",lg:"px-4 py-2 text-sm"},iconSizes={xs:"w-3 h-3",sm:"w-3.5 h-3.5",default:"w-4 h-4",lg:"w-4 h-4"},Button=reactExports.forwardRef(({variant:e="primary",size:t="default",icon:r,loading:s=!1,disabled:i,className:n,children:a,...o},d)=>jsxRuntimeExports.jsxs("button",{ref:d,disabled:i||s,className:cn("flex items-center justify-center gap-1.5 rounded-lg font-medium transition",variantStyles[e],sizeStyles$1[t],(i||s)&&"opacity-50 cursor-not-allowed",n),...o,children:[s?jsxRuntimeExports.jsxs("svg",{className:cn("animate-spin",iconSizes[t]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):r?jsxRuntimeExports.jsx(r,{className:iconSizes[t]}):null,a]}));Button.displayName="Button";function Card({children:e,className:t,title:r,subtitle:s,headerRight:i,noPadding:n=!1}){return jsxRuntimeExports.jsxs("div",{className:cn("bg-zinc-900/80 border border-zinc-800 rounded-xl",t),children:[r&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-zinc-800",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-white",children:r}),s&&jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:s})]}),i]}),jsxRuntimeExports.jsx("div",{className:n?"":"p-4",children:e})]})}const Input=reactExports.forwardRef(({label:e,unit:t,error:r,inputSize:s="default",disabled:i,readOnly:n,className:a,...o},d)=>jsxRuntimeExports.jsxs("div",{className:cn("space-y-1",a),children:[e&&jsxRuntimeExports.jsx("label",{className:"text-xs text-zinc-400",children:e}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("input",{ref:d,disabled:i,readOnly:n,className:cn("w-full bg-zinc-800 border rounded text-white placeholder-zinc-500 focus:outline-none focus:border-blue-500",r?"border-red-500":"border-zinc-700",(i||n)&&"opacity-60 cursor-not-allowed",s==="sm"?"px-2 py-1 text-xs":"px-3 py-2 text-sm",t&&"pr-12"),...o}),t&&jsxRuntimeExports.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-zinc-500",children:t})]}),r&&jsxRuntimeExports.jsx("p",{className:"text-xs text-red-400",children:r})]}));Input.displayName="Input";const Select=reactExports.forwardRef(({label:e,options:t,selectSize:r="default",error:s,disabled:i,className:n,...a},o)=>jsxRuntimeExports.jsxs("div",{className:cn("space-y-1",n),children:[e&&jsxRuntimeExports.jsx("label",{className:"text-xs text-zinc-400",children:e}),jsxRuntimeExports.jsx("select",{ref:o,disabled:i,className:cn("w-full bg-zinc-800 border border-zinc-700 rounded text-white focus:outline-none focus:border-blue-500",i&&"opacity-60 cursor-not-allowed",s&&"border-red-500",r==="sm"?"px-2 py-1 text-xs":"px-3 py-2 text-sm"),...a,children:t.map(d=>jsxRuntimeExports.jsx("option",{value:d.value,children:d.label},d.value))}),s&&jsxRuntimeExports.jsx("p",{className:"text-xs text-red-400",children:s})]}));Select.displayName="Select";const sizeStyles={sm:"max-w-sm",md:"max-w-md",default:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};function Modal({isOpen:e,onClose:t,title:r,children:s,size:i="default"}){return reactExports.useEffect(()=>{const n=a=>{a.key==="Escape"&&t()};return e&&(document.addEventListener("keydown",n),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",n),document.body.style.overflow="unset"}},[e,t]),e?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:cn("bg-zinc-900 border border-zinc-800 rounded-xl w-full max-h-[90vh] flex flex-col",sizeStyles[i]),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-zinc-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-white",children:r}),jsxRuntimeExports.jsx("button",{onClick:t,title:"Fechar",className:"p-1 hover:bg-zinc-800 rounded-lg transition",children:jsxRuntimeExports.jsx(X,{className:"w-4 h-4 text-zinc-400"})})]}),jsxRuntimeExports.jsx("div",{className:"p-4 overflow-y-auto flex-1",children:s})]})}):null}function Tabs({tabs:e,activeTab:t,onChange:r,className:s}){return jsxRuntimeExports.jsx("div",{className:cn("flex gap-1 p-1 bg-zinc-800/50 rounded-lg",s),children:e.map(i=>jsxRuntimeExports.jsxs("button",{onClick:()=>r(i.id),className:cn("px-3 py-1.5 text-xs font-medium rounded-md transition flex items-center gap-1.5",t===i.id?"bg-blue-600 text-white":"text-zinc-400 hover:text-white hover:bg-zinc-700"),children:[i.icon&&jsxRuntimeExports.jsx(i.icon,{className:"w-3.5 h-3.5"}),i.label,i.count!==void 0&&jsxRuntimeExports.jsx("span",{className:cn("px-1.5 py-0.5 rounded-full text-[10px]",t===i.id?"bg-white/20":"bg-zinc-700"),children:i.count})]},i.id))})}const colorStyles$2={blue:"from-blue-500/20 to-blue-600/5 border-blue-500/30",emerald:"from-emerald-500/20 to-emerald-600/5 border-emerald-500/30",amber:"from-amber-500/20 to-amber-600/5 border-amber-500/30",red:"from-red-500/20 to-red-600/5 border-red-500/30",purple:"from-purple-500/20 to-purple-600/5 border-purple-500/30"},iconColors={blue:"text-blue-400",emerald:"text-emerald-400",amber:"text-amber-400",red:"text-red-400",purple:"text-purple-400"};function KPICard({title:e,value:t,unit:r,subtitle:s,icon:i,color:n,trend:a,onClick:o,className:d}){return jsxRuntimeExports.jsx("div",{className:cn("bg-gradient-to-br border rounded-xl p-3",colorStyles$2[n],o&&"cursor-pointer hover:brightness-110 transition",d),onClick:o,children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-400",children:e}),jsxRuntimeExports.jsxs("div",{className:"flex items-baseline gap-1 mt-1",children:[jsxRuntimeExports.jsx("span",{className:"text-xl font-bold text-white",children:t}),r&&jsxRuntimeExports.jsx("span",{className:"text-xs text-zinc-400",children:r})]}),s&&jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:s}),a!==void 0&&a!==0&&jsxRuntimeExports.jsxs("div",{className:cn("flex items-center gap-1 mt-1 text-xs",a>0?"text-emerald-400":"text-red-400"),children:[a>0?jsxRuntimeExports.jsx(ArrowUpRight,{className:"w-3 h-3"}):jsxRuntimeExports.jsx(ArrowDownRight,{className:"w-3 h-3"}),jsxRuntimeExports.jsxs("span",{children:[Math.abs(a),"%"]})]})]}),jsxRuntimeExports.jsx("div",{className:cn("p-2 rounded-lg bg-zinc-800/50",iconColors[n]),children:jsxRuntimeExports.jsx(i,{className:"w-4 h-4"})})]})})}const colorStyles$1={blue:"bg-blue-500",emerald:"bg-emerald-500",amber:"bg-amber-500",red:"bg-red-500",purple:"bg-purple-500"};function ProgressBar({value:e,max:t=100,color:r="blue",showLabel:s=!0,size:i="default",className:n}){const a=Math.min(e/t*100,100),d=r==="auto"?a>=100?"bg-red-500":a>=70?"bg-amber-500":"bg-emerald-500":colorStyles$1[r];return jsxRuntimeExports.jsxs("div",{className:cn("space-y-1",n),children:[jsxRuntimeExports.jsx("div",{className:cn("bg-zinc-800 rounded-full overflow-hidden",i==="sm"?"h-1.5":"h-2"),children:jsxRuntimeExports.jsx("div",{className:cn("h-full rounded-full transition-all",d),style:{width:`${a}%`}})}),s&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs text-zinc-500",children:[jsxRuntimeExports.jsx("span",{children:e}),jsxRuntimeExports.jsx("span",{children:t})]})]})}function StepIndicator({steps:e,currentStep:t,onStepClick:r,className:s}){return jsxRuntimeExports.jsx("div",{className:cn("flex items-center gap-1 overflow-x-auto pb-1",s),children:e.map((i,n)=>{const a=n+1,o=a<t,d=a===t,l=a>t;return jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>r==null?void 0:r(a),className:cn("flex items-center gap-1.5 px-2 py-1 rounded-lg transition flex-shrink-0",d&&"bg-blue-600 text-white",o&&"bg-emerald-500/20 text-emerald-400 hover:bg-emerald-500/30",l&&"bg-zinc-800 text-zinc-500 hover:bg-zinc-700"),children:[jsxRuntimeExports.jsx("div",{className:cn("w-5 h-5 rounded-full flex items-center justify-center text-xs font-medium",o&&"bg-emerald-500 text-white",d&&"bg-white text-blue-600",l&&"bg-zinc-700 text-zinc-400"),children:o?jsxRuntimeExports.jsx(Check,{className:"w-3 h-3"}):a}),jsxRuntimeExports.jsx("span",{className:"text-xs hidden lg:inline whitespace-nowrap",children:i})]}),n<e.length-1&&jsxRuntimeExports.jsx("div",{className:cn("w-4 h-px flex-shrink-0 mx-1",o?"bg-emerald-500":"bg-zinc-700")})]},n)})})}const colorStyles={blue:"text-blue-400 bg-blue-500/10",purple:"text-purple-400 bg-purple-500/10",amber:"text-amber-400 bg-amber-500/10",emerald:"text-emerald-400 bg-emerald-500/10",red:"text-red-400 bg-red-500/10"};function SectionHeader({icon:e,title:t,color:r="blue",action:s,className:i}){return jsxRuntimeExports.jsxs("div",{className:cn("flex items-center justify-between px-3 py-2 rounded-lg mb-3",colorStyles[r],i),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(e,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",children:t})]}),s]})}const ToastContext=reactExports.createContext(null);function ToastProvider({children:e}){const[t,r]=reactExports.useState([]),s=reactExports.useCallback(l=>{r(c=>c.filter(f=>f.id!==l))},[]),i=reactExports.useCallback(l=>{const c=`toast-${Date.now()}-${Math.random().toString(36).substr(2,5)}`,f={...l,id:c};r(h=>[...h,f]);const u=l.duration||5e3;setTimeout(()=>{s(c)},u)},[s]),n=reactExports.useCallback((l,c)=>i({type:"success",title:l,message:c}),[i]),a=reactExports.useCallback((l,c)=>i({type:"error",title:l,message:c,duration:8e3}),[i]),o=reactExports.useCallback((l,c)=>i({type:"warning",title:l,message:c}),[i]),d=reactExports.useCallback((l,c)=>i({type:"info",title:l,message:c}),[i]);return jsxRuntimeExports.jsxs(ToastContext.Provider,{value:{toasts:t,addToast:i,removeToast:s,success:n,error:a,warning:o,info:d},children:[e,jsxRuntimeExports.jsx(ToastContainer,{toasts:t,onRemove:s})]})}function useToast(){const e=reactExports.useContext(ToastContext);if(!e)throw new Error("useToast deve ser usado dentro de ToastProvider");return e}function ToastContainer({toasts:e,onRemove:t}){return e.length===0?null:jsxRuntimeExports.jsx("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col gap-2 max-w-md",children:e.map(r=>jsxRuntimeExports.jsx(ToastItem,{toast:r,onRemove:t},r.id))})}function ToastItem({toast:e,onRemove:t}){const[r,s]=reactExports.useState(!1),i=()=>{s(!0),setTimeout(()=>t(e.id),200)},n={success:CheckCircle,error:XCircle,warning:AlertTriangle,info:Info},a={success:"bg-emerald-500/10 border-emerald-500/30 text-emerald-400",error:"bg-red-500/10 border-red-500/30 text-red-400",warning:"bg-amber-500/10 border-amber-500/30 text-amber-400",info:"bg-blue-500/10 border-blue-500/30 text-blue-400"},o=n[e.type];return jsxRuntimeExports.jsxs("div",{className:cn("flex items-start gap-3 p-4 rounded-lg border backdrop-blur-sm","min-w-[300px] shadow-lg transition-all duration-200",r?"opacity-0 translate-x-4":"opacity-100 translate-x-0",a[e.type]),children:[jsxRuntimeExports.jsx(o,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-white",children:e.title}),e.message&&jsxRuntimeExports.jsx("p",{className:"text-sm opacity-80 mt-1",children:e.message})]}),jsxRuntimeExports.jsx("button",{onClick:i,className:"text-zinc-500 hover:text-white transition-colors p-1",title:"Fechar notificação","aria-label":"Fechar notificação",children:jsxRuntimeExports.jsx(X,{className:"w-4 h-4"})})]})}function Header({title:e,subtitle:t,onToggleSidebar:r,onImport:s,onExport:i,alertCount:n=0}){return jsxRuntimeExports.jsxs("header",{className:"h-14 bg-zinc-900 border-b border-zinc-800 flex items-center justify-between px-4 flex-shrink-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:r,title:"Menu",className:"p-2 hover:bg-zinc-800 rounded-lg transition",children:jsxRuntimeExports.jsx(Menu,{className:"w-5 h-5 text-zinc-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-sm font-semibold",children:e}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:t||`Última atualização: ${formatDateTime(new Date)}`})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[s&&jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:Upload,onClick:s,children:"Importar"}),i&&jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:Download,onClick:i,children:"Exportar"}),jsxRuntimeExports.jsxs("button",{title:"Notificações",className:"relative p-2 hover:bg-zinc-800 rounded-lg transition",children:[jsxRuntimeExports.jsx(Bell,{className:"w-5 h-5 text-zinc-400"}),n>0&&jsxRuntimeExports.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),jsxRuntimeExports.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-xs font-medium",children:"MA"})]})]})}const __vite_import_meta_env__$2={},createStoreImpl=e=>{let t;const r=new Set,s=(c,f)=>{const u=typeof c=="function"?c(t):c;if(!Object.is(u,t)){const h=t;t=f??(typeof u!="object"||u===null)?u:Object.assign({},t,u),r.forEach(g=>g(t,h))}},i=()=>t,d={setState:s,getState:i,getInitialState:()=>l,subscribe:c=>(r.add(c),()=>r.delete(c)),destroy:()=>{(__vite_import_meta_env__$2?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},l=t=e(s,i,d);return d},createStore=e=>e?createStoreImpl(e):createStoreImpl;var withSelector={exports:{}},withSelector_production={},shim$2={exports:{}},useSyncExternalStoreShim_production={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React$1=reactExports;function is$1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var objectIs$1=typeof Object.is=="function"?Object.is:is$1,useState=React$1.useState,useEffect$1=React$1.useEffect,useLayoutEffect=React$1.useLayoutEffect,useDebugValue$2=React$1.useDebugValue;function useSyncExternalStore$2(e,t){var r=t(),s=useState({inst:{value:r,getSnapshot:t}}),i=s[0].inst,n=s[1];return useLayoutEffect(function(){i.value=r,i.getSnapshot=t,checkIfSnapshotChanged(i)&&n({inst:i})},[e,r,t]),useEffect$1(function(){return checkIfSnapshotChanged(i)&&n({inst:i}),e(function(){checkIfSnapshotChanged(i)&&n({inst:i})})},[e]),useDebugValue$2(r),r}function checkIfSnapshotChanged(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!objectIs$1(e,r)}catch{return!0}}function useSyncExternalStore$1(e,t){return t()}var shim$1=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?useSyncExternalStore$1:useSyncExternalStore$2;useSyncExternalStoreShim_production.useSyncExternalStore=React$1.useSyncExternalStore!==void 0?React$1.useSyncExternalStore:shim$1;shim$2.exports=useSyncExternalStoreShim_production;var shimExports=shim$2.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React=reactExports,shim=shimExports;function is(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var objectIs=typeof Object.is=="function"?Object.is:is,useSyncExternalStore=shim.useSyncExternalStore,useRef=React.useRef,useEffect=React.useEffect,useMemo=React.useMemo,useDebugValue$1=React.useDebugValue;withSelector_production.useSyncExternalStoreWithSelector=function(e,t,r,s,i){var n=useRef(null);if(n.current===null){var a={hasValue:!1,value:null};n.current=a}else a=n.current;n=useMemo(function(){function d(h){if(!l){if(l=!0,c=h,h=s(h),i!==void 0&&a.hasValue){var g=a.value;if(i(g,h))return f=g}return f=h}if(g=f,objectIs(c,h))return g;var p=s(h);return i!==void 0&&i(g,p)?(c=h,g):(c=h,f=p)}var l=!1,c,f,u=r===void 0?null:r;return[function(){return d(t())},u===null?void 0:function(){return d(u())}]},[t,r,s,i]);var o=useSyncExternalStore(e,n[0],n[1]);return useEffect(function(){a.hasValue=!0,a.value=o},[o]),useDebugValue$1(o),o};withSelector.exports=withSelector_production;var withSelectorExports=withSelector.exports;const useSyncExternalStoreExports=getDefaultExportFromCjs(withSelectorExports),__vite_import_meta_env__$1={},{useDebugValue}=React$2,{useSyncExternalStoreWithSelector}=useSyncExternalStoreExports;let didWarnAboutEqualityFn=!1;const identity=e=>e;function useStore(e,t=identity,r){(__vite_import_meta_env__$1?"production":void 0)!=="production"&&r&&!didWarnAboutEqualityFn&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),didWarnAboutEqualityFn=!0);const s=useSyncExternalStoreWithSelector(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return useDebugValue(s),s}const createImpl=e=>{(__vite_import_meta_env__$1?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?createStore(e):e,r=(s,i)=>useStore(t,s,i);return Object.assign(r,t),r},create=e=>createImpl,__vite_import_meta_env__={};function createJSONStorage(e,t){let r;try{r=e()}catch{return}return{getItem:i=>{var n;const a=d=>d===null?null:JSON.parse(d,void 0),o=(n=r.getItem(i))!=null?n:null;return o instanceof Promise?o.then(a):a(o)},setItem:(i,n)=>r.setItem(i,JSON.stringify(n,void 0)),removeItem:i=>r.removeItem(i)}}const toThenable=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then(s){return toThenable(s)(r)},catch(s){return this}}}catch(r){return{then(s){return this},catch(s){return toThenable(s)(r)}}}},oldImpl=(e,t)=>(r,s,i)=>{let n={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:x=>x,version:0,merge:(x,E)=>({...E,...x}),...t},a=!1;const o=new Set,d=new Set;let l;try{l=n.getStorage()}catch{}if(!l)return e((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),r(...x)},s,i);const c=toThenable(n.serialize),f=()=>{const x=n.partialize({...s()});let E;const S=c({state:x,version:n.version}).then(P=>l.setItem(n.name,P)).catch(P=>{E=P});if(E)throw E;return S},u=i.setState;i.setState=(x,E)=>{u(x,E),f()};const h=e((...x)=>{r(...x),f()},s,i);let g;const p=()=>{var x;if(!l)return;a=!1,o.forEach(S=>S(s()));const E=((x=n.onRehydrateStorage)==null?void 0:x.call(n,s()))||void 0;return toThenable(l.getItem.bind(l))(n.name).then(S=>{if(S)return n.deserialize(S)}).then(S=>{if(S)if(typeof S.version=="number"&&S.version!==n.version){if(n.migrate)return n.migrate(S.state,S.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return S.state}).then(S=>{var P;return g=n.merge(S,(P=s())!=null?P:h),r(g,!0),f()}).then(()=>{E==null||E(g,void 0),a=!0,d.forEach(S=>S(g))}).catch(S=>{E==null||E(void 0,S)})};return i.persist={setOptions:x=>{n={...n,...x},x.getStorage&&(l=x.getStorage())},clearStorage:()=>{l==null||l.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>p(),hasHydrated:()=>a,onHydrate:x=>(o.add(x),()=>{o.delete(x)}),onFinishHydration:x=>(d.add(x),()=>{d.delete(x)})},p(),g||h},newImpl=(e,t)=>(r,s,i)=>{let n={storage:createJSONStorage(()=>localStorage),partialize:p=>p,version:0,merge:(p,x)=>({...x,...p}),...t},a=!1;const o=new Set,d=new Set;let l=n.storage;if(!l)return e((...p)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),r(...p)},s,i);const c=()=>{const p=n.partialize({...s()});return l.setItem(n.name,{state:p,version:n.version})},f=i.setState;i.setState=(p,x)=>{f(p,x),c()};const u=e((...p)=>{r(...p),c()},s,i);i.getInitialState=()=>u;let h;const g=()=>{var p,x;if(!l)return;a=!1,o.forEach(S=>{var P;return S((P=s())!=null?P:u)});const E=((x=n.onRehydrateStorage)==null?void 0:x.call(n,(p=s())!=null?p:u))||void 0;return toThenable(l.getItem.bind(l))(n.name).then(S=>{if(S)if(typeof S.version=="number"&&S.version!==n.version){if(n.migrate)return[!0,n.migrate(S.state,S.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,S.state];return[!1,void 0]}).then(S=>{var P;const[F,A]=S;if(h=n.merge(A,(P=s())!=null?P:u),r(h,!0),F)return c()}).then(()=>{E==null||E(h,void 0),h=s(),a=!0,d.forEach(S=>S(h))}).catch(S=>{E==null||E(void 0,S)})};return i.persist={setOptions:p=>{n={...n,...p},p.storage&&(l=p.storage)},clearStorage:()=>{l==null||l.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>g(),hasHydrated:()=>a,onHydrate:p=>(o.add(p),()=>{o.delete(p)}),onFinishHydration:p=>(d.add(p),()=>{d.delete(p)})},n.skipHydration||g(),h||u},persistImpl=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((__vite_import_meta_env__?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),oldImpl(e,t)):newImpl(e,t),persist=persistImpl,ANP_LIMITS={HC_BALANCE_WARNING:7,HC_BALANCE_ERROR:10,TOTAL_BALANCE_WARNING:5,TOTAL_BALANCE_ERROR:7,K_FACTOR_MIN:.8,K_FACTOR_MAX:1.2};function calculateDeviation(e,t){return t===0?e===0?0:100:(e-t)/t*100}function getDeviationStatus(e,t,r){const s=Math.abs(e);return s>=r?"FAIL":s>=t?"ALERT":"OK"}function calculateMassBalance(e,t){const r=e.oil+e.gas,s=t.oil+t.gas,i=r+e.water,n=s+t.water,a=calculateDeviation(r,s),o=calculateDeviation(i,n),d=getDeviationStatus(a,ANP_LIMITS.HC_BALANCE_WARNING,ANP_LIMITS.HC_BALANCE_ERROR),l=getDeviationStatus(o,ANP_LIMITS.TOTAL_BALANCE_WARNING,ANP_LIMITS.TOTAL_BALANCE_ERROR);return{hcBalance:a,totalBalance:o,hcStatus:d,totalStatus:l,action:d==="FAIL"||l==="FAIL"?"INVESTIGAR":"MONITORAR"}}function calculateKFactor(e,t){return e===0?t===0?1:0:t/e}function generateCalibrationEventId(e,t,r=new Date){const s=e.startsWith("13")?"TOP":"SUB",i=t.substring(0,3).toUpperCase(),n=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getFullYear()).slice(-2);return`CAL-MPFM_${s}-${i}-${n}-${a}`}function generateUniqueId(e=""){const t=Date.now().toString(36),r=Math.random().toString(36).substring(2,8);return e?`${e}-${t}-${r}`:`${t}-${r}`}const getInitialState=()=>({user:{id:"user-1",name:"Mauricio Amorim",email:"mauricio.amorim@equinor.com",role:"Admin"},activeModule:"monitoring",sidebarCollapsed:!1,showNewEventModal:!1,showImportModal:!1,showExportModal:!1,showMeterModal:!1,showAlertModal:!1,editingMeter:null,meters:[],selectedMeter:null,monitoringData:[],calibrationEvents:[],selectedEvent:null,calibrationFormData:null,alerts:[],monitoringFilters:{startDate:"",endDate:"",meterId:"",status:""},calibrationFilters:{status:"",type:"",meterId:"",responsible:""}}),useAppStore=create()(persist((e,t)=>({...getInitialState(),setActiveModule:r=>e({activeModule:r,selectedEvent:null}),toggleSidebar:()=>e(r=>({sidebarCollapsed:!r.sidebarCollapsed})),setShowNewEventModal:r=>e({showNewEventModal:r}),setShowImportModal:r=>e({showImportModal:r}),setShowExportModal:r=>e({showExportModal:r}),setShowMeterModal:r=>e({showMeterModal:r}),setShowAlertModal:r=>e({showAlertModal:r}),setEditingMeter:r=>e({editingMeter:r,showMeterModal:!!r}),setSelectedMeter:r=>e({selectedMeter:r}),addMeter:r=>{const s={...r,id:generateUniqueId("meter")};e(i=>({meters:[...i.meters,s]})),t().addAlert({type:"success",severity:"info",message:`Medidor ${s.tag} adicionado com sucesso`,meterId:s.id,meterTag:s.tag})},updateMeter:(r,s)=>{e(i=>({meters:i.meters.map(n=>n.id===r?{...n,...s}:n)}))},deleteMeter:r=>{const s=t().meters.find(i=>i.id===r);e(i=>{var n;return{meters:i.meters.filter(a=>a.id!==r),selectedMeter:((n=i.selectedMeter)==null?void 0:n.id)===r?null:i.selectedMeter}}),s&&t().addAlert({type:"warning",severity:"warning",message:`Medidor ${s.tag} removido`})},addMonitoringData:r=>{const s={...r,id:generateUniqueId("mon")};e(i=>({monitoringData:[...i.monitoringData,s]}))},updateMonitoringData:(r,s)=>{e(i=>({monitoringData:i.monitoringData.map(n=>n.id===r?{...n,...s}:n)}))},deleteMonitoringData:r=>{e(s=>({monitoringData:s.monitoringData.filter(i=>i.id!==r)}))},importMonitoringData:r=>{const s=r.map(i=>({...i,id:i.id||generateUniqueId("mon")}));e(i=>({monitoringData:[...i.monitoringData,...s]})),t().addAlert({type:"success",severity:"info",message:`${r.length} registros de monitoramento importados`})},recalculateBalances:()=>{e(r=>({monitoringData:r.monitoringData.map(s=>{const i=calculateMassBalance({oil:s.topOil,gas:s.topGas,water:s.topWater||0},{oil:s.sepOil,gas:s.sepGas,water:s.sepWater||0});return{...s,hcBalancePercent:i.hcBalance,totalBalancePercent:i.totalBalance,hcStatus:i.hcStatus,totalStatus:i.totalStatus,action:i.action}})}))},setSelectedEvent:r=>e({selectedEvent:r}),addCalibrationEvent:(r,s)=>{const i=new Date,n=generateCalibrationEventId(r.tag,s,i),a={id:n,meterId:r.id,meterTag:r.tag,meterName:r.name,type:s,status:"Em Andamento",startDate:i.toISOString().split("T")[0],currentStep:1,progress:0,responsible:t().user.name,createdAt:i.toISOString(),updatedAt:i.toISOString()};return e(o=>({calibrationEvents:[...o.calibrationEvents,a],showNewEventModal:!1})),t().addAlert({type:"info",severity:"info",message:`Avaliação ${n} iniciada para ${r.tag}`,meterId:r.id,meterTag:r.tag}),a},updateCalibrationEvent:(r,s)=>{e(i=>{var n;return{calibrationEvents:i.calibrationEvents.map(a=>a.id===r?{...a,...s,updatedAt:new Date().toISOString()}:a),selectedEvent:((n=i.selectedEvent)==null?void 0:n.id)===r?{...i.selectedEvent,...s,updatedAt:new Date().toISOString()}:i.selectedEvent}})},deleteCalibrationEvent:r=>{e(s=>{var i;return{calibrationEvents:s.calibrationEvents.filter(n=>n.id!==r),selectedEvent:((i=s.selectedEvent)==null?void 0:i.id)===r?null:s.selectedEvent}})},setCalibrationFormData:r=>e({calibrationFormData:r}),updateCalibrationFormData:r=>{e(s=>({calibrationFormData:s.calibrationFormData?{...s.calibrationFormData,...r}:null}))},completeCalibrationStep:(r,s)=>{const i=Math.round(s/7*100);t().updateCalibrationEvent(r,{currentStep:Math.min(s+1,7),progress:i,status:s>=7?"Concluída":"Em Andamento"})},finalizeCalibration:(r,s)=>{var a;const i=new Date;t().updateCalibrationEvent(r,{status:"Concluída",result:s,progress:100,currentStep:7,endDate:i.toISOString().split("T")[0]});const n=t().calibrationEvents.find(o=>o.id===r);if(n){if(s==="Aprovado"&&((a=t().calibrationFormData)!=null&&a.kFactors)){const{kFactors:o}=t().calibrationFormData;t().updateMeter(n.meterId,{kOil:o.kOil,kGas:o.kGas,kWater:o.kWater,lastCalibration:i.toISOString().split("T")[0],daysToCalibration:365})}t().addAlert({type:s==="Aprovado"?"success":"error",severity:s==="Aprovado"?"info":"critical",message:`Calibração ${r} finalizada: ${s}`,meterId:n.meterId,meterTag:n.meterTag})}},addAlert:r=>{const s={...r,id:generateUniqueId("alert"),timestamp:new Date().toISOString(),read:!1};e(i=>({alerts:[s,...i.alerts]}))},markAlertAsRead:r=>{e(s=>({alerts:s.alerts.map(i=>i.id===r?{...i,read:!0}:i)}))},markAllAlertsAsRead:()=>{e(r=>({alerts:r.alerts.map(s=>({...s,read:!0}))}))},deleteAlert:r=>{e(s=>({alerts:s.alerts.filter(i=>i.id!==r)}))},clearAllAlerts:()=>e({alerts:[]}),setMonitoringFilters:r=>{e(s=>({monitoringFilters:{...s.monitoringFilters,...r}}))},setCalibrationFilters:r=>{e(s=>({calibrationFilters:{...s.calibrationFilters,...r}}))},resetToDefaults:()=>{e(getInitialState())},clearAllData:()=>{e({meters:[],monitoringData:[],calibrationEvents:[],alerts:[],selectedMeter:null,selectedEvent:null,calibrationFormData:null})},getUnreadAlertsCount:()=>t().alerts.filter(r=>!r.read).length,getActiveMetersCount:()=>t().meters.filter(r=>r.status==="active").length,getFilteredMonitoringData:()=>{const{monitoringData:r,monitoringFilters:s}=t();return r.filter(i=>!(s.startDate&&i.date<s.startDate||s.endDate&&i.date>s.endDate||s.status&&i.hcStatus!==s.status))},getFilteredCalibrationEvents:()=>{const{calibrationEvents:r,calibrationFilters:s}=t();return r.filter(i=>!(s.status&&i.status!==s.status||s.type&&i.type!==s.type||s.meterId&&i.meterId!==s.meterId||s.responsible&&!i.responsible.toLowerCase().includes(s.responsible.toLowerCase())))}}),{name:"mpfm-monitor-storage",storage:createJSONStorage(()=>localStorage),partialize:e=>({meters:e.meters,monitoringData:e.monitoringData,calibrationEvents:e.calibrationEvents,alerts:e.alerts,user:e.user,sidebarCollapsed:e.sidebarCollapsed})})),MODULE_TITLES={monitoring:"Monitoramento SGM-FM",calibration:"Avaliação de Desempenho",compliance:"Conformidade ANP"};function Layout({children:e}){const[t,r]=reactExports.useState(!1),s=useLocation(),i=useNavigate(),{alerts:n,setShowImportModal:a,setShowExportModal:o}=useAppStore(),d=n.filter(u=>!u.read).length,c=(u=>u.includes("calibration")?"calibration":u.includes("compliance")?"compliance":"monitoring")(s.pathname),f=u=>{i(`/${u}`)};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white flex",children:[jsxRuntimeExports.jsx(Sidebar,{activeModule:c,onModuleChange:f,collapsed:t}),jsxRuntimeExports.jsxs("main",{className:"flex-1 flex flex-col min-w-0",children:[jsxRuntimeExports.jsx(Header,{title:MODULE_TITLES[c]||"MPFM Monitor",onToggleSidebar:()=>r(!t),onImport:()=>a(!0),onExport:()=>o(!0),alertCount:d}),jsxRuntimeExports.jsx("div",{className:"flex-1 p-4 overflow-auto",children:e})]})]})}function BalanceChart({data:e}){return jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:220,children:jsxRuntimeExports.jsxs(AreaChart,{data:e,children:[jsxRuntimeExports.jsxs("defs",{children:[jsxRuntimeExports.jsxs("linearGradient",{id:"hcGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[jsxRuntimeExports.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),jsxRuntimeExports.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]}),jsxRuntimeExports.jsxs("linearGradient",{id:"totalGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[jsxRuntimeExports.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.3}),jsxRuntimeExports.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})]}),jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3",stroke:"#27272a"}),jsxRuntimeExports.jsx(XAxis,{dataKey:"date",stroke:"#71717a",fontSize:10,tickFormatter:t=>t.slice(5)}),jsxRuntimeExports.jsx(YAxis,{stroke:"#71717a",fontSize:10,domain:[-15,40]}),jsxRuntimeExports.jsx(Tooltip,{contentStyle:{backgroundColor:"#18181b",border:"1px solid #27272a",borderRadius:"8px",fontSize:"11px"}}),jsxRuntimeExports.jsx(ReferenceLine,{y:10,stroke:"#ef4444",strokeDasharray:"5 5"}),jsxRuntimeExports.jsx(ReferenceLine,{y:-10,stroke:"#ef4444",strokeDasharray:"5 5"}),jsxRuntimeExports.jsx(ReferenceLine,{y:7,stroke:"#f59e0b",strokeDasharray:"3 3"}),jsxRuntimeExports.jsx(ReferenceLine,{y:-7,stroke:"#f59e0b",strokeDasharray:"3 3"}),jsxRuntimeExports.jsx(ReferenceLine,{y:0,stroke:"#52525b"}),jsxRuntimeExports.jsx(Area,{type:"monotone",dataKey:"hcBalTS",stroke:"#3b82f6",fill:"url(#hcGrad)",name:"HC %",strokeWidth:2}),jsxRuntimeExports.jsx(Area,{type:"monotone",dataKey:"totalBalTS",stroke:"#10b981",fill:"url(#totalGrad)",name:"Total %",strokeWidth:2}),jsxRuntimeExports.jsx(Legend,{wrapperStyle:{fontSize:"11px"}})]})})}function ProductionChart({data:e}){return jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:220,children:jsxRuntimeExports.jsxs(BarChart,{data:e,children:[jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3",stroke:"#27272a"}),jsxRuntimeExports.jsx(XAxis,{dataKey:"date",stroke:"#71717a",fontSize:10,tickFormatter:t=>t.slice(5)}),jsxRuntimeExports.jsx(YAxis,{stroke:"#71717a",fontSize:10}),jsxRuntimeExports.jsx(Tooltip,{contentStyle:{backgroundColor:"#18181b",border:"1px solid #27272a",borderRadius:"8px",fontSize:"11px"}}),jsxRuntimeExports.jsx(Bar,{dataKey:"subHC",fill:"#3b82f6",name:"Subsea",radius:[4,4,0,0]}),jsxRuntimeExports.jsx(Bar,{dataKey:"topHC",fill:"#8b5cf6",name:"Topside",radius:[4,4,0,0]}),jsxRuntimeExports.jsx(Bar,{dataKey:"sepHC",fill:"#10b981",name:"Test Sep",radius:[4,4,0,0]}),jsxRuntimeExports.jsx(Legend,{wrapperStyle:{fontSize:"11px"}})]})})}function DayCell({dayStatus:e,isToday:t,onClick:r}){if(!e)return jsxRuntimeExports.jsx("div",{className:"h-16 bg-zinc-900/30 rounded"});const s=parseInt(e.date.split("-")[2],10),i={OK:"bg-emerald-500/10 border-emerald-500/30 hover:bg-emerald-500/20",ALERT:"bg-amber-500/10 border-amber-500/30 hover:bg-amber-500/20",FAIL:"bg-red-500/10 border-red-500/30 hover:bg-red-500/20",NO_DATA:"bg-zinc-800/50 border-zinc-700/30 hover:bg-zinc-700/50"},n={OK:"bg-emerald-500",ALERT:"bg-amber-500",FAIL:"bg-red-500",NO_DATA:"bg-zinc-600"},a={OK:"text-emerald-400",ALERT:"text-amber-400",FAIL:"text-red-400",NO_DATA:"text-zinc-500"};return jsxRuntimeExports.jsxs("button",{onClick:r,disabled:!e.hasData,className:cn("h-16 rounded border transition-all duration-200 flex flex-col items-center justify-center gap-1","focus:outline-none focus:ring-2 focus:ring-blue-500/50",i[e.status],t&&"ring-2 ring-blue-500",e.hasData?"cursor-pointer":"cursor-default"),children:[jsxRuntimeExports.jsx("span",{className:cn("text-sm font-medium",e.hasData?"text-white":"text-zinc-600",t&&"text-blue-400"),children:s}),e.hasData&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:cn("w-2 h-2 rounded-full",n[e.status])}),jsxRuntimeExports.jsx("span",{className:cn("text-[10px] font-medium",a[e.status]),children:e.status})]}),e.hasData&&e.hcBalance!==void 0&&jsxRuntimeExports.jsxs("span",{className:cn("text-[9px]",a[e.status]),children:["HC: ",e.hcBalance>0?"+":"",e.hcBalance.toFixed(1),"%"]})]})}const STORAGE_KEY$3="mpfm_audit_log",MAX_ENTRIES=1e4;class AuditLogService{constructor(){lt(this,"logs",[]);lt(this,"initialized",!1);this.loadFromStorage()}loadFromStorage(){if(!this.initialized){try{const t=localStorage.getItem(STORAGE_KEY$3);t&&(this.logs=JSON.parse(t))}catch(t){console.error("[AuditLog] Erro ao carregar logs:",t),this.logs=[]}this.initialized=!0}}saveToStorage(){try{this.logs.length>MAX_ENTRIES&&(this.logs=this.logs.slice(-MAX_ENTRIES)),localStorage.setItem(STORAGE_KEY$3,JSON.stringify(this.logs))}catch(t){console.error("[AuditLog] Erro ao salvar logs:",t)}}async log(t){const r={...t,id:`audit-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date().toISOString(),userAgent:typeof navigator<"u"?navigator.userAgent:"server"};return this.logs.push(r),this.saveToStorage(),this.sendToServer(r).catch(console.error),r}async sendToServer(t){try{await fetch("/api/audit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch(r){console.error("[AuditLog] Erro ao enviar para servidor:",r)}}getRecentLogs(t=100){return this.logs.slice(-t).reverse()}getLogsByEntity(t,r){return this.logs.filter(s=>!(s.entity!==t||r&&s.entityId!==r)).reverse()}getLogsByUser(t){return this.logs.filter(r=>r.userId===t).reverse()}getLogsByPeriod(t,r){const s=t.getTime(),i=r.getTime();return this.logs.filter(n=>{const a=new Date(n.timestamp).getTime();return a>=s&&a<=i}).reverse()}getLogsByAction(t){return this.logs.filter(r=>r.action===t).reverse()}exportLogs(){return JSON.stringify(this.logs,null,2)}exportLogsAsCSV(){const t=["ID","Timestamp","Usuário","Ação","Entidade","ID Entidade","Nome Entidade","Motivo"],r=this.logs.map(s=>[s.id,s.timestamp,s.userName,s.action,s.entity,s.entityId,s.entityName||"",s.reason||""]);return[t.join(","),...r.map(s=>s.join(","))].join(`
`)}clearLogs(){{console.warn("[AuditLog] Não é possível limpar logs em produção");return}}}const auditLog=new AuditLogService;function useAuditLog(){const e=useAppStore(r=>r.user);return{logAction:reactExports.useCallback(async(r,s,i,n)=>auditLog.log({userId:(e==null?void 0:e.id)||"anonymous",userName:(e==null?void 0:e.name)||"Operador",action:r,entity:s,entityId:i,...n}),[e]),getRecentLogs:auditLog.getRecentLogs.bind(auditLog),getLogsByEntity:auditLog.getLogsByEntity.bind(auditLog),getLogsByUser:auditLog.getLogsByUser.bind(auditLog),getLogsByPeriod:auditLog.getLogsByPeriod.bind(auditLog),exportLogs:auditLog.exportLogs.bind(auditLog),exportLogsAsCSV:auditLog.exportLogsAsCSV.bind(auditLog)}}function DayDetailModal({isOpen:e,onClose:t,date:r}){const s=useAppStore(C=>C.monitoringData),i=useAppStore(C=>C.updateMonitoringData),n=useAppStore(C=>C.addAlert),{logAction:a}=useAuditLog(),o=useToast(),[d,l]=reactExports.useState(!1),[c,f]=reactExports.useState(""),[u,h]=reactExports.useState({});if(!r)return null;const g=s.find(C=>C.date===r);if(!g)return jsxRuntimeExports.jsx(Modal,{isOpen:e,onClose:t,title:"Detalhes do Dia",size:"md",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-zinc-500",children:[jsxRuntimeExports.jsx(Calendar,{size:48,className:"mb-4 opacity-50"}),jsxRuntimeExports.jsxs("p",{children:["Sem dados de medição para ",r]})]})});const p=C=>{const[_,w,T]=C.split("-");return`${T}/${w}/${_}`},x={OK:{icon:CheckCircle,color:"text-emerald-400",bg:"bg-emerald-500/10"},ALERT:{icon:AlertTriangle,color:"text-amber-400",bg:"bg-amber-500/10"},FAIL:{icon:XCircle,color:"text-red-400",bg:"bg-red-500/10"}},E=x[g.hcStatus]||x.OK,S=E.icon,P=()=>{l(!0),h({subOil:g.subOil,subGas:g.subGas,subWater:g.subWater||0,topOil:g.topOil,topGas:g.topGas,topWater:g.topWater||0})},F=()=>{l(!1),f(""),h({})},A=()=>{if(!c.trim()){n({type:"error",severity:"warning",message:"É necessário informar o motivo da alteração"});return}const C=u.subOil+u.subGas,_=u.topOil+u.topGas,w=C>0?(_-C)/C*100:0,T=C+(u.subWater||0),M=_+(u.topWater||0),R=T>0?(M-T)/T*100:0,k=Math.abs(w)>10?"FAIL":Math.abs(w)>7?"ALERT":"OK",L=Math.abs(R)>7?"FAIL":Math.abs(R)>5?"ALERT":"OK";i(g.id,{subOil:u.subOil,subGas:u.subGas,subWater:u.subWater,subHC:C,topOil:u.topOil,topGas:u.topGas,topWater:u.topWater,topHC:_,hcBalTS:parseFloat(w.toFixed(2)),totalBalTS:parseFloat(R.toFixed(2)),hcBalancePercent:parseFloat(w.toFixed(2)),totalBalancePercent:parseFloat(R.toFixed(2)),hcStatus:k,totalStatus:L,action:k==="FAIL"||L==="FAIL"?"INVESTIGAR":"MONITORAR"}),a("UPDATE","MONITORING_DATA",g.id,{entityName:`Dados de medição - ${p(r)}`,previousValue:{subOil:g.subOil,subGas:g.subGas,topOil:g.topOil,topGas:g.topGas},newValue:{subOil:u.subOil,subGas:u.subGas,topOil:u.topOil,topGas:u.topGas},reason:c}),o.success("Dados atualizados",`Medição de ${p(r)} atualizada com sucesso`),n({type:"info",severity:"info",message:`Dados de ${p(r)} editados. Motivo: ${c}`}),l(!1),f(""),h({})};return jsxRuntimeExports.jsx(Modal,{isOpen:e,onClose:t,title:"",size:"lg",children:jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:cn("p-2 rounded-lg",E.bg),children:jsxRuntimeExports.jsx(S,{className:E.color,size:24})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-white",children:p(r)}),jsxRuntimeExports.jsx("p",{className:"text-sm text-zinc-400",children:"Dados de medição diária"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Badge,{variant:g.hcStatus==="OK"?"success":g.hcStatus==="ALERT"?"warning":"error",children:g.hcStatus}),!d&&jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",onClick:P,children:[jsxRuntimeExports.jsx(PenLine,{size:14,className:"mr-1"}),"Editar"]})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4 bg-zinc-800/50",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-zinc-400 mb-3 flex items-center gap-2",children:[jsxRuntimeExports.jsx(BarChart3,{size:16}),"Balanço de Massa"]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"text-center p-3 rounded-lg bg-zinc-900/50",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mb-1",children:"Balanço HC"}),jsxRuntimeExports.jsxs("p",{className:cn("text-2xl font-bold",Math.abs(g.hcBalTS)>10?"text-red-400":Math.abs(g.hcBalTS)>7?"text-amber-400":"text-emerald-400"),children:[g.hcBalTS>0?"+":"",g.hcBalTS.toFixed(2),"%"]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Limite: ±10%"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center p-3 rounded-lg bg-zinc-900/50",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mb-1",children:"Balanço Total"}),jsxRuntimeExports.jsxs("p",{className:cn("text-2xl font-bold",Math.abs(g.totalBalTS)>7?"text-red-400":Math.abs(g.totalBalTS)>5?"text-amber-400":"text-emerald-400"),children:[g.totalBalTS>0?"+":"",g.totalBalTS.toFixed(2),"%"]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Limite: ±7%"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4 bg-zinc-800/50",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-blue-400 mb-3 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Waves,{size:16}),"SUBSEA (MPFM)"]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:d?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Input,{label:"Óleo (t)",type:"number",value:u.subOil,onChange:C=>h({...u,subOil:parseFloat(C.target.value)||0})}),jsxRuntimeExports.jsx(Input,{label:"Gás (t)",type:"number",value:u.subGas,onChange:C=>h({...u,subGas:parseFloat(C.target.value)||0})}),jsxRuntimeExports.jsx(Input,{label:"Água (t)",type:"number",value:u.subWater,onChange:C=>h({...u,subWater:parseFloat(C.target.value)||0})})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Droplets,{size:12})," Óleo"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[g.subOil.toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Flame,{size:12})," Gás"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[g.subGas.toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Waves,{size:12})," Água"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[(g.subWater||0).toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm pt-2 border-t border-zinc-700",children:[jsxRuntimeExports.jsx("span",{className:"text-zinc-300 font-medium",children:"HC Total"}),jsxRuntimeExports.jsxs("span",{className:"text-blue-400 font-mono font-medium",children:[g.subHC.toFixed(2)," t"]})]})]})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4 bg-zinc-800/50",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-purple-400 mb-3 flex items-center gap-2",children:[jsxRuntimeExports.jsx(BarChart3,{size:16}),"TOPSIDE (MPFM)"]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:d?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Input,{label:"Óleo (t)",type:"number",value:u.topOil,onChange:C=>h({...u,topOil:parseFloat(C.target.value)||0})}),jsxRuntimeExports.jsx(Input,{label:"Gás (t)",type:"number",value:u.topGas,onChange:C=>h({...u,topGas:parseFloat(C.target.value)||0})}),jsxRuntimeExports.jsx(Input,{label:"Água (t)",type:"number",value:u.topWater,onChange:C=>h({...u,topWater:parseFloat(C.target.value)||0})})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Droplets,{size:12})," Óleo"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[g.topOil.toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Flame,{size:12})," Gás"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[g.topGas.toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Waves,{size:12})," Água"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[(g.topWater||0).toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm pt-2 border-t border-zinc-700",children:[jsxRuntimeExports.jsx("span",{className:"text-zinc-300 font-medium",children:"HC Total"}),jsxRuntimeExports.jsxs("span",{className:"text-purple-400 font-mono font-medium",children:[g.topHC.toFixed(2)," t"]})]})]})})]})]}),d&&jsxRuntimeExports.jsxs(Card,{className:"p-4 bg-amber-500/10 border-amber-500/30",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-amber-400 mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx(FileText,{size:16}),"Justificativa da Alteração (obrigatório)"]}),jsxRuntimeExports.jsx("textarea",{value:c,onChange:C=>f(C.target.value),placeholder:"Descreva o motivo da alteração para registro de auditoria...",className:"w-full h-20 bg-zinc-900/50 border border-zinc-700 rounded-lg p-2 text-sm text-white resize-none focus:outline-none focus:ring-2 focus:ring-amber-500/50"})]}),jsxRuntimeExports.jsx("div",{className:"flex justify-end gap-2 pt-2 border-t border-zinc-800",children:d?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",onClick:F,children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{variant:"primary",onClick:A,children:"Salvar Alterações"})]}):jsxRuntimeExports.jsx(Button,{variant:"ghost",onClick:t,children:"Fechar"})})]})})}const WEEKDAYS=["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],MONTHS=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];function CalendarView(){const e=new Date,[t,r]=reactExports.useState(e.getMonth()),[s,i]=reactExports.useState(e.getFullYear()),[n,a]=reactExports.useState(null),[o,d]=reactExports.useState(!1),l=useAppStore(E=>E.monitoringData),c=reactExports.useMemo(()=>{const E=new Date(s,t,1),S=new Date(s,t+1,0),P=E.getDay(),F=S.getDate(),A=[];for(let C=0;C<P;C++)A.push(null);for(let C=1;C<=F;C++){const _=`${s}-${String(t+1).padStart(2,"0")}-${String(C).padStart(2,"0")}`,w=l.find(T=>T.date===_);w?A.push({date:_,hasData:!0,status:w.hcStatus,hcBalance:w.hcBalTS,totalBalance:w.totalBalTS}):A.push({date:_,hasData:!1,status:"NO_DATA"})}return A},[t,s,l]),f=()=>{t===0?(r(11),i(s-1)):r(t-1)},u=()=>{t===11?(r(0),i(s+1)):r(t+1)},h=()=>{r(e.getMonth()),i(e.getFullYear())},g=E=>{a(E.date),d(!0)},p=reactExports.useMemo(()=>{const E=c.filter(A=>A==null?void 0:A.hasData),S=E.filter(A=>(A==null?void 0:A.status)==="OK").length,P=E.filter(A=>(A==null?void 0:A.status)==="ALERT").length,F=E.filter(A=>(A==null?void 0:A.status)==="FAIL").length;return{total:E.length,ok:S,alert:P,fail:F}},[c]),x=Array.from({length:10},(E,S)=>({value:String(s-5+S),label:String(s-5+S)}));return jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(Calendar,{className:"text-blue-400",size:24}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-white",children:"Calendário de Medições"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400",children:[p.total," dias com dados:"]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded-full bg-emerald-500"}),jsxRuntimeExports.jsxs("span",{className:"text-emerald-400",children:[p.ok," OK"]})]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded-full bg-amber-500"}),jsxRuntimeExports.jsxs("span",{className:"text-amber-400",children:[p.alert," Alert"]})]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded-full bg-red-500"}),jsxRuntimeExports.jsxs("span",{className:"text-red-400",children:[p.fail," Fail"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4 bg-zinc-800/50 rounded-lg p-2",children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:f,className:"text-zinc-400 hover:text-white",children:jsxRuntimeExports.jsx(ChevronLeft,{size:20})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Select,{value:String(t),onChange:E=>r(Number(E.target.value)),options:MONTHS.map((E,S)=>({value:String(S),label:E})),className:"w-32"}),jsxRuntimeExports.jsx(Select,{value:String(s),onChange:E=>i(Number(E.target.value)),options:x,className:"w-24"}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:h,className:"ml-2",children:"Hoje"})]}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:u,className:"text-zinc-400 hover:text-white",children:jsxRuntimeExports.jsx(ChevronRight,{size:20})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[WEEKDAYS.map(E=>jsxRuntimeExports.jsx("div",{className:"text-center text-xs font-medium text-zinc-500 py-2",children:E},E)),c.map((E,S)=>jsxRuntimeExports.jsx(DayCell,{dayStatus:E,isToday:(E==null?void 0:E.date)===e.toISOString().split("T")[0],onClick:E?()=>g(E):void 0},S))]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4 pt-4 border-t border-zinc-800 text-xs text-zinc-500",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded bg-emerald-500/20 border border-emerald-500"}),"OK (HC ≤ 7%)"]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded bg-amber-500/20 border border-amber-500"}),"Alert (7% < HC ≤ 10%)"]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded bg-red-500/20 border border-red-500"}),"Fail (HC > 10%)"]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded bg-zinc-700 border border-zinc-600"}),"Sem dados"]})]}),jsxRuntimeExports.jsx(DayDetailModal,{isOpen:o,onClose:()=>d(!1),date:n})]})}function getTimeAgo(e){const t=new Date,r=new Date(e),s=t.getTime()-r.getTime(),i=Math.floor(s/6e4),n=Math.floor(s/36e5),a=Math.floor(s/864e5);return i<60?`${i}m atrás`:n<24?`${n}h atrás`:`${a}d atrás`}const realMeters=[{tag:"13FT0367",name:"Riser P5",location:"TOPSIDE",status:"active",serialNumber:"SLB-VX-2024-0367",manufacturer:"Schlumberger",model:"Vx Spectra",lastCalibration:"2026-01-18",kOil:1.0908,kGas:1.09262,kWater:1,daysToCalibration:365},{tag:"13FT0417",name:"Riser P6",location:"TOPSIDE",status:"inactive",serialNumber:"SLB-VX-2024-0417",manufacturer:"Schlumberger",model:"Vx Spectra",lastCalibration:"2025-06-15",kOil:1,kGas:1,kWater:1,daysToCalibration:180},{tag:"18FT1506",name:"PE_4",location:"SUBSEA",status:"active",serialNumber:"TFMC-MPM-2024-1506",manufacturer:"TechnipFMC",model:"MPM",lastCalibration:"2025-12-01",kOil:1,kGas:1,kWater:1,daysToCalibration:320},{tag:"18FT1806",name:"PE_EO4",location:"SUBSEA",status:"inactive",serialNumber:"TFMC-MPM-2024-1806",manufacturer:"TechnipFMC",model:"MPM",lastCalibration:"2025-08-20",kOil:1,kGas:1,kWater:1,daysToCalibration:0},{tag:"18FT1706",name:"PE_EO105",location:"SUBSEA",status:"inactive",serialNumber:"TFMC-MPM-2024-1706",manufacturer:"TechnipFMC",model:"MPM",lastCalibration:"2025-07-10",kOil:1,kGas:1,kWater:1,daysToCalibration:0},{tag:"18FT1406",name:"PE_EO10",location:"SUBSEA",status:"inactive",serialNumber:"TFMC-MPM-2024-1406",manufacturer:"TechnipFMC",model:"MPM",lastCalibration:"2025-09-05",kOil:1,kGas:1,kWater:1,daysToCalibration:0}],realCalibrationPVT={calibrationNo:211,meterName:"N1 - Riser P5",startDate:"2026-01-17",endDate:"2026-01-18",densities:{oil:{mpfm:754.033},gas:{mpfm:91.842},water:{mpfm:999.784}},composition:[{component:"N₂",molPercent:.575,molecularWeight:28.01},{component:"CO₂",molPercent:.02,molecularWeight:44.01},{component:"C₁",molPercent:62.183,molecularWeight:16.04},{component:"C₂",molPercent:8.069,molecularWeight:30.07},{component:"C₃",molPercent:5.047,molecularWeight:44.1},{component:"i-C₄",molPercent:1.069,molecularWeight:58.12},{component:"n-C₄",molPercent:1.858,molecularWeight:58.12},{component:"i-C₅",molPercent:.681,molecularWeight:72.15},{component:"n-C₅",molPercent:.788,molecularWeight:72.15},{component:"C₆",molPercent:1.112,molecularWeight:86.18},{component:"C₇",molPercent:1.138,molecularWeight:97.37},{component:"C₈",molPercent:1.657,molecularWeight:111.29},{component:"C₉",molPercent:1.472,molecularWeight:125.25},{component:"C₁₀+",molPercent:14.331,molecularWeight:289.64}],peneloux:{gas:1,oil:1}};function AlertsList({limit:e}){const t=useAppStore(n=>n.alerts),r=e?t.slice(0,e):t,s=n=>{switch(n){case"error":return AlertCircle;case"warning":return AlertTriangle;case"success":return CheckCircle;default:return Info}},i=n=>{switch(n){case"error":return"bg-red-500/20 text-red-400";case"warning":return"bg-amber-500/20 text-amber-400";case"success":return"bg-emerald-500/20 text-emerald-400";default:return"bg-blue-500/20 text-blue-400"}};return jsxRuntimeExports.jsx("div",{className:"divide-y divide-zinc-800",children:r.map(n=>{const a=s(n.type);return jsxRuntimeExports.jsx("div",{className:cn("p-3",!n.read&&"bg-zinc-800/30"),children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-2",children:[jsxRuntimeExports.jsx("div",{className:cn("mt-0.5 p-1 rounded",i(n.type)),children:jsxRuntimeExports.jsx(a,{className:"w-3 h-3"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-200 truncate",children:n.message}),jsxRuntimeExports.jsxs("p",{className:"text-[10px] text-zinc-500 mt-0.5",children:[n.meterTag," • ",getTimeAgo(n.timestamp)]})]})]})},n.id)})})}function DailyTable({data:e}){const t=[...e].reverse().slice(0,5);return jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700 bg-zinc-800/50",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-left text-zinc-400",children:"Data"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-blue-400",children:"Subsea HC"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-purple-400",children:"Topside HC"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-emerald-400",children:"Test Sep HC"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Bal HC%"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Status"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Ação"})]})}),jsxRuntimeExports.jsx("tbody",{children:t.map((r,s)=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50 hover:bg-zinc-800/30",children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-zinc-200",children:r.date}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-right text-blue-400",children:r.subHC.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-right text-purple-400",children:r.topHC.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-right text-emerald-400",children:r.sepHC.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsxs("td",{className:cn("py-2 px-3 text-center font-mono",Math.abs(r.hcBalTS)>10?"text-red-400":"text-zinc-300"),children:[r.hcBalTS>0?"+":"",r.hcBalTS.toFixed(2),"%"]}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:r.hcStatus,size:"sm",children:r.hcStatus})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:r.action,size:"sm",children:r.action})})]},s))})]})})}function MetersList(){const{meters:e,setShowMeterModal:t,setEditingMeter:r,deleteMeter:s}=useAppStore(),i=a=>{r(a)},n=a=>{confirm("Tem certeza que deseja remover este medidor?")&&s(a)};return jsxRuntimeExports.jsx(Card,{title:"Medidores MPFM",subtitle:"Status e próximas calibrações",headerRight:jsxRuntimeExports.jsx(Button,{variant:"primary",size:"sm",icon:Plus,onClick:()=>t(!0),children:"Adicionar"}),noPadding:!0,children:e.length===0?jsxRuntimeExports.jsxs("div",{className:"p-8 text-center text-zinc-500",children:[jsxRuntimeExports.jsx("p",{className:"mb-4",children:"Nenhum medidor cadastrado."}),jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:Plus,onClick:()=>t(!0),children:"Adicionar Primeiro Medidor"})]}):jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700 bg-zinc-800/50",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-left text-zinc-400",children:"TAG"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-left text-zinc-400",children:"Nome"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Localização"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Status"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Última Calib."}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-zinc-400",children:"K-Oil"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-zinc-400",children:"K-Gas"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Próx. Calib."}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Ações"})]})}),jsxRuntimeExports.jsx("tbody",{children:e.map(a=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50 hover:bg-zinc-800/30",children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-3 font-mono text-blue-400",children:a.tag}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-zinc-200",children:a.name}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:a.location,size:"sm",children:a.location})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:a.status,size:"sm",children:a.status==="active"?"Ativo":"Inativo"})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center text-zinc-400",children:a.lastCalibration}),jsxRuntimeExports.jsx("td",{className:cn("py-2 px-3 text-right font-mono",a.kOil<.8||a.kOil>1.2?"text-red-400":"text-emerald-400"),children:a.kOil.toFixed(4)}),jsxRuntimeExports.jsx("td",{className:cn("py-2 px-3 text-right font-mono",a.kGas<.8||a.kGas>1.2?"text-red-400":"text-emerald-400"),children:a.kGas.toFixed(4)}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsxs(Badge,{variant:a.daysToCalibration<30?"error":a.daysToCalibration<60?"warning":"success",size:"sm",children:[a.daysToCalibration,"d"]})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-1",children:[jsxRuntimeExports.jsx("button",{onClick:()=>i(a),className:"p-1 hover:bg-zinc-700 rounded transition-colors",title:"Editar",children:jsxRuntimeExports.jsx(PenSquare,{className:"w-3.5 h-3.5 text-zinc-400 hover:text-blue-400"})}),jsxRuntimeExports.jsx("button",{onClick:()=>n(a.id),className:"p-1 hover:bg-zinc-700 rounded transition-colors",title:"Remover",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3.5 h-3.5 text-zinc-400 hover:text-red-400"})})]})})]},a.id))})]})})})}function MonitoringDashboard(){var u,h;const{monitoringData:e,meters:t,getUnreadAlertsCount:r,getActiveMetersCount:s,setShowMeterModal:i,setShowImportModal:n}=useAppStore(),a=e.length>0,o=t.length>0,d=a?e[e.length-1]:null,l=a?Math.max(...e.map(g=>Math.max(g.subVsTS||0,g.topVsTS||0,g.topVsSub||0))):0,c=r(),f=s();return!a&&!o?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-[60vh] space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx(Database,{className:"w-16 h-16 text-zinc-600 mx-auto mb-4"}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Bem-vindo ao MPFM Monitor"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400 max-w-md",children:"Comece adicionando medidores MPFM e importando dados de monitoramento para visualizar os balanços de massa."})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsx(Button,{variant:"primary",icon:Plus,onClick:()=>i(!0),children:"Adicionar Medidor"}),jsxRuntimeExports.jsx(Button,{variant:"secondary",icon:Database,onClick:()=>n(!0),children:"Importar Dados"})]})]}):jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-3",children:[jsxRuntimeExports.jsx(KPICard,{title:"Balanço HC Atual",value:d?((u=d.hcBalTS)==null?void 0:u.toFixed(2))||"0.00":"--",unit:"%",subtitle:d&&Math.abs(d.hcBalTS||0)>10?"FORA DO LIMITE":"Dentro do limite",icon:Target,color:d&&Math.abs(d.hcBalTS||0)>10?"red":"emerald"}),jsxRuntimeExports.jsx(KPICard,{title:"Balanço Total",value:d?((h=d.totalBalTS)==null?void 0:h.toFixed(2))||"0.00":"--",unit:"%",subtitle:"Limite: ±7%",icon:Activity,color:d&&Math.abs(d.totalBalTS||0)>7?"red":"emerald"}),jsxRuntimeExports.jsx(KPICard,{title:"Dias Consecutivos",value:l,unit:"/10",subtitle:"Gatilho calibração",icon:Calendar,color:l>=10?"red":l>=7?"amber":"emerald"}),jsxRuntimeExports.jsx(KPICard,{title:"Medidores Ativos",value:f,unit:`/${t.length}`,icon:Gauge,color:"purple"}),jsxRuntimeExports.jsx(KPICard,{title:"Alertas Pendentes",value:c,icon:Bell,color:c>0?"amber":"emerald"})]}),a&&jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(Card,{title:"Histórico de Balanço de Massa",subtitle:"Últimos 7 dias - Limites ANP: HC ±10%, Total ±7%",children:jsxRuntimeExports.jsx(BalanceChart,{data:e})}),jsxRuntimeExports.jsx(Card,{title:"Produção HC por Sistema",subtitle:"Últimos 7 dias (t)",children:jsxRuntimeExports.jsx(ProductionChart,{data:e})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[jsxRuntimeExports.jsx(Card,{title:"Monitoramento Diário",subtitle:a?"Últimos registros":"Nenhum dado importado",className:"lg:col-span-2",noPadding:!0,children:a?jsxRuntimeExports.jsx(DailyTable,{data:e}):jsxRuntimeExports.jsxs("div",{className:"p-8 text-center text-zinc-500",children:[jsxRuntimeExports.jsx("p",{children:"Importe dados de monitoramento para visualizar a tabela."}),jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",className:"mt-4",onClick:()=>n(!0),children:"Importar Dados"})]})}),jsxRuntimeExports.jsx(Card,{title:"Alertas Recentes",headerRight:jsxRuntimeExports.jsxs(Badge,{variant:c>0?"warning":"success",children:[c," novos"]}),noPadding:!0,children:jsxRuntimeExports.jsx(AlertsList,{limit:4})})]}),jsxRuntimeExports.jsx(MetersList,{}),jsxRuntimeExports.jsx(CalendarView,{})]})}const KFACTOR_LIMITS={K_FACTOR_MIN:.8,K_FACTOR_MAX:1.2,K_FACTOR_WARNING_MIN:.85,K_FACTOR_WARNING_MAX:1.15,CONSECUTIVE_DAYS_TRIGGER:10,CONSECUTIVE_DAYS_WARNING:7,HC_DEVIATION_MAX:10,TOTAL_DEVIATION_MAX:7,BSW_WARNING:15,BSW_CRITICAL:20,CALIBRATION_INTERVAL_DAYS:180,CALIBRATION_WARNING_DAYS:150},STORAGE_KEY$2="mpfm_kfactor_history";class KFactorTrackerService{constructor(){lt(this,"histories",new Map);lt(this,"consecutiveDays",new Map);this.loadFromStorage()}loadFromStorage(){try{const t=localStorage.getItem(STORAGE_KEY$2);if(t){const r=JSON.parse(t);this.histories=new Map(Object.entries(r.histories||{})),this.consecutiveDays=new Map(Object.entries(r.consecutiveDays||{}))}}catch(t){console.error("[KFactorTracker] Erro ao carregar histórico:",t)}}saveToStorage(){try{const t={histories:Object.fromEntries(this.histories),consecutiveDays:Object.fromEntries(this.consecutiveDays)};localStorage.setItem(STORAGE_KEY$2,JSON.stringify(t))}catch(t){console.error("[KFactorTracker] Erro ao salvar histórico:",t)}}isWithinLimits(t){return t>=KFACTOR_LIMITS.K_FACTOR_MIN&&t<=KFACTOR_LIMITS.K_FACTOR_MAX}isNearLimits(t){return t>=KFACTOR_LIMITS.K_FACTOR_MIN&&t<KFACTOR_LIMITS.K_FACTOR_WARNING_MIN||t>KFACTOR_LIMITS.K_FACTOR_WARNING_MAX&&t<=KFACTOR_LIMITS.K_FACTOR_MAX}addReading(t,r,s,i,n,a="calculated"){const o=new Date,d=o.toISOString().split("T")[0],l=this.isWithinLimits(s)&&this.isWithinLimits(i)&&this.isWithinLimits(n),c={date:d,timestamp:o.toISOString(),meterId:t,meterTag:r,kOil:s,kGas:i,kWater:n,source:a,isWithinLimits:l};let f=this.histories.get(t);f||(f={meterId:t,readings:[],statistics:{avgKOil:1,avgKGas:1,avgKWater:1,stdDevKOil:0,stdDevKGas:0,stdDevKWater:0,daysInRange:0,daysOutOfRange:0,complianceRate:100}});const u=f.readings.findIndex(h=>h.date===d);return u>=0?f.readings[u]=c:f.readings.push(c),f.readings.length>365&&(f.readings=f.readings.slice(-365)),this.updateConsecutiveDays(t,l),this.updateStatistics(f),this.histories.set(t,f),this.saveToStorage(),console.log(`[KFactorTracker] Leitura adicionada: ${r} - Oil: ${s.toFixed(4)}, Gas: ${i.toFixed(4)}, Water: ${n.toFixed(4)}`),c}updateConsecutiveDays(t,r){if(r)this.consecutiveDays.set(t,0);else{const s=this.consecutiveDays.get(t)||0;this.consecutiveDays.set(t,s+1)}}updateStatistics(t){const r=t.readings;if(r.length===0)return;const s=r.map(u=>u.kOil),i=r.map(u=>u.kGas),n=r.map(u=>u.kWater),a=u=>u.reduce((h,g)=>h+g,0)/u.length,o=(u,h)=>Math.sqrt(u.reduce((g,p)=>g+Math.pow(p-h,2),0)/u.length),d=a(s),l=a(i),c=a(n),f=r.filter(u=>u.isWithinLimits).length;t.statistics={avgKOil:d,avgKGas:l,avgKWater:c,stdDevKOil:o(s,d),stdDevKGas:o(i,l),stdDevKWater:o(n,c),daysInRange:f,daysOutOfRange:r.length-f,complianceRate:f/r.length*100}}getConsecutiveDaysOutOfRange(t){return this.consecutiveDays.get(t)||0}needsCalibration(t,r){const s=this.getConsecutiveDaysOutOfRange(t);let i=0;if(r){const n=new Date(r);i=Math.floor((Date.now()-n.getTime())/(1e3*60*60*24))}else i=365;return s>=KFACTOR_LIMITS.CONSECUTIVE_DAYS_TRIGGER?{required:!0,reason:`K-Factor fora do limite por ${s} dias consecutivos (ANP 44/2015 Art. 12)`,severity:"critical",daysOutOfRange:s,daysSinceCalibration:i}:i>KFACTOR_LIMITS.CALIBRATION_INTERVAL_DAYS?{required:!0,reason:`Calibração periódica vencida (${i} dias desde última calibração)`,severity:"critical",daysOutOfRange:s,daysSinceCalibration:i}:s>=KFACTOR_LIMITS.CONSECUTIVE_DAYS_WARNING?{required:!1,reason:`Atenção: ${s} dias consecutivos fora do limite. Calibração obrigatória em ${KFACTOR_LIMITS.CONSECUTIVE_DAYS_TRIGGER-s} dias.`,severity:"warning",daysOutOfRange:s,daysSinceCalibration:i}:i>KFACTOR_LIMITS.CALIBRATION_WARNING_DAYS?{required:!1,reason:`Calibração periódica vence em ${KFACTOR_LIMITS.CALIBRATION_INTERVAL_DAYS-i} dias`,severity:"warning",daysOutOfRange:s,daysSinceCalibration:i}:{required:!1,severity:"none",daysOutOfRange:s,daysSinceCalibration:i}}getMeterStatus(t,r,s,i,n){const a=this.needsCalibration(t,n),o=this.histories.get(t);let d="ok";if(a.severity==="critical")d="critical";else if(a.severity==="warning")d="warning";else{const{oil:c,gas:f,water:u}=i;(this.isNearLimits(c)||this.isNearLimits(f)||this.isNearLimits(u))&&(d="warning")}let l="stable";if(o&&o.readings.length>=14){const c=o.readings.slice(-7),f=o.readings.slice(-14,-7),u=c.filter(g=>!g.isWithinLimits).length,h=f.filter(g=>!g.isWithinLimits).length;u<h?l="improving":u>h&&(l="degrading")}return{meterId:t,meterTag:r,meterName:s,currentKFactors:i,status:d,consecutiveDaysOutOfRange:a.daysOutOfRange,lastCalibrationDate:n,daysSinceCalibration:a.daysSinceCalibration,calibrationRequired:a.required,calibrationReason:a.reason,complianceRate:(o==null?void 0:o.statistics.complianceRate)||100,trend:l}}getHistory(t){return this.histories.get(t)}recordCalibration(t,r,s,i){var a;this.consecutiveDays.set(t,0);const n=this.histories.get(t);n&&this.addReading(t,((a=n.readings[0])==null?void 0:a.meterTag)||t,r,s,i,"calibration"),this.saveToStorage(),console.log(`[KFactorTracker] Calibração registrada para ${t}`)}clearAll(){}}new KFactorTrackerService;const STORAGE_KEY$1="mpfm_alerts";class AlertEngineService{constructor(){lt(this,"alerts",[]);lt(this,"rules",[]);lt(this,"listeners",new Set);this.loadFromStorage(),this.initializeDefaultRules()}loadFromStorage(){try{const t=localStorage.getItem(STORAGE_KEY$1);t&&(this.alerts=JSON.parse(t))}catch(t){console.error("[AlertEngine] Erro ao carregar alertas:",t)}}saveToStorage(){try{localStorage.setItem(STORAGE_KEY$1,JSON.stringify(this.alerts)),this.notifyListeners()}catch(t){console.error("[AlertEngine] Erro ao salvar alertas:",t)}}notifyListeners(){this.listeners.forEach(t=>t([...this.alerts]))}generateId(){return`alert_${Date.now()}_${Math.random().toString(36).substring(2,9)}`}initializeDefaultRules(){this.rules=[{id:"k_factor_out_of_range",name:"K-Factor Fora do Limite",category:"k_factor",condition:t=>!t.kOil||!t.kGas||!t.kWater?!1:t.kOil<KFACTOR_LIMITS.K_FACTOR_MIN||t.kOil>KFACTOR_LIMITS.K_FACTOR_MAX||t.kGas<KFACTOR_LIMITS.K_FACTOR_MIN||t.kGas>KFACTOR_LIMITS.K_FACTOR_MAX||t.kWater<KFACTOR_LIMITS.K_FACTOR_MIN||t.kWater>KFACTOR_LIMITS.K_FACTOR_MAX,severity:"warning",titleTemplate:"K-Factor fora do limite - {meterTag}",descriptionTemplate:"K-Factor(s) fora do intervalo permitido (0.8 - 1.2). K-Oil: {kOil}, K-Gas: {kGas}, K-Water: {kWater}",enabled:!0},{id:"consecutive_days_warning",name:"Dias Consecutivos - Aviso",category:"calibration",condition:t=>{const r=t.consecutiveDaysOutOfRange||0;return r>=KFACTOR_LIMITS.CONSECUTIVE_DAYS_WARNING&&r<KFACTOR_LIMITS.CONSECUTIVE_DAYS_TRIGGER},severity:"warning",titleTemplate:"Atenção: {consecutiveDaysOutOfRange} dias consecutivos fora do limite",descriptionTemplate:"Medidor {meterTag} está fora do limite por {consecutiveDaysOutOfRange} dias. Calibração obrigatória em {daysRemaining} dias.",enabled:!0},{id:"consecutive_days_critical",name:"Dias Consecutivos - Crítico",category:"calibration",condition:t=>(t.consecutiveDaysOutOfRange||0)>=KFACTOR_LIMITS.CONSECUTIVE_DAYS_TRIGGER,severity:"critical",titleTemplate:"CALIBRAÇÃO OBRIGATÓRIA - {meterTag}",descriptionTemplate:"K-Factor fora do limite por {consecutiveDaysOutOfRange} dias consecutivos. Calibração obrigatória conforme ANP 44/2015 Art. 12.",enabled:!0},{id:"hc_deviation_exceeded",name:"Desvio HC Excedido",category:"deviation",condition:t=>{const r=Math.abs(t.oilDeviation||0),s=Math.abs(t.gasDeviation||0);return r>KFACTOR_LIMITS.HC_DEVIATION_MAX||s>KFACTOR_LIMITS.HC_DEVIATION_MAX},severity:"critical",titleTemplate:"Desvio de HC excedido - {meterTag}",descriptionTemplate:"Desvio de hidrocarboneto excede limite de ±10%. Óleo: {oilDeviation}%, Gás: {gasDeviation}%",enabled:!0},{id:"total_deviation_exceeded",name:"Desvio Total Excedido",category:"deviation",condition:t=>Math.abs(t.totalDeviation||0)>KFACTOR_LIMITS.TOTAL_DEVIATION_MAX,severity:"warning",titleTemplate:"Desvio total excedido - {meterTag}",descriptionTemplate:"Desvio total excede limite de ±7%. Valor: {totalDeviation}%",enabled:!0},{id:"bsw_warning",name:"BSW Elevado",category:"bsw",condition:t=>{const r=t.bsw||0;return r>=KFACTOR_LIMITS.BSW_WARNING&&r<KFACTOR_LIMITS.BSW_CRITICAL},severity:"warning",titleTemplate:"BSW elevado - {meterTag}",descriptionTemplate:"BSW em {bsw}% - acima do limite de advertência de {threshold}%",enabled:!0},{id:"bsw_critical",name:"BSW Crítico",category:"bsw",condition:t=>(t.bsw||0)>=KFACTOR_LIMITS.BSW_CRITICAL,severity:"critical",titleTemplate:"BSW crítico - {meterTag}",descriptionTemplate:"BSW em {bsw}% - impacta significativamente a qualidade do óleo",enabled:!0},{id:"calibration_due_warning",name:"Calibração Periódica - Aviso",category:"calibration",condition:t=>{const r=t.daysSinceCalibration||0;return r>=KFACTOR_LIMITS.CALIBRATION_WARNING_DAYS&&r<KFACTOR_LIMITS.CALIBRATION_INTERVAL_DAYS},severity:"info",titleTemplate:"Calibração periódica se aproximando - {meterTag}",descriptionTemplate:"Última calibração há {daysSinceCalibration} dias. Vence em {daysRemaining} dias.",enabled:!0},{id:"calibration_overdue",name:"Calibração Periódica Vencida",category:"calibration",condition:t=>(t.daysSinceCalibration||0)>KFACTOR_LIMITS.CALIBRATION_INTERVAL_DAYS,severity:"critical",titleTemplate:"CALIBRAÇÃO VENCIDA - {meterTag}",descriptionTemplate:"Calibração periódica vencida há {overdueDays} dias. Verificar conformidade ANP.",enabled:!0}]}processTemplate(t,r){let s=t;if(Object.entries(r).forEach(([i,n])=>{const a=new RegExp(`\\{${i}\\}`,"g");s=s.replace(a,String(n??"N/A"))}),r.consecutiveDaysOutOfRange){const i=KFACTOR_LIMITS.CONSECUTIVE_DAYS_TRIGGER-r.consecutiveDaysOutOfRange;s=s.replace(/\{daysRemaining\}/g,String(Math.max(0,i)))}if(r.daysSinceCalibration){const i=KFACTOR_LIMITS.CALIBRATION_INTERVAL_DAYS-r.daysSinceCalibration;s=s.replace(/\{daysRemaining\}/g,String(Math.max(0,i)));const n=r.daysSinceCalibration-KFACTOR_LIMITS.CALIBRATION_INTERVAL_DAYS;s=s.replace(/\{overdueDays\}/g,String(Math.max(0,n)))}return s=s.replace(/\{threshold\}/g,String(KFACTOR_LIMITS.BSW_WARNING)),s}checkAndGenerateAlerts(t){const r=[];for(const s of this.rules)if(s.enabled)try{if(s.condition(t)&&!this.alerts.find(n=>!n.resolved&&n.meterId===t.meterId&&n.title.includes(s.id.replace(/_/g," ")))){const n=this.createAlert({meterId:t.meterId,meterTag:t.meterTag,category:s.category,severity:s.severity,title:this.processTemplate(s.titleTemplate,t),description:this.processTemplate(s.descriptionTemplate,t),source:"automatic"});r.push(n)}}catch(i){console.error(`[AlertEngine] Erro na regra ${s.id}:`,i)}return r}createAlert(t){const r={id:this.generateId(),timestamp:new Date().toISOString(),acknowledged:!1,resolved:!1,...t};return this.alerts.unshift(r),this.saveToStorage(),console.log(`[AlertEngine] Alerta criado: ${r.severity.toUpperCase()} - ${r.title}`),r}acknowledgeAlert(t,r){const s=this.alerts.find(i=>i.id===t);return s?(s.acknowledged=!0,s.acknowledgedBy=r,s.acknowledgedAt=new Date().toISOString(),this.saveToStorage(),console.log(`[AlertEngine] Alerta reconhecido: ${t} por ${r}`),!0):!1}resolveAlert(t,r){const s=this.alerts.find(i=>i.id===t);return s?(s.resolved=!0,s.resolvedAt=new Date().toISOString(),r&&(s.resolutionNote=r),this.saveToStorage(),console.log(`[AlertEngine] Alerta resolvido: ${t}`),!0):!1}getActiveAlerts(){return this.alerts.filter(t=>!t.resolved)}getAlertsBySeverity(t){return this.alerts.filter(r=>r.severity===t&&!r.resolved)}getAlertsByMeter(t){return this.alerts.filter(r=>r.meterId===t)}getAlertCounts(){const t=this.getActiveAlerts();return{critical:t.filter(r=>r.severity==="critical").length,warning:t.filter(r=>r.severity==="warning").length,info:t.filter(r=>r.severity==="info").length}}getAllAlerts(){return[...this.alerts]}cleanupOldAlerts(){const t=Date.now()-2592e6,r=this.alerts.length;return this.alerts=this.alerts.filter(s=>s.resolved?new Date(s.timestamp).getTime()>t:!0),this.saveToStorage(),r-this.alerts.length}subscribe(t){return this.listeners.add(t),()=>this.listeners.delete(t)}clearAll(){}}new AlertEngineService;function MonitoringPage(){return jsxRuntimeExports.jsx(MonitoringDashboard,{})}function CalibrationEventsList({onSelectEvent:e}){const{calibrationEvents:t,setShowNewEventModal:r,deleteCalibrationEvent:s}=useAppStore(),[i,n]=reactExports.useState("all"),a=t.filter(f=>i==="all"?!0:i==="active"?f.status==="Em Andamento":i==="pending"?f.status==="Pendente":i==="completed"?f.status==="Concluída":!0),o=(f,u)=>{f.stopPropagation(),confirm("Tem certeza que deseja remover este evento de calibração?")&&s(u)},d=f=>{switch(f){case"Concluída":return CheckCircle;case"Em Andamento":return Play;default:return Clock}},l=f=>{switch(f){case"Concluída":return"bg-emerald-500/20";case"Em Andamento":return"bg-blue-500/20";default:return"bg-zinc-700"}},c=f=>{switch(f){case"Concluída":return"text-emerald-400";case"Em Andamento":return"text-blue-400";default:return"text-zinc-400"}};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-white",children:"Eventos de Calibração"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Avaliações de desempenho MPFM - Comissionamento, Periódica, Investigação"})]}),jsxRuntimeExports.jsx(Button,{onClick:()=>r(!0),icon:Plus,children:"Nova Avaliação"})]}),jsxRuntimeExports.jsx(Tabs,{tabs:[{id:"all",label:"Todos",count:t.length},{id:"active",label:"Em Andamento",count:t.filter(f=>f.status==="Em Andamento").length},{id:"pending",label:"Pendentes",count:t.filter(f=>f.status==="Pendente").length},{id:"completed",label:"Concluídas",count:t.filter(f=>f.status==="Concluída").length}],activeTab:i,onChange:n}),a.length===0?jsxRuntimeExports.jsxs(Card,{className:"p-8 text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-zinc-500 mb-4",children:i==="all"?"Nenhum evento de calibração cadastrado.":`Nenhum evento com status "${i==="active"?"Em Andamento":i==="pending"?"Pendente":"Concluída"}".`}),i==="all"&&jsxRuntimeExports.jsx(Button,{variant:"primary",size:"sm",icon:Plus,onClick:()=>r(!0),children:"Criar Primeira Avaliação"})]}):jsxRuntimeExports.jsx("div",{className:"grid gap-3",children:a.map(f=>{const u=d(f.status);return jsxRuntimeExports.jsx(Card,{className:"hover:ring-1 hover:ring-blue-500/50 cursor-pointer transition",noPadding:!0,children:jsxRuntimeExports.jsx("div",{className:"p-4",onClick:()=>e(f),children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4",children:[jsxRuntimeExports.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${l(f.status)}`,children:jsxRuntimeExports.jsx(u,{className:`w-6 h-6 ${c(f.status)}`})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-white",children:f.id}),jsxRuntimeExports.jsx(Badge,{variant:f.status==="Concluída"?"success":f.status==="Em Andamento"?"info":"warning",children:f.status}),jsxRuntimeExports.jsx(Badge,{variant:"purple",children:f.type}),f.result&&jsxRuntimeExports.jsx(Badge,{variant:f.result==="Aprovado"?"success":"error",children:f.result})]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-zinc-400 mt-1",children:[jsxRuntimeExports.jsx("span",{className:"text-blue-400",children:f.meterTag})," -"," ",f.meterName," | Início: ",f.startDate," | Resp:"," ",f.responsible]}),jsxRuntimeExports.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 max-w-xs",children:jsxRuntimeExports.jsx(ProgressBar,{value:f.progress,color:f.status==="Concluída"?"emerald":"blue",showLabel:!1,size:"sm"})}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-zinc-400",children:["Etapa ",f.currentStep,"/7"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:h=>o(h,f.id),className:"p-2 hover:bg-zinc-700 rounded-lg transition-colors",title:"Remover evento",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4 text-zinc-400 hover:text-red-400"})}),jsxRuntimeExports.jsx(ChevronRight,{className:"w-5 h-5 text-zinc-500"})]})]})})},f.id)})})]})}function Step01Registro({event:e}){const{calibrationFormData:t,updateCalibrationFormData:r,user:s}=useAppStore(),i=(a,o)=>{r({[a]:o})},n=t||{eventId:e.id,status:e.status,resultado:"",operador:"Equinor Brasil Energia Ltda.",serviceOrder:"-",responsavelCalibracao:e.responsible||s.name,preenchidoPor:s.name,dataEmissao:new Date().toISOString().split("T")[0],unidade:"FPSO Bacalhau",baciaCampo:"Santos / Bacalhau",localizacao:`MEDIDOR SUBSEA - Poço ${e.meterName}`,referenciaMet:"Separador de Teste - TAG: 20VA121",tagMPFM:e.meterTag,serialNumber:"",fabricante:"TechnipFMC",modelo:"MPM High-Performance Flowmeter",tamanho:'5"',razaoBeta:"B = 0.7 MPM",modoMedicao:"Dual Mode",sistema:e.meterName,versaoSoftwareMedidor:"",versaoFPM207:"",versaoFCS320:"",versaoPVTsim:"",naturezaAtividade:`${e.type} - ${e.meterName} - ${e.meterTag}`,idEventoDesvio:"-",inicioEstabilizacao:"",inicioTotalizacao:"",fimTotalizacao:"",duracaoEfetiva:24,observacoesIniciais:"",comentariosGerais:""};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Clipboard,title:"Identificação do Responsável e Autoridade",color:"blue"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"ID do Evento/Relatório",value:n.eventId,readOnly:!0}),jsxRuntimeExports.jsx(Select,{label:"Status",value:n.status,onChange:a=>i("status",a.target.value),options:[{value:"Em Andamento",label:"Em Andamento"},{value:"Aguardando PVT",label:"Aguardando PVT"},{value:"Em Totalização",label:"Em Totalização"},{value:"Concluída",label:"Concluída"}]}),jsxRuntimeExports.jsx(Input,{label:"Operador",value:n.operador,onChange:a=>i("operador",a.target.value)}),jsxRuntimeExports.jsx(Select,{label:"Resultado",value:n.resultado,onChange:a=>i("resultado",a.target.value),options:[{value:"",label:"Pendente"},{value:"Aprovado",label:"Aprovado"},{value:"Reprovado",label:"Reprovado"}]}),jsxRuntimeExports.jsx(Input,{label:"Ordem de Serviço (S.O.)",value:n.serviceOrder,onChange:a=>i("serviceOrder",a.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Responsável Calibração",value:n.responsavelCalibracao,onChange:a=>i("responsavelCalibracao",a.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Preenchido por",value:n.preenchidoPor,onChange:a=>i("preenchidoPor",a.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Data de Emissão",type:"date",value:n.dataEmissao,onChange:a=>i("dataEmissao",a.target.value)})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Database,title:"Dados da Instalação",color:"purple"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"Unidade / FPSO",value:n.unidade,onChange:a=>i("unidade",a.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Bacia / Campo",value:n.baciaCampo,onChange:a=>i("baciaCampo",a.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Localização na Planta",value:n.localizacao,onChange:a=>i("localizacao",a.target.value),className:"col-span-2"}),jsxRuntimeExports.jsx(Input,{label:"Referência Metrológica (Autorizada)",value:n.referenciaMet,onChange:a=>i("referenciaMet",a.target.value),className:"col-span-2"})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Gauge,title:"Identificação do Instrumento (MPFM)",color:"amber"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"TAG do MPFM",value:n.tagMPFM,readOnly:!0}),jsxRuntimeExports.jsx(Input,{label:"Número de Série (S/N)",value:n.serialNumber,onChange:a=>i("serialNumber",a.target.value),placeholder:"Ex: 14-100269"}),jsxRuntimeExports.jsx(Input,{label:"Fabricante",value:n.fabricante,onChange:a=>i("fabricante",a.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Modelo",value:n.modelo,onChange:a=>i("modelo",a.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Tamanho",value:n.tamanho,onChange:a=>i("tamanho",a.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Razão Beta",value:n.razaoBeta,onChange:a=>i("razaoBeta",a.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Modo de Medição Ativo",value:n.modoMedicao,onChange:a=>i("modoMedicao",a.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Sistema",value:n.sistema,readOnly:!0})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Settings,title:"Configuração de Software e Integridade",color:"emerald"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"Versão de Software (Medidor)",value:n.versaoSoftwareMedidor,onChange:a=>i("versaoSoftwareMedidor",a.target.value),placeholder:"Ex: FW-MPM-BAC-v1.12.3"}),jsxRuntimeExports.jsx(Input,{label:"Versão do Computador de Vazão FPM207",value:n.versaoFPM207,onChange:a=>i("versaoFPM207",a.target.value),placeholder:"Ex: v2.8.5"}),jsxRuntimeExports.jsx(Input,{label:"Versão do Software FCS320",value:n.versaoFCS320,onChange:a=>i("versaoFCS320",a.target.value),placeholder:"Ex: v8.4.1 Build 710"}),jsxRuntimeExports.jsx(Input,{label:"Software de Simulação (Calsep PVTsim)",value:n.versaoPVTsim,onChange:a=>i("versaoPVTsim",a.target.value),placeholder:"Ex: v23.1.0"})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Calendar,title:"Escopo e Período do Teste de Calibração",color:"red"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"Natureza da Atividade",value:n.naturezaAtividade,className:"col-span-2",readOnly:!0}),jsxRuntimeExports.jsx(Input,{label:"ID do Evento de Desvio (se aplicável)",value:n.idEventoDesvio,onChange:a=>i("idEventoDesvio",a.target.value)}),jsxRuntimeExports.jsx("div",{}),jsxRuntimeExports.jsx(Input,{label:"Início da Estabilização",type:"datetime-local",value:n.inicioEstabilizacao,onChange:a=>i("inicioEstabilizacao",a.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Início da Totalização (24h)",type:"datetime-local",value:n.inicioTotalizacao,onChange:a=>i("inicioTotalizacao",a.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Fim da Totalização",type:"datetime-local",value:n.fimTotalizacao,onChange:a=>i("fimTotalizacao",a.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Duração Total Efetiva (h)",value:String(n.duracaoEfetiva),unit:"h",readOnly:!0}),jsxRuntimeExports.jsx(Input,{label:"Observações Iniciais",className:"col-span-2",value:n.observacoesIniciais,onChange:a=>i("observacoesIniciais",a.target.value),placeholder:"Observações..."})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:FileText,title:"Comentários Gerais"}),jsxRuntimeExports.jsx("textarea",{className:"w-full h-24 px-3 py-2 bg-zinc-800 border border-zinc-700 rounded-lg text-sm text-white placeholder-zinc-500 focus:outline-none focus:border-blue-500",placeholder:"Observações adicionais sobre o evento de calibração...",value:n.comentariosGerais,onChange:a=>i("comentariosGerais",a.target.value)})]})]})}const defaultComposition=[{component:"N₂",molecularWeight:28.01,molPercent:0,normalizedMolPercent:0},{component:"CO₂",molecularWeight:44.01,molPercent:0,normalizedMolPercent:0},{component:"H₂S",molecularWeight:34.08,molPercent:0,normalizedMolPercent:0},{component:"C₁",molecularWeight:16.04,molPercent:0,normalizedMolPercent:0},{component:"C₂",molecularWeight:30.07,molPercent:0,normalizedMolPercent:0},{component:"C₃",molecularWeight:44.1,molPercent:0,normalizedMolPercent:0},{component:"i-C₄",molecularWeight:58.12,molPercent:0,normalizedMolPercent:0},{component:"n-C₄",molecularWeight:58.12,molPercent:0,normalizedMolPercent:0},{component:"i-C₅",molecularWeight:72.15,molPercent:0,normalizedMolPercent:0},{component:"n-C₅",molecularWeight:72.15,molPercent:0,normalizedMolPercent:0},{component:"C₆",molecularWeight:86.18,molPercent:0,normalizedMolPercent:0},{component:"C₇+",molecularWeight:97.37,molPercent:0,normalizedMolPercent:0}];function Step02PVT(){const{calibrationFormData:e,updateCalibrationFormData:t}=useAppStore(),[r,s]=reactExports.useState((e==null?void 0:e.composicao)||defaultComposition),i=e||{pvtReportId:"",dataAmostragem:"",pontoAmostragem:"Separador",softwareModelagem:"PVTsim",versaoModelo:"",statusAprovacao:"Pendente",dataAprovacao:"",comentariosPVT:"",densidadeOleo:0,densidadeGas:0,densidadeAgua:0,gor:0,bsw:0,fatorEncolhimento:0,penelouxGas:1,penelouxOil:1,pvtLoadedFCS320:!1,pvtLoadedFPM207:!1,gammaRestarted:!1,pressureVerified:!1,temperatureVerified:!1},n=(f,u)=>{t({[f]:u})},a=(f,u)=>{const h=[...r];h[f]={...h[f],molPercent:u},s(h)},o=()=>{t({pvtReportId:`Calibration #${realCalibrationPVT.calibrationNo}`,dataAmostragem:realCalibrationPVT.startDate,pontoAmostragem:"Separador de Teste",softwareModelagem:"PVTsim",versaoModelo:"v23.1.0",statusAprovacao:"Aprovado",dataAprovacao:realCalibrationPVT.endDate,comentariosPVT:`Dados reais do FPSO Bacalhau - ${realCalibrationPVT.meterName}`,densidadeOleo:realCalibrationPVT.densities.oil.mpfm,densidadeGas:realCalibrationPVT.densities.gas.mpfm,densidadeAgua:realCalibrationPVT.densities.water.mpfm,gor:350,bsw:.02,fatorEncolhimento:.85,penelouxGas:realCalibrationPVT.peneloux.gas,penelouxOil:realCalibrationPVT.peneloux.oil,pvtLoadedFCS320:!0,pvtLoadedFPM207:!0,gammaRestarted:!0,pressureVerified:!0,temperatureVerified:!0});const f=realCalibrationPVT.composition.map(u=>({component:u.component,molecularWeight:u.molecularWeight,molPercent:u.molPercent,normalizedMolPercent:u.molPercent}));s(f),t({composicao:f})};reactExports.useEffect(()=>{const f=setTimeout(()=>{t({composicao:r})},500);return()=>clearTimeout(f)},[r,t]);const d=r.reduce((f,u)=>f+u.molPercent,0),l=d>0?r.reduce((f,u)=>f+u.molPercent*u.molecularWeight,0)/d:0,c=[{key:"pvtLoadedFCS320",label:"PVT carregada no FCS320"},{key:"pvtLoadedFPM207",label:"PVT carregada no FPM207"},{key:"gammaRestarted",label:"Gamma reiniciado"},{key:"pressureVerified",label:"Pressão verificada"},{key:"temperatureVerified",label:"Temperatura verificada"}];return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:FlaskConical,title:"Identificação do Relatório PVT / Amostragem",color:"purple"}),jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",onClick:o,className:"flex items-center gap-2 text-purple-400 border-purple-500/30 hover:bg-purple-500/10",children:[jsxRuntimeExports.jsx(Sparkles,{size:14}),"Carregar Dados Reais (Cal. #211)"]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"ID do Relatório Laboratorial",value:i.pvtReportId,onChange:f=>n("pvtReportId",f.target.value),className:"col-span-2",placeholder:"Ex: SLB - P.1077663_2025BRRD-P004039"}),jsxRuntimeExports.jsx(Input,{label:"Data da Amostragem",type:"date",value:i.dataAmostragem,onChange:f=>n("dataAmostragem",f.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Ponto de Amostragem",value:i.pontoAmostragem,onChange:f=>n("pontoAmostragem",f.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Software de Modelagem",value:i.softwareModelagem,onChange:f=>n("softwareModelagem",f.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Versão/Arquivo do Modelo",value:i.versaoModelo,onChange:f=>n("versaoModelo",f.target.value),placeholder:"Ex: v23.1.0"}),jsxRuntimeExports.jsx(Select,{label:"Status de Aprovação (PVT GROUP)",value:i.statusAprovacao,onChange:f=>n("statusAprovacao",f.target.value),options:[{value:"Pendente",label:"Pendente"},{value:"Em Análise",label:"Em Análise"},{value:"Aprovado",label:"Aprovado"},{value:"Reprovado",label:"Reprovado"}]}),jsxRuntimeExports.jsx(Input,{label:"Data de Aprovação",type:"date",value:i.dataAprovacao,onChange:f=>n("dataAprovacao",f.target.value)})]}),jsxRuntimeExports.jsx("div",{className:"mt-3",children:jsxRuntimeExports.jsx(Input,{label:"Comentários",value:i.comentariosPVT,onChange:f=>n("comentariosPVT",f.target.value),placeholder:"Observações sobre o relatório PVT..."})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Beaker,title:"Propriedades de Referência (@std)",color:"blue"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"Densidade Óleo",type:"number",value:i.densidadeOleo||"",onChange:f=>n("densidadeOleo",parseFloat(f.target.value)||0),unit:"kg/m³",placeholder:"773.41"}),jsxRuntimeExports.jsx(Input,{label:"Densidade Gás",type:"number",value:i.densidadeGas||"",onChange:f=>n("densidadeGas",parseFloat(f.target.value)||0),unit:"kg/m³",placeholder:"0.87"}),jsxRuntimeExports.jsx(Input,{label:"Densidade Água",type:"number",value:i.densidadeAgua||"",onChange:f=>n("densidadeAgua",parseFloat(f.target.value)||0),unit:"kg/m³",placeholder:"1.25"}),jsxRuntimeExports.jsx(Input,{label:"GOR",type:"number",value:i.gor||"",onChange:f=>n("gor",parseFloat(f.target.value)||0),unit:"Sm³/Sm³",placeholder:"216.81"}),jsxRuntimeExports.jsx(Input,{label:"BSW",type:"number",value:i.bsw||"",onChange:f=>n("bsw",parseFloat(f.target.value)||0),unit:"%",placeholder:"5.5"})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Database,title:"Composição molar (mol%)",color:"amber"}),jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Componente"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"Massa Molar"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"mol% (entrada)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"mol% (normalizado)"})]})}),jsxRuntimeExports.jsx("tbody",{children:r.map((f,u)=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50",children:[jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-zinc-200",children:f.component}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-right text-zinc-400",children:f.molecularWeight.toFixed(2)}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-right",children:jsxRuntimeExports.jsx("input",{type:"number",step:"0.001",value:f.molPercent||"",onChange:h=>a(u,parseFloat(h.target.value)||0),className:"w-20 px-2 py-1 bg-zinc-800 border border-zinc-700 rounded text-xs text-blue-400 text-right",placeholder:"0.000",title:`mol% de ${f.component}`})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-right text-emerald-400",children:d>0?(f.molPercent/d*100).toFixed(3):"0.000"})]},f.component))}),jsxRuntimeExports.jsxs("tfoot",{className:"bg-zinc-800/50",children:[jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-zinc-200 font-medium",children:"Soma mol%"}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2"}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-right text-blue-400 font-medium",children:d.toFixed(3)}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-right text-emerald-400 font-medium",children:"100.000"})]}),jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-zinc-200 font-medium",children:"MW mistura"}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2"}),jsxRuntimeExports.jsxs("td",{className:"py-2 px-2 text-right text-amber-400 font-medium",colSpan:2,children:[l.toFixed(2)," kg/kmol"]})]})]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Layers,title:"Fatores Peneloux",color:"emerald"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[jsxRuntimeExports.jsx(Input,{label:"Peneloux Gas",type:"number",step:"0.001",value:i.penelouxGas||"",onChange:f=>n("penelouxGas",parseFloat(f.target.value)||1),inputSize:"sm"}),jsxRuntimeExports.jsx(Input,{label:"Peneloux Oil",type:"number",step:"0.001",value:i.penelouxOil||"",onChange:f=>n("penelouxOil",parseFloat(f.target.value)||1),inputSize:"sm"})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:CheckCircle,title:"Controle de Aplicação PVT",color:"emerald"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mb-3",children:"Clique para alternar"}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:c.map(f=>{const u=i[f.key];return jsxRuntimeExports.jsxs("button",{type:"button",onClick:()=>n(f.key,!u),className:"w-full flex items-center justify-between p-2 bg-zinc-800/50 rounded hover:bg-zinc-700/50 transition-colors",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-zinc-300",children:f.label}),jsxRuntimeExports.jsx(Badge,{variant:u?"OK":"Pendente",size:"sm",children:u?"OK":"Pendente"})]},f.key)})})]})]})]})}const generateRowId=()=>`tot-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;function Step03Totalizadores(){const{calibrationFormData:e,updateCalibrationFormData:t}=useAppStore(),[r,s]=reactExports.useState((e==null?void 0:e.totalizadores)||[]),i=(p,x)=>{if(!p||!x)return 0;const E=new Date(p),S=new Date(x);return Math.max(0,(S.getTime()-E.getTime())/(1e3*60*60))},n=(p,x)=>p+x,a=reactExports.useCallback(()=>{const p={id:generateRowId(),startTime:"",endTime:"",deltaHours:0,mpfmOil:0,mpfmGas:0,mpfmWater:0,mpfmHC:0,mpfmTotal:0,refOilVolume:0,refOilDensity:0,refOilMassCalc:0,refOilMassPI:0,refGas:0,refWater:0,refHC:0,status:"Pendente"},x=[...r,p];s(x),t({totalizadores:x})},[r,t]),o=reactExports.useCallback(p=>{const x=r.filter(E=>E.id!==p);s(x),t({totalizadores:x})},[r,t]),d=reactExports.useCallback((p,x,E)=>{const S=r.map(P=>{if(P.id!==p)return P;const F={...P,[x]:E};if((x==="startTime"||x==="endTime")&&(F.deltaHours=i(x==="startTime"?String(E):P.startTime,x==="endTime"?String(E):P.endTime)),x==="mpfmOil"||x==="mpfmGas"){const A=x==="mpfmOil"?Number(E):P.mpfmOil,C=x==="mpfmGas"?Number(E):P.mpfmGas;F.mpfmHC=n(A,C)}if(x==="refOilMassCalc"||x==="refGas"){const A=x==="refOilMassCalc"?Number(E):P.refOilMassCalc,C=x==="refGas"?Number(E):P.refGas;F.refHC=n(A,C)}return F.deltaHours>=24&&F.mpfmOil>0&&F.refOilMassCalc>0?F.status="OK":F.startTime&&F.endTime&&(F.status="Parcial"),F});s(S),t({totalizadores:S})},[r,t]),l=r.reduce((p,x)=>p+x.mpfmOil,0),c=r.reduce((p,x)=>p+x.mpfmGas,0),f=r.reduce((p,x)=>p+x.mpfmHC,0),u=r.reduce((p,x)=>p+x.refOilMassCalc,0),h=r.reduce((p,x)=>p+x.refGas,0),g=r.reduce((p,x)=>p+x.deltaHours,0);return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-blue-300",children:[jsxRuntimeExports.jsx(Info,{className:"w-3 h-3 inline mr-1"}),"Adicione períodos de totalização. As deltas e totais são calculados automaticamente. O período total deve ser de no mínimo 24 horas."]})}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Database,title:"Totalizadores / Horário (mínimo 24h)",color:"blue"}),jsxRuntimeExports.jsx(Button,{variant:"primary",size:"sm",icon:Plus,onClick:a,children:"Adicionar Período"})]}),r.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-8 text-zinc-500",children:[jsxRuntimeExports.jsx(Database,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),jsxRuntimeExports.jsx("p",{children:"Nenhum período de totalização adicionado."}),jsxRuntimeExports.jsx("p",{className:"text-xs mt-1",children:'Clique em "Adicionar Período" para começar.'})]}):jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-left text-zinc-400",children:"Início"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-left text-zinc-400",children:"Fim"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-center text-zinc-400",children:"Δt (h)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-right text-blue-400",children:"MPFM Óleo (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-right text-blue-400",children:"MPFM Gás (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-right text-blue-400",children:"HC (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-right text-emerald-400",children:"REF Óleo (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-right text-emerald-400",children:"REF Gás (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-center text-zinc-400",children:"Status"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 w-8"})]})}),jsxRuntimeExports.jsx("tbody",{children:r.map(p=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50",children:[jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"datetime-local",value:p.startTime,onChange:x=>d(p.id,"startTime",x.target.value),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",title:"Início do período"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"datetime-local",value:p.endTime,onChange:x=>d(p.id,"endTime",x.target.value),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",title:"Fim do período"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1 text-center text-zinc-400",children:p.deltaHours.toFixed(2)}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"number",value:p.mpfmOil||"",onChange:x=>d(p.id,"mpfmOil",parseFloat(x.target.value)||0),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-blue-400 text-right",placeholder:"0",title:"MPFM Óleo"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"number",value:p.mpfmGas||"",onChange:x=>d(p.id,"mpfmGas",parseFloat(x.target.value)||0),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-blue-400 text-right",placeholder:"0",title:"MPFM Gás"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1 text-right text-blue-400 font-medium",children:formatNumber(p.mpfmHC)}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"number",value:p.refOilMassCalc||"",onChange:x=>d(p.id,"refOilMassCalc",parseFloat(x.target.value)||0),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-emerald-400 text-right",placeholder:"0",title:"Referência Óleo"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"number",value:p.refGas||"",onChange:x=>d(p.id,"refGas",parseFloat(x.target.value)||0),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-emerald-400 text-right",placeholder:"0",title:"Referência Gás"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:p.status,size:"sm",children:p.status})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>o(p.id),className:"p-1 text-red-400 hover:text-red-300 transition-colors",title:"Remover período",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3 h-3"})})})]},p.id))})]})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Calculator,title:"Total - Somatório",color:"amber"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-6 gap-3",children:[jsxRuntimeExports.jsxs("div",{className:`p-3 rounded-lg ${g>=24?"bg-emerald-500/10 border border-emerald-500/20":"bg-zinc-800/50"}`,children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Duração Total"}),jsxRuntimeExports.jsxs("p",{className:`text-lg font-bold ${g>=24?"text-emerald-400":"text-white"}`,children:[g.toFixed(1),"h"]}),g<24&&jsxRuntimeExports.jsx("p",{className:"text-xs text-amber-400",children:"Mínimo 24h"})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/20",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"MPFM Óleo"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-blue-400",children:formatNumber(l)})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/20",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"MPFM Gás"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-blue-400",children:formatNumber(c)})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/20",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"MPFM HC"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-blue-400",children:formatNumber(f)})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-emerald-500/10 rounded-lg border border-emerald-500/20",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"REF Óleo"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-emerald-400",children:formatNumber(u)})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-emerald-500/10 rounded-lg border border-emerald-500/20",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"REF Gás"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-emerald-400",children:formatNumber(h)})]})]})]})]})}function Step04KFactors(){var c,f;const{calibrationFormData:e,updateCalibrationFormData:t}=useAppStore(),r=e||{kMin:ANP_LIMITS.K_FACTOR_MIN,kMax:ANP_LIMITS.K_FACTOR_MAX,limiteHC:ANP_LIMITS.HC_BALANCE_ERROR,limiteTotal:ANP_LIMITS.TOTAL_BALANCE_ERROR,massas:{oleo:{mpfm:0,ref:0},gas:{mpfm:0,ref:0},agua:{mpfm:0,ref:0}},totalizadores:[]},s=reactExports.useMemo(()=>{const u=r.totalizadores||[];return{mpfmOil:u.reduce((h,g)=>h+g.mpfmOil,0),mpfmGas:u.reduce((h,g)=>h+g.mpfmGas,0),refOil:u.reduce((h,g)=>h+g.refOilMassCalc,0),refGas:u.reduce((h,g)=>h+g.refGas,0)}},[r.totalizadores]),i=(u,h,g)=>u>=h&&u<=g,n=reactExports.useMemo(()=>{var p,x;const u=calculateKFactor(s.refOil,s.mpfmOil),h=calculateKFactor(s.refGas,s.mpfmGas),g=((x=(p=r.massas)==null?void 0:p.agua)==null?void 0:x.mpfm)>0?calculateKFactor(r.massas.agua.ref,r.massas.agua.mpfm):1;return{kOil:u,kGas:h,kWater:g,kOilStatus:i(u,r.kMin,r.kMax)?"Dentro":"Fora",kGasStatus:i(h,r.kMin,r.kMax)?"Dentro":"Fora",kWaterStatus:i(g,r.kMin,r.kMax)?"Dentro":"Fora"}},[s,r.kMin,r.kMax,r.massas]),a=reactExports.useMemo(()=>{var p,x,E,S,P,F,A,C;const u=(_,w)=>w===0?0:(_-w)/w*100,h=s.mpfmOil+s.mpfmGas,g=s.refOil+s.refGas;return[{fase:"Óleo",mpfm:s.mpfmOil,ref:s.refOil,desvio:u(s.mpfmOil,s.refOil)},{fase:"Gás",mpfm:s.mpfmGas,ref:s.refGas,desvio:u(s.mpfmGas,s.refGas)},{fase:"Água",mpfm:((x=(p=r.massas)==null?void 0:p.agua)==null?void 0:x.mpfm)||0,ref:((S=(E=r.massas)==null?void 0:E.agua)==null?void 0:S.ref)||0,desvio:u(((F=(P=r.massas)==null?void 0:P.agua)==null?void 0:F.mpfm)||0,((C=(A=r.massas)==null?void 0:A.agua)==null?void 0:C.ref)||0)},{fase:"HC (Total)",mpfm:h,ref:g,desvio:u(h,g),isTotal:!0}]},[s,r.massas]);reactExports.useEffect(()=>{var u;t({kFactors:n,massas:{oleo:{mpfm:s.mpfmOil,ref:s.refOil},gas:{mpfm:s.mpfmGas,ref:s.refGas},agua:((u=r.massas)==null?void 0:u.agua)||{mpfm:0,ref:0}}})},[n,s,t,(c=r.massas)==null?void 0:c.agua]);const o=(u,h)=>{t({[u]:h})},d=n.kOilStatus==="Dentro"&&n.kGasStatus==="Dentro",l=((f=a.find(u=>u.fase==="HC (Total)"))==null?void 0:f.desvio)||0;return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[s.mpfmOil>0&&s.refOil>0&&jsxRuntimeExports.jsx("div",{className:cn("p-4 rounded-lg flex items-center gap-3",d&&Math.abs(l)<=r.limiteHC?"bg-emerald-500/10 border border-emerald-500/20":"bg-red-500/10 border border-red-500/20"),children:d&&Math.abs(l)<=r.limiteHC?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CheckCircle,{className:"w-5 h-5 text-emerald-400"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-emerald-400",children:"K-Factors dentro do limite"}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-zinc-400",children:["Todos os fatores estão entre ",r.kMin," e ",r.kMax]})]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-5 h-5 text-red-400"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-red-400",children:"K-Factors fora do limite"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-400",children:"Um ou mais fatores estão fora do intervalo permitido"})]})]})}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Settings,title:"Parâmetros de Aceitação (ANP 44/2015)",color:"amber"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"K mínimo",type:"number",step:"0.01",value:r.kMin,onChange:u=>o("kMin",parseFloat(u.target.value)||.8)}),jsxRuntimeExports.jsx(Input,{label:"K máximo",type:"number",step:"0.01",value:r.kMax,onChange:u=>o("kMax",parseFloat(u.target.value)||1.2)}),jsxRuntimeExports.jsx(Input,{label:"Limite desvio HC (±)",type:"number",step:"0.1",value:r.limiteHC,onChange:u=>o("limiteHC",parseFloat(u.target.value)||10),unit:"%"}),jsxRuntimeExports.jsx(Input,{label:"Limite desvio Total (±)",type:"number",step:"0.1",value:r.limiteTotal,onChange:u=>o("limiteTotal",parseFloat(u.target.value)||7),unit:"%"})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Database,title:"Massas Totalizadas (24h)",color:"blue"}),s.mpfmOil===0&&s.refOil===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-6 text-zinc-500",children:[jsxRuntimeExports.jsx(Database,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"Nenhum dado de totalização"}),jsxRuntimeExports.jsx("p",{className:"text-xs",children:"Preencha os totalizadores no passo anterior"})]}):jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Fase"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-blue-400",children:"MPFM (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-emerald-400",children:"Ref (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"Desvio"})]})}),jsxRuntimeExports.jsx("tbody",{children:a.map(u=>jsxRuntimeExports.jsxs("tr",{className:cn("border-b border-zinc-800/50",u.isTotal&&"bg-zinc-800/30 font-medium"),children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-zinc-200",children:u.fase}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-right text-blue-400",children:u.mpfm.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-right text-emerald-400",children:u.ref.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsxs("td",{className:cn("py-2 px-2 text-right",u.isTotal?Math.abs(u.desvio)>r.limiteHC?"text-red-400":"text-emerald-400":Math.abs(u.desvio)>20?"text-red-400":"text-zinc-300"),children:[u.desvio.toFixed(1),"%"]})]},u.fase))})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Calculator,title:"K-Factors Calculados",color:"purple"}),s.mpfmOil===0&&s.refOil===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-6 text-zinc-500",children:[jsxRuntimeExports.jsx(Calculator,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"K-Factors serão calculados"}),jsxRuntimeExports.jsx("p",{className:"text-xs",children:"após preenchimento dos totalizadores"})]}):jsxRuntimeExports.jsx("div",{className:"space-y-3",children:[{fase:"K-Oil (Óleo)",k:n.kOil,status:n.kOilStatus},{fase:"K-Gas (Gás)",k:n.kGas,status:n.kGasStatus},{fase:"K-Water (Água)",k:n.kWater,status:n.kWaterStatus}].map(u=>jsxRuntimeExports.jsxs("div",{className:cn("p-3 rounded-lg flex items-center justify-between",u.status==="Fora"?"bg-red-500/10 border border-red-500/20":"bg-emerald-500/10 border border-emerald-500/20"),children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-zinc-400",children:u.fase}),jsxRuntimeExports.jsx("p",{className:cn("text-xl font-bold font-mono",u.status==="Fora"?"text-red-400":"text-emerald-400"),children:u.k.toFixed(4)})]}),jsxRuntimeExports.jsx(Badge,{variant:u.status==="Dentro"?"OK":"Fora",children:u.status==="Dentro"?`${r.kMin} - ${r.kMax}`:"Fora"})]},u.fase))}),jsxRuntimeExports.jsxs("div",{className:"mt-4 p-3 bg-zinc-800/50 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mb-2",children:"Fórmula ANP 44/2015:"}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-zinc-400 font-mono",children:["K = Massa",jsxRuntimeExports.jsx("sub",{children:"REF"})," / Massa",jsxRuntimeExports.jsx("sub",{children:"MPFM"})]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-zinc-500 mt-2",children:["Intervalo válido: ",r.kMin," ≤ K ≤ ",r.kMax]})]})]})]})]})}const defaultEnvelope=[{id:"gvf",item:"GVF (%)",value:0,limit:95,status:"Pendente"},{id:"pressure",item:"Pressão (bar)",value:0,limit:500,status:"Pendente"},{id:"temperature",item:"Temperatura (°C)",value:0,limit:150,status:"Pendente"},{id:"flow",item:"Vazão (m³/h)",value:0,limit:1e3,status:"Pendente"},{id:"bsw",item:"BSW (%)",value:0,limit:50,status:"Pendente"}];function Step05Balanco(){const{calibrationFormData:e,updateCalibrationFormData:t}=useAppStore(),r=e||{balancoTopOil:0,balancoTopGas:0,balancoGasLift:0,balancoDesvio:0},[s,i]=reactExports.useState(defaultEnvelope),n=reactExports.useMemo(()=>{const l=r.totalizadores||[],c=l.reduce((p,x)=>p+(x.mpfmOil||0),0),f=l.reduce((p,x)=>p+(x.mpfmGas||0),0),u=c+f,h=r.balancoTopOil+r.balancoTopGas-r.balancoGasLift,g=u>0?(h-u)/u*100:0;return{subseaTotal:u,topsideTotal:h,desvio:g,status:Math.abs(g)<=10?"Dentro":"Fora"}},[r]),a=(l,c)=>{t({[l]:c,balancoDesvio:n.desvio})},o=(l,c,f)=>{i(u=>u.map(h=>{if(h.id!==l)return h;const g={...h,[c]:f};return g.value>0&&g.limit>0&&(g.status=g.value<=g.limit?"OK":"Fora"),g}))},d=s.every(l=>l.status==="OK"||l.status==="Pendente");return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Target,title:"Balanço HC Subsea vs Topside (com desconto de Gás Lift)",color:"blue"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[jsxRuntimeExports.jsx(Input,{label:"MPFM Topside – Óleo (kg)",type:"number",value:r.balancoTopOil||"",onChange:l=>a("balancoTopOil",parseFloat(l.target.value)||0),placeholder:"0"}),jsxRuntimeExports.jsx(Input,{label:"MPFM Topside – Gás (kg)",type:"number",value:r.balancoTopGas||"",onChange:l=>a("balancoTopGas",parseFloat(l.target.value)||0),placeholder:"0"}),jsxRuntimeExports.jsx(Input,{label:"Gás Lift – Gás (kg)",type:"number",value:r.balancoGasLift||"",onChange:l=>a("balancoGasLift",parseFloat(l.target.value)||0),placeholder:"0"}),jsxRuntimeExports.jsx(Input,{label:"Desvio (%)",value:n.desvio.toFixed(2),readOnly:!0,className:cn(Math.abs(n.desvio)>10&&"text-red-400")})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/20 text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"MPFM Subsea (Total)"}),jsxRuntimeExports.jsxs("p",{className:"text-lg font-bold text-blue-400",children:[n.subseaTotal.toLocaleString("pt-BR",{maximumFractionDigits:0})," kg"]})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-emerald-500/10 rounded-lg border border-emerald-500/20 text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Topside (Corrigido)"}),jsxRuntimeExports.jsxs("p",{className:"text-lg font-bold text-emerald-400",children:[n.topsideTotal.toLocaleString("pt-BR",{maximumFractionDigits:0})," kg"]})]}),jsxRuntimeExports.jsxs("div",{className:cn("p-3 rounded-lg text-center",n.status==="Dentro"?"bg-emerald-500/10 border border-emerald-500/20":"bg-red-500/10 border border-red-500/20"),children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Desvio"}),jsxRuntimeExports.jsxs("p",{className:cn("text-lg font-bold",n.status==="Dentro"?"text-emerald-400":"text-red-400"),children:[n.desvio.toFixed(1),"%"]})]})]}),jsxRuntimeExports.jsx("div",{className:cn("p-3 rounded-lg flex items-center gap-2",n.status==="Dentro"?"bg-emerald-500/10 border border-emerald-500/20":"bg-red-500/10 border border-red-500/20"),children:n.status==="Dentro"?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CheckCircle,{className:"w-4 h-4 text-emerald-400"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-emerald-300",children:"Status (±10%): Dentro do limite"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-4 h-4 text-red-400"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-red-300",children:"Status (±10%): Fora do limite - verificar dados"})]})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:CheckCircle,title:"Checagens de Envelope / Integridade",color:"emerald"}),jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-left text-zinc-400",children:"Item"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-zinc-400",children:"Valor Medido"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-zinc-400",children:"Limite Máx."}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Status"})]})}),jsxRuntimeExports.jsx("tbody",{children:s.map(l=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50",children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-zinc-200",children:l.item}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3",children:jsxRuntimeExports.jsx("input",{type:"number",value:l.value||"",onChange:c=>o(l.id,"value",parseFloat(c.target.value)||0),className:"w-full px-2 py-1 bg-zinc-800 border border-zinc-700 rounded text-xs text-white text-right",placeholder:"0",title:`Valor de ${l.item}`})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3",children:jsxRuntimeExports.jsx("input",{type:"number",value:l.limit||"",onChange:c=>o(l.id,"limit",parseFloat(c.target.value)||0),className:"w-full px-2 py-1 bg-zinc-800 border border-zinc-700 rounded text-xs text-white text-right",placeholder:"0",title:`Limite de ${l.item}`})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:l.status,size:"sm",children:l.status})})]},l.id))})]})}),!d&&jsxRuntimeExports.jsx("div",{className:"mt-3 p-3 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-amber-300",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-3 h-3 inline mr-1"}),"Alguns itens estão fora do envelope operacional. Verifique os valores."]})})]})]})}const generateId$1=()=>`mon-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,migrateRows=e=>!e||!Array.isArray(e)?[]:e.map(t=>({id:t.id||generateId$1(),data:t.data||"",duracao:t.duracao||0,mpfmOil:t.mpfmOil||0,mpfmGas:t.mpfmGas||0,mpfmTotal:t.mpfmTotal||0,refTotal:t.refTotal||0,desvio:t.desvio||0,alarmes:t.alarmes||""}));function Step06Monitoramento(){const{calibrationFormData:e,updateCalibrationFormData:t}=useAppStore(),[r,s]=reactExports.useState(()=>migrateRows((e==null?void 0:e.monitoramentoPosData)||[])),i=reactExports.useCallback(()=>{const d={id:generateId$1(),data:new Date().toISOString().split("T")[0],duracao:24,mpfmOil:0,mpfmGas:0,mpfmTotal:0,refTotal:0,desvio:0,alarmes:""},l=[...r,d];s(l),t({monitoramentoPosData:l})},[r,t]),n=reactExports.useCallback(d=>{const l=r.filter(c=>c.id!==d);s(l),t({monitoramentoPosData:l})},[r,t]),a=reactExports.useCallback((d,l,c)=>{const f=r.map(u=>{if(u.id!==d)return u;const h={...u,[l]:c};if(l==="mpfmOil"||l==="mpfmGas"){const g=l==="mpfmOil"?Number(c):u.mpfmOil,p=l==="mpfmGas"?Number(c):u.mpfmGas;h.mpfmTotal=g+p,h.refTotal>0&&(h.desvio=(h.mpfmTotal-h.refTotal)/h.refTotal*100)}return l==="refTotal"&&h.mpfmTotal>0&&(h.desvio=(h.mpfmTotal-Number(c))/Number(c)*100),h});s(f),t({monitoramentoPosData:f})},[r,t]),o=d=>{const l=Math.abs(d);return l<=7?"OK":l<=10?"Alerta":"Crítico"};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-purple-500/10 border border-purple-500/20 rounded-lg",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-purple-300",children:[jsxRuntimeExports.jsx(Info,{className:"w-3 h-3 inline mr-1"}),"Registre por período as massas totalizadas e o efeito dos novos K-factors. Este monitoramento serve como evidência pós-calibração."]})}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Eye,title:"Monitoramento Pós-Aplicação de Novos Fatores",color:"purple"}),jsxRuntimeExports.jsx(Button,{variant:"primary",size:"sm",icon:Plus,onClick:i,children:"Adicionar Período"})]}),r.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-8 text-zinc-500",children:[jsxRuntimeExports.jsx(Eye,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),jsxRuntimeExports.jsx("p",{children:"Nenhum período de monitoramento registrado."}),jsxRuntimeExports.jsx("p",{className:"text-xs mt-1",children:"Adicione períodos para acompanhar o desempenho pós-calibração."})]}):jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Data"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-center text-zinc-400",children:"Duração (h)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"MPFM Óleo"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"MPFM Gás"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-blue-400",children:"MPFM Total"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-emerald-400",children:"REF Total"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-center text-zinc-400",children:"Desvio"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Alarmes"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 w-8"})]})}),jsxRuntimeExports.jsx("tbody",{children:r.map(d=>{const l=o(d.desvio);return jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50",children:[jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"date",value:d.data,onChange:c=>a(d.id,"data",c.target.value),className:"px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",title:"Data do período"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"number",value:d.duracao||"",onChange:c=>a(d.id,"duracao",parseFloat(c.target.value)||0),className:"w-14 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white text-center",placeholder:"24",title:"Duração em horas"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"number",value:d.mpfmOil||"",onChange:c=>a(d.id,"mpfmOil",parseFloat(c.target.value)||0),className:"w-20 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white text-right",placeholder:"0",title:"MPFM Óleo"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"number",value:d.mpfmGas||"",onChange:c=>a(d.id,"mpfmGas",parseFloat(c.target.value)||0),className:"w-20 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white text-right",placeholder:"0",title:"MPFM Gás"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-right text-blue-400 font-medium",children:d.mpfmTotal.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"number",value:d.refTotal||"",onChange:c=>a(d.id,"refTotal",parseFloat(c.target.value)||0),className:"w-20 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-emerald-400 text-right",placeholder:"0",title:"Referência Total"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-center",children:jsxRuntimeExports.jsxs(Badge,{variant:l==="OK"?"OK":l==="Alerta"?"Alerta":"Crítico",size:"sm",children:[d.desvio.toFixed(1),"%"]})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{value:d.alarmes,onChange:c=>a(d.id,"alarmes",c.target.value),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",placeholder:"Nenhum",title:"Alarmes observados"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>n(d.id),className:"p-1 text-red-400 hover:text-red-300 transition-colors",title:"Remover período",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3 h-3"})})})]},d.id)})})]})}),r.length>0&&jsxRuntimeExports.jsx("div",{className:"mt-4 p-3 bg-zinc-800/50 rounded-lg",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400",children:["Total de períodos: ",r.length]}),jsxRuntimeExports.jsxs("span",{className:cn(r.filter(d=>o(d.desvio)==="OK").length===r.length?"text-emerald-400":"text-amber-400"),children:["Períodos OK: ",r.filter(d=>o(d.desvio)==="OK").length," / ",r.length]})]})})]})]})}const generateId=()=>`alm-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,migrateAlarmRows=e=>!e||!Array.isArray(e)?[]:e.map(t=>({id:t.id||generateId(),dataHora:t.dataHora||"",tag:t.tag||"",codigo:t.codigo||"",descricao:t.descricao||"",gravidade:t.gravidade||"Info",acaoTomada:t.acaoTomada||""}));function Step07Alarmes(){const{calibrationFormData:e,updateCalibrationFormData:t,selectedEvent:r}=useAppStore(),[s,i]=reactExports.useState(()=>migrateAlarmRows((e==null?void 0:e.alarmes)||[])),n=reactExports.useCallback(()=>{const f={id:generateId(),dataHora:new Date().toISOString().slice(0,16),tag:(r==null?void 0:r.meterTag)||"",codigo:"",descricao:"",gravidade:"Info",acaoTomada:""},u=[...s,f];i(u),t({alarmes:u})},[s,t,r]),a=reactExports.useCallback(f=>{const u=s.filter(h=>h.id!==f);i(u),t({alarmes:u})},[s,t]),o=reactExports.useCallback((f,u,h)=>{const g=s.map(p=>p.id===f?{...p,[u]:h}:p);i(g),t({alarmes:g})},[s,t]),d=f=>{switch(f){case"Critical":return"bg-red-500/10 border-red-500/20";case"Warning":return"bg-amber-500/10 border-amber-500/20";default:return"bg-blue-500/10 border-blue-500/20"}},l=s.filter(f=>f.gravidade==="Critical").length,c=s.filter(f=>f.gravidade==="Warning").length;return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-red-300",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-3 h-3 inline mr-1"}),"Use este log para rastreabilidade: alarmes críticos devem estar inativos no início do teste e investigados quando ocorrerem."]})}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[jsxRuntimeExports.jsxs("div",{className:cn("p-3 rounded-lg border text-center",s.length===0?"bg-emerald-500/10 border-emerald-500/20":"bg-zinc-800/50 border-zinc-700"),children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Total de Alarmes"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-white",children:s.length})]}),jsxRuntimeExports.jsxs("div",{className:cn("p-3 rounded-lg border text-center",l>0?"bg-red-500/10 border-red-500/20":"bg-emerald-500/10 border-emerald-500/20"),children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Críticos"}),jsxRuntimeExports.jsx("p",{className:cn("text-2xl font-bold",l>0?"text-red-400":"text-emerald-400"),children:l})]}),jsxRuntimeExports.jsxs("div",{className:cn("p-3 rounded-lg border text-center",c>0?"bg-amber-500/10 border-amber-500/20":"bg-emerald-500/10 border-emerald-500/20"),children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Warnings"}),jsxRuntimeExports.jsx("p",{className:cn("text-2xl font-bold",c>0?"text-amber-400":"text-emerald-400"),children:c})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Bell,title:"Registro de Alarmes / Eventos (HMI/MPM/FCS320)",color:"red"}),jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:Plus,onClick:n,children:"Adicionar Alarme"})]}),s.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-8 text-zinc-500",children:[jsxRuntimeExports.jsx(CheckCircle,{className:"w-12 h-12 mx-auto mb-3 text-emerald-500 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-emerald-400",children:"Nenhum alarme registrado durante o período."}),jsxRuntimeExports.jsx("p",{className:"text-xs mt-1",children:"Isso é um bom sinal para a calibração."})]}):jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Data/Hora"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"TAG"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Código"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Descrição"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-center text-zinc-400",children:"Gravidade"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Ação Tomada"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 w-8"})]})}),jsxRuntimeExports.jsx("tbody",{children:s.map(f=>jsxRuntimeExports.jsxs("tr",{className:cn("border-b border-zinc-800/50",d(f.gravidade)),children:[jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"datetime-local",value:f.dataHora,onChange:u=>o(f.id,"dataHora",u.target.value),className:"px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",title:"Data e hora do alarme"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{value:f.tag,onChange:u=>o(f.id,"tag",u.target.value),className:"w-24 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-blue-400",placeholder:"TAG",title:"TAG do equipamento"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{value:f.codigo,onChange:u=>o(f.id,"codigo",u.target.value),className:"w-20 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",placeholder:"Código",title:"Código do alarme"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{value:f.descricao,onChange:u=>o(f.id,"descricao",u.target.value),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",placeholder:"Descrição do alarme",title:"Descrição detalhada"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-center",children:jsxRuntimeExports.jsxs("select",{value:f.gravidade,onChange:u=>o(f.id,"gravidade",u.target.value),className:"px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",title:"Gravidade do alarme",children:[jsxRuntimeExports.jsx("option",{value:"Info",children:"Info"}),jsxRuntimeExports.jsx("option",{value:"Warning",children:"Warning"}),jsxRuntimeExports.jsx("option",{value:"Critical",children:"Critical"})]})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{value:f.acaoTomada,onChange:u=>o(f.id,"acaoTomada",u.target.value),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",placeholder:"Ação tomada",title:"Ação tomada para resolver"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>a(f.id),className:"p-1 text-red-400 hover:text-red-300 transition-colors",title:"Remover alarme",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3 h-3"})})})]},f.id))})]})})]}),l>0&&jsxRuntimeExports.jsxs("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-4 h-4 text-red-400"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-red-400",children:"Atenção"})]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-red-300",children:["Há ",l," alarme(s) crítico(s) registrado(s). Certifique-se de que todos foram investigados e as ações corretivas foram tomadas antes de finalizar a calibração."]})]})]})}const STEPS=["Registro","PVT","Totalizadores","K-Fatores","Balanços","Pós-Monit.","Alarmes"];function CalibrationWorkflow({event:e,onBack:t}){const{setSelectedEvent:r,setCalibrationFormData:s,calibrationFormData:i,completeCalibrationStep:n,finalizeCalibration:a}=useAppStore(),[o,d]=reactExports.useState(e.currentStep),[l,c]=reactExports.useState(!1);reactExports.useEffect(()=>{r(e),(!i||i.eventId!==e.id)&&s({eventId:e.id,status:e.status,resultado:e.result||"",operador:"",serviceOrder:"",responsavelCalibracao:e.responsible,preenchidoPor:"",dataEmissao:new Date().toISOString().split("T")[0],unidade:"",baciaCampo:"",localizacao:"",referenciaMet:"",tagMPFM:e.meterTag,serialNumber:"",fabricante:"",modelo:"",tamanho:"",razaoBeta:"",modoMedicao:"",sistema:"",versaoSoftwareMedidor:"",versaoFPM207:"",versaoFCS320:"",versaoPVTsim:"",naturezaAtividade:e.type,idEventoDesvio:"",inicioEstabilizacao:e.startDate,inicioTotalizacao:"",fimTotalizacao:"",duracaoEfetiva:0,observacoesIniciais:"",comentariosGerais:"",pvtReportId:"",dataAmostragem:"",pontoAmostragem:"",softwareModelagem:"PVTsim",versaoModelo:"",statusAprovacao:"Pendente",dataAprovacao:"",comentariosPVT:"",densidadeOleo:0,densidadeGas:0,densidadeAgua:0,gor:0,bsw:0,fatorEncolhimento:0,composicao:[],penelouxGas:1,penelouxOil:1,pvtLoadedFCS320:!1,pvtLoadedFPM207:!1,gammaRestarted:!1,pressureVerified:!1,temperatureVerified:!1,totalizadores:[],kMin:.8,kMax:1.2,limiteHC:10,limiteTotal:7,massas:{oleo:{mpfm:0,ref:0},gas:{mpfm:0,ref:0},agua:{mpfm:0,ref:0}},kFactors:{kOil:1,kGas:1,kWater:1,kOilStatus:"Dentro",kGasStatus:"Dentro",kWaterStatus:"Dentro"},balancoTopOil:0,balancoTopGas:0,balancoGasLift:0,balancoDesvio:0,monitoramentoPosData:[],alarmes:[]})},[e,r,s,i]);const f=async()=>{c(!0),setTimeout(()=>{c(!1),alert("Dados salvos com sucesso!")},500)},u=()=>{n(e.id,o),d(Math.min(7,o+1))},h=()=>{const p=confirm(`Deseja aprovar ou reprovar a calibração?

OK = Aprovado
Cancelar = Reprovado`);a(e.id,p?"Aprovado":"Reprovado"),alert(`Calibração ${p?"aprovada":"reprovada"} com sucesso!`),t()},g=()=>{switch(o){case 1:return jsxRuntimeExports.jsx(Step01Registro,{event:e});case 2:return jsxRuntimeExports.jsx(Step02PVT,{});case 3:return jsxRuntimeExports.jsx(Step03Totalizadores,{});case 4:return jsxRuntimeExports.jsx(Step04KFactors,{});case 5:return jsxRuntimeExports.jsx(Step05Balanco,{});case 6:return jsxRuntimeExports.jsx(Step06Monitoramento,{});case 7:return jsxRuntimeExports.jsx(Step07Alarmes,{});default:return null}};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:t,icon:ChevronLeft,children:"Voltar"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-white",children:e.id}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-zinc-500",children:[e.meterTag," - ",e.meterName," | ",e.type]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Badge,{variant:"info",children:e.status}),jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:Save,onClick:f,disabled:l,children:l?"Salvando...":"Salvar"}),jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:FileText,children:"Relatório"})]})]}),jsxRuntimeExports.jsx(Card,{className:"p-3",children:jsxRuntimeExports.jsx(StepIndicator,{steps:STEPS,currentStep:o,onStepClick:d})}),g(),jsxRuntimeExports.jsxs("div",{className:"flex justify-between pt-4 border-t border-zinc-800",children:[jsxRuntimeExports.jsx(Button,{variant:"secondary",onClick:()=>d(Math.max(1,o-1)),disabled:o===1,icon:ChevronLeft,children:"Anterior"}),jsxRuntimeExports.jsx("div",{className:"flex gap-2",children:o<7?jsxRuntimeExports.jsxs(Button,{onClick:u,children:["Próximo",jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4 ml-1"})]}):jsxRuntimeExports.jsx(Button,{variant:"success",icon:Check,onClick:h,children:"Concluir Avaliação"})})]})]})}function CalibrationPage(){const[e,t]=reactExports.useState(null);return e?jsxRuntimeExports.jsx(CalibrationWorkflow,{event:e,onBack:()=>t(null)}):jsxRuntimeExports.jsx(CalibrationEventsList,{onSelectEvent:t})}const checklistData=[{id:"1",category:"RTMV",description:"Avaliação de desempenho no comissionamento",status:"compliant",dueDate:"2025-12-01",notes:"Concluído - CAL-2025-001"},{id:"2",category:"RTMV",description:"Avaliação periódica (intervalos 6-12 meses)",status:"in-progress",dueDate:"2026-06-01",notes:"Próxima avaliação agendada"},{id:"3",category:"RTMV",description:"Investigação por gatilho ANP (±10% HC ou ±7% total)",status:"pending",notes:"Aplicável quando limite excedido"},{id:"4",category:"RTMV",description:"Arquivo PVT atualizado e aprovado",status:"compliant",dueDate:"2026-01-10",notes:"PVTsim v23.1.0"},{id:"5",category:"RTMV",description:"Software do medidor atualizado",status:"compliant",notes:"FW-MPM-BAC-v1.12.3"},{id:"6",category:"RTMV",description:"Relatório de calibração arquivado",status:"compliant",notes:"3 relatórios gerados"},{id:"7",category:"RTMV",description:"K-factors dentro do range (0.8-1.2)",status:"overdue",notes:"K-Gas fora do limite - investigar"},{id:"8",category:"RTMV",description:"Monitoramento de balanço diário implementado",status:"compliant",notes:"Dashboard operacional"},{id:"9",category:"Manutenção",description:"Verificação de integridade mecânica",status:"pending",dueDate:"2026-03-15"},{id:"10",category:"Manutenção",description:"Calibração de sensores P/T",status:"in-progress",dueDate:"2026-02-01"}],categoryStats=[{name:"RTMV",total:8,compliant:5,pending:1,overdue:1,inProgress:1},{name:"Manutenção",total:2,compliant:0,pending:1,overdue:0,inProgress:1}];function ComplianceDashboard(){const e=checklistData.length,t=checklistData.filter(a=>a.status==="compliant").length,r=checklistData.filter(a=>a.status==="pending").length,s=checklistData.filter(a=>a.status==="overdue").length,i=a=>{switch(a){case"compliant":return jsxRuntimeExports.jsx(Badge,{variant:"success",children:"Conforme"});case"pending":return jsxRuntimeExports.jsx(Badge,{variant:"warning",children:"Pendente"});case"overdue":return jsxRuntimeExports.jsx(Badge,{variant:"error",children:"Atrasado"});case"in-progress":return jsxRuntimeExports.jsx(Badge,{variant:"info",children:"Em Andamento"})}},n=a=>{switch(a){case"compliant":return jsxRuntimeExports.jsx(CheckCircle2,{className:"w-4 h-4 text-emerald-400"});case"pending":return jsxRuntimeExports.jsx(Clock,{className:"w-4 h-4 text-amber-400"});case"overdue":return jsxRuntimeExports.jsx(AlertCircle,{className:"w-4 h-4 text-red-400"});case"in-progress":return jsxRuntimeExports.jsx(Clock,{className:"w-4 h-4 text-blue-400"})}};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Card,{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-zinc-700 flex items-center justify-center",children:jsxRuntimeExports.jsx(FileCheck,{className:"w-5 h-5 text-zinc-300"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Total Requisitos"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-white",children:e})]})]})}),jsxRuntimeExports.jsx(Card,{className:"p-4 bg-emerald-500/10 border-emerald-500/20",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-500/20 flex items-center justify-center",children:jsxRuntimeExports.jsx(CheckCircle2,{className:"w-5 h-5 text-emerald-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Conformes"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:t})]})]})}),jsxRuntimeExports.jsx(Card,{className:"p-4 bg-amber-500/10 border-amber-500/20",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-500/20 flex items-center justify-center",children:jsxRuntimeExports.jsx(Clock,{className:"w-5 h-5 text-amber-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Pendentes"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-amber-400",children:r})]})]})}),jsxRuntimeExports.jsx(Card,{className:"p-4 bg-red-500/10 border-red-500/20",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-500/20 flex items-center justify-center",children:jsxRuntimeExports.jsx(AlertCircle,{className:"w-5 h-5 text-red-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Atrasados"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-red-400",children:s})]})]})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:FileCheck,title:"Conformidade por Categoria",color:"blue"}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:categoryStats.map(a=>jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-zinc-300",children:a.name}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-zinc-500",children:[a.compliant,"/",a.total," conformes"]})]}),jsxRuntimeExports.jsx(ProgressBar,{value:a.compliant/a.total*100,color:a.overdue>0?"red":a.compliant===a.total?"emerald":"amber"})]},a.name))})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:CheckCircle2,title:"Checklist de Requisitos Regulatórios (RTMV)",color:"emerald"}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:checklistData.map(a=>jsxRuntimeExports.jsxs("div",{className:cn("flex items-center justify-between p-3 rounded-lg border transition cursor-pointer hover:bg-zinc-700/50",a.status==="overdue"?"bg-red-500/5 border-red-500/20":a.status==="compliant"?"bg-emerald-500/5 border-emerald-500/10":"bg-zinc-800/50 border-zinc-700"),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[n(a.status),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-zinc-200",children:a.description}),jsxRuntimeExports.jsx(Badge,{variant:"secondary",size:"sm",children:a.category})]}),a.notes&&jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mt-0.5",children:a.notes})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[a.dueDate&&jsxRuntimeExports.jsx("span",{className:"text-xs text-zinc-500",children:a.dueDate}),i(a.status),jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4 text-zinc-600"})]})]},a.id))})]})]})}function CompliancePage(){return jsxRuntimeExports.jsx(ComplianceDashboard,{})}const PRAZOS_RANP44={RELATORIO_PARCIAL_DIAS:10,RELATORIO_FINAL_TOPSIDE:30,RELATORIO_FINAL_SUBSEA:60,REPARO_TOPSIDE_DIAS:60,REPARO_SUBSEA_DIAS:120},CHECKLIST_PADRAO_ANP=[{itemRANP:"10.4.1.a",descricao:"Identificação do Agente Autorizado",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.b",descricao:"Bacia, campo e instalação",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.c",descricao:"Identificação do sistema de medição",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.d",descricao:"TAG e nome do equipamento",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.e",descricao:"Responsável técnico",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.f",descricao:"Condições operacionais (GVF, BSW, P, T, vazões)",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.g",descricao:"Data de ocorrência da falha",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.h",descricao:"Data de detecção da falha",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.i",descricao:"Data de emissão do relatório",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.j",descricao:"Descrição da falha ou irregularidade",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.k",descricao:"Investigação realizada até o momento",obrigatorio:!0,tipoRelatorio:["Parcial"]},{itemRANP:"10.4.1.l",descricao:"Plano de contingência acionado",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.1.m",descricao:"Medidas mitigadoras",obrigatorio:!0,tipoRelatorio:["Parcial","Final"]},{itemRANP:"10.4.2.j",descricao:"Investigação completa",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.k",descricao:"Cronologia e metodologia da investigação",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.l",descricao:"Causa provável da falha",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.m",descricao:"Fato determinante do evento",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.n",descricao:"Plano de contingência acionado e eficácia",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.o",descricao:"Recomendações de ações corretivas/preventivas",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.p",descricao:"Cronograma de execução das recomendações",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.q",descricao:"Prazo previsto para reparo",obrigatorio:!0,tipoRelatorio:["Final"]},{itemRANP:"10.4.2.r",descricao:"Justificativa se prazo > 60/120 dias",obrigatorio:!1,tipoRelatorio:["Final"]}],STORAGE_KEY="mpfm_desenquadramento_events";class DesenquadramentoService{constructor(){lt(this,"events",[]);this.loadFromStorage()}loadFromStorage(){try{const t=localStorage.getItem(STORAGE_KEY);t&&(this.events=JSON.parse(t))}catch(t){console.error("[Desenquadramento] Erro ao carregar eventos:",t)}}saveToStorage(){try{localStorage.setItem(STORAGE_KEY,JSON.stringify(this.events))}catch(t){console.error("[Desenquadramento] Erro ao salvar eventos:",t)}}generateId(){const t=new Date().getFullYear(),r=this.events.filter(s=>s.id.startsWith(`DES-${t}`)).length+1;return`DES-${t}-${String(r).padStart(4,"0")}`}generateEntryId(){return`ENT-${Date.now()}-${Math.random().toString(36).substring(2,7)}`}calcularPrazos(t,r){const s=new Date(t),i=new Date(s);i.setDate(i.getDate()+PRAZOS_RANP44.RELATORIO_PARCIAL_DIAS);const n=r==="TOPSIDE"?PRAZOS_RANP44.RELATORIO_FINAL_TOPSIDE:PRAZOS_RANP44.RELATORIO_FINAL_SUBSEA,a=new Date(s);a.setDate(a.getDate()+n);const o=r==="TOPSIDE"?PRAZOS_RANP44.REPARO_TOPSIDE_DIAS:PRAZOS_RANP44.REPARO_SUBSEA_DIAS,d=new Date(s);return d.setDate(d.getDate()+o),{prazoRelatorioParcial:i.toISOString().split("T")[0],prazoRelatorioFinal:a.toISOString().split("T")[0],prazoReparo:d.toISOString().split("T")[0]}}gerarChecklistANP(t){return CHECKLIST_PADRAO_ANP.filter(r=>r.tipoRelatorio.includes(t)).map((r,s)=>({...r,id:`CHK-${s+1}`,status:"Pendente"}))}criarEvento(t){const r=this.calcularPrazos(t.dataOcorrencia,t.ambiente),s=new Date().toISOString(),i={id:this.generateId(),status:"Aberto",tipoRelatorio:"Parcial",ambiente:t.ambiente,equipamentoId:t.equipamentoId,equipamentoTag:t.equipamentoTag,equipamentoNome:t.equipamentoNome,dataOcorrencia:t.dataOcorrencia,dataDeteccao:t.dataDeteccao,dataRelatorio:s.split("T")[0],...r,responsavelTecnico:t.responsavelTecnico,condicoesOperacionais:t.condicoesOperacionais,diarioBordo:[],planosAcao:[],anexos:[],checklistANP:this.gerarChecklistANP("Parcial"),diasConsecutivosDesvio:t.diasConsecutivosDesvio,desvioHC:t.desvioHC,desvioTotal:t.desvioTotal,createdAt:s,updatedAt:s,createdBy:t.createdBy},n={id:this.generateEntryId(),eventId:i.id,dataHora:s,dPlus:0,etapa:"Abertura do Evento",detalhe:`Evento de desenquadramento aberto automaticamente após ${t.diasConsecutivosDesvio} dias consecutivos de desvio. Desvio HC: ${t.desvioHC.toFixed(2)}%, Desvio Total: ${t.desvioTotal.toFixed(2)}%`,responsavel:t.createdBy,area:"Medição",status:"Concluído",itemRANP:"10.4.1.g"};return i.diarioBordo.push(n),this.events.push(i),this.saveToStorage(),console.log(`[Desenquadramento] Evento criado: ${i.id}`),i}adicionarEntradaDiario(t,r){const s=this.events.find(n=>n.id===t);if(!s)return null;const i={id:this.generateEntryId(),eventId:t,dataHora:new Date().toISOString(),...r};return s.diarioBordo.push(i),s.updatedAt=new Date().toISOString(),this.saveToStorage(),console.log(`[Desenquadramento] Entrada adicionada ao diário: ${i.id}`),i}atualizarDiagnostico(t,r){const s=this.events.find(i=>i.id===t);return s?(s.diagnostico=r,s.updatedAt=new Date().toISOString(),(s.status==="Aberto"||s.status==="Em Investigação")&&(s.status="Em Investigação"),this.saveToStorage(),!0):!1}atualizarContingencia(t,r){const s=this.events.find(i=>i.id===t);return s?(s.contingencia=r,s.updatedAt=new Date().toISOString(),this.saveToStorage(),!0):!1}adicionarAcaoCAPA(t,r){const s=this.events.find(n=>n.id===t);if(!s)return null;const i={id:`CAPA-${Date.now()}`,eventId:t,...r};return s.planosAcao.push(i),s.updatedAt=new Date().toISOString(),s.status==="Em Investigação"&&(s.status="Plano de Ação"),this.saveToStorage(),i}atualizarAcaoCAPA(t,r,s){const i=this.events.find(a=>a.id===t);if(!i)return!1;const n=i.planosAcao.find(a=>a.id===r);return n?(Object.assign(n,s),i.updatedAt=new Date().toISOString(),this.saveToStorage(),!0):!1}atualizarChecklistItem(t,r,s,i){const n=this.events.find(o=>o.id===t);if(!n)return!1;const a=n.checklistANP.find(o=>o.id===r);return a?(a.status=s,i&&(a.observacao=i),n.updatedAt=new Date().toISOString(),this.saveToStorage(),!0):!1}verificarProntidaoEnvio(t){const r=this.events.find(a=>a.id===t);if(!r)return{pronto:!1,itensOK:0,itensPendentes:0,itensObrigatoriosPendentes:[]};const s=r.checklistANP.filter(a=>a.status==="OK").length,i=r.checklistANP.filter(a=>a.status==="Pendente").length,n=r.checklistANP.filter(a=>a.obrigatorio&&a.status==="Pendente").map(a=>a.itemRANP);return{pronto:n.length===0,itensOK:s,itensPendentes:i,itensObrigatoriosPendentes:n}}atualizarStatus(t,r){const s=this.events.find(n=>n.id===t);if(!s)return!1;const i=s.status;return s.status=r,s.updatedAt=new Date().toISOString(),this.adicionarEntradaDiario(t,{dPlus:this.calcularDPlus(s.dataOcorrencia),etapa:"Alteração de Status",detalhe:`Status alterado de "${i}" para "${r}"`,responsavel:"Sistema",area:"Medição",status:"Concluído"}),this.saveToStorage(),!0}promoverParaFinal(t){const r=this.events.find(s=>s.id===t);return r?(r.tipoRelatorio="Final",r.checklistANP=this.gerarChecklistANP("Final"),r.updatedAt=new Date().toISOString(),this.adicionarEntradaDiario(t,{dPlus:this.calcularDPlus(r.dataOcorrencia),etapa:"Promoção para Relatório Final",detalhe:"Evento promovido de Relatório Parcial para Relatório Final",responsavel:"Sistema",area:"Medição",status:"Concluído",itemRANP:"10.4.2"}),this.saveToStorage(),!0):!1}calcularDPlus(t){const r=new Date(t),i=new Date().getTime()-r.getTime();return Math.floor(i/(1e3*60*60*24))}getAll(){return[...this.events]}getById(t){return this.events.find(r=>r.id===t)}getAtivos(){return this.events.filter(t=>t.status!=="Concluído"&&t.status!=="Enviado ANP")}getComPrazoProximo(t=3){const r=new Date;return this.events.filter(s=>{if(s.status==="Concluído"||s.status==="Enviado ANP")return!1;const i=s.tipoRelatorio==="Parcial"?new Date(s.prazoRelatorioParcial):new Date(s.prazoRelatorioFinal),n=Math.ceil((i.getTime()-r.getTime())/(1e3*60*60*24));return n<=t&&n>=0})}getVencidos(){const t=new Date;return this.events.filter(r=>r.status==="Concluído"||r.status==="Enviado ANP"?!1:(r.tipoRelatorio==="Parcial"?new Date(r.prazoRelatorioParcial):new Date(r.prazoRelatorioFinal))<t)}getEstatisticas(){const t=this.getVencidos().length,r=this.getComPrazoProximo(3).length;return{total:this.events.length,abertos:this.events.filter(s=>s.status==="Aberto").length,emInvestigacao:this.events.filter(s=>s.status==="Em Investigação").length,planoAcao:this.events.filter(s=>s.status==="Plano de Ação").length,concluidos:this.events.filter(s=>s.status==="Concluído"||s.status==="Enviado ANP").length,vencidos:t,proximos3Dias:r}}clearAll(){}}const desenquadramentoService=new DesenquadramentoService;function Desenquadramento(){const[e,t]=reactExports.useState([]),[r,s]=reactExports.useState(null),[i,n]=reactExports.useState(!1),[a,o]=reactExports.useState("all"),[d,l]=reactExports.useState("lista");reactExports.useEffect(()=>{c()},[]);const c=()=>{t(desenquadramentoService.getAll())},f=reactExports.useMemo(()=>desenquadramentoService.getEstatisticas(),[e]),u=reactExports.useMemo(()=>desenquadramentoService.getVencidos(),[e]),h=reactExports.useMemo(()=>desenquadramentoService.getComPrazoProximo(3),[e]),g=reactExports.useMemo(()=>a==="all"?e:e.filter(S=>S.status===a),[e,a]),p=S=>({Aberto:{color:"text-red-500",icon:XCircle,bgColor:"bg-red-50"},"Em Investigação":{color:"text-yellow-500",icon:Activity,bgColor:"bg-yellow-50"},"Plano de Ação":{color:"text-blue-500",icon:ClipboardList,bgColor:"bg-blue-50"},"Aguardando Validação":{color:"text-purple-500",icon:Clock,bgColor:"bg-purple-50"},Concluído:{color:"text-green-500",icon:CheckCircle,bgColor:"bg-green-50"},"Enviado ANP":{color:"text-emerald-500",icon:Send,bgColor:"bg-emerald-50"}})[S],x=S=>{const P=new Date,F=new Date(S);return Math.ceil((F.getTime()-P.getTime())/(1e3*60*60*24))},E=S=>new Date(S).toLocaleDateString("pt-BR");return jsxRuntimeExports.jsxs("div",{className:"p-6 space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-7 h-7 text-orange-500"}),"Gestão de Desenquadramento"]}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400 mt-1",children:"Conforme Resolução ANP nº 44/2015 - Seção 10"})]}),jsxRuntimeExports.jsxs(Button,{onClick:()=>n(!0),children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4 mr-2"}),"Novo Evento"]})]}),(u.length>0||h.length>0)&&jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[u.length>0&&jsxRuntimeExports.jsxs("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx(XCircle,{className:"w-6 h-6 text-red-400 flex-shrink-0"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("p",{className:"text-red-400 font-medium",children:[u.length," evento(s) com prazo vencido!"]}),jsxRuntimeExports.jsx("p",{className:"text-red-300/80 text-sm",children:u.map(S=>S.id).join(", ")})]})]}),h.length>0&&jsxRuntimeExports.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx(Clock,{className:"w-6 h-6 text-yellow-400 flex-shrink-0"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("p",{className:"text-yellow-400 font-medium",children:[h.length," evento(s) com prazo nos próximos 3 dias"]}),jsxRuntimeExports.jsx("p",{className:"text-yellow-300/80 text-sm",children:h.map(S=>`${S.id} (${x(S.tipoRelatorio==="Parcial"?S.prazoRelatorioParcial:S.prazoRelatorioFinal)}d)`).join(", ")})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[jsxRuntimeExports.jsx(KPICard,{title:"Total Eventos",value:f.total,icon:FileText,color:"blue"}),jsxRuntimeExports.jsx(KPICard,{title:"Abertos",value:f.abertos,icon:XCircle,color:f.abertos>0?"red":"blue"}),jsxRuntimeExports.jsx(KPICard,{title:"Em Investigação",value:f.emInvestigacao,icon:Activity,color:f.emInvestigacao>0?"amber":"blue"}),jsxRuntimeExports.jsx(KPICard,{title:"Plano de Ação",value:f.planoAcao,icon:ClipboardList,color:"purple"}),jsxRuntimeExports.jsx(KPICard,{title:"Concluídos",value:f.concluidos,icon:CheckCircle,color:"emerald"}),jsxRuntimeExports.jsx(KPICard,{title:"Vencidos",value:f.vencidos,icon:Clock,color:f.vencidos>0?"red":"blue"})]}),jsxRuntimeExports.jsx(Tabs,{activeTab:d,onChange:l,tabs:[{id:"lista",label:"Lista de Eventos",icon:FileText},{id:"timeline",label:"Timeline",icon:Clock},{id:"relatorios",label:"Relatórios ANP",icon:Send}]}),d==="lista"&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Filter,{className:"w-4 h-4 text-zinc-400"}),jsxRuntimeExports.jsx("label",{htmlFor:"status-filter",className:"sr-only",children:"Filtrar por status"}),jsxRuntimeExports.jsx(Select,{id:"status-filter",value:a,onChange:S=>o(S.target.value),options:[{value:"all",label:"Todos os Status"},{value:"Aberto",label:"Aberto"},{value:"Em Investigação",label:"Em Investigação"},{value:"Plano de Ação",label:"Plano de Ação"},{value:"Aguardando Validação",label:"Aguardando Validação"},{value:"Concluído",label:"Concluído"},{value:"Enviado ANP",label:"Enviado ANP"}]})]}),jsxRuntimeExports.jsxs("span",{className:"text-zinc-500 text-sm",children:[g.length," evento(s)"]})]}),d==="lista"&&jsxRuntimeExports.jsx("div",{className:"space-y-4",children:g.length===0?jsxRuntimeExports.jsxs(Card,{className:"p-12 text-center",children:[jsxRuntimeExports.jsx(FileText,{className:"w-16 h-16 text-zinc-600 mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400 text-lg",children:"Nenhum evento de desenquadramento registrado"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-sm mt-2",children:"Eventos são criados automaticamente quando K-Factors ficam fora do limite por 10 dias consecutivos"})]}):g.map(S=>{const P=p(S.status),F=P.icon,A=x(S.tipoRelatorio==="Parcial"?S.prazoRelatorioParcial:S.prazoRelatorioFinal),C=A<0,_=desenquadramentoService.calcularDPlus(S.dataOcorrencia);return jsxRuntimeExports.jsx("div",{className:"cursor-pointer",onClick:()=>s(S),role:"button",tabIndex:0,onKeyDown:w=>w.key==="Enter"&&s(S),children:jsxRuntimeExports.jsx(Card,{className:cn("p-4 hover:border-blue-500/50 transition-colors",C&&"border-red-500/50"),children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4",children:[jsxRuntimeExports.jsx("div",{className:cn("p-3 rounded-lg",P.bgColor),children:jsxRuntimeExports.jsx(F,{className:cn("w-6 h-6",P.color)})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-white",children:S.id}),jsxRuntimeExports.jsxs(Badge,{variant:S.tipoRelatorio==="Parcial"?"warning":"info",children:["Relatório ",S.tipoRelatorio]}),jsxRuntimeExports.jsx(Badge,{variant:S.ambiente==="TOPSIDE"?"TOPSIDE":"SUBSEA",children:S.ambiente})]}),jsxRuntimeExports.jsxs("p",{className:"text-zinc-400 mt-1",children:[S.equipamentoTag," - ",S.equipamentoNome]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-zinc-500",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(Calendar,{className:"w-4 h-4"}),"Ocorrência: ",E(S.dataOcorrencia)]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(Clock,{className:"w-4 h-4"}),"D+",_]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(User,{className:"w-4 h-4"}),S.responsavelTecnico]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[jsxRuntimeExports.jsx("span",{className:cn("text-sm font-medium",C?"text-red-400":A<=3?"text-yellow-400":"text-zinc-400"),children:C?`Vencido há ${Math.abs(A)} dia(s)`:`${A} dia(s) restante(s)`}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-zinc-500",children:["Desvio HC: ",S.desvioHC.toFixed(1),"%"]}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-zinc-500",children:[S.diarioBordo.length," entrada(s) no diário"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Badge,{variant:S.status,children:S.status}),jsxRuntimeExports.jsx(ChevronRight,{className:"w-5 h-5 text-zinc-500"})]})]})})},S.id)})}),d==="timeline"&&jsxRuntimeExports.jsxs(Card,{className:"p-8 text-center",children:[jsxRuntimeExports.jsx(Clock,{className:"w-16 h-16 text-zinc-600 mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400 text-lg",children:"Timeline de Eventos"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-sm mt-2",children:"Visualização cronológica dos eventos e marcos D+10, D+30"})]}),d==="relatorios"&&jsxRuntimeExports.jsxs(Card,{className:"p-8 text-center",children:[jsxRuntimeExports.jsx(Send,{className:"w-16 h-16 text-zinc-600 mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400 text-lg",children:"Relatórios para ANP"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-sm mt-2",children:"Geração e controle de relatórios parciais e finais"})]}),r&&jsxRuntimeExports.jsx(EventDetailModal,{event:r,onClose:()=>s(null),onUpdate:c}),i&&jsxRuntimeExports.jsx(NewEventModal,{onClose:()=>n(!1),onCreate:S=>{c(),s(S),n(!1)}})]})}function EventDetailModal({event:e,onClose:t,onUpdate:r}){const[s,i]=reactExports.useState("geral"),n=desenquadramentoService.verificarProntidaoEnvio(e.id),a=desenquadramentoService.calcularDPlus(e.dataOcorrencia);return jsxRuntimeExports.jsx(Modal,{isOpen:!0,onClose:t,title:`Evento ${e.id}`,size:"xl",children:jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between pb-4 border-b border-zinc-700",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(Badge,{variant:e.status,children:e.status}),jsxRuntimeExports.jsxs(Badge,{variant:e.tipoRelatorio==="Parcial"?"warning":"info",children:["Relatório ",e.tipoRelatorio]}),jsxRuntimeExports.jsx(Badge,{variant:e.ambiente==="TOPSIDE"?"TOPSIDE":"SUBSEA",children:e.ambiente}),jsxRuntimeExports.jsxs("span",{className:"text-zinc-400",children:["D+",a]})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:n.pronto?jsxRuntimeExports.jsx(Badge,{variant:"success",children:"Pronto para Envio"}):jsxRuntimeExports.jsxs(Badge,{variant:"warning",children:[n.itensPendentes," itens pendentes"]})})]}),jsxRuntimeExports.jsx(Tabs,{activeTab:s,onChange:i,tabs:[{id:"geral",label:"Informações Gerais"},{id:"diario",label:`Diário de Bordo (${e.diarioBordo.length})`},{id:"diagnostico",label:"Diagnóstico"},{id:"acoes",label:`Ações CAPA (${e.planosAcao.length})`},{id:"checklist",label:"Checklist ANP"}]}),s==="geral"&&jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-white",children:"Identificação"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-zinc-500",children:"Equipamento:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:e.equipamentoTag}),jsxRuntimeExports.jsx("span",{className:"text-zinc-500",children:"Nome:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:e.equipamentoNome}),jsxRuntimeExports.jsx("span",{className:"text-zinc-500",children:"Responsável:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:e.responsavelTecnico})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-white",children:"Datas"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-zinc-500",children:"Ocorrência:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:new Date(e.dataOcorrencia).toLocaleDateString("pt-BR")}),jsxRuntimeExports.jsx("span",{className:"text-zinc-500",children:"Detecção:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:new Date(e.dataDeteccao).toLocaleDateString("pt-BR")}),jsxRuntimeExports.jsx("span",{className:"text-zinc-500",children:"Prazo Parcial:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:new Date(e.prazoRelatorioParcial).toLocaleDateString("pt-BR")}),jsxRuntimeExports.jsx("span",{className:"text-zinc-500",children:"Prazo Final:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:new Date(e.prazoRelatorioFinal).toLocaleDateString("pt-BR")})]})]}),jsxRuntimeExports.jsxs("div",{className:"col-span-2 space-y-4",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-white",children:"Condições Operacionais"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-zinc-800 p-3 rounded-lg text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-xs",children:"GVF"}),jsxRuntimeExports.jsxs("p",{className:"text-white font-mono",children:[e.condicoesOperacionais.gvf,"%"]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-zinc-800 p-3 rounded-lg text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-xs",children:"BSW"}),jsxRuntimeExports.jsxs("p",{className:"text-white font-mono",children:[e.condicoesOperacionais.bsw,"%"]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-zinc-800 p-3 rounded-lg text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-xs",children:"Pressão"}),jsxRuntimeExports.jsxs("p",{className:"text-white font-mono",children:[e.condicoesOperacionais.pressao," bar"]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-zinc-800 p-3 rounded-lg text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-xs",children:"Temperatura"}),jsxRuntimeExports.jsxs("p",{className:"text-white font-mono",children:[e.condicoesOperacionais.temperatura,"°C"]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-zinc-800 p-3 rounded-lg text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-xs",children:"Desvio HC"}),jsxRuntimeExports.jsxs("p",{className:"text-white font-mono",children:[e.desvioHC.toFixed(2),"%"]})]})]})]})]}),s==="diario"&&jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[e.diarioBordo.length===0?jsxRuntimeExports.jsx("p",{className:"text-zinc-500 text-center py-8",children:"Nenhuma entrada no diário de bordo"}):jsxRuntimeExports.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:e.diarioBordo.map((o,d)=>jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center",children:[jsxRuntimeExports.jsxs("div",{className:"w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400 text-xs font-bold",children:["D+",o.dPlus]}),d<e.diarioBordo.length-1&&jsxRuntimeExports.jsx("div",{className:"w-0.5 h-full bg-zinc-700 my-1"})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 bg-zinc-800 rounded-lg p-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-white",children:o.etapa}),jsxRuntimeExports.jsx(Badge,{variant:o.status==="Concluído"?"success":"warning",size:"sm",children:o.status})]}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400 text-sm mt-1",children:o.detalhe}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-zinc-500",children:[jsxRuntimeExports.jsx("span",{children:new Date(o.dataHora).toLocaleString("pt-BR")}),jsxRuntimeExports.jsx("span",{children:o.responsavel}),o.itemRANP&&jsxRuntimeExports.jsxs("span",{children:["Ref: ",o.itemRANP]})]})]})]},o.id))}),jsxRuntimeExports.jsxs(Button,{variant:"outline",className:"w-full",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4 mr-2"}),"Adicionar Entrada"]})]}),s==="checklist"&&jsxRuntimeExports.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:e.checklistANP.map(o=>jsxRuntimeExports.jsxs("div",{className:cn("flex items-center justify-between p-3 rounded-lg",o.status==="OK"?"bg-green-500/10":o.status==="Pendente"?"bg-zinc-800":"bg-zinc-700"),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[o.status==="OK"?jsxRuntimeExports.jsx(CheckCircle,{className:"w-5 h-5 text-green-500"}):o.status==="N/A"?jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full bg-zinc-600"}):jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-zinc-500"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-zinc-400 text-sm font-mono mr-2",children:o.itemRANP}),jsxRuntimeExports.jsx("span",{className:"text-white text-sm",children:o.descricao}),o.obrigatorio&&jsxRuntimeExports.jsx("span",{className:"text-red-400 text-xs ml-2",children:"*"})]})]}),jsxRuntimeExports.jsx(Badge,{variant:o.status==="OK"?"success":o.status==="N/A"?"secondary":"warning",size:"sm",children:o.status})]},o.id))}),s==="diagnostico"&&jsxRuntimeExports.jsx("div",{className:"space-y-4",children:e.diagnostico?jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-white mb-2",children:"Descrição da Falha"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400",children:e.diagnostico.descricaoFalha})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-white mb-2",children:"Causa Provável"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400",children:e.diagnostico.causaProvavel})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-white mb-2",children:"Metodologia"}),jsxRuntimeExports.jsx(Badge,{children:e.diagnostico.metodologiaAnalise})]})]}):jsxRuntimeExports.jsxs("div",{className:"text-center py-8",children:[jsxRuntimeExports.jsx(Activity,{className:"w-12 h-12 text-zinc-600 mx-auto mb-2"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-500",children:"Diagnóstico ainda não preenchido"}),jsxRuntimeExports.jsxs(Button,{variant:"outline",className:"mt-4",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4 mr-2"}),"Iniciar Diagnóstico"]})]})}),s==="acoes"&&jsxRuntimeExports.jsx("div",{className:"space-y-4",children:e.planosAcao.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-8",children:[jsxRuntimeExports.jsx(ClipboardList,{className:"w-12 h-12 text-zinc-600 mx-auto mb-2"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-500",children:"Nenhuma ação CAPA registrada"}),jsxRuntimeExports.jsxs(Button,{variant:"outline",className:"mt-4",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4 mr-2"}),"Adicionar Ação"]})]}):jsxRuntimeExports.jsx("div",{className:"space-y-3",children:e.planosAcao.map(o=>jsxRuntimeExports.jsxs("div",{className:"bg-zinc-800 rounded-lg p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-white",children:o.acao}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Badge,{variant:o.tipo==="Corretiva"?"error":"info",size:"sm",children:o.tipo}),jsxRuntimeExports.jsx(Badge,{variant:o.status==="Concluído"?"success":"warning",size:"sm",children:o.status})]})]}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400 text-sm mt-2",children:o.descricao}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-zinc-500",children:[jsxRuntimeExports.jsxs("span",{children:["Responsável: ",o.responsavel]}),jsxRuntimeExports.jsxs("span",{children:["Prazo: ",new Date(o.prazo).toLocaleDateString("pt-BR")]})]})]},o.id))})}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-zinc-700",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",onClick:t,children:"Fechar"}),e.tipoRelatorio==="Parcial"&&e.status!=="Enviado ANP"&&jsxRuntimeExports.jsx(Button,{variant:"outline",onClick:()=>{desenquadramentoService.promoverParaFinal(e.id),r()},children:"Promover para Final"}),n.pronto&&jsxRuntimeExports.jsxs(Button,{children:[jsxRuntimeExports.jsx(Send,{className:"w-4 h-4 mr-2"}),"Gerar Relatório ANP"]})]})]})})}function NewEventModal({onClose:e,onCreate:t}){const[r,s]=reactExports.useState({equipamentoId:"",equipamentoTag:"",equipamentoNome:"",ambiente:"TOPSIDE",dataOcorrencia:new Date().toISOString().split("T")[0],dataDeteccao:new Date().toISOString().split("T")[0],responsavelTecnico:"",diasConsecutivosDesvio:10,desvioHC:0,desvioTotal:0,gvf:0,bsw:0,pressao:0,temperatura:0,vazaoOleo:0,vazaoGas:0,vazaoAgua:0,vazaoTotal:0}),i=n=>{n.preventDefault();const a=desenquadramentoService.criarEvento({equipamentoId:r.equipamentoId,equipamentoTag:r.equipamentoTag,equipamentoNome:r.equipamentoNome,ambiente:r.ambiente,dataOcorrencia:r.dataOcorrencia,dataDeteccao:r.dataDeteccao,responsavelTecnico:r.responsavelTecnico,diasConsecutivosDesvio:r.diasConsecutivosDesvio,desvioHC:r.desvioHC,desvioTotal:r.desvioTotal,createdBy:"Usuário",condicoesOperacionais:{gvf:r.gvf,bsw:r.bsw,pressao:r.pressao,temperatura:r.temperatura,vazaoOleo:r.vazaoOleo,vazaoGas:r.vazaoGas,vazaoAgua:r.vazaoAgua,vazaoTotal:r.vazaoTotal,salinidade:0}});t(a)};return jsxRuntimeExports.jsx(Modal,{isOpen:!0,onClose:e,title:"Novo Evento de Desenquadramento",size:"lg",children:jsxRuntimeExports.jsxs("form",{onSubmit:i,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(Input,{label:"TAG do Equipamento",value:r.equipamentoTag,onChange:n=>s(a=>({...a,equipamentoTag:n.target.value})),placeholder:"Ex: 2601.18FT1506",required:!0}),jsxRuntimeExports.jsx(Input,{label:"Nome do Equipamento",value:r.equipamentoNome,onChange:n=>s(a=>({...a,equipamentoNome:n.target.value})),placeholder:"Ex: MPFM Bank 05",required:!0}),jsxRuntimeExports.jsx(Select,{label:"Ambiente",value:r.ambiente,onChange:n=>s(a=>({...a,ambiente:n.target.value})),options:[{value:"TOPSIDE",label:"Topside"},{value:"SUBSEA",label:"Subsea"}]}),jsxRuntimeExports.jsx(Input,{label:"Responsável Técnico",value:r.responsavelTecnico,onChange:n=>s(a=>({...a,responsavelTecnico:n.target.value})),required:!0}),jsxRuntimeExports.jsx(Input,{label:"Data de Ocorrência",type:"date",value:r.dataOcorrencia,onChange:n=>s(a=>({...a,dataOcorrencia:n.target.value})),required:!0}),jsxRuntimeExports.jsx(Input,{label:"Data de Detecção",type:"date",value:r.dataDeteccao,onChange:n=>s(a=>({...a,dataDeteccao:n.target.value})),required:!0}),jsxRuntimeExports.jsx(Input,{label:"Dias Consecutivos de Desvio",type:"number",value:r.diasConsecutivosDesvio,onChange:n=>s(a=>({...a,diasConsecutivosDesvio:Number(n.target.value)})),min:10,required:!0}),jsxRuntimeExports.jsx(Input,{label:"Desvio HC (%)",type:"number",step:"0.01",value:r.desvioHC,onChange:n=>s(a=>({...a,desvioHC:Number(n.target.value)}))})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3",children:[jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",onClick:e,children:"Cancelar"}),jsxRuntimeExports.jsxs(Button,{type:"submit",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4 mr-2"}),"Criar Evento"]})]})]})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var XLSX={};XLSX.version="0.18.5";var current_ansi=1252,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],set_ansi=function(e){VALID_ANSI.indexOf(e)!=-1&&(current_ansi=e)};function reset_ansi(){set_ansi(1252)}var set_cp=function(e){set_ansi(e)};function reset_cp(){set_cp(1200),reset_ansi()}var _getchar=function(t){return String.fromCharCode(t)},_getansi=function(t){return String.fromCharCode(t)},$cptable,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(e){for(var t="",r=0,s=0,i=0,n=0,a=0,o=0,d=0,l=0;l<e.length;)r=e.charCodeAt(l++),n=r>>2,s=e.charCodeAt(l++),a=(r&3)<<4|s>>4,i=e.charCodeAt(l++),o=(s&15)<<2|i>>6,d=i&63,isNaN(s)?o=d=64:isNaN(i)&&(d=64),t+=Base64_map.charAt(n)+Base64_map.charAt(a)+Base64_map.charAt(o)+Base64_map.charAt(d);return t}function Base64_decode(e){var t="",r=0,s=0,i=0,n=0,a=0,o=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)n=Base64_map.indexOf(e.charAt(l++)),a=Base64_map.indexOf(e.charAt(l++)),r=n<<2|a>>4,t+=String.fromCharCode(r),o=Base64_map.indexOf(e.charAt(l++)),s=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(s)),d=Base64_map.indexOf(e.charAt(l++)),i=(o&3)<<6|d,d!==64&&(t+=String.fromCharCode(i));return t}var has_buf=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Buffer_from=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function new_raw_buf(e){return has_buf?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function new_unsafe_buf(e){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var s2a=function(t){return has_buf?Buffer_from(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function s2ab(e){if(typeof ArrayBuffer>"u")return s2a(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function a2s(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function a2u(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var bconcat=has_buf?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Buffer_from(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(n){return Array.isArray(n)?n:[].slice.call(n)}))};function utf8decode(e){for(var t=[],r=0,s=e.length+250,i=new_raw_buf(e.length+255),n=0;n<e.length;++n){var a=e.charCodeAt(n);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++n)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>s&&(t.push(i.slice(0,r)),r=0,i=new_raw_buf(65535),s=65530)}return t.push(i.slice(0,r)),bconcat(t)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function pad0(e,t){var r=""+e;return r.length>=t?r:fill("0",t-r.length)+r}function pad_(e,t){var r=""+e;return r.length>=t?r:fill(" ",t-r.length)+r}function rpad_(e,t){var r=""+e;return r.length>=t?r:r+fill(" ",t-r.length)}function pad0r1(e,t){var r=""+Math.round(e);return r.length>=t?r:fill("0",t-r.length)+r}function pad0r2(e,t){var r=""+e;return r.length>=t?r:fill("0",t-r.length)+r}var p2_32=Math.pow(2,32);function pad0r(e,t){if(e>p2_32||e<-p2_32)return pad0r1(e,t);var r=Math.round(e);return pad0r2(r,t)}function SSF_isgeneral(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(e,t,r){for(var s=e<0?-1:1,i=e*s,n=0,a=1,o=0,d=1,l=0,c=0,f=Math.floor(i);l<t&&(f=Math.floor(i),o=f*a+n,c=f*l+d,!(i-f<5e-8));)i=1/(i-f),n=a,a=o,d=l,l=c;if(c>t&&(l>t?(c=d,o=n):(c=l,o=a)),!r)return[0,s*o,c];var u=Math.floor(s*o/c);return[u,s*o-u*c,c]}function SSF_parse_date_code(e,t,r){if(e>2958465||e<0)return null;var s=e|0,i=Math.floor(86400*(e-s)),n=0,a=[],o={D:s,T:i,u:86400*(e-s)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(s+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++s,++o.D)),s===60)a=r?[1317,10,29]:[1900,2,29],n=3;else if(s===0)a=r?[1317,8,29]:[1900,1,0],n=6;else{s>60&&--s;var d=new Date(1900,0,1);d.setDate(d.getDate()+s-1),a=[d.getFullYear(),d.getMonth()+1,d.getDate()],n=d.getDay(),s<60&&(n=(n+6)%7),r&&(n=SSF_fix_hijri(d,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=n,o}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=SSFbase1904&&(r+=24*60*60*1e3),(r-(SSFdnthresh+(e.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function SSF_strip_decimal(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(e){var t=e<0?12:11,r=SSF_strip_decimal(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function SSF_large_exp(e){var t=SSF_strip_decimal(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function SSF_general_num(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=SSF_small_exp(e):t===10?r=e.toFixed(10).substr(0,12):r=SSF_large_exp(e),SSF_strip_decimal(SSF_normalize_exp(r.toUpperCase()))}function SSF_general(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):SSF_general_num(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return SSF_format(14,datenum_local(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function SSF_fix_hijri(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function SSF_write_date(e,t,r,s){var i="",n=0,a=0,o=r.y,d,l=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:d=o%100,l=2;break;default:d=o%1e4,l=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,l=t.length;break;case 3:return months[r.m-1][1];case 5:return months[r.m-1][0];default:return months[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,l=t.length;break;case 3:return days[r.q][0];default:return days[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?pad0(r.S,t.length):(s>=2?a=s===3?1e3:100:a=s===1?10:1,n=Math.round(a*(r.S+r.u)),n>=60*a&&(n=0),t==="s"?n===0?"0":""+n/a:(i=pad0(n,2+s),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}l=t.length===3?1:2;break;case 101:d=o,l=1;break}var c=l>0?pad0(d,l):"";return c}function commaify(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var pct1=/%/g;function write_num_pct(e,t,r){var s=t.replace(pct1,""),i=t.length-s.length;return write_num(e,s,r*Math.pow(10,2*i))+fill("%",i)}function write_num_cm(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return write_num(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function write_num_exp(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+write_num_exp(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%i;if(n<0&&(n+=i),r=(t/Math.pow(10,n)).toPrecision(s+1+(i+n)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+n):r+="E+"+(a-n);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,d,l,c){return d+l+c.substr(0,(i+n)%i)+"."+c.substr(n)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(e,t,r){var s=parseInt(e[4],10),i=Math.round(t*s),n=Math.floor(i/s),a=i-n*s,o=s;return r+(n===0?"":""+n)+" "+(a===0?fill(" ",e[1].length+1+e[4].length):pad_(a,e[1].length)+e[2]+"/"+e[3]+pad0(o,e[4].length))}function write_num_f2(e,t,r){return r+(t===0?"":""+t)+fill(" ",e[1].length+2+e[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function rnd(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function dec(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function carry(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function flr(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function write_num_flt(e,t,r){if(e.charCodeAt(0)===40&&!t.match(closeparen)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?write_num_flt("n",s,r):"("+write_num_flt("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return write_num_cm(e,t,r);if(t.indexOf("%")!==-1)return write_num_pct(e,t,r);if(t.indexOf("E")!==-1)return write_num_exp(t,r);if(t.charCodeAt(0)===36)return"$"+write_num_flt(e,t.substr(t.charAt(1)==" "?2:1),r);var i,n,a,o,d=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+pad0r(d,t.length);if(t.match(/^[#?]+$/))return i=pad0r(r,0),i==="0"&&(i=""),i.length>t.length?i:hashq(t.substr(0,t.length-i.length))+i;if(n=t.match(frac1))return write_num_f1(n,d,l);if(t.match(/^#+0+$/))return l+pad0r(d,t.length-t.indexOf("0"));if(n=t.match(dec1))return i=rnd(r,n[1].length).replace(/^([^\.]+)$/,"$1."+hashq(n[1])).replace(/\.$/,"."+hashq(n[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+fill("0",hashq(n[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return l+rnd(d,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return l+commaify(pad0r(d,0));if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+write_num_flt(e,t,-r):commaify(""+(Math.floor(r)+carry(r,n[1].length)))+"."+pad0(dec(r,n[1].length),n[1].length);if(n=t.match(/^#,#*,#0/))return write_num_flt(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=_strrev(write_num_flt(e,t.replace(/[\\-]/g,""),r)),a=0,_strrev(_strrev(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(t.match(phone))return i=write_num_flt(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(n[4].length,7),o=SSF_frac(d,Math.pow(10,a)-1,!1),i=""+l,c=write_num("n",n[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+n[2]+"/"+n[3],c=rpad_(o[2],a),c.length<n[4].length&&(c=hashq(n[4].substr(n[4].length-c.length))+c),i+=c,i;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(n[1].length,n[4].length),7),o=SSF_frac(d,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?pad_(o[1],a)+n[2]+"/"+n[3]+rpad_(o[2],a):fill(" ",2*a+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return i=pad0r(r,0),t.length<=i.length?i:hashq(t.substr(0,t.length-i.length))+i;if(n=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,u=t.length-i.length-f;return hashq(t.substr(0,f)+i+t.substr(t.length-u))}if(n=t.match(/^00,000\.([#0]*0)$/))return a=dec(r,n[1].length),r<0?"-"+write_num_flt(e,t,-r):commaify(flr(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?pad0(0,3-g.length):"")+g})+"."+pad0(a,n[1].length);switch(t){case"###,##0.00":return write_num_flt(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=commaify(pad0r(d,0));return h!=="0"?l+h:"";case"###,###.00":return write_num_flt(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return write_num_flt(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function write_num_cm2(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return write_num(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function write_num_pct2(e,t,r){var s=t.replace(pct1,""),i=t.length-s.length;return write_num(e,s,r*Math.pow(10,2*i))+fill("%",i)}function write_num_exp2(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+write_num_exp2(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%i;if(n<0&&(n+=i),r=(t/Math.pow(10,n)).toPrecision(s+1+(i+n)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+n):r+="E+"+(a-n),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,d,l,c){return d+l+c.substr(0,(i+n)%i)+"."+c.substr(n)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function write_num_int(e,t,r){if(e.charCodeAt(0)===40&&!t.match(closeparen)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?write_num_int("n",s,r):"("+write_num_int("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return write_num_cm2(e,t,r);if(t.indexOf("%")!==-1)return write_num_pct2(e,t,r);if(t.indexOf("E")!==-1)return write_num_exp2(t,r);if(t.charCodeAt(0)===36)return"$"+write_num_int(e,t.substr(t.charAt(1)==" "?2:1),r);var i,n,a,o,d=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+pad0(d,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:hashq(t.substr(0,t.length-i.length))+i;if(n=t.match(frac1))return write_num_f2(n,d,l);if(t.match(/^#+0+$/))return l+pad0(d,t.length-t.indexOf("0"));if(n=t.match(dec1))return i=(""+r).replace(/^([^\.]+)$/,"$1."+hashq(n[1])).replace(/\.$/,"."+hashq(n[1])),i=i.replace(/\.(\d*)$/,function(g,p){return"."+p+fill("0",hashq(n[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return l+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return l+commaify(""+d);if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+write_num_int(e,t,-r):commaify(""+r)+"."+fill("0",n[1].length);if(n=t.match(/^#,#*,#0/))return write_num_int(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=_strrev(write_num_int(e,t.replace(/[\\-]/g,""),r)),a=0,_strrev(_strrev(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(t.match(phone))return i=write_num_int(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(n[4].length,7),o=SSF_frac(d,Math.pow(10,a)-1,!1),i=""+l,c=write_num("n",n[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+n[2]+"/"+n[3],c=rpad_(o[2],a),c.length<n[4].length&&(c=hashq(n[4].substr(n[4].length-c.length))+c),i+=c,i;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(n[1].length,n[4].length),7),o=SSF_frac(d,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?pad_(o[1],a)+n[2]+"/"+n[3]+rpad_(o[2],a):fill(" ",2*a+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:hashq(t.substr(0,t.length-i.length))+i;if(n=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,u=t.length-i.length-f;return hashq(t.substr(0,f)+i+t.substr(t.length-u))}if(n=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+write_num_int(e,t,-r):commaify(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?pad0(0,3-g.length):"")+g})+"."+pad0(0,n[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=commaify(""+d);return h!=="0"?l+h:"";default:if(t.match(/\.[0#?]*$/))return write_num_int(e,t.slice(0,t.lastIndexOf(".")),r)+hashq(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function write_num(e,t,r){return(r|0)===r?write_num_int(e,t,r):write_num_flt(e,t,r)}function SSF_split_fmt(e){for(var t=[],r=!1,s=0,i=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(i,s-i),i=s+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":SSF_isgeneral(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function eval_fmt(e,t,r,s){for(var i=[],n="",a=0,o="",d="t",l,c,f,u="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!SSF_isgeneral(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(n="";(f=e.charCodeAt(++a))!==34&&a<e.length;)n+=String.fromCharCode(f);i[i.length]={t:"t",v:n},++a;break;case"\\":var h=e.charAt(++a),g=h==="("||h===")"?h:"t";i[i.length]={t:g,v:h},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(l==null&&(l=SSF_parse_date_code(t,r,e.charAt(a+1)==="2"),l==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},d=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||l==null&&(l=SSF_parse_date_code(t,r),l==null))return"";for(n=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)n+=o;o==="m"&&d.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=u),i[i.length]={t:o,v:n},d=o;break;case"A":case"a":case"上":var p={t:o,v:o};if(l==null&&(l=SSF_parse_date_code(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",u="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",a+=5,u="h"):e.substr(a,5).toUpperCase()==="上午/下午"?(l!=null&&(p.v=l.H>=12?"下午":"上午"),p.t="T",a+=5,u="h"):(p.t="t",++a),l==null&&p.t==="T")return"";i[i.length]=p,d=o;break;case"[":for(n=o;e.charAt(a++)!=="]"&&a<e.length;)n+=e.charAt(a);if(n.slice(-1)!=="]")throw'unterminated "[" block: |'+n+"|";if(n.match(SSF_abstime)){if(l==null&&(l=SSF_parse_date_code(t,r),l==null))return"";i[i.length]={t:"Z",v:n.toLowerCase()},d=n.charAt(1)}else n.indexOf("$")>-1&&(n=(n.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(e)||(i[i.length]={t:"t",v:n}));break;case".":if(l!=null){for(n=o;++a<e.length&&(o=e.charAt(a))==="0";)n+=o;i[i.length]={t:"s",v:n};break}case"0":case"#":for(n=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)n+=o;i[i.length]={t:"n",v:n};break;case"?":for(n=o;e.charAt(++a)===o;)n+=o;i[i.length]={t:o,v:n},d=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:s===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(n=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)n+=e.charAt(a);i[i.length]={t:"D",v:n};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var x=0,E=0,S;for(a=i.length-1,d="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=u,d="h",x<1&&(x=1);break;case"s":(S=i[a].v.match(/\.0+$/))&&(E=Math.max(E,S[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":d=i[a].t;break;case"m":d==="s"&&(i[a].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&i[a].v.match(/[Hh]/)&&(x=1),x<2&&i[a].v.match(/[Mm]/)&&(x=2),x<3&&i[a].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var P="",F;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=SSF_write_date(i[a].t.charCodeAt(0),i[a].v,l,E),i[a].t="t";break;case"n":case"?":for(F=a+1;i[F]!=null&&((o=i[F].t)==="?"||o==="D"||(o===" "||o==="t")&&i[F+1]!=null&&(i[F+1].t==="?"||i[F+1].t==="t"&&i[F+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[F].v==="/"||i[F].v===" "&&i[F+1]!=null&&i[F+1].t=="?"));)i[a].v+=i[F].v,i[F]={v:"",t:";"},++F;P+=i[a].v,a=F-1;break;case"G":i[a].t="t",i[a].v=SSF_general(t,r);break}var A="",C,_;if(P.length>0){P.charCodeAt(0)==40?(C=t<0&&P.charCodeAt(0)===45?-t:t,_=write_num("n",P,C)):(C=t<0&&s>1?-t:t,_=write_num("n",P,C),C<0&&i[0]&&i[0].t=="t"&&(_=_.substr(1),i[0].v="-"+i[0].v)),F=_.length-1;var w=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){w=a;break}var T=i.length;if(w===i.length&&_.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(F>=i[a].v.length-1?(F-=i[a].v.length,i[a].v=_.substr(F+1,i[a].v.length)):F<0?i[a].v="":(i[a].v=_.substr(0,F+1),F=-1),i[a].t="t",T=a);F>=0&&T<i.length&&(i[T].v=_.substr(0,F+1)+i[T].v)}else if(w!==i.length&&_.indexOf("E")===-1){for(F=_.indexOf(".")-1,a=w;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(c=i[a].v.indexOf(".")>-1&&a===w?i[a].v.indexOf(".")-1:i[a].v.length-1,A=i[a].v.substr(c+1);c>=0;--c)F>=0&&(i[a].v.charAt(c)==="0"||i[a].v.charAt(c)==="#")&&(A=_.charAt(F--)+A);i[a].v=A,i[a].t="t",T=a}for(F>=0&&T<i.length&&(i[T].v=_.substr(0,F+1)+i[T].v),F=_.indexOf(".")+1,a=w;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==w)){for(c=i[a].v.indexOf(".")>-1&&a===w?i[a].v.indexOf(".")+1:0,A=i[a].v.substr(0,c);c<i[a].v.length;++c)F<_.length&&(A+=_.charAt(F++));i[a].v=A,i[a].t="t",T=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(C=s>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=write_num(i[a].t,i[a].v,C),i[a].t="t");var M="";for(a=0;a!==i.length;++a)i[a]!=null&&(M+=i[a].v);return M}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function choose_fmt(e,t){var r=SSF_split_fmt(e),s=r.length,i=r[s-1].indexOf("@");if(s<4&&i>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var n=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,n];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(cfregex2),o=r[1].match(cfregex2);return chkcond(t,a)?[s,r[0]]:chkcond(t,o)?[s,r[1]]:[s,r[a!=null&&o!=null?2:1]]}return[s,n]}function SSF_format(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:table_fmt)[e],s==null&&(s=r.table&&r.table[SSF_default_map[e]]||table_fmt[SSF_default_map[e]]),s==null&&(s=SSF_default_str[e]||"General");break}if(SSF_isgeneral(s,0))return SSF_general(t,r);t instanceof Date&&(t=datenum_local(t,r.date1904));var i=choose_fmt(s,t);if(SSF_isgeneral(i[1]))return SSF_general(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return eval_fmt(i[1],t,r,i[0])}function SSF_load(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(table_fmt[r]==null){t<0&&(t=r);continue}if(table_fmt[r]==e){t=r;break}}t<0&&(t=391)}return table_fmt[t]=e,t}function SSF_load_table(e){for(var t=0;t!=392;++t)e[t]!==void 0&&SSF_load(e[t],t)}function make_ssf(){table_fmt=SSF_init_table()}var dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(e){var t=typeof e=="number"?table_fmt[e]:e;return t=t.replace(dateNFregex,"(\\d+)"),new RegExp("^"+t+"$")}function dateNF_fix(e,t,r){var s=-1,i=-1,n=-1,a=-1,o=-1,d=-1;(t.match(dateNFregex)||[]).forEach(function(f,u){var h=parseInt(r[u+1],10);switch(f.toLowerCase().charAt(0)){case"y":s=h;break;case"d":n=h;break;case"h":a=h;break;case"s":d=h;break;case"m":a>=0?o=h:i=h;break}}),d>=0&&o==-1&&i>=0&&(o=i,i=-1);var l=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var c=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return a==-1&&o==-1&&d==-1?l:s==-1&&i==-1&&n==-1?c:l+"T"+c}var CRC32=function(){var e={};e.version="1.2.0";function t(){for(var _=0,w=new Array(256),T=0;T!=256;++T)_=T,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,w[T]=_;return typeof Int32Array<"u"?new Int32Array(w):w}var r=t();function s(_){var w=0,T=0,M=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)R[M]=_[M];for(M=0;M!=256;++M)for(T=_[M],w=256+M;w<4096;w+=256)T=R[w]=T>>>8^_[T&255];var k=[];for(M=1;M!=16;++M)k[M-1]=typeof Int32Array<"u"?R.subarray(M*256,M*256+256):R.slice(M*256,M*256+256);return k}var i=s(r),n=i[0],a=i[1],o=i[2],d=i[3],l=i[4],c=i[5],f=i[6],u=i[7],h=i[8],g=i[9],p=i[10],x=i[11],E=i[12],S=i[13],P=i[14];function F(_,w){for(var T=w^-1,M=0,R=_.length;M<R;)T=T>>>8^r[(T^_.charCodeAt(M++))&255];return~T}function A(_,w){for(var T=w^-1,M=_.length-15,R=0;R<M;)T=P[_[R++]^T&255]^S[_[R++]^T>>8&255]^E[_[R++]^T>>16&255]^x[_[R++]^T>>>24]^p[_[R++]]^g[_[R++]]^h[_[R++]]^u[_[R++]]^f[_[R++]]^c[_[R++]]^l[_[R++]]^d[_[R++]]^o[_[R++]]^a[_[R++]]^n[_[R++]]^r[_[R++]];for(M+=15;R<M;)T=T>>>8^r[(T^_[R++])&255];return~T}function C(_,w){for(var T=w^-1,M=0,R=_.length,k=0,L=0;M<R;)k=_.charCodeAt(M++),k<128?T=T>>>8^r[(T^k)&255]:k<2048?(T=T>>>8^r[(T^(192|k>>6&31))&255],T=T>>>8^r[(T^(128|k&63))&255]):k>=55296&&k<57344?(k=(k&1023)+64,L=_.charCodeAt(M++)&1023,T=T>>>8^r[(T^(240|k>>8&7))&255],T=T>>>8^r[(T^(128|k>>2&63))&255],T=T>>>8^r[(T^(128|L>>6&15|(k&3)<<4))&255],T=T>>>8^r[(T^(128|L&63))&255]):(T=T>>>8^r[(T^(224|k>>12&15))&255],T=T>>>8^r[(T^(128|k>>6&63))&255],T=T>>>8^r[(T^(128|k&63))&255]);return~T}return e.table=r,e.bstr=F,e.buf=A,e.str=C,e}(),CFB=function(){var t={};t.version="1.2.1";function r(I,K){for(var O=I.split("/"),B=K.split("/"),G=0,q=0,pe=Math.min(O.length,B.length);G<pe;++G){if(q=O[G].length-B[G].length)return q;if(O[G]!=B[G])return O[G]<B[G]?-1:1}return O.length-B.length}function s(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:s(I.slice(0,-1));var K=I.lastIndexOf("/");return K===-1?I:I.slice(0,K+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var K=I.lastIndexOf("/");return K===-1?I:I.slice(K+1)}function n(I,K){typeof K=="string"&&(K=new Date(K));var O=K.getHours();O=O<<6|K.getMinutes(),O=O<<5|K.getSeconds()>>>1,I.write_shift(2,O);var B=K.getFullYear()-1980;B=B<<4|K.getMonth()+1,B=B<<5|K.getDate(),I.write_shift(2,B)}function a(I){var K=I.read_shift(2)&65535,O=I.read_shift(2)&65535,B=new Date,G=O&31;O>>>=5;var q=O&15;O>>>=4,B.setMilliseconds(0),B.setFullYear(O+1980),B.setMonth(q-1),B.setDate(G);var pe=K&31;K>>>=5;var je=K&63;return K>>>=6,B.setHours(K),B.setMinutes(je),B.setSeconds(pe<<1),B}function o(I){prep_blob(I,0);for(var K={},O=0;I.l<=I.length-4;){var B=I.read_shift(2),G=I.read_shift(2),q=I.l+G,pe={};switch(B){case 21589:O=I.read_shift(1),O&1&&(pe.mtime=I.read_shift(4)),G>5&&(O&2&&(pe.atime=I.read_shift(4)),O&4&&(pe.ctime=I.read_shift(4))),pe.mtime&&(pe.mt=new Date(pe.mtime*1e3));break}I.l=q,K[B]=pe}return K}var d;function l(){return d||(d={})}function c(I,K){if(I[0]==80&&I[1]==75)return rt(I,K);if((I[0]|32)==109&&(I[1]|32)==105)return ne(I,K);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var O=3,B=512,G=0,q=0,pe=0,je=0,Se=0,we=[],Ce=I.slice(0,512);prep_blob(Ce,0);var Ue=f(Ce);switch(O=Ue[0],O){case 3:B=512;break;case 4:B=4096;break;case 0:if(Ue[1]==0)return rt(I,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}B!==512&&(Ce=I.slice(0,B),prep_blob(Ce,28));var We=I.slice(0,B);u(Ce,O);var Qe=Ce.read_shift(4,"i");if(O===3&&Qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Qe);Ce.l+=4,pe=Ce.read_shift(4,"i"),Ce.l+=4,Ce.chk("00100000","Mini Stream Cutoff Size: "),je=Ce.read_shift(4,"i"),G=Ce.read_shift(4,"i"),Se=Ce.read_shift(4,"i"),q=Ce.read_shift(4,"i");for(var He=-1,Ze=0;Ze<109&&(He=Ce.read_shift(4,"i"),!(He<0));++Ze)we[Ze]=He;var at=h(I,B);x(Se,q,at,B,we);var ct=S(at,pe,we,B);ct[pe].name="!Directory",G>0&&je!==L&&(ct[je].name="!MiniFAT"),ct[we[0]].name="!FAT",ct.fat_addrs=we,ct.ssz=B;var dt={},ut=[],wt=[],St=[];P(pe,ct,at,ut,G,dt,wt,je),g(wt,St,ut),ut.shift();var yt={FileIndex:wt,FullPaths:St};return K&&K.raw&&(yt.raw={header:We,sectors:at}),yt}function f(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(ae,"Header Signature: "),I.l+=16;var K=I.read_shift(2,"u");return[I.read_shift(2,"u"),K]}function u(I,K){var O=9;switch(I.l+=2,O=I.read_shift(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function h(I,K){for(var O=Math.ceil(I.length/K)-1,B=[],G=1;G<O;++G)B[G-1]=I.slice(G*K,(G+1)*K);return B[O-1]=I.slice(O*K),B}function g(I,K,O){for(var B=0,G=0,q=0,pe=0,je=0,Se=O.length,we=[],Ce=[];B<Se;++B)we[B]=Ce[B]=B,K[B]=O[B];for(;je<Ce.length;++je)B=Ce[je],G=I[B].L,q=I[B].R,pe=I[B].C,we[B]===B&&(G!==-1&&we[G]!==G&&(we[B]=we[G]),q!==-1&&we[q]!==q&&(we[B]=we[q])),pe!==-1&&(we[pe]=B),G!==-1&&B!=we[B]&&(we[G]=we[B],Ce.lastIndexOf(G)<je&&Ce.push(G)),q!==-1&&B!=we[B]&&(we[q]=we[B],Ce.lastIndexOf(q)<je&&Ce.push(q));for(B=1;B<Se;++B)we[B]===B&&(q!==-1&&we[q]!==q?we[B]=we[q]:G!==-1&&we[G]!==G&&(we[B]=we[G]));for(B=1;B<Se;++B)if(I[B].type!==0){if(je=B,je!=we[je])do je=we[je],K[B]=K[je]+"/"+K[B];while(je!==0&&we[je]!==-1&&je!=we[je]);we[B]=-1}for(K[0]+="/",B=1;B<Se;++B)I[B].type!==2&&(K[B]+="/")}function p(I,K,O){for(var B=I.start,G=I.size,q=[],pe=B;O&&G>0&&pe>=0;)q.push(K.slice(pe*k,pe*k+k)),G-=k,pe=__readInt32LE(O,pe*4);return q.length===0?new_buf(0):bconcat(q).slice(0,I.size)}function x(I,K,O,B,G){var q=L;if(I===L){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var pe=O[I],je=(B>>>2)-1;if(!pe)return;for(var Se=0;Se<je&&(q=__readInt32LE(pe,Se*4))!==L;++Se)G.push(q);x(__readInt32LE(pe,B-4),K-1,O,B,G)}}function E(I,K,O,B,G){var q=[],pe=[];G||(G=[]);var je=B-1,Se=0,we=0;for(Se=K;Se>=0;){G[Se]=!0,q[q.length]=Se,pe.push(I[Se]);var Ce=O[Math.floor(Se*4/B)];if(we=Se*4&je,B<4+we)throw new Error("FAT boundary crossed: "+Se+" 4 "+B);if(!I[Ce])break;Se=__readInt32LE(I[Ce],we)}return{nodes:q,data:__toBuffer([pe])}}function S(I,K,O,B){var G=I.length,q=[],pe=[],je=[],Se=[],we=B-1,Ce=0,Ue=0,We=0,Qe=0;for(Ce=0;Ce<G;++Ce)if(je=[],We=Ce+K,We>=G&&(We-=G),!pe[We]){Se=[];var He=[];for(Ue=We;Ue>=0;){He[Ue]=!0,pe[Ue]=!0,je[je.length]=Ue,Se.push(I[Ue]);var Ze=O[Math.floor(Ue*4/B)];if(Qe=Ue*4&we,B<4+Qe)throw new Error("FAT boundary crossed: "+Ue+" 4 "+B);if(!I[Ze]||(Ue=__readInt32LE(I[Ze],Qe),He[Ue]))break}q[We]={nodes:je,data:__toBuffer([Se])}}return q}function P(I,K,O,B,G,q,pe,je){for(var Se=0,we=B.length?2:0,Ce=K[I].data,Ue=0,We=0,Qe;Ue<Ce.length;Ue+=128){var He=Ce.slice(Ue,Ue+128);prep_blob(He,64),We=He.read_shift(2),Qe=__utf16le(He,0,We-we),B.push(Qe);var Ze={name:Qe,type:He.read_shift(1),color:He.read_shift(1),L:He.read_shift(4,"i"),R:He.read_shift(4,"i"),C:He.read_shift(4,"i"),clsid:He.read_shift(16),state:He.read_shift(4,"i"),start:0,size:0},at=He.read_shift(2)+He.read_shift(2)+He.read_shift(2)+He.read_shift(2);at!==0&&(Ze.ct=F(He,He.l-8));var ct=He.read_shift(2)+He.read_shift(2)+He.read_shift(2)+He.read_shift(2);ct!==0&&(Ze.mt=F(He,He.l-8)),Ze.start=He.read_shift(4,"i"),Ze.size=He.read_shift(4,"i"),Ze.size<0&&Ze.start<0&&(Ze.size=Ze.type=0,Ze.start=L,Ze.name=""),Ze.type===5?(Se=Ze.start,G>0&&Se!==L&&(K[Se].name="!StreamData")):Ze.size>=4096?(Ze.storage="fat",K[Ze.start]===void 0&&(K[Ze.start]=E(O,Ze.start,K.fat_addrs,K.ssz)),K[Ze.start].name=Ze.name,Ze.content=K[Ze.start].data.slice(0,Ze.size)):(Ze.storage="minifat",Ze.size<0?Ze.size=0:Se!==L&&Ze.start!==L&&K[Se]&&(Ze.content=p(Ze,K[Se].data,(K[je]||{}).data))),Ze.content&&prep_blob(Ze.content,0),q[Qe]=Ze,pe.push(Ze)}}function F(I,K){return new Date((__readUInt32LE(I,K+4)/1e7*Math.pow(2,32)+__readUInt32LE(I,K)/1e7-11644473600)*1e3)}function A(I,K){return l(),c(d.readFileSync(I),K)}function C(I,K){var O=K&&K.type;switch(O||has_buf&&Buffer.isBuffer(I)&&(O="buffer"),O||"base64"){case"file":return A(I,K);case"base64":return c(s2a(Base64_decode(I)),K);case"binary":return c(s2a(I),K)}return c(I,K)}function _(I,K){var O=K||{},B=O.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=B+"/",I.FileIndex[0]={name:B,type:5}),O.CLSID&&(I.FileIndex[0].clsid=O.CLSID),w(I)}function w(I){var K="Sh33tJ5";if(!CFB.find(I,"/"+K)){var O=new_buf(4);O[0]=55,O[1]=O[3]=50,O[2]=54,I.FileIndex.push({name:K,type:2,content:O,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+K),T(I)}}function T(I,K){_(I);for(var O=!1,B=!1,G=I.FullPaths.length-1;G>=0;--G){var q=I.FileIndex[G];switch(q.type){case 0:B?O=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(q.R*q.L*q.C)&&(O=!0),q.R>-1&&q.L>-1&&q.R==q.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!K)){var pe=new Date(1987,1,19),je=0,Se=Object.create?Object.create(null):{},we=[];for(G=0;G<I.FullPaths.length;++G)Se[I.FullPaths[G]]=!0,I.FileIndex[G].type!==0&&we.push([I.FullPaths[G],I.FileIndex[G]]);for(G=0;G<we.length;++G){var Ce=s(we[G][0]);B=Se[Ce],B||(we.push([Ce,{name:i(Ce).replace("/",""),type:1,clsid:oe,ct:pe,mt:pe,content:null}]),Se[Ce]=!0)}for(we.sort(function(Qe,He){return r(Qe[0],He[0])}),I.FullPaths=[],I.FileIndex=[],G=0;G<we.length;++G)I.FullPaths[G]=we[G][0],I.FileIndex[G]=we[G][1];for(G=0;G<we.length;++G){var Ue=I.FileIndex[G],We=I.FullPaths[G];if(Ue.name=i(We).replace("/",""),Ue.L=Ue.R=Ue.C=-(Ue.color=1),Ue.size=Ue.content?Ue.content.length:0,Ue.start=0,Ue.clsid=Ue.clsid||oe,G===0)Ue.C=we.length>1?1:-1,Ue.size=0,Ue.type=5;else if(We.slice(-1)=="/"){for(je=G+1;je<we.length&&s(I.FullPaths[je])!=We;++je);for(Ue.C=je>=we.length?-1:je,je=G+1;je<we.length&&s(I.FullPaths[je])!=s(We);++je);Ue.R=je>=we.length?-1:je,Ue.type=1}else s(I.FullPaths[G+1]||"")==s(We)&&(Ue.R=G+1),Ue.type=2}}}function M(I,K){var O=K||{};if(O.fileType=="mad")return ye(I,O);switch(T(I),O.fileType){case"zip":return Ne(I,O)}var B=function(Qe){for(var He=0,Ze=0,at=0;at<Qe.FileIndex.length;++at){var ct=Qe.FileIndex[at];if(ct.content){var dt=ct.content.length;dt>0&&(dt<4096?He+=dt+63>>6:Ze+=dt+511>>9)}}for(var ut=Qe.FullPaths.length+3>>2,wt=He+7>>3,St=He+127>>7,yt=wt+Ze+ut+St,mt=yt+127>>7,Kt=mt<=109?0:Math.ceil((mt-109)/127);yt+mt+Kt+127>>7>mt;)Kt=++mt<=109?0:Math.ceil((mt-109)/127);var ft=[1,Kt,mt,St,ut,Ze,He,0];return Qe.FileIndex[0].size=He<<6,ft[7]=(Qe.FileIndex[0].start=ft[0]+ft[1]+ft[2]+ft[3]+ft[4]+ft[5])+(ft[6]+7>>3),ft}(I),G=new_buf(B[7]<<9),q=0,pe=0;{for(q=0;q<8;++q)G.write_shift(1,Q[q]);for(q=0;q<8;++q)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),q=0;q<3;++q)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,B[2]),G.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:L),G.write_shift(4,B[3]),G.write_shift(-4,B[1]?B[0]-1:L),G.write_shift(4,B[1]),q=0;q<109;++q)G.write_shift(-4,q<B[2]?B[1]+q:-1)}if(B[1])for(pe=0;pe<B[1];++pe){for(;q<236+pe*127;++q)G.write_shift(-4,q<B[2]?B[1]+q:-1);G.write_shift(-4,pe===B[1]-1?L:pe+1)}var je=function(Qe){for(pe+=Qe;q<pe-1;++q)G.write_shift(-4,q+1);Qe&&(++q,G.write_shift(-4,L))};for(pe=q=0,pe+=B[1];q<pe;++q)G.write_shift(-4,re.DIFSECT);for(pe+=B[2];q<pe;++q)G.write_shift(-4,re.FATSECT);je(B[3]),je(B[4]);for(var Se=0,we=0,Ce=I.FileIndex[0];Se<I.FileIndex.length;++Se)Ce=I.FileIndex[Se],Ce.content&&(we=Ce.content.length,!(we<4096)&&(Ce.start=pe,je(we+511>>9)));for(je(B[6]+7>>3);G.l&511;)G.write_shift(-4,re.ENDOFCHAIN);for(pe=q=0,Se=0;Se<I.FileIndex.length;++Se)Ce=I.FileIndex[Se],Ce.content&&(we=Ce.content.length,!(!we||we>=4096)&&(Ce.start=pe,je(we+63>>6)));for(;G.l&511;)G.write_shift(-4,re.ENDOFCHAIN);for(q=0;q<B[4]<<2;++q){var Ue=I.FullPaths[q];if(!Ue||Ue.length===0){for(Se=0;Se<17;++Se)G.write_shift(4,0);for(Se=0;Se<3;++Se)G.write_shift(4,-1);for(Se=0;Se<12;++Se)G.write_shift(4,0);continue}Ce=I.FileIndex[q],q===0&&(Ce.start=Ce.size?Ce.start-1:L);var We=q===0&&O.root||Ce.name;if(we=2*(We.length+1),G.write_shift(64,We,"utf16le"),G.write_shift(2,we),G.write_shift(1,Ce.type),G.write_shift(1,Ce.color),G.write_shift(-4,Ce.L),G.write_shift(-4,Ce.R),G.write_shift(-4,Ce.C),Ce.clsid)G.write_shift(16,Ce.clsid,"hex");else for(Se=0;Se<4;++Se)G.write_shift(4,0);G.write_shift(4,Ce.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,Ce.start),G.write_shift(4,Ce.size),G.write_shift(4,0)}for(q=1;q<I.FileIndex.length;++q)if(Ce=I.FileIndex[q],Ce.size>=4096)if(G.l=Ce.start+1<<9,has_buf&&Buffer.isBuffer(Ce.content))Ce.content.copy(G,G.l,0,Ce.size),G.l+=Ce.size+511&-512;else{for(Se=0;Se<Ce.size;++Se)G.write_shift(1,Ce.content[Se]);for(;Se&511;++Se)G.write_shift(1,0)}for(q=1;q<I.FileIndex.length;++q)if(Ce=I.FileIndex[q],Ce.size>0&&Ce.size<4096)if(has_buf&&Buffer.isBuffer(Ce.content))Ce.content.copy(G,G.l,0,Ce.size),G.l+=Ce.size+63&-64;else{for(Se=0;Se<Ce.size;++Se)G.write_shift(1,Ce.content[Se]);for(;Se&63;++Se)G.write_shift(1,0)}if(has_buf)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function R(I,K){var O=I.FullPaths.map(function(Se){return Se.toUpperCase()}),B=O.map(function(Se){var we=Se.split("/");return we[we.length-(Se.slice(-1)=="/"?2:1)]}),G=!1;K.charCodeAt(0)===47?(G=!0,K=O[0].slice(0,-1)+K):G=K.indexOf("/")!==-1;var q=K.toUpperCase(),pe=G===!0?O.indexOf(q):B.indexOf(q);if(pe!==-1)return I.FileIndex[pe];var je=!q.match(chr1);for(q=q.replace(chr0,""),je&&(q=q.replace(chr1,"!")),pe=0;pe<O.length;++pe)if((je?O[pe].replace(chr1,"!"):O[pe]).replace(chr0,"")==q||(je?B[pe].replace(chr1,"!"):B[pe]).replace(chr0,"")==q)return I.FileIndex[pe];return null}var k=64,L=-2,ae="d0cf11e0a1b11ae1",Q=[208,207,17,224,161,177,26,225],oe="00000000000000000000000000000000",re={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:ae,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:oe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function me(I,K,O){l();var B=M(I,O);d.writeFileSync(K,B)}function H(I){for(var K=new Array(I.length),O=0;O<I.length;++O)K[O]=String.fromCharCode(I[O]);return K.join("")}function ie(I,K){var O=M(I,K);switch(K&&K.type||"buffer"){case"file":return l(),d.writeFileSync(K.filename,O),O;case"binary":return typeof O=="string"?O:H(O);case"base64":return Base64_encode(typeof O=="string"?O:H(O));case"buffer":if(has_buf)return Buffer.isBuffer(O)?O:Buffer_from(O);case"array":return typeof O=="string"?s2a(O):O}return O}var le;function N(I){try{var K=I.InflateRaw,O=new K;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)le=I;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function b(I,K){if(!le)return Ve(I,K);var O=le.InflateRaw,B=new O,G=B._processChunk(I.slice(I.l),B._finishFlushFlag);return I.l+=B.bytesRead,G}function v(I){return le?le.deflateRawSync(I):it(I)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],U=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function W(I){var K=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(K>>16|K>>8|K)&255}for(var Z=typeof Uint8Array<"u",te=Z?new Uint8Array(256):[],ve=0;ve<256;++ve)te[ve]=W(ve);function xe(I,K){var O=te[I&255];return K<=8?O>>>8-K:(O=O<<8|te[I>>8&255],K<=16?O>>>16-K:(O=O<<8|te[I>>16&255],O>>>24-K))}function Re(I,K){var O=K&7,B=K>>>3;return(I[B]|(O<=6?0:I[B+1]<<8))>>>O&3}function Ae(I,K){var O=K&7,B=K>>>3;return(I[B]|(O<=5?0:I[B+1]<<8))>>>O&7}function ke(I,K){var O=K&7,B=K>>>3;return(I[B]|(O<=4?0:I[B+1]<<8))>>>O&15}function ue(I,K){var O=K&7,B=K>>>3;return(I[B]|(O<=3?0:I[B+1]<<8))>>>O&31}function se(I,K){var O=K&7,B=K>>>3;return(I[B]|(O<=1?0:I[B+1]<<8))>>>O&127}function z(I,K,O){var B=K&7,G=K>>>3,q=(1<<O)-1,pe=I[G]>>>B;return O<8-B||(pe|=I[G+1]<<8-B,O<16-B)||(pe|=I[G+2]<<16-B,O<24-B)||(pe|=I[G+3]<<24-B),pe&q}function J(I,K,O){var B=K&7,G=K>>>3;return B<=5?I[G]|=(O&7)<<B:(I[G]|=O<<B&255,I[G+1]=(O&7)>>8-B),K+3}function de(I,K,O){var B=K&7,G=K>>>3;return O=(O&1)<<B,I[G]|=O,K+1}function fe(I,K,O){var B=K&7,G=K>>>3;return O<<=B,I[G]|=O&255,O>>>=8,I[G+1]=O,K+8}function Fe(I,K,O){var B=K&7,G=K>>>3;return O<<=B,I[G]|=O&255,O>>>=8,I[G+1]=O&255,I[G+2]=O>>>8,K+16}function De(I,K){var O=I.length,B=2*O>K?2*O:K+5,G=0;if(O>=K)return I;if(has_buf){var q=new_unsafe_buf(B);if(I.copy)I.copy(q);else for(;G<I.length;++G)q[G]=I[G];return q}else if(Z){var pe=new Uint8Array(B);if(pe.set)pe.set(I);else for(;G<O;++G)pe[G]=I[G];return pe}return I.length=B,I}function Pe(I){for(var K=new Array(I),O=0;O<I;++O)K[O]=0;return K}function he(I,K,O){var B=1,G=0,q=0,pe=0,je=0,Se=I.length,we=Z?new Uint16Array(32):Pe(32);for(q=0;q<32;++q)we[q]=0;for(q=Se;q<O;++q)I[q]=0;Se=I.length;var Ce=Z?new Uint16Array(Se):Pe(Se);for(q=0;q<Se;++q)we[G=I[q]]++,B<G&&(B=G),Ce[q]=0;for(we[0]=0,q=1;q<=B;++q)we[q+16]=je=je+we[q-1]<<1;for(q=0;q<Se;++q)je=I[q],je!=0&&(Ce[q]=we[je+16]++);var Ue=0;for(q=0;q<Se;++q)if(Ue=I[q],Ue!=0)for(je=xe(Ce[q],B)>>B-Ue,pe=(1<<B+4-Ue)-1;pe>=0;--pe)K[je|pe<<Ue]=Ue&15|q<<4;return B}var ze=Z?new Uint16Array(512):Pe(512),Le=Z?new Uint16Array(32):Pe(32);if(!Z){for(var tt=0;tt<512;++tt)ze[tt]=0;for(tt=0;tt<32;++tt)Le[tt]=0}(function(){for(var I=[],K=0;K<32;K++)I.push(5);he(I,Le,32);var O=[];for(K=0;K<=143;K++)O.push(8);for(;K<=255;K++)O.push(9);for(;K<=279;K++)O.push(7);for(;K<=287;K++)O.push(8);he(O,ze,288)})();var et=function(){for(var K=Z?new Uint8Array(32768):[],O=0,B=0;O<U.length-1;++O)for(;B<U[O+1];++B)K[B]=O;for(;B<32768;++B)K[B]=29;var G=Z?new Uint8Array(259):[];for(O=0,B=0;O<D.length-1;++O)for(;B<D[O+1];++B)G[B]=O;function q(je,Se){for(var we=0;we<je.length;){var Ce=Math.min(65535,je.length-we),Ue=we+Ce==je.length;for(Se.write_shift(1,+Ue),Se.write_shift(2,Ce),Se.write_shift(2,~Ce&65535);Ce-- >0;)Se[Se.l++]=je[we++]}return Se.l}function pe(je,Se){for(var we=0,Ce=0,Ue=Z?new Uint16Array(32768):[];Ce<je.length;){var We=Math.min(65535,je.length-Ce);if(We<10){for(we=J(Se,we,+(Ce+We==je.length)),we&7&&(we+=8-(we&7)),Se.l=we/8|0,Se.write_shift(2,We),Se.write_shift(2,~We&65535);We-- >0;)Se[Se.l++]=je[Ce++];we=Se.l*8;continue}we=J(Se,we,+(Ce+We==je.length)+2);for(var Qe=0;We-- >0;){var He=je[Ce];Qe=(Qe<<5^He)&32767;var Ze=-1,at=0;if((Ze=Ue[Qe])&&(Ze|=Ce&-32768,Ze>Ce&&(Ze-=32768),Ze<Ce))for(;je[Ze+at]==je[Ce+at]&&at<250;)++at;if(at>2){He=G[at],He<=22?we=fe(Se,we,te[He+1]>>1)-1:(fe(Se,we,3),we+=5,fe(Se,we,te[He-23]>>5),we+=3);var ct=He<8?0:He-4>>2;ct>0&&(Fe(Se,we,at-D[He]),we+=ct),He=K[Ce-Ze],we=fe(Se,we,te[He]>>3),we-=3;var dt=He<4?0:He-2>>1;dt>0&&(Fe(Se,we,Ce-Ze-U[He]),we+=dt);for(var ut=0;ut<at;++ut)Ue[Qe]=Ce&32767,Qe=(Qe<<5^je[Ce])&32767,++Ce;We-=at-1}else He<=143?He=He+48:we=de(Se,we,1),we=fe(Se,we,te[He]),Ue[Qe]=Ce&32767,++Ce}we=fe(Se,we,0)-1}return Se.l=(we+7)/8|0,Se.l}return function(Se,we){return Se.length<8?q(Se,we):pe(Se,we)}}();function it(I){var K=new_buf(50+Math.floor(I.length*1.1)),O=et(I,K);return K.slice(0,O)}var Xe=Z?new Uint16Array(32768):Pe(32768),Je=Z?new Uint16Array(32768):Pe(32768),nt=Z?new Uint16Array(128):Pe(128),ot=1,Me=1;function ge(I,K){var O=ue(I,K)+257;K+=5;var B=ue(I,K)+1;K+=5;var G=ke(I,K)+4;K+=4;for(var q=0,pe=Z?new Uint8Array(19):Pe(19),je=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Se=1,we=Z?new Uint8Array(8):Pe(8),Ce=Z?new Uint8Array(8):Pe(8),Ue=pe.length,We=0;We<G;++We)pe[j[We]]=q=Ae(I,K),Se<q&&(Se=q),we[q]++,K+=3;var Qe=0;for(we[0]=0,We=1;We<=Se;++We)Ce[We]=Qe=Qe+we[We-1]<<1;for(We=0;We<Ue;++We)(Qe=pe[We])!=0&&(je[We]=Ce[Qe]++);var He=0;for(We=0;We<Ue;++We)if(He=pe[We],He!=0){Qe=te[je[We]]>>8-He;for(var Ze=(1<<7-He)-1;Ze>=0;--Ze)nt[Qe|Ze<<He]=He&7|We<<3}var at=[];for(Se=1;at.length<O+B;)switch(Qe=nt[se(I,K)],K+=Qe&7,Qe>>>=3){case 16:for(q=3+Re(I,K),K+=2,Qe=at[at.length-1];q-- >0;)at.push(Qe);break;case 17:for(q=3+Ae(I,K),K+=3;q-- >0;)at.push(0);break;case 18:for(q=11+se(I,K),K+=7;q-- >0;)at.push(0);break;default:at.push(Qe),Se<Qe&&(Se=Qe);break}var ct=at.slice(0,O),dt=at.slice(O);for(We=O;We<286;++We)ct[We]=0;for(We=B;We<30;++We)dt[We]=0;return ot=he(ct,Xe,286),Me=he(dt,Je,30),K}function be(I,K){if(I[0]==3&&!(I[1]&3))return[new_raw_buf(K),2];for(var O=0,B=0,G=new_unsafe_buf(K||1<<18),q=0,pe=G.length>>>0,je=0,Se=0;!(B&1);){if(B=Ae(I,O),O+=3,B>>>1)B>>1==1?(je=9,Se=5):(O=ge(I,O),je=ot,Se=Me);else{O&7&&(O+=8-(O&7));var we=I[O>>>3]|I[(O>>>3)+1]<<8;if(O+=32,we>0)for(!K&&pe<q+we&&(G=De(G,q+we),pe=G.length);we-- >0;)G[q++]=I[O>>>3],O+=8;continue}for(;;){!K&&pe<q+32767&&(G=De(G,q+32767),pe=G.length);var Ce=z(I,O,je),Ue=B>>>1==1?ze[Ce]:Xe[Ce];if(O+=Ue&15,Ue>>>=4,!(Ue>>>8&255))G[q++]=Ue;else{if(Ue==256)break;Ue-=257;var We=Ue<8?0:Ue-4>>2;We>5&&(We=0);var Qe=q+D[Ue];We>0&&(Qe+=z(I,O,We),O+=We),Ce=z(I,O,Se),Ue=B>>>1==1?Le[Ce]:Je[Ce],O+=Ue&15,Ue>>>=4;var He=Ue<4?0:Ue-2>>1,Ze=U[Ue];for(He>0&&(Ze+=z(I,O,He),O+=He),!K&&pe<Qe&&(G=De(G,Qe+100),pe=G.length);q<Qe;)G[q]=G[q-Ze],++q}}}return K?[G,O+7>>>3]:[G.slice(0,q),O+7>>>3]}function Ve(I,K){var O=I.slice(I.l||0),B=be(O,K);return I.l+=B[1],B[0]}function st(I,K){if(I)typeof console<"u"&&console.error(K);else throw new Error(K)}function rt(I,K){var O=I;prep_blob(O,0);var B=[],G=[],q={FileIndex:B,FullPaths:G};_(q,{root:K.root});for(var pe=O.length-4;(O[pe]!=80||O[pe+1]!=75||O[pe+2]!=5||O[pe+3]!=6)&&pe>=0;)--pe;O.l=pe+4,O.l+=4;var je=O.read_shift(2);O.l+=6;var Se=O.read_shift(4);for(O.l=Se,pe=0;pe<je;++pe){O.l+=20;var we=O.read_shift(4),Ce=O.read_shift(4),Ue=O.read_shift(2),We=O.read_shift(2),Qe=O.read_shift(2);O.l+=8;var He=O.read_shift(4),Ze=o(O.slice(O.l+Ue,O.l+Ue+We));O.l+=Ue+We+Qe;var at=O.l;O.l=He+4,ee(O,we,Ce,q,Ze),O.l=at}return q}function ee(I,K,O,B,G){I.l+=2;var q=I.read_shift(2),pe=I.read_shift(2),je=a(I);if(q&8257)throw new Error("Unsupported ZIP encryption");for(var Se=I.read_shift(4),we=I.read_shift(4),Ce=I.read_shift(4),Ue=I.read_shift(2),We=I.read_shift(2),Qe="",He=0;He<Ue;++He)Qe+=String.fromCharCode(I[I.l++]);if(We){var Ze=o(I.slice(I.l,I.l+We));(Ze[21589]||{}).mt&&(je=Ze[21589].mt),((G||{})[21589]||{}).mt&&(je=G[21589].mt)}I.l+=We;var at=I.slice(I.l,I.l+we);switch(pe){case 8:at=b(I,Ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+pe)}var ct=!1;q&8&&(Se=I.read_shift(4),Se==134695760&&(Se=I.read_shift(4),ct=!0),we=I.read_shift(4),Ce=I.read_shift(4)),we!=K&&st(ct,"Bad compressed size: "+K+" != "+we),Ce!=O&&st(ct,"Bad uncompressed size: "+O+" != "+Ce),Ie(B,Qe,at,{unsafe:!0,mt:je})}function Ne(I,K){var O=K||{},B=[],G=[],q=new_buf(1),pe=O.compression?8:0,je=0,Se=0,we=0,Ce=0,Ue=0,We=I.FullPaths[0],Qe=We,He=I.FileIndex[0],Ze=[],at=0;for(Se=1;Se<I.FullPaths.length;++Se)if(Qe=I.FullPaths[Se].slice(We.length),He=I.FileIndex[Se],!(!He.size||!He.content||Qe=="Sh33tJ5")){var ct=Ce,dt=new_buf(Qe.length);for(we=0;we<Qe.length;++we)dt.write_shift(1,Qe.charCodeAt(we)&127);dt=dt.slice(0,dt.l),Ze[Ue]=CRC32.buf(He.content,0);var ut=He.content;pe==8&&(ut=v(ut)),q=new_buf(30),q.write_shift(4,67324752),q.write_shift(2,20),q.write_shift(2,je),q.write_shift(2,pe),He.mt?n(q,He.mt):q.write_shift(4,0),q.write_shift(-4,Ze[Ue]),q.write_shift(4,ut.length),q.write_shift(4,He.content.length),q.write_shift(2,dt.length),q.write_shift(2,0),Ce+=q.length,B.push(q),Ce+=dt.length,B.push(dt),Ce+=ut.length,B.push(ut),q=new_buf(46),q.write_shift(4,33639248),q.write_shift(2,0),q.write_shift(2,20),q.write_shift(2,je),q.write_shift(2,pe),q.write_shift(4,0),q.write_shift(-4,Ze[Ue]),q.write_shift(4,ut.length),q.write_shift(4,He.content.length),q.write_shift(2,dt.length),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(4,0),q.write_shift(4,ct),at+=q.l,G.push(q),at+=dt.length,G.push(dt),++Ue}return q=new_buf(22),q.write_shift(4,101010256),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,Ue),q.write_shift(2,Ue),q.write_shift(4,at),q.write_shift(4,Ce),q.write_shift(2,0),bconcat([bconcat(B),bconcat(G),q])}var Be={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function qe(I,K){if(I.ctype)return I.ctype;var O=I.name||"",B=O.match(/\.([^\.]+)$/);return B&&Be[B[1]]||K&&(B=(O=K).match(/[\.\\]([^\.\\])+$/),B&&Be[B[1]])?Be[B[1]]:"application/octet-stream"}function Ye(I){for(var K=Base64_encode(I),O=[],B=0;B<K.length;B+=76)O.push(K.slice(B,B+76));return O.join(`\r
`)+`\r
`}function Ge(I){var K=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(we){var Ce=we.charCodeAt(0).toString(16).toUpperCase();return"="+(Ce.length==1?"0"+Ce:Ce)});K=K.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],B=K.split(`\r
`),G=0;G<B.length;++G){var q=B[G];if(q.length==0){O.push("");continue}for(var pe=0;pe<q.length;){var je=76,Se=q.slice(pe,pe+je);Se.charAt(je-1)=="="?je--:Se.charAt(je-2)=="="?je-=2:Se.charAt(je-3)=="="&&(je-=3),Se=q.slice(pe,pe+je),pe+=je,pe<q.length&&(Se+="="),O.push(Se)}}return O.join(`\r
`)}function Y(I){for(var K=[],O=0;O<I.length;++O){for(var B=I[O];O<=I.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+I[++O];K.push(B)}for(var G=0;G<K.length;++G)K[G]=K[G].replace(/[=][0-9A-Fa-f]{2}/g,function(q){return String.fromCharCode(parseInt(q.slice(1),16))});return s2a(K.join(`\r
`))}function V(I,K,O){for(var B="",G="",q="",pe,je=0;je<10;++je){var Se=K[je];if(!Se||Se.match(/^\s*$/))break;var we=Se.match(/^(.*?):\s*([^\s].*)$/);if(we)switch(we[1].toLowerCase()){case"content-location":B=we[2].trim();break;case"content-type":q=we[2].trim();break;case"content-transfer-encoding":G=we[2].trim();break}}switch(++je,G.toLowerCase()){case"base64":pe=s2a(Base64_decode(K.slice(je).join("")));break;case"quoted-printable":pe=Y(K.slice(je));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var Ce=Ie(I,B.slice(O.length),pe,{unsafe:!0});q&&(Ce.ctype=q)}function ne(I,K){if(H(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=K&&K.root||"",B=(has_buf&&Buffer.isBuffer(I)?I.toString("binary"):H(I)).split(`\r
`),G=0,q="";for(G=0;G<B.length;++G)if(q=B[G],!!/^Content-Location:/i.test(q)&&(q=q.slice(q.indexOf("file")),O||(O=q.slice(0,q.lastIndexOf("/")+1)),q.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),q.slice(0,O.length)!=O););var pe=(B[1]||"").match(/boundary="(.*?)"/);if(!pe)throw new Error("MAD cannot find boundary");var je="--"+(pe[1]||""),Se=[],we=[],Ce={FileIndex:Se,FullPaths:we};_(Ce);var Ue,We=0;for(G=0;G<B.length;++G){var Qe=B[G];Qe!==je&&Qe!==je+"--"||(We++&&V(Ce,B.slice(Ue,G),O),Ue=G)}return Ce}function ye(I,K){var O=K||{},B=O.boundary||"SheetJS";B="------="+B;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],q=I.FullPaths[0],pe=q,je=I.FileIndex[0],Se=1;Se<I.FullPaths.length;++Se)if(pe=I.FullPaths[Se].slice(q.length),je=I.FileIndex[Se],!(!je.size||!je.content||pe=="Sh33tJ5")){pe=pe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(at){return"_x"+at.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(at){return"_u"+at.charCodeAt(0).toString(16)+"_"});for(var we=je.content,Ce=has_buf&&Buffer.isBuffer(we)?we.toString("binary"):H(we),Ue=0,We=Math.min(1024,Ce.length),Qe=0,He=0;He<=We;++He)(Qe=Ce.charCodeAt(He))>=32&&Qe<128&&++Ue;var Ze=Ue>=We*4/5;G.push(B),G.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+pe),G.push("Content-Transfer-Encoding: "+(Ze?"quoted-printable":"base64")),G.push("Content-Type: "+qe(je,pe)),G.push(""),G.push(Ze?Ge(Ce):Ye(Ce))}return G.push(B+`--\r
`),G.join(`\r
`)}function Te(I){var K={};return _(K,I),K}function Ie(I,K,O,B){var G=B&&B.unsafe;G||_(I);var q=!G&&CFB.find(I,K);if(!q){var pe=I.FullPaths[0];K.slice(0,pe.length)==pe?pe=K:(pe.slice(-1)!="/"&&(pe+="/"),pe=(pe+K).replace("//","/")),q={name:i(K),type:2},I.FileIndex.push(q),I.FullPaths.push(pe),G||CFB.utils.cfb_gc(I)}return q.content=O,q.size=O?O.length:0,B&&(B.CLSID&&(q.clsid=B.CLSID),B.mt&&(q.mt=B.mt),B.ct&&(q.ct=B.ct)),q}function Oe(I,K){_(I);var O=CFB.find(I,K);if(O){for(var B=0;B<I.FileIndex.length;++B)if(I.FileIndex[B]==O)return I.FileIndex.splice(B,1),I.FullPaths.splice(B,1),!0}return!1}function $e(I,K,O){_(I);var B=CFB.find(I,K);if(B){for(var G=0;G<I.FileIndex.length;++G)if(I.FileIndex[G]==B)return I.FileIndex[G].name=i(O),I.FullPaths[G]=O,!0}return!1}function Ke(I){T(I,!0)}return t.find=R,t.read=C,t.parse=c,t.write=ie,t.writeFile=me,t.utils={cfb_new:Te,cfb_add:Ie,cfb_del:Oe,cfb_mov:$e,cfb_gc:Ke,ReadShift,CheckField,prep_blob,bconcat,use_zlib:N,_deflateRaw:it,_inflateRaw:Ve,consts:re},t}();function blobify(e){return typeof e=="string"?s2ab(e):Array.isArray(e)?a2u(e):e}function write_dl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=s2ab(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?utf8write(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var i=new Blob([blobify(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var n=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),chrome.downloads.download({url:n,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=n,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),n}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=a2s(t)),o.write(t),o.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function keys(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function evert_key(e,t){for(var r=[],s=keys(e),i=0;i!==s.length;++i)r[e[s[i]][t]]==null&&(r[e[s[i]][t]]=s[i]);return r}function evert(e){for(var t=[],r=keys(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function evert_num(e){for(var t=[],r=keys(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function evert_arr(e){for(var t=[],r=keys(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var basedate=new Date(1899,11,30,0,0,0);function datenum(e,t){var r=e.getTime(),s=basedate.getTime()+(e.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(r-s)/(24*60*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(e){var t=new Date;return t.setTime(e*24*60*60*1e3+dnthresh),t.getTimezoneOffset()!==refoffset&&t.setTime(t.getTime()+(t.getTimezoneOffset()-refoffset)*6e4),t}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(e,t){var r=new Date(e);if(good_pd)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(good_pd_date.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(n=new Date(n.getTime()-n.getTimezoneOffset()*60*1e3)),n}function cc2str(e,t){if(has_buf&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(n){return r[n]||n})}catch{}for(var s=[],i=0;i!=e.length;++i)s.push(String.fromCharCode(e[i]));return s.join("")}function dup(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=dup(e[r]));return t}function fill(e,t){for(var r="";r.length<t;)r+=e;return r}function fuzzynum(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(i,n){return r=-r,n}),!isNaN(t=Number(s)))?t/r:t}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),i=t.getMonth(),n=t.getDate();if(isNaN(n))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&lower_months.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return s<0||s>8099?r:(i>0||n>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function zip_add_file(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return has_buf?s=Buffer_from(r):s=utf8decode(r),CFB.utils.cfb_add(e,t,s)}CFB.utils.cfb_add(e,t,r)}else e.file(t,r)}function zip_new(){return CFB.utils.cfb_new()}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f]/g;function escapexml(e){var t=e+"";return t.replace(decregex,function(r){return rencoding[r]}).replace(charegex,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function escapexmltag(e){return escapexml(e).replace(/ /g,"_x0020_")}var htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(e){var t=e+"";return t.replace(decregex,function(r){return rencoding[r]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function escapexlml(e){var t=e+"";return t.replace(decregex,function(r){return rencoding[r]}).replace(htmlcharegex,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function xlml_unfixstr(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function parsexmlbool(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function utf8reada(e){for(var t="",r=0,s=0,i=0,n=0,a=0,o=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),s>191&&s<224){a=(s&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(i&63)<<6|n&63);continue}a=e.charCodeAt(r++),o=((s&7)<<18|(i&63)<<12|(n&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function utf8readb(e){var t=new_raw_buf(2*e.length),r,s,i=1,n=0,a=0,o;for(s=0;s<e.length;s+=i)i=1,(o=e.charCodeAt(s))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(s+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[n++]=a&255,t[n++]=a>>>8,a=0),t[n++]=r%256,t[n++]=r>>>8;return t.slice(0,n).toString("ucs2")}function utf8readc(e){return Buffer_from(e,"binary").toString("utf8")}var utf8corpus="foo bar bazâð£",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(e){return Buffer_from(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,i=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,i=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},htmldecode=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)s=s.replace(e[i][0],e[i][1]);return s}}(),wtregex=/(^\s|\s$|\n)/;function writetag(e,t){return"<"+e+(t.match(wtregex)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function wxt_helper(e){return keys(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function writextag(e,t,r){return"<"+e+(r!=null?wxt_helper(r):"")+(t!=null?(t.match(wtregex)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function write_w3cdtf(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function write_vt(e,t){switch(typeof e){case"string":var r=writextag("vt:lpwstr",escapexml(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return writextag((e|0)==e?"vt:i4":"vt:r8",escapexml(String(e)));case"boolean":return writextag("vt:bool",e?"true":"false")}if(e instanceof Date)return writextag("vt:filetime",write_w3cdtf(e));throw new Error("Unable to serialize "+e)}var XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],XLMLNS={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function read_double_le(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,n=5;n>=0;--n)i=i*256+e[t+n];return s==2047?i==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,i+=Math.pow(2,52)),r*Math.pow(2,s-52)*i)}function write_double_le(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,i=0,n=0,a=s?-t:t;isFinite(a)?a==0?i=n=0:(i=Math.floor(Math.log(a)/Math.LN2),n=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?i=-1022:(n-=Math.pow(2,52),i+=1023)):(i=2047,n=isNaN(t)?26985:0);for(var o=0;o<=5;++o,n/=256)e[r+o]=n&255;e[r+6]=(i&15)<<4|n&15,e[r+7]=i>>4|s}var ___toBuffer=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var i=0,n=e[0][s].length;i<n;i+=r)t.push.apply(t,e[0][s].slice(i,i+r));return t},__toBuffer=has_buf?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Buffer_from(t)})):___toBuffer(e)}:___toBuffer,___utf16le=function(e,t,r){for(var s=[],i=t;i<r;i+=2)s.push(String.fromCharCode(__readUInt16LE(e,i)));return s.join("").replace(chr0,"")},__utf16le=has_buf?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(chr0,""):___utf16le(e,t,r)}:___utf16le,___hexlify=function(e,t,r){for(var s=[],i=t;i<t+r;++i)s.push(("0"+e[i].toString(16)).slice(-2));return s.join("")},__hexlify=has_buf?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):___hexlify(e,t,r)}:___hexlify,___utf8=function(e,t,r){for(var s=[],i=t;i<r;i++)s.push(String.fromCharCode(__readUInt8(e,i)));return s.join("")},__utf8=has_buf?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):___utf8(t,r,s)}:___utf8,___lpstr=function(e,t){var r=__readUInt32LE(e,t);return r>0?__utf8(e,t+4,t+4+r-1):""},__lpstr=___lpstr,___cpstr=function(e,t){var r=__readUInt32LE(e,t);return r>0?__utf8(e,t+4,t+4+r-1):""},__cpstr=___cpstr,___lpwstr=function(e,t){var r=2*__readUInt32LE(e,t);return r>0?__utf8(e,t+4,t+4+r-1):""},__lpwstr=___lpwstr,___lpp4=function(t,r){var s=__readUInt32LE(t,r);return s>0?__utf16le(t,r+4,r+4+s):""},__lpp4=___lpp4,___8lpp4=function(e,t){var r=__readUInt32LE(e,t);return r>0?__utf8(e,t+4,t+4+r):""},__8lpp4=___8lpp4,___double=function(e,t){return read_double_le(e,t)},__double=___double,is_buf=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};has_buf&&(__lpstr=function(t,r){if(!Buffer.isBuffer(t))return ___lpstr(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},__cpstr=function(t,r){if(!Buffer.isBuffer(t))return ___cpstr(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},__lpwstr=function(t,r){if(!Buffer.isBuffer(t))return ___lpwstr(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},__lpp4=function(t,r){if(!Buffer.isBuffer(t))return ___lpp4(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},__8lpp4=function(t,r){if(!Buffer.isBuffer(t))return ___8lpp4(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},__double=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):___double(t,r)},is_buf=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var __readUInt8=function(e,t){return e[t]},__readUInt16LE=function(e,t){return e[t+1]*256+e[t]},__readInt16LE=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},__readUInt32LE=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},__readInt32LE=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},__readInt32BE=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ReadShift(e,t){var r="",s,i,n=[],a,o,d,l;switch(t){case"dbcs":if(l=this.l,has_buf&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(__readUInt16LE(this,l)),l+=2;e*=2;break;case"utf8":r=__utf8(this,this.l,this.l+e);break;case"utf16le":e*=2,r=__utf16le(this,this.l,this.l+e);break;case"wstr":return ReadShift.call(this,e,"dbcs");case"lpstr-ansi":r=__lpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":r=__cpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpwstr":r=__lpwstr(this,this.l),e=4+2*__readUInt32LE(this,this.l);break;case"lpp4":e=4+__readUInt32LE(this,this.l),r=__lpp4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+__readUInt32LE(this,this.l),r=__8lpp4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=__readUInt8(this,this.l+e++))!==0;)n.push(_getchar(a));r=n.join("");break;case"_wstr":for(e=0,r="";(a=__readUInt16LE(this,this.l+e))!==0;)n.push(_getchar(a)),e+=2;e+=2,r=n.join("");break;case"dbcs-cont":for(r="",l=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(l)!==-1)return a=__readUInt8(this,l),this.l=l+1,o=ReadShift.call(this,e-d,a?"dbcs-cont":"sbcs-cont"),n.join("")+o;n.push(_getchar(__readUInt16LE(this,l))),l+=2}r=n.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",l=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(l)!==-1)return a=__readUInt8(this,l),this.l=l+1,o=ReadShift.call(this,e-d,a?"dbcs-cont":"sbcs-cont"),n.join("")+o;n.push(_getchar(__readUInt8(this,l))),l+=1}r=n.join("");break;default:switch(e){case 1:return s=__readUInt8(this,this.l),this.l++,s;case 2:return s=(t==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(s=(e>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,s):(i=__readUInt32LE(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=__double(this,this.l):i=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=__hexlify(this,this.l,e);break}}return this.l+=e,r}var __writeUInt32LE=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},__writeInt32LE=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},__writeUInt16LE=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function WriteShift(e,t,r){var s=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)__writeUInt16LE(this,t.charCodeAt(i),this.l+2*i);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;s=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var n=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<n;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,__writeUInt32LE(this,t,this.l);break;case 8:if(s=8,r==="f"){write_double_le(this,t,this.l);break}case 16:break;case-4:s=4,__writeInt32LE(this,t,this.l);break}return this.l+=s,this}function CheckField(e,t){var r=__hexlify(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function prep_blob(e,t){e.l=t,e.read_shift=ReadShift,e.chk=CheckField,e.write_shift=WriteShift}function parsenoop(e,t){e.l+=t}function new_buf(e){var t=new_raw_buf(e);return prep_blob(t,0),t}function buf_array(){var e=[],t=has_buf?256:2048,r=function(l){var c=new_buf(l);return prep_blob(c,0),c},s=r(t),i=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},n=function(l){return s&&l<s.length-s.l?s:(i(),s=r(Math.max(l+1,t)))},a=function(){return i(),bconcat(e)},o=function(l){i(),s=l,s.l==null&&(s.l=s.length),n(t)};return{next:n,push:o,end:a,_bufs:e}}function write_record(e,t,r,s){var i=+t,n;if(!isNaN(i)){s||(s=XLSBRecordEnum[i].p||(r||[]).length||0),n=1+(i>=128?1:0)+1,s>=128&&++n,s>=16384&&++n,s>=2097152&&++n;var a=e.next(n);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(s>=128)a.write_shift(1,(s&127)+128),s>>=7;else{a.write_shift(1,s);break}s>0&&is_buf(r)&&e.push(r)}}function shift_cell_xls(e,t,r){var s=dup(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function shift_range_xls(e,t,r){var s=dup(e);return s.s=shift_cell_xls(s.s,t.s,r),s.e=shift_cell_xls(s.e,t.s,r),s}function encode_cell_xls(e,t){if(e.cRel&&e.c<0)for(e=dup(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=dup(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=encode_cell(e);return!e.cRel&&e.cRel!=null&&(r=fix_col(r)),!e.rRel&&e.rRel!=null&&(r=fix_row(r)),r}function encode_range_xls(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+encode_col(e.s.c)+":"+(e.e.cRel?"":"$")+encode_col(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+encode_row(e.s.r)+":"+(e.e.rRel?"":"$")+encode_row(e.e.r):encode_cell_xls(e.s,t.biff)+":"+encode_cell_xls(e.e,t.biff)}function decode_row(e){return parseInt(unfix_row(e),10)-1}function encode_row(e){return""+(e+1)}function fix_row(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(e){return e.replace(/\$(\d+)$/,"$1")}function decode_col(e){for(var t=unfix_col(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function encode_col(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function fix_col(e){return e.replace(/^([A-Z])/,"$$$1")}function unfix_col(e){return e.replace(/^\$([A-Z])/,"$1")}function split_cell(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(e){for(var t=0,r=0,s=0;s<e.length;++s){var i=e.charCodeAt(s);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function encode_cell(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function decode_range(e){var t=e.indexOf(":");return t==-1?{s:decode_cell(e),e:decode_cell(e)}:{s:decode_cell(e.slice(0,t)),e:decode_cell(e.slice(t+1))}}function encode_range(e,t){return typeof t>"u"||typeof t=="number"?encode_range(e.s,e.e):(typeof e!="string"&&(e=encode_cell(e)),typeof t!="string"&&(t=encode_cell(t)),e==t?e:e+":"+t)}function safe_decode_range(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,i=0,n=e.length;for(r=0;s<n&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)r=26*r+i;for(t.s.c=--r,r=0;s<n&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)r=10*r+i;if(t.s.r=--r,s===n||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=n&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)r=26*r+i;for(t.e.c=--r,r=0;s!=n&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)r=10*r+i;return t.e.r=--r,t}function safe_format_cell(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=SSF_format(e.z,r?datenum(t):t)}catch{}try{return e.w=SSF_format((e.XF||{}).numFmtId||(r?14:0),r?datenum(t):t)}catch{return""+t}}function format_cell(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?BErr[e.v]||e.v:t==null?safe_format_cell(e,e.v):safe_format_cell(e,t))}function sheet_to_workbook(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function sheet_add_aoa(e,t,r){var s=r||{},i=e?Array.isArray(e):s.dense,n=e||(i?[]:{}),a=0,o=0;if(n&&s.origin!=null){if(typeof s.origin=="number")a=s.origin;else{var d=typeof s.origin=="string"?decode_cell(s.origin):s.origin;a=d.r,o=d.c}n["!ref"]||(n["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var c=safe_decode_range(n["!ref"]);l.s.c=c.s.c,l.s.r=c.s.r,l.e.c=Math.max(l.e.c,c.e.c),l.e.r=Math.max(l.e.r,c.e.r),a==-1&&(l.e.r=a=c.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=t[f].length;++u)if(!(typeof t[f][u]>"u")){var h={v:t[f][u]},g=a+f,p=o+u;if(l.s.r>g&&(l.s.r=g),l.s.c>p&&(l.s.c=p),l.e.r<g&&(l.e.r=g),l.e.c<p&&(l.e.c=p),t[f][u]&&typeof t[f][u]=="object"&&!Array.isArray(t[f][u])&&!(t[f][u]instanceof Date))h=t[f][u];else if(Array.isArray(h.v)&&(h.f=t[f][u][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(s.nullError)h.t="e",h.v=0;else if(s.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=s.dateNF||table_fmt[14],s.cellDates?(h.t="d",h.w=SSF_format(h.z,datenum(h.v))):(h.t="n",h.v=datenum(h.v),h.w=SSF_format(h.z,h.v))):h.t="s";if(i)n[g]||(n[g]=[]),n[g][p]&&n[g][p].z&&(h.z=n[g][p].z),n[g][p]=h;else{var x=encode_cell({c:p,r:g});n[x]&&n[x].z&&(h.z=n[x].z),n[x]=h}}}return l.s.c<1e7&&(n["!ref"]=encode_range(l)),n}function aoa_to_sheet(e,t){return sheet_add_aoa(null,e,t)}function parse_Int32LE(e){return e.read_shift(4,"i")}function write_UInt32LE(e,t){return t||(t=new_buf(4)),t.write_shift(4,e),t}function parse_XLWideString(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function write_XLWideString(e,t){var r=!1;return t==null&&(r=!0,t=new_buf(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function parse_StrRun(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function write_StrRun(e,t){return t||(t=new_buf(4)),t.write_shift(2,0),t.write_shift(2,0),t}function parse_RichStr(e,t){var r=e.l,s=e.read_shift(1),i=parse_XLWideString(e),n=[],a={t:i,h:i};if(s&1){for(var o=e.read_shift(4),d=0;d!=o;++d)n.push(parse_StrRun(e));a.r=n}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function write_RichStr(e,t){var r=!1;return t==null&&(r=!0,t=new_buf(15+4*e.t.length)),t.write_shift(1,0),write_XLWideString(e.t,t),r?t.slice(0,t.l):t}var parse_BrtCommentText=parse_RichStr;function write_BrtCommentText(e,t){var r=!1;return t==null&&(r=!0,t=new_buf(23+4*e.t.length)),t.write_shift(1,1),write_XLWideString(e.t,t),t.write_shift(4,1),write_StrRun({},t),r?t.slice(0,t.l):t}function parse_XLSBCell(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function write_XLSBCell(e,t){return t==null&&(t=new_buf(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function parse_XLSBShortCell(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function write_XLSBShortCell(e,t){return t==null&&(t=new_buf(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var parse_XLSBCodeName=parse_XLWideString,write_XLSBCodeName=write_XLWideString;function parse_XLNullableWideString(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function write_XLNullableWideString(e,t){var r=!1;return t==null&&(r=!0,t=new_buf(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString,write_RelID=write_XLNullableWideString;function parse_RkNumber(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var i=s===0?__double([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):__readInt32LE(t,0)>>2;return r?i/100:i}function write_RkNumber(e,t){t==null&&(t=new_buf(4));var r=0,s=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function parse_RfX(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function write_RfX(e,t){return t||(t=new_buf(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var parse_UncheckedRfX=parse_RfX,write_UncheckedRfX=write_RfX;function parse_Xnum(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function write_Xnum(e,t){return(t||new_buf(8)).write_shift(8,e,"f")}function parse_BrtColor(e){var t={},r=e.read_shift(1),s=r>>>1,i=e.read_shift(1),n=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),d=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=i;var l=XLSIcv[i];l&&(t.rgb=rgb2Hex(l));break;case 2:t.rgb=rgb2Hex([a,o,d]);break;case 3:t.theme=i;break}return n!=0&&(t.tint=n>0?n/32767:n/32768),t}function write_BrtColor(e,t){if(t||(t=new_buf(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function parse_FontFlags(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function write_FontFlags(e,t){t||(t=new_buf(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}};function rgbify(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},CT_LIST={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function write_ct(e,t){var r=evert_arr(ct2type),s=[],i;s[s.length]=XML_HEADER,s[s.length]=writextag("Types",null,{xmlns:XMLNS.CT,"xmlns:xsd":XMLNS.xsd,"xmlns:xsi":XMLNS.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return writextag("Default",null,{Extension:d[0],ContentType:d[1]})}));var n=function(d){e[d]&&e[d].length>0&&(i=e[d][0],s[s.length]=writextag("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:CT_LIST[d][t.bookType]||CT_LIST[d].xlsx}))},a=function(d){(e[d]||[]).forEach(function(l){s[s.length]=writextag("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:CT_LIST[d][t.bookType]||CT_LIST[d].xlsx})})},o=function(d){(e[d]||[]).forEach(function(l){s[s.length]=writextag("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:r[d][0]})})};return n("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(n),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function write_rels(e){var t=[XML_HEADER,writextag("Relationships",null,{xmlns:XMLNS.RELS})];return keys(e["!id"]).forEach(function(r){t[t.length]=writextag("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function add_rels(e,t,r,s,i,n){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=s,i.Target=r,[RELS.HLINK,RELS.XPATH,RELS.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function write_manifest(e){var t=[XML_HEADER];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function write_rdf_type(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf_has(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf(e){var t=[XML_HEADER];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(write_rdf_type(e[r][0],e[r][1])),t.push(write_rdf_has("",e[r][0]));return t.push(write_rdf_type("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function write_meta_ods(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+XLSX.version+"</meta:generator></office:meta></office:document-meta>"}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function cp_doit(e,t,r,s,i){i[e]!=null||t==null||t===""||(i[e]=t,t=escapexml(t),s[s.length]=r?writextag(e,t,r):writetag(e,t))}function write_core_props(e,t){var r=t||{},s=[XML_HEADER,writextag("cp:coreProperties",null,{"xmlns:cp":XMLNS.CORE_PROPS,"xmlns:dc":XMLNS.dc,"xmlns:dcterms":XMLNS.dcterms,"xmlns:dcmitype":XMLNS.dcmitype,"xmlns:xsi":XMLNS.xsi})],i={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&cp_doit("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:write_w3cdtf(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,i),e.ModifiedDate!=null&&cp_doit("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:write_w3cdtf(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,i));for(var n=0;n!=CORE_PROPS.length;++n){var a=CORE_PROPS[n],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&cp_doit(a[0],o,null,s,i)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PseudoPropsPairs=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function write_ext_props(e){var t=[],r=writextag;return e||(e={}),e.Application="SheetJS",t[t.length]=XML_HEADER,t[t.length]=writextag("Properties",null,{xmlns:XMLNS.EXT_PROPS,"xmlns:vt":XMLNS.vt}),EXT_PROPS.forEach(function(s){if(e[s[1]]!==void 0){var i;switch(s[2]){case"string":i=escapexml(String(e[s[1]]));break;case"bool":i=e[s[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(s[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+escapexml(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function write_cust_props(e){var t=[XML_HEADER,writextag("Properties",null,{xmlns:XMLNS.CUST_PROPS,"xmlns:vt":XMLNS.vt})];if(!e)return t.join("");var r=1;return keys(e).forEach(function(i){++r,t[t.length]=writextag("property",write_vt(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:escapexml(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function xlml_write_docprops(e,t){var r=[];return keys(XLMLDocPropsMap).map(function(s){for(var i=0;i<CORE_PROPS.length;++i)if(CORE_PROPS[i][1]==s)return CORE_PROPS[i];for(i=0;i<EXT_PROPS.length;++i)if(EXT_PROPS[i][1]==s)return EXT_PROPS[i];throw s}).forEach(function(s){if(e[s[1]]!=null){var i=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];switch(s[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(writetag(XLMLDocPropsMap[s[1]]||s[1],i))}}),writextag("DocumentProperties",r.join(""),{xmlns:XLMLNS.o})}function xlml_write_custprops(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",i=[];return e&&keys(e).forEach(function(n){if(Object.prototype.hasOwnProperty.call(e,n)){for(var a=0;a<CORE_PROPS.length;++a)if(n==CORE_PROPS[a][1])return;for(a=0;a<EXT_PROPS.length;++a)if(n==EXT_PROPS[a][1])return;for(a=0;a<r.length;++a)if(n==r[a])return;var o=e[n],d="string";typeof o=="number"?(d="float",o=String(o)):o===!0||o===!1?(d="boolean",o=o?"1":"0"):o=String(o),i.push(writextag(escapexmltag(n),o,{"dt:dt":d}))}}),t&&keys(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&!(e&&Object.prototype.hasOwnProperty.call(e,n))){var a=t[n],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(writextag(escapexmltag(n),a,{"dt:dt":o}))}}),"<"+s+' xmlns="'+XLMLNS.o+'">'+i.join("")+"</"+s+">"}function write_FILETIME(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),i=(r-s)/Math.pow(2,32);s*=1e7,i*=1e7;var n=s/Math.pow(2,32)|0;n>0&&(s=s%Math.pow(2,32),i+=n);var a=new_buf(8);return a.write_shift(4,s),a.write_shift(4,i),a}function write_TypedPropertyValue(e,t){var r=new_buf(4),s=new_buf(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=new_buf(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=write_FILETIME(t);break;case 31:case 80:for(s=new_buf(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return bconcat([r,s])}var XLSPSSkip=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function guess_property_type(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function write_PropertySet(e,t,r){var s=new_buf(8),i=[],n=[],a=8,o=0,d=new_buf(8),l=new_buf(8);if(d.write_shift(4,2),d.write_shift(4,1200),l.write_shift(4,1),n.push(d),i.push(l),a+=8+d.length,!t){l=new_buf(8),l.write_shift(4,0),i.unshift(l);var c=[new_buf(4)];for(c[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(d=new_buf(8+2*(f.length+1)+(f.length%2?0:2)),d.write_shift(4,o+2),d.write_shift(4,f.length+1),d.write_shift(0,f,"dbcs");d.l!=d.length;)d.write_shift(1,0);c.push(d)}d=bconcat(c),n.unshift(d),a+=8+d.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(XLSPSSkip.indexOf(e[o][0])>-1||PseudoPropsPairs.indexOf(e[o][0])>-1)&&e[o][1]!=null){var u=e[o][1],h=0;if(t){h=+t[e[o][0]];var g=r[h];if(g.p=="version"&&typeof u=="string"){var p=u.split(".");u=(+p[0]<<16)+(+p[1]||0)}d=write_TypedPropertyValue(g.t,u)}else{var x=guess_property_type(u);x==-1&&(x=31,u=String(u)),d=write_TypedPropertyValue(x,u)}n.push(d),l=new_buf(8),l.write_shift(4,t?h:2+o),i.push(l),a+=8+d.length}var E=8*(n.length+1);for(o=0;o<n.length;++o)i[o].write_shift(4,E),E+=n[o].length;return s.write_shift(4,a),s.write_shift(4,n.length),bconcat([s].concat(i).concat(n))}function write_PropertySetStream(e,t,r,s,i,n){var a=new_buf(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,CFB.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var d=write_PropertySet(e,r,s);if(o.push(d),i){var l=write_PropertySet(i,null,null);a.write_shift(16,n,"hex"),a.write_shift(4,68+d.length),o.push(l)}return bconcat(o)}function writezeroes(e,t){t||(t=new_buf(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function parsebool(e,t){return e.read_shift(t)===1}function writebool(e,t){return t||(t=new_buf(2)),t.write_shift(2,+!!e),t}function parseuint16(e){return e.read_shift(2,"u")}function writeuint16(e,t){return t||(t=new_buf(2)),t.write_shift(2,e),t}function write_Bes(e,t,r){return r||(r=new_buf(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function parse_ShortXLUnicodeString(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var n=e.read_shift(1);n&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=s?e.read_shift(s,i):"";return a}function write_XLUnicodeRichExtendedString(e){var t=e.t||"",r=new_buf(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=new_buf(2*t.length);s.write_shift(2*t.length,t,"utf16le");var i=[r,s];return bconcat(i)}function parse_XLUnicodeStringNoCch(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function parse_XLUnicodeString(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):parse_XLUnicodeStringNoCch(e,s,r)}function parse_XLUnicodeString2(e,t,r){if(r.biff>5)return parse_XLUnicodeString(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function write_XLUnicodeString(e,t,r){return r||(r=new_buf(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function write_HyperlinkString(e,t){t||(t=new_buf(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function write_Hyperlink(e){var t=new_buf(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var i=s.indexOf("#"),n=i>-1?31:23;switch(s.charAt(0)){case"#":n=28;break;case".":n&=-3;break}t.write_shift(4,2),t.write_shift(4,n);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(n==28)s=s.slice(1),write_HyperlinkString(s,t);else if(n&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var o=i>-1?s.slice(0,i):s;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),n&8&&write_HyperlinkString(i>-1?s.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var d=0;s.slice(d*3,d*3+3)=="../"||s.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,s.length-3*d+1),r=0;r<s.length-3*d;++r)t.write_shift(1,s.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function write_XLSCell(e,t,r,s){return s||(s=new_buf(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function parse_XTI(e,t,r){var s=r.biff>8?4:2,i=e.read_shift(s),n=e.read_shift(s,"i"),a=e.read_shift(s,"i");return[i,n,a]}function parse_Ref8U(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);return{s:{c:s,r:t},e:{c:i,r}}}function write_Ref8U(e,t){return t||(t=new_buf(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function write_BOF(e,t,r){var s=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,i=8;break;case"biff4":s=4,i=6;break;case"biff3":s=3,i=6;break;case"biff2":s=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var n=new_buf(i);return n.write_shift(2,s),n.write_shift(2,t),i>4&&n.write_shift(2,29282),i>6&&n.write_shift(2,1997),i>8&&(n.write_shift(2,49161),n.write_shift(2,1),n.write_shift(2,1798),n.write_shift(2,0)),n}function write_WriteAccess(e,t){var r=!t||t.biff==8,s=new_buf(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function write_BoundSheet8(e,t){var r=!t||t.biff>=8?2:1,s=new_buf(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=s.slice(0,s.l);return i.l=s.l,i}function write_SST(e,t){var r=new_buf(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],i=0;i<e.length;++i)s[i]=write_XLUnicodeRichExtendedString(e[i]);var n=bconcat([r].concat(s));return n.parts=[r.length].concat(s.map(function(a){return a.length})),n}function write_Window1(){var e=new_buf(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function write_Window2(e){var t=new_buf(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function write_Font(e,t){var r=e.name||"Arial",s=t&&t.biff==5,i=s?15+r.length:16+2*r.length,n=new_buf(i);return n.write_shift(2,e.sz*20),n.write_shift(4,0),n.write_shift(2,400),n.write_shift(4,0),n.write_shift(2,0),n.write_shift(1,r.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),n}function write_LabelSst(e,t,r,s){var i=new_buf(10);return write_XLSCell(e,t,s,i),i.write_shift(4,r),i}function write_Label(e,t,r,s,i){var n=!i||i.biff==8,a=new_buf(8+ +n+(1+n)*r.length);return write_XLSCell(e,t,s,a),a.write_shift(2,r.length),n&&a.write_shift(1,1),a.write_shift((1+n)*r.length,r,n?"utf16le":"sbcs"),a}function write_Format(e,t,r,s){var i=r&&r.biff==5;s||(s=new_buf(i?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(i?1:2,t.length),i||s.write_shift(1,1),s.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var n=s.length>s.l?s.slice(0,s.l):s;return n.l==null&&(n.l=n.length),n}function write_Dimensions(e,t){var r=t.biff==8||!t.biff?4:2,s=new_buf(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function write_XF(e,t,r,s){var i=r&&r.biff==5;s||(s=new_buf(i?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var n=0;return e.numFmtId>0&&i&&(n|=1024),s.write_shift(4,n),s.write_shift(4,0),i||s.write_shift(4,0),s.write_shift(2,0),s}function write_Guts(e){var t=new_buf(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function write_BoolErr(e,t,r,s,i,n){var a=new_buf(8);return write_XLSCell(e,t,s,a),write_Bes(r,n,a),a}function write_Number(e,t,r,s){var i=new_buf(14);return write_XLSCell(e,t,s,i),write_Xnum(r,i),i}function parse_ExternSheet(e,t,r){if(r.biff<8)return parse_BIFF5ExternSheet(e,t,r);for(var s=[],i=e.l+t,n=e.read_shift(r.biff>8?4:2);n--!==0;)s.push(parse_XTI(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return s}function parse_BIFF5ExternSheet(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=parse_ShortXLUnicodeString(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function write_MergeCells(e){var t=new_buf(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)write_Ref8U(e[r],t);return t}function write_HLink(e){var t=new_buf(24),r=decode_cell(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(s[i],16));return bconcat([t,write_Hyperlink(e[1])])}function write_HLinkTooltip(e){var t=e[1].Tooltip,r=new_buf(10+2*(t.length+1));r.write_shift(2,2048);var s=decode_cell(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function write_Country(e){return e||(e=new_buf(4)),e.write_shift(2,1),e.write_shift(2,1),e}function parse_ColInfo(e,t,r){if(!r.cellStyles)return parsenoop(e,t);var s=r&&r.biff>=12?4:2,i=e.read_shift(s),n=e.read_shift(s),a=e.read_shift(s),o=e.read_shift(s),d=e.read_shift(2);s==2&&(e.l+=2);var l={s:i,e:n,w:a,ixfe:o,flags:d};return(r.biff>=5||!r.biff)&&(l.level=d>>8&7),l}function write_ColInfo(e,t){var r=new_buf(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function write_RRTabId(e){for(var t=new_buf(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function write_BIFF2NUM(e,t,r){var s=new_buf(15);return write_BIFF2Cell(s,e,t),s.write_shift(8,r,"f"),s}function write_BIFF2INT(e,t,r){var s=new_buf(9);return write_BIFF2Cell(s,e,t),s.write_shift(2,r),s}var DBF=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,d){var l=[],c=new_raw_buf(1);switch(d.type){case"base64":c=s2a(Base64_decode(o));break;case"binary":c=s2a(o);break;case"buffer":case"array":c=o;break}prep_blob(c,0);var f=c.read_shift(1),u=!!(f&136),h=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,u=!0;break;case 49:h=!0,u=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,x=521;f==2&&(p=c.read_shift(2)),c.l+=3,f!=2&&(p=c.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(x=c.read_shift(2));var E=c.read_shift(2),S=d.codepage||1252;f!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(S=e[c[c.l]]),c.l+=1,c.l+=2),g&&(c.l+=36);for(var P=[],F={},A=Math.min(c.length,f==2?521:x-10-(h?264:0)),C=g?32:11;c.l<A&&c[c.l]!=13;)switch(F={},F.name=$cptable.utils.decode(S,c.slice(c.l,c.l+C)).replace(/[\u0000\r\n].*$/g,""),c.l+=C,F.type=String.fromCharCode(c.read_shift(1)),f!=2&&!g&&(F.offset=c.read_shift(4)),F.len=c.read_shift(1),f==2&&(F.offset=c.read_shift(2)),F.dec=c.read_shift(1),F.name.length&&P.push(F),f!=2&&(c.l+=g?13:14),F.type){case"B":(!h||F.len!=8)&&d.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(c[c.l]!==13&&(c.l=x-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=x;var _=0,w=0;for(l[0]=[],w=0;w!=P.length;++w)l[0][w]=P[w].name;for(;p-- >0;){if(c[c.l]===42){c.l+=E;continue}for(++c.l,l[++_]=[],w=0,w=0;w!=P.length;++w){var T=c.slice(c.l,c.l+P[w].len);c.l+=P[w].len,prep_blob(T,0);var M=$cptable.utils.decode(S,T);switch(P[w].type){case"C":M.trim().length&&(l[_][w]=M.replace(/\s+$/,""));break;case"D":M.length===8?l[_][w]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):l[_][w]=M;break;case"F":l[_][w]=parseFloat(M.trim());break;case"+":case"I":l[_][w]=g?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":l[_][w]=!0;break;case"N":case"F":l[_][w]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));l[_][w]="##MEMO##"+(g?parseInt(M.trim(),10):T.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(l[_][w]=+M||0);break;case"@":l[_][w]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":l[_][w]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":l[_][w]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[_][w]=-T.read_shift(-8,"f");break;case"B":if(h&&P[w].len==8){l[_][w]=T.read_shift(8,"f");break}case"G":case"P":T.l+=P[w].len;break;case"0":if(P[w].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+P[w].type)}}}if(f!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return d&&d.sheetRows&&(l=l.slice(0,d.sheetRows)),d.DBF=P,l}function s(o,d){var l=d||{};l.dateNF||(l.dateNF="yyyymmdd");var c=aoa_to_sheet(r(o,l),l);return c["!cols"]=l.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete l.DBF,c}function i(o,d){try{return sheet_to_workbook(s(o,d),d)}catch(l){if(d&&d.WTF)throw l}return{SheetNames:[],Sheets:{}}}var n={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,d){var l=d||{};if(+l.codepage>=0&&set_cp(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var c=buf_array(),f=sheet_to_json(o,{header:1,raw:!0,cellDates:!0}),u=f[0],h=f.slice(1),g=o["!cols"]||[],p=0,x=0,E=0,S=1;for(p=0;p<u.length;++p){if(((g[p]||{}).DBF||{}).name){u[p]=g[p].DBF.name,++E;continue}if(u[p]!=null){if(++E,typeof u[p]=="number"&&(u[p]=u[p].toString(10)),typeof u[p]!="string")throw new Error("DBF Invalid column name "+u[p]+" |"+typeof u[p]+"|");if(u.indexOf(u[p])!==p){for(x=0;x<1024;++x)if(u.indexOf(u[p]+"_"+x)==-1){u[p]+="_"+x;break}}}}var P=safe_decode_range(o["!ref"]),F=[],A=[],C=[];for(p=0;p<=P.e.c-P.s.c;++p){var _="",w="",T=0,M=[];for(x=0;x<h.length;++x)h[x][p]!=null&&M.push(h[x][p]);if(M.length==0||u[p]==null){F[p]="?";continue}for(x=0;x<M.length;++x){switch(typeof M[x]){case"number":w="B";break;case"string":w="C";break;case"boolean":w="L";break;case"object":w=M[x]instanceof Date?"D":"C";break;default:w="C"}T=Math.max(T,String(M[x]).length),_=_&&_!=w?"C":w}T>250&&(T=250),w=((g[p]||{}).DBF||{}).type,w=="C"&&g[p].DBF.len>T&&(T=g[p].DBF.len),_=="B"&&w=="N"&&(_="N",C[p]=g[p].DBF.dec,T=g[p].DBF.len),A[p]=_=="C"||w=="N"?T:n[_]||0,S+=A[p],F[p]=_}var R=c.next(32);for(R.write_shift(4,318902576),R.write_shift(4,h.length),R.write_shift(2,296+32*E),R.write_shift(2,S),p=0;p<4;++p)R.write_shift(4,0);for(R.write_shift(4,0|(+t[current_ansi]||3)<<8),p=0,x=0;p<u.length;++p)if(u[p]!=null){var k=c.next(32),L=(u[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);k.write_shift(1,L,"sbcs"),k.write_shift(1,F[p]=="?"?"C":F[p],"sbcs"),k.write_shift(4,x),k.write_shift(1,A[p]||n[F[p]]||0),k.write_shift(1,C[p]||0),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(1,0),k.write_shift(4,0),k.write_shift(4,0),x+=A[p]||n[F[p]]||0}var ae=c.next(264);for(ae.write_shift(4,13),p=0;p<65;++p)ae.write_shift(4,0);for(p=0;p<h.length;++p){var Q=c.next(S);for(Q.write_shift(1,0),x=0;x<u.length;++x)if(u[x]!=null)switch(F[x]){case"L":Q.write_shift(1,h[p][x]==null?63:h[p][x]?84:70);break;case"B":Q.write_shift(8,h[p][x]||0,"f");break;case"N":var oe="0";for(typeof h[p][x]=="number"&&(oe=h[p][x].toFixed(C[x]||0)),E=0;E<A[x]-oe.length;++E)Q.write_shift(1,32);Q.write_shift(1,oe,"sbcs");break;case"D":h[p][x]?(Q.write_shift(4,("0000"+h[p][x].getFullYear()).slice(-4),"sbcs"),Q.write_shift(2,("00"+(h[p][x].getMonth()+1)).slice(-2),"sbcs"),Q.write_shift(2,("00"+h[p][x].getDate()).slice(-2),"sbcs")):Q.write_shift(8,"00000000","sbcs");break;case"C":var re=String(h[p][x]!=null?h[p][x]:"").slice(0,A[x]);for(Q.write_shift(1,re,"sbcs"),E=0;E<A[x]-re.length;++E)Q.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:i,to_sheet:s,from_sheet:a}}(),SYLK=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+keys(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(u,h){var g=e[h];return typeof g=="number"?_getansi(g):g},s=function(u,h,g){var p=h.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?u:_getansi(p)};e["|"]=254;function i(u,h){switch(h.type){case"base64":return n(Base64_decode(u),h);case"binary":return n(u,h);case"buffer":return n(has_buf&&Buffer.isBuffer(u)?u.toString("binary"):a2s(u),h);case"array":return n(cc2str(u),h)}throw new Error("Unrecognized type "+h.type)}function n(u,h){var g=u.split(/[\n\r]+/),p=-1,x=-1,E=0,S=0,P=[],F=[],A=null,C={},_=[],w=[],T=[],M=0,R;for(+h.codepage>=0&&set_cp(+h.codepage);E!==g.length;++E){M=0;var k=g[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),L=k.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),ae=L[0],Q;if(k.length>0)switch(ae){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&F.push(k.slice(3).replace(/;;/g,";"));break;case"C":var oe=!1,re=!1,me=!1,H=!1,ie=-1,le=-1;for(S=1;S<L.length;++S)switch(L[S].charAt(0)){case"A":break;case"X":x=parseInt(L[S].slice(1))-1,re=!0;break;case"Y":for(p=parseInt(L[S].slice(1))-1,re||(x=0),R=P.length;R<=p;++R)P[R]=[];break;case"K":Q=L[S].slice(1),Q.charAt(0)==='"'?Q=Q.slice(1,Q.length-1):Q==="TRUE"?Q=!0:Q==="FALSE"?Q=!1:isNaN(fuzzynum(Q))?isNaN(fuzzydate(Q).getDate())||(Q=parseDate(Q)):(Q=fuzzynum(Q),A!==null&&fmt_is_date(A)&&(Q=numdate(Q))),oe=!0;break;case"E":H=!0;var N=rc_to_a1(L[S].slice(1),{r:p,c:x});P[p][x]=[P[p][x],N];break;case"S":me=!0,P[p][x]=[P[p][x],"S5S"];break;case"G":break;case"R":ie=parseInt(L[S].slice(1))-1;break;case"C":le=parseInt(L[S].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+k)}if(oe&&(P[p][x]&&P[p][x].length==2?P[p][x][0]=Q:P[p][x]=Q,A=null),me){if(H)throw new Error("SYLK shared formula cannot have own formula");var b=ie>-1&&P[ie][le];if(!b||!b[1])throw new Error("SYLK shared formula cannot find base");P[p][x][1]=shift_formula_str(b[1],{r:p-ie,c:x-le})}break;case"F":var v=0;for(S=1;S<L.length;++S)switch(L[S].charAt(0)){case"X":x=parseInt(L[S].slice(1))-1,++v;break;case"Y":for(p=parseInt(L[S].slice(1))-1,R=P.length;R<=p;++R)P[R]=[];break;case"M":M=parseInt(L[S].slice(1))/20;break;case"F":break;case"G":break;case"P":A=F[parseInt(L[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=L[S].slice(1).split(" "),R=parseInt(T[0],10);R<=parseInt(T[1],10);++R)M=parseInt(T[2],10),w[R-1]=M===0?{hidden:!0}:{wch:M},process_col(w[R-1]);break;case"C":x=parseInt(L[S].slice(1))-1,w[x]||(w[x]={});break;case"R":p=parseInt(L[S].slice(1))-1,_[p]||(_[p]={}),M>0?(_[p].hpt=M,_[p].hpx=pt2px(M)):M===0&&(_[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+k)}v<1&&(A=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+k)}}return _.length>0&&(C["!rows"]=_),w.length>0&&(C["!cols"]=w),h&&h.sheetRows&&(P=P.slice(0,h.sheetRows)),[P,C]}function a(u,h){var g=i(u,h),p=g[0],x=g[1],E=aoa_to_sheet(p,h);return keys(x).forEach(function(S){E[S]=x[S]}),E}function o(u,h){return sheet_to_workbook(a(u,h),h)}function d(u,h,g,p){var x="C;Y"+(g+1)+";X"+(p+1)+";K";switch(u.t){case"n":x+=u.v||0,u.f&&!u.F&&(x+=";E"+a1_to_rc(u.f,{r:g,c:p}));break;case"b":x+=u.v?"TRUE":"FALSE";break;case"e":x+=u.w||u.v;break;case"d":x+='"'+(u.w||u.v)+'"';break;case"s":x+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function l(u,h){h.forEach(function(g,p){var x="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?x+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=width2px(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=px2char(g.wpx)),typeof g.wch=="number"&&(x+=Math.round(g.wch))),x.charAt(x.length-1)!=" "&&u.push(x)})}function c(u,h){h.forEach(function(g,p){var x="F;";g.hidden?x+="M0;":g.hpt?x+="M"+20*g.hpt+";":g.hpx&&(x+="M"+20*px2pt(g.hpx)+";"),x.length>2&&u.push(x+"R"+(p+1))})}function f(u,h){var g=["ID;PWXL;N;E"],p=[],x=safe_decode_range(u["!ref"]),E,S=Array.isArray(u),P=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),u["!cols"]&&l(g,u["!cols"]),u["!rows"]&&c(g,u["!rows"]),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var F=x.s.r;F<=x.e.r;++F)for(var A=x.s.c;A<=x.e.c;++A){var C=encode_cell({r:F,c:A});E=S?(u[F]||[])[A]:u[C],!(!E||E.v==null&&(!E.f||E.F))&&p.push(d(E,u,F,A))}return g.join(P)+P+p.join(P)+P+"E"+P}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),DIF=function(){function e(n,a){switch(a.type){case"base64":return t(Base64_decode(n),a);case"binary":return t(n,a);case"buffer":return t(has_buf&&Buffer.isBuffer(n)?n.toString("binary"):a2s(n),a);case"array":return t(cc2str(n),a)}throw new Error("Unrecognized type "+a.type)}function t(n,a){for(var o=n.split(`
`),d=-1,l=-1,c=0,f=[];c!==o.length;++c){if(o[c].trim()==="BOT"){f[++d]=[],l=0;continue}if(!(d<0)){var u=o[c].trim().split(","),h=u[0],g=u[1];++c;for(var p=o[c]||"";(p.match(/["]/g)||[]).length&1&&c<o.length-1;)p+=`
`+o[++c];switch(p=p.trim(),+h){case-1:if(p==="BOT"){f[++d]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[d][l]=!0:p==="FALSE"?f[d][l]=!1:isNaN(fuzzynum(g))?isNaN(fuzzydate(g).getDate())?f[d][l]=g:f[d][l]=parseDate(g):f[d][l]=fuzzynum(g),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[d][l++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(n,a){return aoa_to_sheet(e(n,a),a)}function s(n,a){return sheet_to_workbook(r(n,a),a)}var i=function(){var n=function(d,l,c,f,u){d.push(l),d.push(c+","+f),d.push('"'+u.replace(/"/g,'""')+'"')},a=function(d,l,c,f){d.push(l+","+c),d.push(l==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(d){var l=[],c=safe_decode_range(d["!ref"]),f,u=Array.isArray(d);n(l,"TABLE",0,1,"sheetjs"),n(l,"VECTORS",0,c.e.r-c.s.r+1,""),n(l,"TUPLES",0,c.e.c-c.s.c+1,""),n(l,"DATA",0,0,"");for(var h=c.s.r;h<=c.e.r;++h){a(l,-1,0,"BOT");for(var g=c.s.c;g<=c.e.c;++g){var p=encode_cell({r:h,c:g});if(f=u?(d[h]||[])[g]:d[p],!f){a(l,1,0,"");continue}switch(f.t){case"n":var x=f.w;!x&&f.v!=null&&(x=f.v),x==null?f.f&&!f.F?a(l,1,0,"="+f.f):a(l,1,0,""):a(l,0,x,"V");break;case"b":a(l,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(l,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=SSF_format(f.z||table_fmt[14],datenum(parseDate(f.v)))),a(l,0,f.w,"V");break;default:a(l,1,0,"")}}}a(l,-1,0,"EOD");var E=`\r
`,S=l.join(E);return S}}();return{to_workbook:s,to_sheet:r,from_sheet:i}}(),ETH=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,u){for(var h=f.split(`
`),g=-1,p=-1,x=0,E=[];x!==h.length;++x){var S=h[x].trim().split(":");if(S[0]==="cell"){var P=decode_cell(S[1]);if(E.length<=P.r)for(g=E.length;g<=P.r;++g)E[g]||(E[g]=[]);switch(g=P.r,p=P.c,S[2]){case"t":E[g][p]=e(S[3]);break;case"v":E[g][p]=+S[3];break;case"vtf":var F=S[S.length-1];case"vtc":switch(S[3]){case"nl":E[g][p]=!!+S[4];break;default:E[g][p]=+S[4];break}S[2]=="vtf"&&(E[g][p]=[E[g][p],F])}}}return u&&u.sheetRows&&(E=E.slice(0,u.sheetRows)),E}function s(f,u){return aoa_to_sheet(r(f,u),u)}function i(f,u){return sheet_to_workbook(s(f,u),u)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function l(f){if(!f||!f["!ref"])return"";for(var u=[],h=[],g,p="",x=decode_range(f["!ref"]),E=Array.isArray(f),S=x.s.r;S<=x.e.r;++S)for(var P=x.s.c;P<=x.e.c;++P)if(p=encode_cell({r:S,c:P}),g=E?(f[S]||[])[P]:f[p],!(!g||g.v==null||g.t==="z")){switch(h=["cell",p,"t"],g.t){case"s":case"str":h.push(t(g.v));break;case"n":g.f?(h[2]="vtf",h[3]="n",h[4]=g.v,h[5]=t(g.f)):(h[2]="v",h[3]=g.v);break;case"b":h[2]="vt"+(g.f?"f":"c"),h[3]="nl",h[4]=g.v?"1":"0",h[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var F=datenum(parseDate(g.v));h[2]="vtc",h[3]="nd",h[4]=""+F,h[5]=g.w||SSF_format(g.z||table_fmt[14],F);break;case"e":continue}u.push(h.join(":"))}return u.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function c(f){return[n,a,o,a,l(f),d].join(`
`)}return{to_workbook:i,to_sheet:s,from_sheet:c}}(),PRN=function(){function e(c,f,u,h,g){g.raw?f[u][h]=c:c===""||(c==="TRUE"?f[u][h]=!0:c==="FALSE"?f[u][h]=!1:isNaN(fuzzynum(c))?isNaN(fuzzydate(c).getDate())?f[u][h]=c:f[u][h]=parseDate(c):f[u][h]=fuzzynum(c))}function t(c,f){var u=f||{},h=[];if(!c||c.length===0)return h;for(var g=c.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var x=10,E=0,S=0;S<=p;++S)E=g[S].indexOf(" "),E==-1?E=g[S].length:E++,x=Math.max(x,E);for(S=0;S<=p;++S){h[S]=[];var P=0;for(e(g[S].slice(0,x).trim(),h,S,P,u),P=1;P<=(g[S].length-x)/10+1;++P)e(g[S].slice(x+(P-1)*10,x+P*10).trim(),h,S,P,u)}return u.sheetRows&&(h=h.slice(0,u.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function i(c){for(var f={},u=!1,h=0,g=0;h<c.length;++h)(g=c.charCodeAt(h))==34?u=!u:!u&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&g.push([f[h],h]);if(!g.length){f=s;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&g.push([f[h],h])}return g.sort(function(p,x){return p[0]-x[0]||s[p[1]]-s[x[1]]}),r[g.pop()[1]]||44}function n(c,f){var u=f||{},h="",g=u.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(h=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(h=c.charAt(4),c=c.slice(6)):h=i(c.slice(0,1024)):u&&u.FS?h=u.FS:h=i(c.slice(0,1024));var x=0,E=0,S=0,P=0,F=0,A=h.charCodeAt(0),C=!1,_=0,w=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var T=u.dateNF!=null?dateNF_regex(u.dateNF):null;function M(){var R=c.slice(P,F),k={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)k.t="z";else if(u.raw)k.t="s",k.v=R;else if(R.trim().length===0)k.t="s",k.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(k.t="s",k.v=R.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(R)?(k.t="n",k.f=R.slice(1)):(k.t="s",k.v=R);else if(R=="TRUE")k.t="b",k.v=!0;else if(R=="FALSE")k.t="b",k.v=!1;else if(!isNaN(S=fuzzynum(R)))k.t="n",u.cellText!==!1&&(k.w=R),k.v=S;else if(!isNaN(fuzzydate(R).getDate())||T&&R.match(T)){k.z=u.dateNF||table_fmt[14];var L=0;T&&R.match(T)&&(R=dateNF_fix(R,u.dateNF,R.match(T)||[]),L=1),u.cellDates?(k.t="d",k.v=parseDate(R,L)):(k.t="n",k.v=datenum(parseDate(R,L))),u.cellText!==!1&&(k.w=SSF_format(k.z,k.v instanceof Date?datenum(k.v):k.v)),u.cellNF||delete k.z}else k.t="s",k.v=R;if(k.t=="z"||(u.dense?(g[x]||(g[x]=[]),g[x][E]=k):g[encode_cell({c:E,r:x})]=k),P=F+1,w=c.charCodeAt(P),p.e.c<E&&(p.e.c=E),p.e.r<x&&(p.e.r=x),_==A)++E;else if(E=0,++x,u.sheetRows&&u.sheetRows<=x)return!0}e:for(;F<c.length;++F)switch(_=c.charCodeAt(F)){case 34:w===34&&(C=!C);break;case A:case 10:case 13:if(!C&&M())break e;break}return F-P>0&&M(),g["!ref"]=encode_range(p),g}function a(c,f){return!(f&&f.PRN)||f.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?n(c,f):aoa_to_sheet(t(c,f),f)}function o(c,f){var u="",h=f.type=="string"?[0,0,0,0]:firstbyte(c,f);switch(f.type){case"base64":u=Base64_decode(c);break;case"binary":u=c;break;case"buffer":f.codepage==65001?u=c.toString("utf8"):f.codepage&&typeof $cptable<"u"||(u=has_buf&&Buffer.isBuffer(c)?c.toString("binary"):a2s(c));break;case"array":u=cc2str(c);break;case"string":u=c;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?u=utf8read(u.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?u=utf8read(u):f.type=="binary"&&typeof $cptable<"u",u.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(f.type=="string"?u:utf8read(u),f):a(u,f)}function d(c,f){return sheet_to_workbook(o(c,f),f)}function l(c){for(var f=[],u=safe_decode_range(c["!ref"]),h,g=Array.isArray(c),p=u.s.r;p<=u.e.r;++p){for(var x=[],E=u.s.c;E<=u.e.c;++E){var S=encode_cell({r:p,c:E});if(h=g?(c[p]||[])[E]:c[S],!h||h.v==null){x.push("          ");continue}for(var P=(h.w||(format_cell(h),h.w)||"").slice(0,10);P.length<10;)P+=" ";x.push(P+(E===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:d,to_sheet:o,from_sheet:l}}(),WK_=function(){function e(N,b,v){if(N){prep_blob(N,N.l||0);for(var j=v.Enum||ie;N.l<N.length;){var D=N.read_shift(2),U=j[D]||j[65535],W=N.read_shift(2),Z=N.l+W,te=U.f&&U.f(N,W,v);if(N.l=Z,b(te,U,D))return}}}function t(N,b){switch(b.type){case"base64":return r(s2a(Base64_decode(N)),b);case"binary":return r(s2a(N),b);case"buffer":case"array":return r(N,b)}throw"Unsupported type "+b.type}function r(N,b){if(!N)return N;var v=b||{},j=v.dense?[]:{},D="Sheet1",U="",W=0,Z={},te=[],ve=[],xe={s:{r:0,c:0},e:{r:0,c:0}},Re=v.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)v.Enum=ie,e(N,function(se,z,J){switch(J){case 0:v.vers=se,se>=4096&&(v.qpro=!0);break;case 6:xe=se;break;case 204:se&&(U=se);break;case 222:U=se;break;case 15:case 51:v.qpro||(se[1].v=se[1].v.slice(1));case 13:case 14:case 16:J==14&&(se[2]&112)==112&&(se[2]&15)>1&&(se[2]&15)<15&&(se[1].z=v.dateNF||table_fmt[14],v.cellDates&&(se[1].t="d",se[1].v=numdate(se[1].v))),v.qpro&&se[3]>W&&(j["!ref"]=encode_range(xe),Z[D]=j,te.push(D),j=v.dense?[]:{},xe={s:{r:0,c:0},e:{r:0,c:0}},W=se[3],D=U||"Sheet"+(W+1),U="");var de=v.dense?(j[se[0].r]||[])[se[0].c]:j[encode_cell(se[0])];if(de){de.t=se[1].t,de.v=se[1].v,se[1].z!=null&&(de.z=se[1].z),se[1].f!=null&&(de.f=se[1].f);break}v.dense?(j[se[0].r]||(j[se[0].r]=[]),j[se[0].r][se[0].c]=se[1]):j[encode_cell(se[0])]=se[1];break}},v);else if(N[2]==26||N[2]==14)v.Enum=le,N[2]==14&&(v.qpro=!0,N.l=0),e(N,function(se,z,J){switch(J){case 204:D=se;break;case 22:se[1].v=se[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(se[3]>W&&(j["!ref"]=encode_range(xe),Z[D]=j,te.push(D),j=v.dense?[]:{},xe={s:{r:0,c:0},e:{r:0,c:0}},W=se[3],D="Sheet"+(W+1)),Re>0&&se[0].r>=Re)break;v.dense?(j[se[0].r]||(j[se[0].r]=[]),j[se[0].r][se[0].c]=se[1]):j[encode_cell(se[0])]=se[1],xe.e.c<se[0].c&&(xe.e.c=se[0].c),xe.e.r<se[0].r&&(xe.e.r=se[0].r);break;case 27:se[14e3]&&(ve[se[14e3][0]]=se[14e3][1]);break;case 1537:ve[se[0]]=se[1],se[0]==W&&(D=se[1]);break}},v);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(j["!ref"]=encode_range(xe),Z[U||D]=j,te.push(U||D),!ve.length)return{SheetNames:te,Sheets:Z};for(var Ae={},ke=[],ue=0;ue<ve.length;++ue)Z[te[ue]]?(ke.push(ve[ue]||te[ue]),Ae[ve[ue]]=Z[ve[ue]]||Z[te[ue]]):(ke.push(ve[ue]),Ae[ve[ue]]={"!ref":"A1"});return{SheetNames:ke,Sheets:Ae}}function s(N,b){var v=b||{};if(+v.codepage>=0&&set_cp(+v.codepage),v.type=="string")throw new Error("Cannot write WK1 to JS string");var j=buf_array(),D=safe_decode_range(N["!ref"]),U=Array.isArray(N),W=[];write_biff_rec(j,0,n(1030)),write_biff_rec(j,6,d(D));for(var Z=Math.min(D.e.r,8191),te=D.s.r;te<=Z;++te)for(var ve=encode_row(te),xe=D.s.c;xe<=D.e.c;++xe){te===D.s.r&&(W[xe]=encode_col(xe));var Re=W[xe]+ve,Ae=U?(N[te]||[])[xe]:N[Re];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?write_biff_rec(j,13,h(te,xe,Ae.v)):write_biff_rec(j,14,p(te,xe,Ae.v));else{var ke=format_cell(Ae);write_biff_rec(j,15,f(te,xe,ke.slice(0,239)))}}return write_biff_rec(j,1),j.end()}function i(N,b){var v=b||{};if(+v.codepage>=0&&set_cp(+v.codepage),v.type=="string")throw new Error("Cannot write WK3 to JS string");var j=buf_array();write_biff_rec(j,0,a(N));for(var D=0,U=0;D<N.SheetNames.length;++D)(N.Sheets[N.SheetNames[D]]||{})["!ref"]&&write_biff_rec(j,27,H(N.SheetNames[D],U++));var W=0;for(D=0;D<N.SheetNames.length;++D){var Z=N.Sheets[N.SheetNames[D]];if(!(!Z||!Z["!ref"])){for(var te=safe_decode_range(Z["!ref"]),ve=Array.isArray(Z),xe=[],Re=Math.min(te.e.r,8191),Ae=te.s.r;Ae<=Re;++Ae)for(var ke=encode_row(Ae),ue=te.s.c;ue<=te.e.c;++ue){Ae===te.s.r&&(xe[ue]=encode_col(ue));var se=xe[ue]+ke,z=ve?(Z[Ae]||[])[ue]:Z[se];if(!(!z||z.t=="z"))if(z.t=="n")write_biff_rec(j,23,M(Ae,ue,W,z.v));else{var J=format_cell(z);write_biff_rec(j,22,_(Ae,ue,W,J.slice(0,239)))}}++W}}return write_biff_rec(j,1),j.end()}function n(N){var b=new_buf(2);return b.write_shift(2,N),b}function a(N){var b=new_buf(26);b.write_shift(2,4096),b.write_shift(2,4),b.write_shift(4,0);for(var v=0,j=0,D=0,U=0;U<N.SheetNames.length;++U){var W=N.SheetNames[U],Z=N.Sheets[W];if(!(!Z||!Z["!ref"])){++D;var te=decode_range(Z["!ref"]);v<te.e.r&&(v=te.e.r),j<te.e.c&&(j=te.e.c)}}return v>8191&&(v=8191),b.write_shift(2,v),b.write_shift(1,D),b.write_shift(1,j),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(1,1),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(4,0),b}function o(N,b,v){var j={s:{c:0,r:0},e:{c:0,r:0}};return b==8&&v.qpro?(j.s.c=N.read_shift(1),N.l++,j.s.r=N.read_shift(2),j.e.c=N.read_shift(1),N.l++,j.e.r=N.read_shift(2),j):(j.s.c=N.read_shift(2),j.s.r=N.read_shift(2),b==12&&v.qpro&&(N.l+=2),j.e.c=N.read_shift(2),j.e.r=N.read_shift(2),b==12&&v.qpro&&(N.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function d(N){var b=new_buf(8);return b.write_shift(2,N.s.c),b.write_shift(2,N.s.r),b.write_shift(2,N.e.c),b.write_shift(2,N.e.r),b}function l(N,b,v){var j=[{c:0,r:0},{t:"n",v:0},0,0];return v.qpro&&v.vers!=20768?(j[0].c=N.read_shift(1),j[3]=N.read_shift(1),j[0].r=N.read_shift(2),N.l+=2):(j[2]=N.read_shift(1),j[0].c=N.read_shift(2),j[0].r=N.read_shift(2)),j}function c(N,b,v){var j=N.l+b,D=l(N,b,v);if(D[1].t="s",v.vers==20768){N.l++;var U=N.read_shift(1);return D[1].v=N.read_shift(U,"utf8"),D}return v.qpro&&N.l++,D[1].v=N.read_shift(j-N.l,"cstr"),D}function f(N,b,v){var j=new_buf(7+v.length);j.write_shift(1,255),j.write_shift(2,b),j.write_shift(2,N),j.write_shift(1,39);for(var D=0;D<j.length;++D){var U=v.charCodeAt(D);j.write_shift(1,U>=128?95:U)}return j.write_shift(1,0),j}function u(N,b,v){var j=l(N,b,v);return j[1].v=N.read_shift(2,"i"),j}function h(N,b,v){var j=new_buf(7);return j.write_shift(1,255),j.write_shift(2,b),j.write_shift(2,N),j.write_shift(2,v,"i"),j}function g(N,b,v){var j=l(N,b,v);return j[1].v=N.read_shift(8,"f"),j}function p(N,b,v){var j=new_buf(13);return j.write_shift(1,255),j.write_shift(2,b),j.write_shift(2,N),j.write_shift(8,v,"f"),j}function x(N,b,v){var j=N.l+b,D=l(N,b,v);if(D[1].v=N.read_shift(8,"f"),v.qpro)N.l=j;else{var U=N.read_shift(2);F(N.slice(N.l,N.l+U),D),N.l+=U}return D}function E(N,b,v){var j=b&32768;return b&=-32769,b=(j?N:0)+(b>=8192?b-16384:b),(j?"":"$")+(v?encode_col(b):encode_row(b))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},P=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(N,b){prep_blob(N,0);for(var v=[],j=0,D="",U="",W="",Z="";N.l<N.length;){var te=N[N.l++];switch(te){case 0:v.push(N.read_shift(8,"f"));break;case 1:U=E(b[0].c,N.read_shift(2),!0),D=E(b[0].r,N.read_shift(2),!1),v.push(U+D);break;case 2:{var ve=E(b[0].c,N.read_shift(2),!0),xe=E(b[0].r,N.read_shift(2),!1);U=E(b[0].c,N.read_shift(2),!0),D=E(b[0].r,N.read_shift(2),!1),v.push(ve+xe+":"+U+D)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:v.push("("+v.pop()+")");break;case 5:v.push(N.read_shift(2));break;case 6:{for(var Re="";te=N[N.l++];)Re+=String.fromCharCode(te);v.push('"'+Re.replace(/"/g,'""')+'"')}break;case 8:v.push("-"+v.pop());break;case 23:v.push("+"+v.pop());break;case 22:v.push("NOT("+v.pop()+")");break;case 20:case 21:Z=v.pop(),W=v.pop(),v.push(["AND","OR"][te-20]+"("+W+","+Z+")");break;default:if(te<32&&P[te])Z=v.pop(),W=v.pop(),v.push(W+P[te]+Z);else if(S[te]){if(j=S[te][1],j==69&&(j=N[N.l++]),j>v.length){console.error("WK1 bad formula parse 0x"+te.toString(16)+":|"+v.join("|")+"|");return}var Ae=v.slice(-j);v.length-=j,v.push(S[te][0]+"("+Ae.join(",")+")")}else return te<=7?console.error("WK1 invalid opcode "+te.toString(16)):te<=24?console.error("WK1 unsupported op "+te.toString(16)):te<=30?console.error("WK1 invalid opcode "+te.toString(16)):te<=115?console.error("WK1 unsupported function opcode "+te.toString(16)):console.error("WK1 unrecognized opcode "+te.toString(16))}}v.length==1?b[1].f=""+v[0]:console.error("WK1 bad formula parse |"+v.join("|")+"|")}function A(N){var b=[{c:0,r:0},{t:"n",v:0},0];return b[0].r=N.read_shift(2),b[3]=N[N.l++],b[0].c=N[N.l++],b}function C(N,b){var v=A(N);return v[1].t="s",v[1].v=N.read_shift(b-4,"cstr"),v}function _(N,b,v,j){var D=new_buf(6+j.length);D.write_shift(2,N),D.write_shift(1,v),D.write_shift(1,b),D.write_shift(1,39);for(var U=0;U<j.length;++U){var W=j.charCodeAt(U);D.write_shift(1,W>=128?95:W)}return D.write_shift(1,0),D}function w(N,b){var v=A(N);v[1].v=N.read_shift(2);var j=v[1].v>>1;if(v[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return v[1].v=j,v}function T(N,b){var v=A(N),j=N.read_shift(4),D=N.read_shift(4),U=N.read_shift(2);if(U==65535)return j===0&&D===3221225472?(v[1].t="e",v[1].v=15):j===0&&D===3489660928?(v[1].t="e",v[1].v=42):v[1].v=0,v;var W=U&32768;return U=(U&32767)-16446,v[1].v=(1-W*2)*(D*Math.pow(2,U+32)+j*Math.pow(2,U)),v}function M(N,b,v,j){var D=new_buf(14);if(D.write_shift(2,N),D.write_shift(1,v),D.write_shift(1,b),j==0)return D.write_shift(4,0),D.write_shift(4,0),D.write_shift(2,65535),D;var U=0,W=0,Z=0,te=0;return j<0&&(U=1,j=-j),W=Math.log2(j)|0,j/=Math.pow(2,W-31),te=j>>>0,te&2147483648||(j/=2,++W,te=j>>>0),j-=te,te|=2147483648,te>>>=0,j*=Math.pow(2,32),Z=j>>>0,D.write_shift(4,Z),D.write_shift(4,te),W+=16383+(U?32768:0),D.write_shift(2,W),D}function R(N,b){var v=T(N);return N.l+=b-14,v}function k(N,b){var v=A(N),j=N.read_shift(4);return v[1].v=j>>6,v}function L(N,b){var v=A(N),j=N.read_shift(8,"f");return v[1].v=j,v}function ae(N,b){var v=L(N);return N.l+=b-10,v}function Q(N,b){return N[N.l+b-1]==0?N.read_shift(b,"cstr"):""}function oe(N,b){var v=N[N.l++];v>b-1&&(v=b-1);for(var j="";j.length<v;)j+=String.fromCharCode(N[N.l++]);return j}function re(N,b,v){if(!(!v.qpro||b<21)){var j=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var D=N.read_shift(b-21,"cstr");return[j,D]}}function me(N,b){for(var v={},j=N.l+b;N.l<j;){var D=N.read_shift(2);if(D==14e3){for(v[D]=[0,""],v[D][0]=N.read_shift(2);N[N.l];)v[D][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return v}function H(N,b){var v=new_buf(5+N.length);v.write_shift(2,14e3),v.write_shift(2,b);for(var j=0;j<N.length;++j){var D=N.charCodeAt(j);v[v.l++]=D>127?95:D}return v[v.l++]=0,v}var ie={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Q},222:{n:"SHEETNAMELP",f:oe},65535:{n:""}},le={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:C},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:w},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:me},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:k},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:ae},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:re},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:i,to_workbook:t}}(),straywsregex=/^\s|\s$|[\t\n\r]/;function write_sst_xml(e,t){if(!t.bookSST)return"";var r=[XML_HEADER];r[r.length]=writextag("sst",null,{xmlns:XMLNS_main[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var i=e[s],n="<si>";i.r?n+=i.r:(n+="<t",i.t||(i.t=""),i.t.match(straywsregex)&&(n+=' xml:space="preserve"'),n+=">"+escapexml(i.t)+"</t>"),n+="</si>",r[r.length]=n}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function parse_BrtBeginSst(e){return[e.read_shift(4),e.read_shift(4)]}function write_BrtBeginSst(e,t){return t||(t=new_buf(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var write_BrtSSTItem=write_RichStr;function write_sst_bin(e){var t=buf_array();write_record(t,159,write_BrtBeginSst(e));for(var r=0;r<e.length;++r)write_record(t,19,write_BrtSSTItem(e[r]));return write_record(t,160),t.end()}function _JS2ANSI(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function crypto_CreatePasswordVerifier_Method1(e){var t=0,r,s=_JS2ANSI(e),i=s.length+1,n,a,o,d,l;for(r=new_raw_buf(i),r[0]=s.length,n=1;n!=i;++n)r[n]=s[n-1];for(n=i-1;n>=0;--n)a=r[n],o=t&16384?1:0,d=t<<1&32767,l=o|d,t=l^a;return t^52811}var RTF=function(){function e(i,n){switch(n.type){case"base64":return t(Base64_decode(i),n);case"binary":return t(i,n);case"buffer":return t(has_buf&&Buffer.isBuffer(i)?i.toString("binary"):a2s(i),n);case"array":return t(cc2str(i),n)}throw new Error("Unrecognized type "+n.type)}function t(i,n){var a=n||{},o=a.dense?[]:{},d=i.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(c,f){Array.isArray(o)&&(o[f]=[]);for(var u=/\\\w+\b/g,h=0,g,p=-1;g=u.exec(c);){switch(g[0]){case"\\cell":var x=c.slice(h,u.lastIndex-g[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var E={v:x,t:"s"};Array.isArray(o)?o[f][p]=E:o[encode_cell({r:f,c:p})]=E}break}h=u.lastIndex}p>l.e.c&&(l.e.c=p)}),o["!ref"]=encode_range(l),o}function r(i,n){return sheet_to_workbook(e(i,n),n)}function s(i){for(var n=["{\\rtf1\\ansi"],a=safe_decode_range(i["!ref"]),o,d=Array.isArray(i),l=a.s.r;l<=a.e.r;++l){n.push("\\trowd\\trautofit1");for(var c=a.s.c;c<=a.e.c;++c)n.push("\\cellx"+(c+1));for(n.push("\\pard\\intbl"),c=a.s.c;c<=a.e.c;++c){var f=encode_cell({r:l,c});o=d?(i[l]||[])[c]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(n.push(" "+(o.w||(format_cell(o),o.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}}();function rgb2Hex(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var DEF_MDW=6,MDW=DEF_MDW;function width2px(e){return Math.floor((e+Math.round(128/MDW)/256)*MDW)}function px2char(e){return Math.floor((e-5)/MDW*100+.5)/100}function char2width(e){return Math.round((e*MDW+5)/MDW*256)/256}function process_col(e){e.width?(e.wpx=width2px(e.width),e.wch=px2char(e.wpx),e.MDW=MDW):e.wpx?(e.wch=px2char(e.wpx),e.width=char2width(e.wch),e.MDW=MDW):typeof e.wch=="number"&&(e.width=char2width(e.wch),e.wpx=width2px(e.width),e.MDW=MDW),e.customWidth&&delete e.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(e){return e*96/PPI}function pt2px(e){return e*PPI/96}function write_numFmts(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=writextag("numFmt",null,{numFmtId:s,formatCode:escapexml(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=writextag("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function write_cellXfs(e){var t=[];return t[t.length]=writextag("cellXfs",null),e.forEach(function(r){t[t.length]=writextag("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=writextag("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function write_sty_xml(e,t){var r=[XML_HEADER,writextag("styleSheet",null,{xmlns:XMLNS_main[0],"xmlns:vt":XMLNS.vt})],s;return e.SSF&&(s=write_numFmts(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=write_cellXfs(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function parse_BrtFmt(e,t){var r=e.read_shift(2),s=parse_XLWideString(e);return[r,s]}function write_BrtFmt(e,t,r){r||(r=new_buf(6+4*t.length)),r.write_shift(2,e),write_XLWideString(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function parse_BrtFont(e,t,r){var s={};s.sz=e.read_shift(2)/20;var i=parse_FontFlags(e);i.fItalic&&(s.italic=1),i.fCondense&&(s.condense=1),i.fExtend&&(s.extend=1),i.fShadow&&(s.shadow=1),i.fOutline&&(s.outline=1),i.fStrikeout&&(s.strike=1);var n=e.read_shift(2);switch(n===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(s.underline=a);var o=e.read_shift(1);o>0&&(s.family=o);var d=e.read_shift(1);switch(d>0&&(s.charset=d),e.l++,s.color=parse_BrtColor(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=parse_XLWideString(e),s}function write_BrtFont(e,t){t||(t=new_buf(25+4*32)),t.write_shift(2,e.sz*20),write_FontFlags(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),write_BrtColor(e.color,t);var s=0;return s=2,t.write_shift(1,s),write_XLWideString(e.name,t),t.length>t.l?t.slice(0,t.l):t}var XLSBFillPTNames=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rev_XLSBFillPTNames,parse_BrtFill=parsenoop;function write_BrtFill(e,t){t||(t=new_buf(4*3+8*7+16*1)),rev_XLSBFillPTNames||(rev_XLSBFillPTNames=evert(XLSBFillPTNames));var r=rev_XLSBFillPTNames[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(write_BrtColor({auto:1},t),write_BrtColor({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function parse_BrtXF(e,t){var r=e.l+t,s=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:i}}function write_BrtXF(e,t,r){r||(r=new_buf(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function write_Blxf(e,t){return t||(t=new_buf(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var parse_BrtBorder=parsenoop;function write_BrtBorder(e,t){return t||(t=new_buf(51)),t.write_shift(1,0),write_Blxf(null,t),write_Blxf(null,t),write_Blxf(null,t),write_Blxf(null,t),write_Blxf(null,t),t.length>t.l?t.slice(0,t.l):t}function write_BrtStyle(e,t){return t||(t=new_buf(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),write_XLNullableWideString(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function write_BrtBeginTableStyles(e,t,r){var s=new_buf(2052);return s.write_shift(4,e),write_XLNullableWideString(t,s),write_XLNullableWideString(r,s),s.length>s.l?s.slice(0,s.l):s}function write_FMTS_bin(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)t[i]!=null&&++r}),r!=0&&(write_record(e,615,write_UInt32LE(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)t[i]!=null&&write_record(e,44,write_BrtFmt(i,t[i]))}),write_record(e,616))}}function write_FONTS_bin(e){var t=1;write_record(e,611,write_UInt32LE(t)),write_record(e,43,write_BrtFont({sz:12,color:{theme:1},name:"Calibri",family:2})),write_record(e,612)}function write_FILLS_bin(e){var t=2;write_record(e,603,write_UInt32LE(t)),write_record(e,45,write_BrtFill({patternType:"none"})),write_record(e,45,write_BrtFill({patternType:"gray125"})),write_record(e,604)}function write_BORDERS_bin(e){var t=1;write_record(e,613,write_UInt32LE(t)),write_record(e,46,write_BrtBorder()),write_record(e,614)}function write_CELLSTYLEXFS_bin(e){var t=1;write_record(e,626,write_UInt32LE(t)),write_record(e,47,write_BrtXF({numFmtId:0},65535)),write_record(e,627)}function write_CELLXFS_bin(e,t){write_record(e,617,write_UInt32LE(t.length)),t.forEach(function(r){write_record(e,47,write_BrtXF(r,0))}),write_record(e,618)}function write_STYLES_bin(e){var t=1;write_record(e,619,write_UInt32LE(t)),write_record(e,48,write_BrtStyle({xfId:0,name:"Normal"})),write_record(e,620)}function write_DXFS_bin(e){var t=0;write_record(e,505,write_UInt32LE(t)),write_record(e,506)}function write_TABLESTYLES_bin(e){var t=0;write_record(e,508,write_BrtBeginTableStyles(t,"TableStyleMedium9","PivotStyleMedium4")),write_record(e,509)}function write_sty_bin(e,t){var r=buf_array();return write_record(r,278),write_FMTS_bin(r,e.SSF),write_FONTS_bin(r),write_FILLS_bin(r),write_BORDERS_bin(r),write_CELLSTYLEXFS_bin(r),write_CELLXFS_bin(r,t.cellXfs),write_STYLES_bin(r),write_DXFS_bin(r),write_TABLESTYLES_bin(r),write_record(r,279),r.end()}function write_theme(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[XML_HEADER];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function parse_BrtMdtinfo(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:parse_XLWideString(e)}}function write_BrtMdtinfo(e){var t=new_buf(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),write_XLWideString(e.name,t),t.slice(0,t.l)}function parse_BrtMdb(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function write_BrtMdb(e){var t=new_buf(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function write_BrtBeginEsfmd(e,t){var r=new_buf(8+2*t.length);return r.write_shift(4,e),write_XLWideString(t,r),r.slice(0,r.l)}function parse_BrtBeginEsmdb(e){return e.l+=4,e.read_shift(4)!=0}function write_BrtBeginEsmdb(e,t){var r=new_buf(8);return r.write_shift(4,e),r.write_shift(4,1),r}function write_xlmeta_bin(){var e=buf_array();return write_record(e,332),write_record(e,334,write_UInt32LE(1)),write_record(e,335,write_BrtMdtinfo({name:"XLDAPR",version:12e4,flags:3496657072})),write_record(e,336),write_record(e,339,write_BrtBeginEsfmd(1,"XLDAPR")),write_record(e,52),write_record(e,35,write_UInt32LE(514)),write_record(e,4096,write_UInt32LE(0)),write_record(e,4097,writeuint16(1)),write_record(e,36),write_record(e,53),write_record(e,340),write_record(e,337,write_BrtBeginEsmdb(1)),write_record(e,51,write_BrtMdb([[1,0]])),write_record(e,338),write_record(e,333),e.end()}function write_xlmeta_xml(){var e=[XML_HEADER];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function parse_BrtCalcChainItem$(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=encode_cell(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}var _shapeid=1024;function write_comments_vml(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[writextag("xml",null,{"xmlns:v":XLMLNS.v,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:mv":XLMLNS.mv}).replace(/\/>/,">"),writextag("o:shapelayout",writextag("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),writextag("v:shapetype",[writextag("v:stroke",null,{joinstyle:"miter"}),writextag("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];_shapeid<e*1e3;)_shapeid+=1e3;return t.forEach(function(n){var a=decode_cell(n[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var d=o.type=="gradient"?writextag("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=writextag("v:fill",d,o),c={on:"t",obscured:"t"};++_shapeid,i=i.concat(["<v:shape"+wxt_helper({id:"_x0000_s"+_shapeid,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(n[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,writextag("v:shadow",null,c),writextag("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",writetag("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),writetag("x:AutoFill","False"),writetag("x:Row",String(a.r)),writetag("x:Column",String(a.c)),n[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function write_comments_xml(e){var t=[XML_HEADER,writextag("comments",null,{xmlns:XMLNS_main[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(i){var n=escapexml(i.a);r.indexOf(n)==-1&&(r.push(n),t.push("<author>"+n+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var i=0,n=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?i=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(d){d.a&&(i=r.indexOf(escapexml(d.a))),n.push(d.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+i+'"><text>'),n.length<=1)t.push(writetag("t",escapexml(n[0]||"")));else{for(var a=`Comment:
    `+n[0]+`
`,o=1;o<n.length;++o)a+=`Reply:
    `+n[o]+`
`;t.push(writetag("t",escapexml(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function write_tcmnt_xml(e,t,r){var s=[XML_HEADER,writextag("ThreadedComments",null,{xmlns:XMLNS.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var n="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var d={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?n=d.id:d.parentId=n,a.ID=d.id,a.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),s.push(writextag("threadedComment",writetag("text",a.t||""),d))})}),s.push("</ThreadedComments>"),s.join("")}function write_people_xml(e){var t=[XML_HEADER,writextag("personList",null,{xmlns:XMLNS.TCMNT,"xmlns:x":XMLNS_main[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(writextag("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function parse_BrtBeginComment(e){var t={};t.iauthor=e.read_shift(4);var r=parse_UncheckedRfX(e);return t.rfx=r.s,t.ref=encode_cell(r.s),e.l+=16,t}function write_BrtBeginComment(e,t){return t==null&&(t=new_buf(36)),t.write_shift(4,e[1].iauthor),write_UncheckedRfX(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var parse_BrtCommentAuthor=parse_XLWideString;function write_BrtCommentAuthor(e){return write_XLWideString(e.slice(0,54))}function write_comments_bin(e){var t=buf_array(),r=[];return write_record(t,628),write_record(t,630),e.forEach(function(s){s[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),write_record(t,632,write_BrtCommentAuthor(i.a)))})}),write_record(t,631),write_record(t,633),e.forEach(function(s){s[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var n={s:decode_cell(s[0]),e:decode_cell(s[0])};write_record(t,635,write_BrtBeginComment([n,i])),i.t&&i.t.length>0&&write_record(t,637,write_BrtCommentText(i)),write_record(t,636),delete i.iauthor})}),write_record(t,634),write_record(t,629),t.end()}function fill_vba_xls(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&CFB.utils.cfb_add(e,i,t.FileIndex[s].content)}})}var VBAFMTS=["xlsb","xlsm","xlam","biff8","xla"],rc_to_a1=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,i,n,a){var o=!1,d=!1;n.length==0?d=!0:n.charAt(0)=="["&&(d=!0,n=n.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var l=n.length>0?parseInt(n,10)|0:0,c=a.length>0?parseInt(a,10)|0:0;return o?c+=t.c:--c,d?l+=t.r:--l,i+(o?"":"$")+encode_col(c)+(d?"":"$")+encode_row(l)}return function(i,n){return t=n,i.replace(e,r)}}(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=function(){return function(t,r){return t.replace(crefregex,function(s,i,n,a,o,d){var l=decode_col(a)-(n?0:r.c),c=decode_row(d)-(o?0:r.r),f=c==0?"":o?c+1:"["+c+"]",u=l==0?"":n?l+1:"["+l+"]";return i+"R"+f+"C"+u})}}();function shift_formula_str(e,t){return e.replace(crefregex,function(r,s,i,n,a,o){return s+(i=="$"?i+n:encode_col(decode_col(n)+t.c))+(a=="$"?a+o:encode_row(decode_row(o)+t.r))})}function fuzzyfmla(e){return e.length!=1}function parseread1(e){e.l+=1}function parse_ColRelU(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function parse_RgceArea(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return parse_RgceArea_BIFF2(e);r.biff==12&&(s=4)}var i=e.read_shift(s),n=e.read_shift(s),a=parse_ColRelU(e),o=parse_ColRelU(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function parse_RgceArea_BIFF2(e){var t=parse_ColRelU(e),r=parse_ColRelU(e),s=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function parse_RgceAreaRel(e,t,r){if(r.biff<8)return parse_RgceArea_BIFF2(e);var s=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),n=parse_ColRelU(e),a=parse_ColRelU(e);return{s:{r:s,c:n[0],cRel:n[1],rRel:n[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function parse_RgceLoc(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return parse_RgceLoc_BIFF2(e);var s=e.read_shift(r&&r.biff==12?4:2),i=parse_ColRelU(e);return{r:s,c:i[0],cRel:i[1],rRel:i[2]}}function parse_RgceLoc_BIFF2(e){var t=parse_ColRelU(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function parse_RgceElfLoc(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function parse_RgceLocRel(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return parse_RgceLocRel_BIFF2(e);var i=e.read_shift(s>=12?4:2),n=e.read_shift(2),a=(n&16384)>>14,o=(n&32768)>>15;if(n&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;n>8191;)n=n-16384;return{r:i,c:n,cRel:a,rRel:o}}function parse_RgceLocRel_BIFF2(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:s}}function parse_PtgArea(e,t,r){var s=(e[e.l++]&96)>>5,i=parse_RgceArea(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,i]}function parse_PtgArea3d(e,t,r){var s=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}var a=parse_RgceArea(e,n,r);return[s,i,a]}function parse_PtgAreaErr(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function parse_PtgAreaErr3d(e,t,r){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}return e.l+=n,[s,i]}function parse_PtgAreaN(e,t,r){var s=(e[e.l++]&96)>>5,i=parse_RgceAreaRel(e,t-1,r);return[s,i]}function parse_PtgArray(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function parse_PtgAttrBaxcel(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function parse_PtgAttrChoose(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),i=[],n=0;n<=s;++n)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function parse_PtgAttrGoto(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function parse_PtgAttrIf(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function parse_PtgAttrIfError(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function parse_PtgAttrSemi(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function parse_PtgAttrSpaceType(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function parse_PtgAttrSpace(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgAttrSpaceSemi(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgRef(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=parse_RgceLoc(e,0,r);return[s,i]}function parse_PtgRefN(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=parse_RgceLocRel(e,0,r);return[s,i]}function parse_PtgRef3d(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var n=parse_RgceLoc(e,0,r);return[s,i,n]}function parse_PtgFunc(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[FtabArgc[i],Ftab[i],s]}function parse_PtgFuncVar(e,t,r){var s=e[e.l++],i=e.read_shift(1),n=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:parsetab(e);return[i,(n[0]===0?Ftab:Cetab)[n[1]]]}function parsetab(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function parse_PtgAttrSum(e,t,r){e.l+=r&&r.biff==2?3:4}function parse_PtgExp(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[s,i]}function parse_PtgErr(e){return e.l++,BErr[e.read_shift(1)]}function parse_PtgInt(e){return e.l++,e.read_shift(2)}function parse_PtgBool(e){return e.l++,e.read_shift(1)!==0}function parse_PtgNum(e){return e.l++,parse_Xnum(e)}function parse_PtgStr(e,t,r){return e.l++,parse_ShortXLUnicodeString(e,t-1,r)}function parse_SerAr(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=parsebool(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=BErr[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=parse_Xnum(e);break;case 2:r[1]=parse_XLUnicodeString2(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function parse_PtgExtraMem(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),i=[],n=0;n!=s;++n)i.push((r.biff==12?parse_UncheckedRfX:parse_Ref8U)(e));return i}function parse_PtgExtraArray(e,t,r){var s=0,i=0;r.biff==12?(s=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--i==0&&(i=256));for(var n=0,a=[];n!=s&&(a[n]=[]);++n)for(var o=0;o!=i;++o)a[n][o]=parse_SerAr(e,r.biff);return a}function parse_PtgName(e,t,r){var s=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,n=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,n]}function parse_PtgNameX(e,t,r){if(r.biff==5)return parse_PtgNameX_BIFF5(e);var s=e.read_shift(1)>>>5&3,i=e.read_shift(2),n=e.read_shift(4);return[s,i,n]}function parse_PtgNameX_BIFF5(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function parse_PtgMemArea(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[s,i]}function parse_PtgMemFunc(e,t,r){var s=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[s,i]}function parse_PtgRefErr(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function parse_PtgRefErr3d(e,t,r){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),n=4;if(r)switch(r.biff){case 5:n=15;break;case 12:n=6;break}return e.l+=n,[s,i]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(e,t,r){return e.l+=2,[parse_RgceElfLoc(e)]}function parse_PtgElfNoop(e){return e.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(e){return e.l+=2,[parseuint16(e),e.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),i=e.read_shift(2),n=e.read_shift(2),a=PtgListRT[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:s,c:i,C:n}}function parse_PtgSxName(e){return e.l+=2,[e.read_shift(4)]}function parse_PtgSheet(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function parse_PtgMemNoMemN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function parse_PtgAttrNoop(e){return e.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(e,t,r,s){if(s.biff<8)return parsenoop(e,t);for(var i=e.l+t,n=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=parse_PtgExtraArray(e,0,s),n.push(r[a][1]);break;case"PtgMemArea":r[a][2]=parse_PtgExtraMem(e,r[a][1],s),n.push(r[a][2]);break;case"PtgExp":s&&s.biff==12&&(r[a][1][1]=e.read_shift(4),n.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&n.push(parsenoop(e,t)),n}function parse_Rgce(e,t,r){for(var s=e.l+t,i,n,a=[];s!=e.l;)t=s-e.l,n=e[e.l],i=PtgTypes[n]||PtgTypes[PtgDupes[n]],(n===24||n===25)&&(i=(n===24?Ptg18:Ptg19)[e[e.l+1]]),!i||!i.f?parsenoop(e,t):a.push([i.n,i.f(e,t,r)]);return a}function stringify_array(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],i=[],n=0;n<s.length;++n){var a=s[n];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function formula_quote_sheet_name(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function get_ixti_raw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[s[0]][0]){case 357:return i=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return i=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(n){return n.Name}).join(";;");default:return e[s[0]][0][3]?(i=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?i:i+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function get_ixti(e,t,r){var s=get_ixti_raw(e,t,r);return s=="#REF"?s:formula_quote_sheet_name(s,r)}function stringify_formula(e,t,r,s,i){var n=i&&i.biff||8,a={s:{c:0,r:0}},o=[],d,l,c,f=0,u=0,h,g="";if(!e[0]||!e[0][0])return"";for(var p=-1,x="",E=0,S=e[0].length;E<S;++E){var P=e[0][E];switch(P[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=o.pop(),l=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:x=fill(" ",e[0][p][1][1]);break;case 1:x=fill("\r",e[0][p][1][1]);break;default:if(x="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}l=l+x,p=-1}o.push(l+PtgBinOp[P[0]]+d);break;case"PtgIsect":d=o.pop(),l=o.pop(),o.push(l+" "+d);break;case"PtgUnion":d=o.pop(),l=o.pop(),o.push(l+","+d);break;case"PtgRange":d=o.pop(),l=o.pop(),o.push(l+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=shift_cell_xls(P[1][1],a,i),o.push(encode_cell_xls(c,n));break;case"PtgRefN":c=r?shift_cell_xls(P[1][1],r,i):P[1][1],o.push(encode_cell_xls(c,n));break;case"PtgRef3d":f=P[1][1],c=shift_cell_xls(P[1][2],a,i),g=get_ixti(s,f,i),o.push(g+"!"+encode_cell_xls(c,n));break;case"PtgFunc":case"PtgFuncVar":var F=P[1][0],A=P[1][1];F||(F=0),F&=127;var C=F==0?[]:o.slice(-F);o.length-=F,A==="User"&&(A=C.shift()),o.push(A+"("+C.join(",")+")");break;case"PtgBool":o.push(P[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(P[1]);break;case"PtgNum":o.push(String(P[1]));break;case"PtgStr":o.push('"'+P[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(P[1]);break;case"PtgAreaN":h=shift_range_xls(P[1][1],r?{s:r}:a,i),o.push(encode_range_xls(h,i));break;case"PtgArea":h=shift_range_xls(P[1][1],a,i),o.push(encode_range_xls(h,i));break;case"PtgArea3d":f=P[1][1],h=P[1][2],g=get_ixti(s,f,i),o.push(g+"!"+encode_range_xls(h,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=P[1][2];var _=(s.names||[])[u-1]||(s[0]||[])[u],w=_?_.Name:"SH33TJSNAME"+String(u);w&&w.slice(0,6)=="_xlfn."&&!i.xlfn&&(w=w.slice(6)),o.push(w);break;case"PtgNameX":var T=P[1][1];u=P[1][2];var M;if(i.biff<=5)T<0&&(T=-T),s[T]&&(M=s[T][u]);else{var R="";if(((s[T]||[])[0]||[])[0]==14849||(((s[T]||[])[0]||[])[0]==1025?s[T][u]&&s[T][u].itab>0&&(R=s.SheetNames[s[T][u].itab-1]+"!"):R=s.SheetNames[u-1]+"!"),s[T]&&s[T][u])R+=s[T][u].Name;else if(s[0]&&s[0][u])R+=s[0][u].Name;else{var k=(get_ixti_raw(s,T,i)||"").split(";;");k[u-1]?R=k[u-1]:R+="SH33TJSERRX"}o.push(R);break}M||(M={Name:"SH33TJSERRY"}),o.push(M.Name);break;case"PtgParen":var L="(",ae=")";if(p>=0){switch(x="",e[0][p][1][0]){case 2:L=fill(" ",e[0][p][1][1])+L;break;case 3:L=fill("\r",e[0][p][1][1])+L;break;case 4:ae=fill(" ",e[0][p][1][1])+ae;break;case 5:ae=fill("\r",e[0][p][1][1])+ae;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(L+o.pop()+ae);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":c={c:P[1][1],r:P[1][0]};var Q={c:r.c,r:r.r};if(s.sharedf[encode_cell(c)]){var oe=s.sharedf[encode_cell(c)];o.push(stringify_formula(oe,a,Q,s,i))}else{var re=!1;for(d=0;d!=s.arrayf.length;++d)if(l=s.arrayf[d],!(c.c<l[0].s.c||c.c>l[0].e.c)&&!(c.r<l[0].s.r||c.r>l[0].e.r)){o.push(stringify_formula(l[1],a,Q,s,i)),re=!0;break}re||o.push(P[1])}break;case"PtgArray":o.push("{"+stringify_array(P[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+P[1].idx+"[#"+P[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(P));default:throw new Error("Unrecognized Formula Token: "+String(P))}var me=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&me.indexOf(e[0][E][0])==-1){P=e[0][p];var H=!0;switch(P[1][0]){case 4:H=!1;case 0:x=fill(" ",P[1][1]);break;case 5:H=!1;case 1:x=fill("\r",P[1][1]);break;default:if(x="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+P[1][0])}o.push((H?x:"")+o.pop()+(H?"":x)),p=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function write_FormulaValue(e){if(e==null){var t=new_buf(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return write_Xnum(e);return write_Xnum(0)}function write_Formula(e,t,r,s,i){var n=write_XLSCell(t,r,i),a=write_FormulaValue(e.v),o=new_buf(6),d=33;o.write_shift(2,d),o.write_shift(4,0);for(var l=new_buf(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];var f=bconcat([n,a,o,l]);return f}function parse_XLSBParsedFormula(e,t,r){var s=e.read_shift(4),i=parse_Rgce(e,s,r),n=e.read_shift(4),a=n>0?parse_RgbExtra(e,n,i,r):null;return[i,a]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function csf_to_ods_formula(e){var t="of:="+e.replace(crefregex,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function csf_to_ods_3D(e){return e.replace(/\./,"!")}var browser_has_Map=typeof Map<"u";function get_sst_id(e,t,r){var s=0,i=e.length;if(r){if(browser_has_Map?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var n=browser_has_Map?r.get(t):r[t];s<n.length;++s)if(e[n[s]].t===t)return e.Count++,n[s]}}else for(;s<i;++s)if(e[s].t===t)return e.Count++,s;return e[i]={t},e.Count++,e.Unique++,r&&(browser_has_Map?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function col_obj_w(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(MDW=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=px2char(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=char2width(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function default_margins(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function get_cell_style(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],i=60,n=e.length;if(s==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){SSF_load(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=s=i;break}}for(i=0;i!=n;++i)if(e[i].numFmtId===s)return i;return e[n]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},n}function check_ws(e,t,r){if(e&&e["!ref"]){var s=safe_decode_range(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function write_ws_xml_merges(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+encode_range(e[r])+'"/>';return t+"</mergeCells>"}function write_ws_xml_sheetpr(e,t,r,s,i){var n=!1,a={},o=null;if(s.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}n=!0,a.codeName=utf8write(escapexml(d))}if(e&&e["!outline"]){var l={summaryBelow:1,summaryRight:1};e["!outline"].above&&(l.summaryBelow=0),e["!outline"].left&&(l.summaryRight=0),o=(o||"")+writextag("outlinePr",null,l)}!n&&!o||(i[i.length]=writextag("sheetPr",o,a))}var sheetprot_deffalse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sheetprot_deftrue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function write_ws_xml_protection(e){var t={sheet:1};return sheetprot_deffalse.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),sheetprot_deftrue.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=crypto_CreatePasswordVerifier_Method1(e.password).toString(16).toUpperCase()),writextag("sheetProtection",null,t)}function write_ws_xml_margins(e){return default_margins(e),writextag("pageMargins",null,e)}function write_ws_xml_cols(e,t){for(var r=["<cols>"],s,i=0;i!=t.length;++i)(s=t[i])&&(r[r.length]=writextag("col",null,col_obj_w(i,s)));return r[r.length]="</cols>",r.join("")}function write_ws_xml_autofilter(e,t,r,s){var i=typeof e.ref=="string"?e.ref:encode_range(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var n=r.Workbook.Names,a=decode_range(i);a.s.r==a.e.r&&(a.e.r=decode_range(t["!ref"]).e.r,i=encode_range(a));for(var o=0;o<n.length;++o){var d=n[o];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==s){d.Ref="'"+r.SheetNames[s]+"'!"+i;break}}return o==n.length&&n.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+i}),writextag("autoFilter",null,{ref:i})}function write_ws_xml_sheetviews(e,t,r,s){var i={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),writextag("sheetViews",writextag("sheetView",null,i),{})}function write_ws_xml_cell(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",n=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=BErr[e.v];break;case"d":s&&s.cellDates?i=parseDate(e.v,-1).toISOString():(e=dup(e),e.t="n",i=""+(e.v=datenum(parseDate(e.v)))),typeof e.z>"u"&&(e.z=table_fmt[14]);break;default:i=e.v;break}var o=writetag("v",escapexml(i)),d={r:t},l=get_cell_style(s.cellXfs,e,s);switch(l!==0&&(d.s=l),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){o=writetag("v",""+get_sst_id(s.Strings,e.v,s.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=n&&(e.t=n,e.v=a),typeof e.f=="string"&&e.f){var c=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=writextag("f",escapexml(e.f),c)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(d.cm=1),writextag("c",o,d)}function write_ws_xml_data(e,t,r,s){var i=[],n=[],a=safe_decode_range(e["!ref"]),o="",d,l="",c=[],f=0,u=0,h=e["!rows"],g=Array.isArray(e),p={r:l},x,E=-1;for(u=a.s.c;u<=a.e.c;++u)c[u]=encode_col(u);for(f=a.s.r;f<=a.e.r;++f){for(n=[],l=encode_row(f),u=a.s.c;u<=a.e.c;++u){d=c[u]+l;var S=g?(e[f]||[])[u]:e[d];S!==void 0&&(o=write_ws_xml_cell(S,d,e,t))!=null&&n.push(o)}(n.length>0||h&&h[f])&&(p={r:l},h&&h[f]&&(x=h[f],x.hidden&&(p.hidden=1),E=-1,x.hpx?E=px2pt(x.hpx):x.hpt&&(E=x.hpt),E>-1&&(p.ht=E,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),i[i.length]=writextag("row",n.join(""),p))}if(h)for(;f<h.length;++f)h&&h[f]&&(p={r:f+1},x=h[f],x.hidden&&(p.hidden=1),E=-1,x.hpx?E=px2pt(x.hpx):x.hpt&&(E=x.hpt),E>-1&&(p.ht=E,p.customHeight=1),x.level&&(p.outlineLevel=x.level),i[i.length]=writextag("row","",p));return i.join("")}function write_ws_xml(e,t,r,s){var i=[XML_HEADER,writextag("worksheet",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r})],n=r.SheetNames[e],a=0,o="",d=r.Sheets[n];d==null&&(d={});var l=d["!ref"]||"A1",c=safe_decode_range(l);if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),l=encode_range(c)}s||(s={}),d["!comments"]=[];var f=[];write_ws_xml_sheetpr(d,r,e,t,i),i[i.length]=writextag("dimension",null,{ref:l}),i[i.length]=write_ws_xml_sheetviews(d,t,e,r),t.sheetFormat&&(i[i.length]=writextag("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(i[i.length]=write_ws_xml_cols(d,d["!cols"])),i[a=i.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(o=write_ws_xml_data(d,t),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),d["!protect"]&&(i[i.length]=write_ws_xml_protection(d["!protect"])),d["!autofilter"]!=null&&(i[i.length]=write_ws_xml_autofilter(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(i[i.length]=write_ws_xml_merges(d["!merges"]));var u=-1,h,g=-1;return d["!links"].length>0&&(i[i.length]="<hyperlinks>",d["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=add_rels(s,-1,escapexml(p[1].Target).replace(/#.*$/,""),RELS.HLINK),h["r:id"]="rId"+g),(u=p[1].Target.indexOf("#"))>-1&&(h.location=escapexml(p[1].Target.slice(u+1))),p[1].Tooltip&&(h.tooltip=escapexml(p[1].Tooltip)),i[i.length]=writextag("hyperlink",null,h))}),i[i.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(i[i.length]=write_ws_xml_margins(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=writetag("ignoredErrors",writextag("ignoredError",null,{numberStoredAsText:1,sqref:l}))),f.length>0&&(g=add_rels(s,-1,"../drawings/drawing"+(e+1)+".xml",RELS.DRAW),i[i.length]=writextag("drawing",null,{"r:id":"rId"+g}),d["!drawing"]=f),d["!comments"].length>0&&(g=add_rels(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",RELS.VML),i[i.length]=writextag("legacyDrawing",null,{"r:id":"rId"+g}),d["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function parse_BrtRowHdr(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var n=e.read_shift(1);return e.l=s,n&7&&(r.level=n&7),n&16&&(r.hidden=!0),n&32&&(r.hpt=i/20),r}function write_BrtRowHdr(e,t,r){var s=new_buf(145),i=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var n=320;i.hpx?n=px2pt(i.hpx)*20:i.hpt&&(n=i.hpt*20),s.write_shift(2,n),s.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),s.write_shift(1,a),s.write_shift(1,0);var o=0,d=s.l;s.l+=4;for(var l={r:e,c:0},c=0;c<16;++c)if(!(t.s.c>c+1<<10||t.e.c<c<<10)){for(var f=-1,u=-1,h=c<<10;h<c+1<<10;++h){l.c=h;var g=Array.isArray(r)?(r[l.r]||[])[l.c]:r[encode_cell(l)];g&&(f<0&&(f=h),u=h)}f<0||(++o,s.write_shift(4,f),s.write_shift(4,u))}var p=s.l;return s.l=d,s.write_shift(4,o),s.l=p,s.length>s.l?s.slice(0,s.l):s}function write_row_header(e,t,r,s){var i=write_BrtRowHdr(s,r,t);(i.length>17||(t["!rows"]||[])[s])&&write_record(e,0,i)}var parse_BrtWsDim=parse_UncheckedRfX,write_BrtWsDim=write_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=parse_XLSBCodeName(e),r}function write_BrtWsProp(e,t,r){r==null&&(r=new_buf(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var i=1;i<3;++i)r.write_shift(1,0);return write_BrtColor({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),write_XLSBCodeName(e,r),r.slice(0,r.l)}function parse_BrtCellBlank(e){var t=parse_XLSBCell(e);return[t]}function write_BrtCellBlank(e,t,r){return r==null&&(r=new_buf(8)),write_XLSBCell(t,r)}function parse_BrtShortBlank(e){var t=parse_XLSBShortCell(e);return[t]}function write_BrtShortBlank(e,t,r){return r==null&&(r=new_buf(4)),write_XLSBShortCell(t,r)}function parse_BrtCellBool(e){var t=parse_XLSBCell(e),r=e.read_shift(1);return[t,r,"b"]}function write_BrtCellBool(e,t,r){return r==null&&(r=new_buf(9)),write_XLSBCell(t,r),r.write_shift(1,e.v?1:0),r}function parse_BrtShortBool(e){var t=parse_XLSBShortCell(e),r=e.read_shift(1);return[t,r,"b"]}function write_BrtShortBool(e,t,r){return r==null&&(r=new_buf(5)),write_XLSBShortCell(t,r),r.write_shift(1,e.v?1:0),r}function parse_BrtCellError(e){var t=parse_XLSBCell(e),r=e.read_shift(1);return[t,r,"e"]}function write_BrtCellError(e,t,r){return r==null&&(r=new_buf(9)),write_XLSBCell(t,r),r.write_shift(1,e.v),r}function parse_BrtShortError(e){var t=parse_XLSBShortCell(e),r=e.read_shift(1);return[t,r,"e"]}function write_BrtShortError(e,t,r){return r==null&&(r=new_buf(8)),write_XLSBShortCell(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function parse_BrtCellIsst(e){var t=parse_XLSBCell(e),r=e.read_shift(4);return[t,r,"s"]}function write_BrtCellIsst(e,t,r){return r==null&&(r=new_buf(12)),write_XLSBCell(t,r),r.write_shift(4,t.v),r}function parse_BrtShortIsst(e){var t=parse_XLSBShortCell(e),r=e.read_shift(4);return[t,r,"s"]}function write_BrtShortIsst(e,t,r){return r==null&&(r=new_buf(8)),write_XLSBShortCell(t,r),r.write_shift(4,t.v),r}function parse_BrtCellReal(e){var t=parse_XLSBCell(e),r=parse_Xnum(e);return[t,r,"n"]}function write_BrtCellReal(e,t,r){return r==null&&(r=new_buf(16)),write_XLSBCell(t,r),write_Xnum(e.v,r),r}function parse_BrtShortReal(e){var t=parse_XLSBShortCell(e),r=parse_Xnum(e);return[t,r,"n"]}function write_BrtShortReal(e,t,r){return r==null&&(r=new_buf(12)),write_XLSBShortCell(t,r),write_Xnum(e.v,r),r}function parse_BrtCellRk(e){var t=parse_XLSBCell(e),r=parse_RkNumber(e);return[t,r,"n"]}function write_BrtCellRk(e,t,r){return r==null&&(r=new_buf(12)),write_XLSBCell(t,r),write_RkNumber(e.v,r),r}function parse_BrtShortRk(e){var t=parse_XLSBShortCell(e),r=parse_RkNumber(e);return[t,r,"n"]}function write_BrtShortRk(e,t,r){return r==null&&(r=new_buf(8)),write_XLSBShortCell(t,r),write_RkNumber(e.v,r),r}function parse_BrtCellRString(e){var t=parse_XLSBCell(e),r=parse_RichStr(e);return[t,r,"is"]}function parse_BrtCellSt(e){var t=parse_XLSBCell(e),r=parse_XLWideString(e);return[t,r,"str"]}function write_BrtCellSt(e,t,r){return r==null&&(r=new_buf(12+4*e.v.length)),write_XLSBCell(t,r),write_XLWideString(e.v,r),r.length>r.l?r.slice(0,r.l):r}function parse_BrtShortSt(e){var t=parse_XLSBShortCell(e),r=parse_XLWideString(e);return[t,r,"str"]}function write_BrtShortSt(e,t,r){return r==null&&(r=new_buf(8+4*e.v.length)),write_XLSBShortCell(t,r),write_XLWideString(e.v,r),r.length>r.l?r.slice(0,r.l):r}function parse_BrtFmlaBool(e,t,r){var s=e.l+t,i=parse_XLSBCell(e);i.r=r["!row"];var n=e.read_shift(1),a=[i,n,"b"];if(r.cellFormula){e.l+=2;var o=parse_XLSBCellParsedFormula(e,s-e.l,r);a[3]=stringify_formula(o,null,i,r.supbooks,r)}else e.l=s;return a}function parse_BrtFmlaError(e,t,r){var s=e.l+t,i=parse_XLSBCell(e);i.r=r["!row"];var n=e.read_shift(1),a=[i,n,"e"];if(r.cellFormula){e.l+=2;var o=parse_XLSBCellParsedFormula(e,s-e.l,r);a[3]=stringify_formula(o,null,i,r.supbooks,r)}else e.l=s;return a}function parse_BrtFmlaNum(e,t,r){var s=e.l+t,i=parse_XLSBCell(e);i.r=r["!row"];var n=parse_Xnum(e),a=[i,n,"n"];if(r.cellFormula){e.l+=2;var o=parse_XLSBCellParsedFormula(e,s-e.l,r);a[3]=stringify_formula(o,null,i,r.supbooks,r)}else e.l=s;return a}function parse_BrtFmlaString(e,t,r){var s=e.l+t,i=parse_XLSBCell(e);i.r=r["!row"];var n=parse_XLWideString(e),a=[i,n,"str"];if(r.cellFormula){e.l+=2;var o=parse_XLSBCellParsedFormula(e,s-e.l,r);a[3]=stringify_formula(o,null,i,r.supbooks,r)}else e.l=s;return a}var parse_BrtMergeCell=parse_UncheckedRfX,write_BrtMergeCell=write_UncheckedRfX;function write_BrtBeginMergeCells(e,t){return t==null&&(t=new_buf(4)),t.write_shift(4,e),t}function parse_BrtHLink(e,t){var r=e.l+t,s=parse_UncheckedRfX(e),i=parse_XLNullableWideString(e),n=parse_XLWideString(e),a=parse_XLWideString(e),o=parse_XLWideString(e);e.l=r;var d={rfx:s,relId:i,loc:n,display:o};return a&&(d.Tooltip=a),d}function write_BrtHLink(e,t){var r=new_buf(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));write_UncheckedRfX({s:decode_cell(e[0]),e:decode_cell(e[0])},r),write_RelID("rId"+t,r);var s=e[1].Target.indexOf("#"),i=s==-1?"":e[1].Target.slice(s+1);return write_XLWideString(i||"",r),write_XLWideString(e[1].Tooltip||"",r),write_XLWideString("",r),r.slice(0,r.l)}function parse_BrtPane(){}function parse_BrtArrFmla(e,t,r){var s=e.l+t,i=parse_RfX(e),n=e.read_shift(1),a=[i];if(a[2]=n,r.cellFormula){var o=parse_XLSBArrayParsedFormula(e,s-e.l,r);a[1]=o}else e.l=s;return a}function parse_BrtShrFmla(e,t,r){var s=e.l+t,i=parse_UncheckedRfX(e),n=[i];if(r.cellFormula){var a=parse_XLSBSharedParsedFormula(e,s-e.l,r);n[1]=a,e.l=s}else e.l=s;return n}function write_BrtColInfo(e,t,r){r==null&&(r=new_buf(18));var s=col_obj_w(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof s.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(e){var t={};return BrtMarginKeys.forEach(function(r){t[r]=parse_Xnum(e)}),t}function write_BrtMargins(e,t){return t==null&&(t=new_buf(6*8)),default_margins(e),BrtMarginKeys.forEach(function(r){write_Xnum(e[r],t)}),t}function parse_BrtBeginWsView(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function write_BrtBeginWsView(e,t,r){r==null&&(r=new_buf(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function write_BrtCellIgnoreEC(e){var t=new_buf(24);return t.write_shift(4,4),t.write_shift(4,1),write_UncheckedRfX(e,t),t}function write_BrtSheetProtection(e,t){return t==null&&(t=new_buf(16*4+2)),t.write_shift(2,e.password?crypto_CreatePasswordVerifier_Method1(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function parse_BrtDVal(){}function parse_BrtDVal14(){}function write_ws_bin_cell(e,t,r,s,i,n,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=dup(t),t.z=t.z||table_fmt[14],t.v=datenum(parseDate(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var d={r,c:s};switch(d.s=get_cell_style(i.cellXfs,t,i),t.l&&n["!links"].push([encode_cell(d),t.l]),t.c&&n["!comments"].push([encode_cell(d),t.c]),t.t){case"s":case"str":return i.bookSST?(o=get_sst_id(i.Strings,t.v,i.revStrings),d.t="s",d.v=o,a?write_record(e,18,write_BrtShortIsst(t,d)):write_record(e,7,write_BrtCellIsst(t,d))):(d.t="str",a?write_record(e,17,write_BrtShortSt(t,d)):write_record(e,6,write_BrtCellSt(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?write_record(e,13,write_BrtShortRk(t,d)):write_record(e,2,write_BrtCellRk(t,d)):a?write_record(e,16,write_BrtShortReal(t,d)):write_record(e,5,write_BrtCellReal(t,d)),!0;case"b":return d.t="b",a?write_record(e,15,write_BrtShortBool(t,d)):write_record(e,4,write_BrtCellBool(t,d)),!0;case"e":return d.t="e",a?write_record(e,14,write_BrtShortError(t,d)):write_record(e,3,write_BrtCellError(t,d)),!0}return a?write_record(e,12,write_BrtShortBlank(t,d)):write_record(e,1,write_BrtCellBlank(t,d)),!0}function write_CELLTABLE(e,t,r,s){var i=safe_decode_range(t["!ref"]||"A1"),n,a="",o=[];write_record(e,145);var d=Array.isArray(t),l=i.e.r;t["!rows"]&&(l=Math.max(i.e.r,t["!rows"].length-1));for(var c=i.s.r;c<=l;++c){a=encode_row(c),write_row_header(e,t,i,c);var f=!1;if(c<=i.e.r)for(var u=i.s.c;u<=i.e.c;++u){c===i.s.r&&(o[u]=encode_col(u)),n=o[u]+a;var h=d?(t[c]||[])[u]:t[n];if(!h){f=!1;continue}f=write_ws_bin_cell(e,h,c,u,s,t,f)}}write_record(e,146)}function write_MERGECELLS(e,t){!t||!t["!merges"]||(write_record(e,177,write_BrtBeginMergeCells(t["!merges"].length)),t["!merges"].forEach(function(r){write_record(e,176,write_BrtMergeCell(r))}),write_record(e,178))}function write_COLINFOS(e,t){!t||!t["!cols"]||(write_record(e,390),t["!cols"].forEach(function(r,s){r&&write_record(e,60,write_BrtColInfo(s,r))}),write_record(e,391))}function write_IGNOREECS(e,t){!t||!t["!ref"]||(write_record(e,648),write_record(e,649,write_BrtCellIgnoreEC(safe_decode_range(t["!ref"]))),write_record(e,650))}function write_HLINKS(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var i=add_rels(r,-1,s[1].Target.replace(/#.*$/,""),RELS.HLINK);write_record(e,494,write_BrtHLink(s,i))}}),delete t["!links"]}function write_LEGACYDRAWING(e,t,r,s){if(t["!comments"].length>0){var i=add_rels(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",RELS.VML);write_record(e,551,write_RelID("rId"+i)),t["!legacy"]=i}}function write_AUTOFILTER(e,t,r,s){if(t["!autofilter"]){var i=t["!autofilter"],n=typeof i.ref=="string"?i.ref:encode_range(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=decode_range(n);o.s.r==o.e.r&&(o.e.r=decode_range(t["!ref"]).e.r,n=encode_range(o));for(var d=0;d<a.length;++d){var l=a[d];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==s){l.Ref="'"+r.SheetNames[s]+"'!"+n;break}}d==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+n}),write_record(e,161,write_UncheckedRfX(safe_decode_range(n))),write_record(e,162)}}function write_WSVIEWS2(e,t,r){write_record(e,133),write_record(e,137,write_BrtBeginWsView(t,r)),write_record(e,138),write_record(e,134)}function write_SHEETPROTECT(e,t){t["!protect"]&&write_record(e,535,write_BrtSheetProtection(t["!protect"]))}function write_ws_bin(e,t,r,s){var i=buf_array(),n=r.SheetNames[e],a=r.Sheets[n]||{},o=n;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var d=safe_decode_range(a["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],write_record(i,129),(r.vbaraw||a["!outline"])&&write_record(i,147,write_BrtWsProp(o,a["!outline"])),write_record(i,148,write_BrtWsDim(d)),write_WSVIEWS2(i,a,r.Workbook),write_COLINFOS(i,a),write_CELLTABLE(i,a,e,t),write_SHEETPROTECT(i,a),write_AUTOFILTER(i,a,r,e),write_MERGECELLS(i,a),write_HLINKS(i,a,s),a["!margins"]&&write_record(i,476,write_BrtMargins(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&write_IGNOREECS(i,a),write_LEGACYDRAWING(i,a,e,s),write_record(i,130),i.end()}function parse_BrtCsProp(e,t){e.l+=10;var r=parse_XLWideString(e);return{name:r}}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function safe1904(e){return!e.Workbook||!e.Workbook.WBProps?"false":parsexmlbool(e.Workbook.WBProps.date1904)?"true":"false"}var badchars="][*?/\\".split("");function check_ws_name(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return badchars.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function check_wb_names(e,t,r){e.forEach(function(s,i){check_ws_name(s);for(var n=0;n<i;++n)if(s==e[n])throw new Error("Duplicate Sheet Name: "+s);if(r){var a=t&&t[i]&&t[i].CodeName||s;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function check_wb(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];check_wb_names(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)check_ws(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function write_wb_xml(e){var t=[XML_HEADER];t[t.length]=writextag("workbook",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(WBPropsDef.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(s[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=writextag("workbookPr",null,s);var i=e.Workbook&&e.Workbook.Sheets||[],n=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",n=0;n!=e.SheetNames.length&&!(!i[n]||!i[n].Hidden);++n);n==e.SheetNames.length&&(n=0),t[t.length]='<workbookView firstSheet="'+n+'" activeTab="'+n+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",n=0;n!=e.SheetNames.length;++n){var a={name:escapexml(e.SheetNames[n].slice(0,31))};if(a.sheetId=""+(n+1),a["r:id"]="rId"+(n+1),i[n])switch(i[n].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=writextag("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var d={name:o.Name};o.Comment&&(d.comment=o.Comment),o.Sheet!=null&&(d.localSheetId=""+o.Sheet),o.Hidden&&(d.hidden="1"),o.Ref&&(t[t.length]=writextag("definedName",escapexml(o.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function parse_BrtBundleSh(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=parse_RelID(e),r.name=parse_XLWideString(e),r}function write_BrtBundleSh(e,t){return t||(t=new_buf(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),write_RelID(e.strRelID,t),write_XLWideString(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function parse_BrtWbProp(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?parse_XLWideString(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function write_BrtWbProp(e,t){t||(t=new_buf(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),write_XLSBCodeName(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function parse_BrtName(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),n=parse_XLNameWideString(e),a=parse_XLSBNameParsedFormula(e,0,r),o=parse_XLNullableWideString(e);e.l=s;var d={Name:n,Ptg:a};return i<268435455&&(d.Sheet=i),o&&(d.Comment=o),d}function write_BUNDLESHS(e,t){write_record(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};write_record(e,156,write_BrtBundleSh(i))}write_record(e,144)}function write_BrtFileVersion(e,t){t||(t=new_buf(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return write_XLWideString("SheetJS",t),write_XLWideString(XLSX.version,t),write_XLWideString(XLSX.version,t),write_XLWideString("7262",t),t.length>t.l?t.slice(0,t.l):t}function write_BrtBookView(e,t){t||(t=new_buf(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function write_BOOKVIEWS(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,i=-1,n=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&i==-1?i=s:r[s].Hidden==1&&n==-1&&(n=s);n>i||(write_record(e,135),write_record(e,158,write_BrtBookView(i)),write_record(e,136))}}function write_wb_bin(e,t){var r=buf_array();return write_record(r,131),write_record(r,128,write_BrtFileVersion()),write_record(r,153,write_BrtWbProp(e.Workbook&&e.Workbook.WBProps||null)),write_BOOKVIEWS(r,e),write_BUNDLESHS(r,e),write_record(r,132),r.end()}function write_wb(e,t,r){return(t.slice(-4)===".bin"?write_wb_bin:write_wb_xml)(e)}function write_ws(e,t,r,s,i){return(t.slice(-4)===".bin"?write_ws_bin:write_ws_xml)(e,r,s,i)}function write_sty(e,t,r){return(t.slice(-4)===".bin"?write_sty_bin:write_sty_xml)(e,r)}function write_sst(e,t,r){return(t.slice(-4)===".bin"?write_sst_bin:write_sst_xml)(e,r)}function write_cmnt(e,t,r){return(t.slice(-4)===".bin"?write_comments_bin:write_comments_xml)(e)}function write_xlmeta(e){return(e.slice(-4)===".bin"?write_xlmeta_bin:write_xlmeta_xml)()}function write_props_xlml(e,t){var r=[];return e.Props&&r.push(xlml_write_docprops(e.Props,t)),e.Custprops&&r.push(xlml_write_custprops(e.Props,e.Custprops)),r.join("")}function write_wb_xlml(){return""}function write_sty_xlml(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,i){var n=[];n.push(writextag("NumberFormat",null,{"ss:Format":escapexml(table_fmt[s.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(writextag("Style",n.join(""),a))}),writextag("Styles",r.join(""))}function write_name_xlml(e){return writextag("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+a1_to_rc(e.Ref,{r:0,c:0})})}function write_names_xlml(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var i=t[s];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(write_name_xlml(i)))}return writextag("Names",r.join(""))}function write_ws_xlml_names(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var i=s.Workbook.Names,n=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||n.push(write_name_xlml(o)))}return n.join("")}function write_ws_xlml_wsopts(e,t,r,s){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(writextag("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(writextag("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(writextag("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)i.push(writextag("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var n=0;n<r&&!(s.Workbook.Sheets[n]&&!s.Workbook.Sheets[n].Hidden);++n);n==r&&i.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(writetag("ProtectContents","True")),e["!protect"].objects&&i.push(writetag("ProtectObjects","True")),e["!protect"].scenarios&&i.push(writetag("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(writetag("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(writetag("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":writextag("WorksheetOptions",i.join(""),{xmlns:XLMLNS.x})}function write_ws_xlml_comment(e){return e.map(function(t){var r=xlml_unfixstr(t.t||""),s=writextag("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return writextag("Comment",s,{"ss:Author":t.a})}).join("")}function write_ws_xlml_cell(e,t,r,s,i,n,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+escapexml(a1_to_rc(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var d=decode_cell(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(d.r==a.r?"":"["+(d.r-a.r)+"]")+"C"+(d.c==a.c?"":"["+(d.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=escapexml(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=escapexml(e.l.Tooltip))),r["!merges"])for(var l=r["!merges"],c=0;c!=l.length;++c)l[c].s.c!=a.c||l[c].s.r!=a.r||(l[c].e.c>l[c].s.c&&(o["ss:MergeAcross"]=l[c].e.c-l[c].s.c),l[c].e.r>l[c].s.r&&(o["ss:MergeDown"]=l[c].e.r-l[c].s.r));var f="",u="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":f="Number",u=String(e.v);break;case"b":f="Boolean",u=e.v?"1":"0";break;case"e":f="Error",u=BErr[e.v];break;case"d":f="DateTime",u=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||table_fmt[14]);break;case"s":f="String",u=escapexlml(e.v||"");break}var h=get_cell_style(s.cellXfs,e,s);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=a.c+1;var g=e.v!=null?u:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(p+=write_ws_xlml_comment(e.c)),writextag("Cell",p,o)}function write_ws_xlml_row(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=pt2px(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function write_ws_xlml_table(e,t,r,s){if(!e["!ref"])return"";var i=safe_decode_range(e["!ref"]),n=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(x,E){process_col(x);var S=!!x.width,P=col_obj_w(E,x),F={"ss:Index":E+1};S&&(F["ss:Width"]=width2px(P.width)),x.hidden&&(F["ss:Hidden"]="1"),o.push(writextag("Column",null,F))});for(var d=Array.isArray(e),l=i.s.r;l<=i.e.r;++l){for(var c=[write_ws_xlml_row(l,(e["!rows"]||[])[l])],f=i.s.c;f<=i.e.c;++f){var u=!1;for(a=0;a!=n.length;++a)if(!(n[a].s.c>f)&&!(n[a].s.r>l)&&!(n[a].e.c<f)&&!(n[a].e.r<l)){(n[a].s.c!=f||n[a].s.r!=l)&&(u=!0);break}if(!u){var h={r:l,c:f},g=encode_cell(h),p=d?(e[l]||[])[f]:e[g];c.push(write_ws_xlml_cell(p,g,e,t,r,s,h))}}c.push("</Row>"),c.length>2&&o.push(c.join(""))}return o.join("")}function write_ws_xlml(e,t,r){var s=[],i=r.SheetNames[e],n=r.Sheets[i],a=n?write_ws_xlml_names(n,t,e,r):"";return a.length>0&&s.push("<Names>"+a+"</Names>"),a=n?write_ws_xlml_table(n,t,e,r):"",a.length>0&&s.push("<Table>"+a+"</Table>"),s.push(write_ws_xlml_wsopts(n,t,e,r)),s.join("")}function write_xlml(e,t){t||(t={}),e.SSF||(e.SSF=dup(table_fmt)),e.SSF&&(make_ssf(),SSF_load_table(e.SSF),t.revssf=evert_num(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],get_cell_style(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(write_props_xlml(e,t)),r.push(write_wb_xlml()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(writextag("Worksheet",write_ws_xlml(s,t,e),{"ss:Name":escapexml(e.SheetNames[s])}));return r[2]=write_sty_xlml(e,t),r[3]=write_names_xlml(e),XML_HEADER+writextag("Workbook",r.join(""),{xmlns:XLMLNS.ss,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:ss":XLMLNS.ss,"xmlns:dt":XLMLNS.dt,"xmlns:html":XLMLNS.html})}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function write_xls_props(e,t){var r=[],s=[],i=[],n=0,a,o=evert_key(DocSummaryPIDDSI,"n"),d=evert_key(SummaryPIDSI,"n");if(e.Props)for(a=keys(e.Props),n=0;n<a.length;++n)(Object.prototype.hasOwnProperty.call(o,a[n])?r:Object.prototype.hasOwnProperty.call(d,a[n])?s:i).push([a[n],e.Props[a[n]]]);if(e.Custprops)for(a=keys(e.Custprops),n=0;n<a.length;++n)Object.prototype.hasOwnProperty.call(e.Props||{},a[n])||(Object.prototype.hasOwnProperty.call(o,a[n])?r:Object.prototype.hasOwnProperty.call(d,a[n])?s:i).push([a[n],e.Custprops[a[n]]]);var l=[];for(n=0;n<i.length;++n)XLSPSSkip.indexOf(i[n][0])>-1||PseudoPropsPairs.indexOf(i[n][0])>-1||i[n][1]!=null&&l.push(i[n]);s.length&&CFB.utils.cfb_add(t,"/SummaryInformation",write_PropertySetStream(s,PSCLSID.SI,d,SummaryPIDSI)),(r.length||l.length)&&CFB.utils.cfb_add(t,"/DocumentSummaryInformation",write_PropertySetStream(r,PSCLSID.DSI,o,DocSummaryPIDDSI,l.length?l:null,PSCLSID.UDI))}function write_xlscfb(e,t){var r=t||{},s=CFB.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return CFB.utils.cfb_add(s,i,write_biff_buf(e,r)),r.biff==8&&(e.Props||e.Custprops)&&write_xls_props(e,s),r.biff==8&&e.vbaraw&&fill_vba_xls(s,CFB.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function write_biff_rec(e,t,r,s){var i=t;if(!isNaN(i)){var n=s||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,n),n>0&&is_buf(r)&&e.push(r)}}function write_biff_continue(e,t,r,s){var i=(r||[]).length||0;if(i<=8224)return write_biff_rec(e,t,r,i);var n=t;if(!isNaN(n)){for(var a=r.parts||[],o=0,d=0,l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;var c=e.next(4);for(c.write_shift(2,n),c.write_shift(2,l),e.push(r.slice(d,d+l)),d+=l;d<i;){for(c=e.next(4),c.write_shift(2,60),l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;c.write_shift(2,l),e.push(r.slice(d,d+l)),d+=l}}}function write_BIFF2Cell(e,t,r){return e||(e=new_buf(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function write_BIFF2BERR(e,t,r,s){var i=new_buf(9);return write_BIFF2Cell(i,e,t),write_Bes(r,s||"b",i),i}function write_BIFF2LABEL(e,t,r){var s=new_buf(8+2*r.length);return write_BIFF2Cell(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function write_ws_biff2_cell(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?datenum(parseDate(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?write_biff_rec(e,2,write_BIFF2INT(r,s,i)):write_biff_rec(e,3,write_BIFF2NUM(r,s,i));return;case"b":case"e":write_biff_rec(e,5,write_BIFF2BERR(r,s,t.v,t.t));return;case"s":case"str":write_biff_rec(e,4,write_BIFF2LABEL(r,s,(t.v||"").slice(0,255)));return}write_biff_rec(e,1,write_BIFF2Cell(null,r,s))}function write_ws_biff2(e,t,r,s){var i=Array.isArray(t),n=safe_decode_range(t["!ref"]||"A1"),a,o="",d=[];if(n.e.c>255||n.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");n.e.c=Math.min(n.e.c,255),n.e.r=Math.min(n.e.c,16383),a=encode_range(n)}for(var l=n.s.r;l<=n.e.r;++l){o=encode_row(l);for(var c=n.s.c;c<=n.e.c;++c){l===n.s.r&&(d[c]=encode_col(c)),a=d[c]+o;var f=i?(t[l]||[])[c]:t[a];f&&write_ws_biff2_cell(e,f,l,c)}}}function write_biff2_buf(e,t){for(var r=t||{},s=buf_array(),i=0,n=0;n<e.SheetNames.length;++n)e.SheetNames[n]==r.sheet&&(i=n);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return write_biff_rec(s,r.biff==4?1033:r.biff==3?521:9,write_BOF(e,16,r)),write_ws_biff2(s,e.Sheets[e.SheetNames[i]],i,r),write_biff_rec(s,10),s.end()}function write_FONTS_biff8(e,t,r){write_biff_rec(e,49,write_Font({sz:12,name:"Arial"},r))}function write_FMTS_biff8(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)t[i]!=null&&write_biff_rec(e,1054,write_Format(i,t[i],r))})}function write_FEAT(e,t){var r=new_buf(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),write_biff_rec(e,2151,r),r=new_buf(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),write_Ref8U(safe_decode_range(t["!ref"]||"A1"),r),r.write_shift(4,4),write_biff_rec(e,2152,r)}function write_CELLXFS_biff8(e,t){for(var r=0;r<16;++r)write_biff_rec(e,224,write_XF({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){write_biff_rec(e,224,write_XF(s,0,t))})}function write_ws_biff8_hlinks(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];write_biff_rec(e,440,write_HLink(s)),s[1].Tooltip&&write_biff_rec(e,2048,write_HLinkTooltip(s))}delete t["!links"]}function write_ws_cols_biff8(e,t){if(t){var r=0;t.forEach(function(s,i){++r<=256&&s&&write_biff_rec(e,125,write_ColInfo(col_obj_w(i,s),i))})}}function write_ws_biff8_cell(e,t,r,s,i){var n=16+get_cell_style(i.cellXfs,t,i);if(t.v==null&&!t.bf){write_biff_rec(e,513,write_XLSCell(r,s,n));return}if(t.bf)write_biff_rec(e,6,write_Formula(t,r,s,i,n));else switch(t.t){case"d":case"n":var a=t.t=="d"?datenum(parseDate(t.v)):t.v;write_biff_rec(e,515,write_Number(r,s,a,n));break;case"b":case"e":write_biff_rec(e,517,write_BoolErr(r,s,t.v,n,i,t.t));break;case"s":case"str":if(i.bookSST){var o=get_sst_id(i.Strings,t.v,i.revStrings);write_biff_rec(e,253,write_LabelSst(r,s,o,n))}else write_biff_rec(e,516,write_Label(r,s,(t.v||"").slice(0,255),n,i));break;default:write_biff_rec(e,513,write_XLSCell(r,s,n))}}function write_ws_biff8(e,t,r){var s=buf_array(),i=r.SheetNames[e],n=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[e]||{},d=Array.isArray(n),l=t.biff==8,c,f="",u=[],h=safe_decode_range(n["!ref"]||"A1"),g=l?65536:16384;if(h.e.c>255||h.e.r>=g){if(t.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,g-1)}write_biff_rec(s,2057,write_BOF(r,16,t)),write_biff_rec(s,13,writeuint16(1)),write_biff_rec(s,12,writeuint16(100)),write_biff_rec(s,15,writebool(!0)),write_biff_rec(s,17,writebool(!1)),write_biff_rec(s,16,write_Xnum(.001)),write_biff_rec(s,95,writebool(!0)),write_biff_rec(s,42,writebool(!1)),write_biff_rec(s,43,writebool(!1)),write_biff_rec(s,130,writeuint16(1)),write_biff_rec(s,128,write_Guts()),write_biff_rec(s,131,writebool(!1)),write_biff_rec(s,132,writebool(!1)),l&&write_ws_cols_biff8(s,n["!cols"]),write_biff_rec(s,512,write_Dimensions(h,t)),l&&(n["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){f=encode_row(p);for(var x=h.s.c;x<=h.e.c;++x){p===h.s.r&&(u[x]=encode_col(x)),c=u[x]+f;var E=d?(n[p]||[])[x]:n[c];E&&(write_ws_biff8_cell(s,E,p,x,t),l&&E.l&&n["!links"].push([c,E.l]))}}var S=o.CodeName||o.name||i;return l&&write_biff_rec(s,574,write_Window2((a.Views||[])[0])),l&&(n["!merges"]||[]).length&&write_biff_rec(s,229,write_MergeCells(n["!merges"])),l&&write_ws_biff8_hlinks(s,n),write_biff_rec(s,442,write_XLUnicodeString(S)),l&&write_FEAT(s,n),write_biff_rec(s,10),s.end()}function write_biff8_global(e,t,r){var s=buf_array(),i=(e||{}).Workbook||{},n=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,d=r.biff==5;if(write_biff_rec(s,2057,write_BOF(e,5,r)),r.bookType=="xla"&&write_biff_rec(s,135),write_biff_rec(s,225,o?writeuint16(1200):null),write_biff_rec(s,193,writezeroes(2)),d&&write_biff_rec(s,191),d&&write_biff_rec(s,192),write_biff_rec(s,226),write_biff_rec(s,92,write_WriteAccess("SheetJS",r)),write_biff_rec(s,66,writeuint16(o?1200:1252)),o&&write_biff_rec(s,353,writeuint16(0)),o&&write_biff_rec(s,448),write_biff_rec(s,317,write_RRTabId(e.SheetNames.length)),o&&e.vbaraw&&write_biff_rec(s,211),o&&e.vbaraw){var l=a.CodeName||"ThisWorkbook";write_biff_rec(s,442,write_XLUnicodeString(l))}write_biff_rec(s,156,writeuint16(17)),write_biff_rec(s,25,writebool(!1)),write_biff_rec(s,18,writebool(!1)),write_biff_rec(s,19,writeuint16(0)),o&&write_biff_rec(s,431,writebool(!1)),o&&write_biff_rec(s,444,writeuint16(0)),write_biff_rec(s,61,write_Window1()),write_biff_rec(s,64,writebool(!1)),write_biff_rec(s,141,writeuint16(0)),write_biff_rec(s,34,writebool(safe1904(e)=="true")),write_biff_rec(s,14,writebool(!0)),o&&write_biff_rec(s,439,writebool(!1)),write_biff_rec(s,218,writeuint16(0)),write_FONTS_biff8(s,e,r),write_FMTS_biff8(s,e.SSF,r),write_CELLXFS_biff8(s,r),o&&write_biff_rec(s,352,writebool(!1));var c=s.end(),f=buf_array();o&&write_biff_rec(f,140,write_Country()),o&&r.Strings&&write_biff_continue(f,252,write_SST(r.Strings)),write_biff_rec(f,10);var u=f.end(),h=buf_array(),g=0,p=0;for(p=0;p<e.SheetNames.length;++p)g+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var x=c.length+g+u.length;for(p=0;p<e.SheetNames.length;++p){var E=n[p]||{};write_biff_rec(h,133,write_BoundSheet8({pos:x,hs:E.Hidden||0,dt:0,name:e.SheetNames[p]},r)),x+=t[p].length}var S=h.end();if(g!=S.length)throw new Error("BS8 "+g+" != "+S.length);var P=[];return c.length&&P.push(c),S.length&&P.push(S),u.length&&P.push(u),bconcat(P)}function write_biff8_buf(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),r.revssf=evert_num(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,fix_write_opts(r),r.cellXfs=[],get_cell_style(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)s[s.length]=write_ws_biff8(i,r,e);return s.unshift(write_biff8_global(e,s,r)),bconcat(s)}function write_biff_buf(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var i=decode_range(s["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var n=t||{};switch(n.biff||2){case 8:case 5:return write_biff8_buf(e,t);case 4:case 3:case 2:return write_biff2_buf(e,t)}throw new Error("invalid type "+n.bookType+" for BIFF")}function make_html_row(e,t,r,s){for(var i=e["!merges"]||[],n=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,d=0,l=0;l<i.length;++l)if(!(i[l].s.r>r||i[l].s.c>a)&&!(i[l].e.r<r||i[l].e.c<a)){if(i[l].s.r<r||i[l].s.c<a){o=-1;break}o=i[l].e.r-i[l].s.r+1,d=i[l].e.c-i[l].s.c+1;break}if(!(o<0)){var c=encode_cell({r,c:a}),f=s.dense?(e[r]||[])[a]:e[c],u=f&&f.v!=null&&(f.h||escapehtml(f.w||(format_cell(f),f.w)||""))||"",h={};o>1&&(h.rowspan=o),d>1&&(h.colspan=d),s.editable?u='<span contenteditable="true">'+u+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+f.l.Target+'">'+u+"</a>")),h.id=(s.id||"sjs")+"-"+c,n.push(writextag("td",u,h))}}var g="<tr>";return g+n.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function make_html_preamble(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function sheet_to_html(e,t){var r=t||{},s=r.header!=null?r.header:HTML_BEGIN,i=r.footer!=null?r.footer:HTML_END,n=[s],a=decode_range(e["!ref"]);r.dense=Array.isArray(e),n.push(make_html_preamble(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)n.push(make_html_row(e,a,o,r));return n.push("</table>"+i),n.join("")}function sheet_add_dom(e,t,r){var s=r||{},i=0,n=0;if(s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var a=typeof s.origin=="string"?decode_cell(s.origin):s.origin;i=a.r,n=a.c}var o=t.getElementsByTagName("tr"),d=Math.min(s.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:i,c:n}};if(e["!ref"]){var c=decode_range(e["!ref"]);l.s.r=Math.min(l.s.r,c.s.r),l.s.c=Math.min(l.s.c,c.s.c),l.e.r=Math.max(l.e.r,c.e.r),l.e.c=Math.max(l.e.c,c.e.c),i==-1&&(l.e.r=i=c.e.r+1)}var f=[],u=0,h=e["!rows"]||(e["!rows"]=[]),g=0,p=0,x=0,E=0,S=0,P=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&p<d;++g){var F=o[g];if(is_dom_element_hidden(F)){if(s.display)continue;h[p]={hidden:!0}}var A=F.children;for(x=E=0;x<A.length;++x){var C=A[x];if(!(s.display&&is_dom_element_hidden(C))){var _=C.hasAttribute("data-v")?C.getAttribute("data-v"):C.hasAttribute("v")?C.getAttribute("v"):htmldecode(C.innerHTML),w=C.getAttribute("data-z")||C.getAttribute("z");for(u=0;u<f.length;++u){var T=f[u];T.s.c==E+n&&T.s.r<p+i&&p+i<=T.e.r&&(E=T.e.c+1-n,u=-1)}P=+C.getAttribute("colspan")||1,((S=+C.getAttribute("rowspan")||1)>1||P>1)&&f.push({s:{r:p+i,c:E+n},e:{r:p+i+(S||1)-1,c:E+n+(P||1)-1}});var M={t:"s",v:_},R=C.getAttribute("data-t")||C.getAttribute("t")||"";_!=null&&(_.length==0?M.t=R||"z":s.raw||_.trim().length==0||R=="s"||(_==="TRUE"?M={t:"b",v:!0}:_==="FALSE"?M={t:"b",v:!1}:isNaN(fuzzynum(_))?isNaN(fuzzydate(_).getDate())||(M={t:"d",v:parseDate(_)},s.cellDates||(M={t:"n",v:datenum(M.v)}),M.z=s.dateNF||table_fmt[14]):M={t:"n",v:fuzzynum(_)})),M.z===void 0&&w!=null&&(M.z=w);var k="",L=C.getElementsByTagName("A");if(L&&L.length)for(var ae=0;ae<L.length&&!(L[ae].hasAttribute("href")&&(k=L[ae].getAttribute("href"),k.charAt(0)!="#"));++ae);k&&k.charAt(0)!="#"&&(M.l={Target:k}),s.dense?(e[p+i]||(e[p+i]=[]),e[p+i][E+n]=M):e[encode_cell({c:E+n,r:p+i})]=M,l.e.c<E+n&&(l.e.c=E+n),E+=P}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),l.e.r=Math.max(l.e.r,p-1+i),e["!ref"]=encode_range(l),p>=d&&(e["!fullref"]=encode_range((l.e.r=o.length-g+p-1+i,l))),e}function parse_dom_table(e,t){var r=t||{},s=r.dense?[]:{};return sheet_add_dom(s,e,t)}function table_to_book(e,t){return sheet_to_workbook(parse_dom_table(e,t),t)}function is_dom_element_hidden(e){var t="",r=get_get_computed_style_function(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function get_get_computed_style_function(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var write_styles_ods=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return XML_HEADER+t}}(),write_content_ods=function(){var e=function(n){return escapexml(n).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(n,a,o){var d=[];d.push('      <table:table table:name="'+escapexml(a.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,c=0,f=decode_range(n["!ref"]||"A1"),u=n["!merges"]||[],h=0,g=Array.isArray(n);if(n["!cols"])for(c=0;c<=f.e.c;++c)d.push("        <table:table-column"+(n["!cols"][c]?' table:style-name="co'+n["!cols"][c].ods+'"':"")+`></table:table-column>
`);var p="",x=n["!rows"]||[];for(l=0;l<f.s.r;++l)p=x[l]?' table:style-name="ro'+x[l].ods+'"':"",d.push("        <table:table-row"+p+`></table:table-row>
`);for(;l<=f.e.r;++l){for(p=x[l]?' table:style-name="ro'+x[l].ods+'"':"",d.push("        <table:table-row"+p+`>
`),c=0;c<f.s.c;++c)d.push(t);for(;c<=f.e.c;++c){var E=!1,S={},P="";for(h=0;h!=u.length;++h)if(!(u[h].s.c>c)&&!(u[h].s.r>l)&&!(u[h].e.c<c)&&!(u[h].e.r<l)){(u[h].s.c!=c||u[h].s.r!=l)&&(E=!0),S["table:number-columns-spanned"]=u[h].e.c-u[h].s.c+1,S["table:number-rows-spanned"]=u[h].e.r-u[h].s.r+1;break}if(E){d.push(r);continue}var F=encode_cell({r:l,c}),A=g?(n[l]||[])[c]:n[F];if(A&&A.f&&(S["table:formula"]=escapexml(csf_to_ods_formula(A.f)),A.F&&A.F.slice(0,F.length)==F)){var C=decode_range(A.F);S["table:number-matrix-columns-spanned"]=C.e.c-C.s.c+1,S["table:number-matrix-rows-spanned"]=C.e.r-C.s.r+1}if(!A){d.push(t);continue}switch(A.t){case"b":P=A.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=A.v?"true":"false";break;case"n":P=A.w||String(A.v||0),S["office:value-type"]="float",S["office:value"]=A.v||0;break;case"s":case"str":P=A.v==null?"":A.v,S["office:value-type"]="string";break;case"d":P=A.w||parseDate(A.v).toISOString(),S["office:value-type"]="date",S["office:date-value"]=parseDate(A.v).toISOString(),S["table:style-name"]="ce1";break;default:d.push(t);continue}var _=e(P);if(A.l&&A.l.Target){var w=A.l.Target;w=w.charAt(0)=="#"?"#"+csf_to_ods_3D(w.slice(1)):w,w.charAt(0)!="#"&&!w.match(/^\w+:/)&&(w="../"+w),_=writextag("text:a",_,{"xlink:href":w.replace(/&/g,"&amp;")})}d.push("          "+writextag("table:table-cell",writextag("text:p",_,{}),S)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},i=function(n,a){n.push(` <office:automatic-styles>
`),n.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),n.push(`   <number:month number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:day number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:year/>
`),n.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var c=0;c<l["!cols"].length;++c)if(l["!cols"][c]){var f=l["!cols"][c];if(f.width==null&&f.wpx==null&&f.wch==null)continue;process_col(f),f.ods=o;var u=l["!cols"][c].wpx+"px";n.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),n.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+u+`"/>
`),n.push(`  </style:style>
`),++o}}});var d=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var c=0;c<l["!rows"].length;++c)if(l["!rows"][c]){l["!rows"][c].ods=d;var f=l["!rows"][c].hpx+"px";n.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),n.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),n.push(`  </style:style>
`),++d}}}),n.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),n.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),n.push(`  </style:style>
`),n.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),n.push(` </office:automatic-styles>
`)};return function(a,o){var d=[XML_HEADER],l=wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=wxt_helper({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(d.push("<office:document"+l+c+`>
`),d.push(write_meta_ods().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+l+`>
`),i(d,a),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)d.push(s(a.Sheets[a.SheetNames[f]],a,f));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),o.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}}();function write_ods(e,t){if(t.bookType=="fods")return write_content_ods(e,t);var r=zip_new(),s="",i=[],n=[];return s="mimetype",zip_add_file(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",zip_add_file(r,s,write_content_ods(e,t)),i.push([s,"text/xml"]),n.push([s,"ContentFile"]),s="styles.xml",zip_add_file(r,s,write_styles_ods(e,t)),i.push([s,"text/xml"]),n.push([s,"StylesFile"]),s="meta.xml",zip_add_file(r,s,XML_HEADER+write_meta_ods()),i.push([s,"text/xml"]),n.push([s,"MetadataFile"]),s="manifest.rdf",zip_add_file(r,s,write_rdf(n)),i.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",zip_add_file(r,s,write_manifest(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function u8_to_dataview(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function stru8(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):s2a(utf8write(e))}function u8contains(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function u8concat(e){var t=e.reduce(function(i,n){return i+n.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(i){r.set(i,s),s+=i.length}),r}function writeDecimal128LE(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var n=0;i>=1;++n,i/=256)e[t+n]=i&255;e[t+15]|=r>=0?0:128}function parse_varint49(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function write_varint49(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function varint_to_i32(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function parse_shallow(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],i=parse_varint49(e,r),n=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(n){case 0:{for(var d=r[0];e[r[0]++]>=128;);o=e.slice(d,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=parse_varint49(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(n," for Field ").concat(i," at offset ").concat(s))}var l={data:o,type:n};t[i]==null?t[i]=[l]:t[i].push(l)}return t}function write_shallow(e){var t=[];return e.forEach(function(r,s){r.forEach(function(i){i.data&&(t.push(write_varint49(s*8+i.type)),i.type==2&&t.push(write_varint49(i.data.length)),t.push(i.data))})}),u8concat(t)}function parse_iwa_file(e){for(var t,r=[],s=[0];s[0]<e.length;){var i=parse_varint49(e,s),n=parse_shallow(e.slice(s[0],s[0]+i));s[0]+=i;var a={id:varint_to_i32(n[1][0].data),messages:[]};n[2].forEach(function(o){var d=parse_shallow(o.data),l=varint_to_i32(d[3][0].data);a.messages.push({meta:d,data:e.slice(s[0],s[0]+l)}),s[0]+=l}),(t=n[3])!=null&&t[0]&&(a.merge=varint_to_i32(n[3][0].data)>>>0>0),r.push(a)}return r}function write_iwa_file(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:write_varint49(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:write_varint49(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:write_varint49(a.data.length)}],s[2].push({data:write_shallow(a.meta),type:2})});var n=write_shallow(s);t.push(write_varint49(n.length)),t.push(n),i.forEach(function(a){return t.push(a)})}),u8concat(t)}function parse_snappy_chunk(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=parse_varint49(t,r),i=[];r[0]<t.length;){var n=t[r[0]]&3;if(n==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var d=0,l=0;if(n==1?(l=(t[r[0]]>>2&7)+4,d=(t[r[0]++]&224)<<3,d|=t[r[0]++]):(l=(t[r[0]++]>>2)+1,n==2?(d=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(d=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[u8concat(i)],d==0)throw new Error("Invalid offset 0");if(d>i[0].length)throw new Error("Invalid offset beyond length");if(l>=d)for(i.push(i[0].slice(-d)),l-=d;l>=i[i.length-1].length;)i.push(i[i.length-1]),l-=i[i.length-1].length;i.push(i[0].slice(-d,-d+l))}}var c=u8concat(i);if(c.length!=s)throw new Error("Unexpected length: ".concat(c.length," != ").concat(s));return c}function decompress_iwa_file(e){for(var t=[],r=0;r<e.length;){var s=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(parse_snappy_chunk(s,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return u8concat(t)}function compress_iwa_file(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var n=write_varint49(s),a=n.length;t.push(n),s<=60?(a++,t.push(new Uint8Array([s-1<<2]))):s<=256?(a+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(a+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(a+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(a+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),a+=s,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=s}return u8concat(t)}function write_new_storage(e,t){var r=new Uint8Array(32),s=u8_to_dataview(r),i=12,n=0;switch(r[0]=5,e.t){case"n":r[1]=2,writeDecimal128LE(r,i,e.v),n|=1,i+=16;break;case"b":r[1]=6,s.setFloat64(i,e.v?1:0,!0),n|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(i,t.indexOf(e.v),!0),n|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,n,!0),r.slice(0,i)}function write_old_storage(e,t){var r=new Uint8Array(32),s=u8_to_dataview(r),i=12,n=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(i,e.v,!0),n|=32,i+=8;break;case"b":r[2]=6,s.setFloat64(i,e.v?1:0,!0),n|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(i,t.indexOf(e.v),!0),n|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,n,!0),r.slice(0,i)}function parse_TSP_Reference(e){var t=parse_shallow(e);return parse_varint49(t[1][0].data)}function write_tile_row(e,t,r){var s,i,n,a;if(!((s=e[6])!=null&&s[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(n=e[8])==null?void 0:n[0])==null?void 0:a.data)&&varint_to_i32(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var d=0,l=u8_to_dataview(e[7][0].data),c=0,f=[],u=u8_to_dataview(e[4][0].data),h=0,g=[],p=0;p<t.length;++p){if(t[p]==null){l.setUint16(p*2,65535,!0),u.setUint16(p*2,65535);continue}l.setUint16(p*2,c,!0),u.setUint16(p*2,h,!0);var x,E;switch(typeof t[p]){case"string":x=write_new_storage({t:"s",v:t[p]},r),E=write_old_storage({t:"s",v:t[p]},r);break;case"number":x=write_new_storage({t:"n",v:t[p]},r),E=write_old_storage({t:"n",v:t[p]},r);break;case"boolean":x=write_new_storage({t:"b",v:t[p]},r),E=write_old_storage({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(x),c+=x.length,g.push(E),h+=E.length,++d}for(e[2][0].data=write_varint49(d);p<e[7][0].data.length/2;++p)l.setUint16(p*2,65535,!0),u.setUint16(p*2,65535,!0);return e[6][0].data=u8concat(f),e[3][0].data=u8concat(g),d}function write_numbers_iwa(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=decode_range(r["!ref"]);s.s.r=s.s.c=0;var i=!1;s.e.c>9&&(i=!0,s.e.c=9),s.e.r>49&&(i=!0,s.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(encode_range(s)));var n=sheet_to_json(r,{range:s,header:1}),a=["~Sh33tJ5~"];n.forEach(function(b){return b.forEach(function(v){typeof v=="string"&&a.push(v)})});var o={},d=[],l=CFB.read(t.numbers,{type:"base64"});l.FileIndex.map(function(b,v){return[b,l.FullPaths[v]]}).forEach(function(b){var v=b[0],j=b[1];if(v.type==2&&v.name.match(/\.iwa/)){var D=v.content,U=decompress_iwa_file(D),W=parse_iwa_file(U);W.forEach(function(Z){d.push(Z.id),o[Z.id]={deps:[],location:j,type:varint_to_i32(Z.messages[0].meta[1][0].data)}})}}),d.sort(function(b,v){return b-v});var c=d.filter(function(b){return b>1}).map(function(b){return[b,write_varint49(b)]});l.FileIndex.map(function(b,v){return[b,l.FullPaths[v]]}).forEach(function(b){var v=b[0];if(b[1],!!v.name.match(/\.iwa/)){var j=parse_iwa_file(decompress_iwa_file(v.content));j.forEach(function(D){D.messages.forEach(function(U){c.forEach(function(W){D.messages.some(function(Z){return varint_to_i32(Z.meta[1][0].data)!=11006&&u8contains(Z.data,W[1])})&&o[W[0]].deps.push(D.id)})})})}});for(var f=CFB.find(l,o[1].location),u=parse_iwa_file(decompress_iwa_file(f.content)),h,g=0;g<u.length;++g){var p=u[g];p.id==1&&(h=p)}var x=parse_TSP_Reference(parse_shallow(h.messages[0].data)[1][0].data);for(f=CFB.find(l,o[x].location),u=parse_iwa_file(decompress_iwa_file(f.content)),g=0;g<u.length;++g)p=u[g],p.id==x&&(h=p);for(x=parse_TSP_Reference(parse_shallow(h.messages[0].data)[2][0].data),f=CFB.find(l,o[x].location),u=parse_iwa_file(decompress_iwa_file(f.content)),g=0;g<u.length;++g)p=u[g],p.id==x&&(h=p);for(x=parse_TSP_Reference(parse_shallow(h.messages[0].data)[2][0].data),f=CFB.find(l,o[x].location),u=parse_iwa_file(decompress_iwa_file(f.content)),g=0;g<u.length;++g)p=u[g],p.id==x&&(h=p);var E=parse_shallow(h.messages[0].data);{E[6][0].data=write_varint49(s.e.r+1),E[7][0].data=write_varint49(s.e.c+1);var S=parse_TSP_Reference(E[46][0].data),P=CFB.find(l,o[S].location),F=parse_iwa_file(decompress_iwa_file(P.content));{for(var A=0;A<F.length&&F[A].id!=S;++A);if(F[A].id!=S)throw"Bad ColumnRowUIDMapArchive";var C=parse_shallow(F[A].messages[0].data);C[1]=[],C[2]=[],C[3]=[];for(var _=0;_<=s.e.c;++_){var w=[];w[1]=w[2]=[{type:0,data:write_varint49(_+420690)}],C[1].push({type:2,data:write_shallow(w)}),C[2].push({type:0,data:write_varint49(_)}),C[3].push({type:0,data:write_varint49(_)})}C[4]=[],C[5]=[],C[6]=[];for(var T=0;T<=s.e.r;++T)w=[],w[1]=w[2]=[{type:0,data:write_varint49(T+726270)}],C[4].push({type:2,data:write_shallow(w)}),C[5].push({type:0,data:write_varint49(T)}),C[6].push({type:0,data:write_varint49(T)});F[A].messages[0].data=write_shallow(C)}P.content=compress_iwa_file(write_iwa_file(F)),P.size=P.content.length,delete E[46];var M=parse_shallow(E[4][0].data);{M[7][0].data=write_varint49(s.e.r+1);var R=parse_shallow(M[1][0].data),k=parse_TSP_Reference(R[2][0].data);P=CFB.find(l,o[k].location),F=parse_iwa_file(decompress_iwa_file(P.content));{if(F[0].id!=k)throw"Bad HeaderStorageBucket";var L=parse_shallow(F[0].messages[0].data);for(T=0;T<n.length;++T){var ae=parse_shallow(L[2][0].data);ae[1][0].data=write_varint49(T),ae[4][0].data=write_varint49(n[T].length),L[2][T]={type:L[2][0].type,data:write_shallow(ae)}}F[0].messages[0].data=write_shallow(L)}P.content=compress_iwa_file(write_iwa_file(F)),P.size=P.content.length;var Q=parse_TSP_Reference(M[2][0].data);P=CFB.find(l,o[Q].location),F=parse_iwa_file(decompress_iwa_file(P.content));{if(F[0].id!=Q)throw"Bad HeaderStorageBucket";for(L=parse_shallow(F[0].messages[0].data),_=0;_<=s.e.c;++_)ae=parse_shallow(L[2][0].data),ae[1][0].data=write_varint49(_),ae[4][0].data=write_varint49(s.e.r+1),L[2][_]={type:L[2][0].type,data:write_shallow(ae)};F[0].messages[0].data=write_shallow(L)}P.content=compress_iwa_file(write_iwa_file(F)),P.size=P.content.length;var oe=parse_TSP_Reference(M[4][0].data);(function(){for(var b=CFB.find(l,o[oe].location),v=parse_iwa_file(decompress_iwa_file(b.content)),j,D=0;D<v.length;++D){var U=v[D];U.id==oe&&(j=U)}var W=parse_shallow(j.messages[0].data);{W[3]=[];var Z=[];a.forEach(function(xe,Re){Z[1]=[{type:0,data:write_varint49(Re)}],Z[2]=[{type:0,data:write_varint49(1)}],Z[3]=[{type:2,data:stru8(xe)}],W[3].push({type:2,data:write_shallow(Z)})})}j.messages[0].data=write_shallow(W);var te=write_iwa_file(v),ve=compress_iwa_file(te);b.content=ve,b.size=b.content.length})();var re=parse_shallow(M[3][0].data);{var me=re[1][0];delete re[2];var H=parse_shallow(me.data);{var ie=parse_TSP_Reference(H[2][0].data);(function(){for(var b=CFB.find(l,o[ie].location),v=parse_iwa_file(decompress_iwa_file(b.content)),j,D=0;D<v.length;++D){var U=v[D];U.id==ie&&(j=U)}var W=parse_shallow(j.messages[0].data);{delete W[6],delete re[7];var Z=new Uint8Array(W[5][0].data);W[5]=[];for(var te=0,ve=0;ve<=s.e.r;++ve){var xe=parse_shallow(Z);te+=write_tile_row(xe,n[ve],a),xe[1][0].data=write_varint49(ve),W[5].push({data:write_shallow(xe),type:2})}W[1]=[{type:0,data:write_varint49(s.e.c+1)}],W[2]=[{type:0,data:write_varint49(s.e.r+1)}],W[3]=[{type:0,data:write_varint49(te)}],W[4]=[{type:0,data:write_varint49(s.e.r+1)}]}j.messages[0].data=write_shallow(W);var Re=write_iwa_file(v),Ae=compress_iwa_file(Re);b.content=Ae,b.size=b.content.length})()}me.data=write_shallow(H)}M[3][0].data=write_shallow(re)}E[4][0].data=write_shallow(M)}h.messages[0].data=write_shallow(E);var le=write_iwa_file(u),N=compress_iwa_file(le);return f.content=N,f.size=f.content.length,l}function fix_opts_func(e){return function(r){for(var s=0;s!=e.length;++s){var i=e[s];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function fix_write_opts(e){fix_opts_func([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function write_zip(e,t){return t.bookType=="ods"?write_ods(e,t):t.bookType=="numbers"?write_numbers_iwa(e,t):t.bookType=="xlsb"?write_zip_xlsxb(e,t):write_zip_xlsx(e,t)}function write_zip_xlsxb(e,t){_shapeid=1024,e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),t.revssf=evert_num(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,browser_has_Map?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=VBAFMTS.indexOf(t.bookType)>-1,i=new_ct();fix_write_opts(t=t||{});var n=zip_new(),a="",o=0;if(t.cellXfs=[],get_cell_style(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",zip_add_file(n,a,write_core_props(e.Props,t)),i.coreprops.push(a),add_rels(t.rels,2,a,RELS.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&d.push(e.SheetNames[l]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(n,a,write_ext_props(e.Props)),i.extprops.push(a),add_rels(t.rels,3,a,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(a="docProps/custom.xml",zip_add_file(n,a,write_cust_props(e.Custprops)),i.custprops.push(a),add_rels(t.rels,4,a,RELS.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var c={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],u=(f||{})["!type"]||"sheet";switch(u){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,zip_add_file(n,a,write_ws(o-1,a,t,e,c)),i.sheets.push(a),add_rels(t.wbrels,-1,"worksheets/sheet"+o+"."+r,RELS.WS[0])}if(f){var h=f["!comments"],g=!1,p="";h&&h.length>0&&(p="xl/comments"+o+"."+r,zip_add_file(n,p,write_cmnt(h,p)),i.comments.push(p),add_rels(c,-1,"../comments"+o+"."+r,RELS.CMNT),g=!0),f["!legacy"]&&g&&zip_add_file(n,"xl/drawings/vmlDrawing"+o+".vml",write_comments_vml(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}c["!id"].rId1&&zip_add_file(n,get_rels_path(a),write_rels(c))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,zip_add_file(n,a,write_sst(t.Strings,a,t)),i.strs.push(a),add_rels(t.wbrels,-1,"sharedStrings."+r,RELS.SST)),a="xl/workbook."+r,zip_add_file(n,a,write_wb(e,a)),i.workbooks.push(a),add_rels(t.rels,1,a,RELS.WB),a="xl/theme/theme1.xml",zip_add_file(n,a,write_theme(e.Themes,t)),i.themes.push(a),add_rels(t.wbrels,-1,"theme/theme1.xml",RELS.THEME),a="xl/styles."+r,zip_add_file(n,a,write_sty(e,a,t)),i.styles.push(a),add_rels(t.wbrels,-1,"styles."+r,RELS.STY),e.vbaraw&&s&&(a="xl/vbaProject.bin",zip_add_file(n,a,e.vbaraw),i.vba.push(a),add_rels(t.wbrels,-1,"vbaProject.bin",RELS.VBA)),a="xl/metadata."+r,zip_add_file(n,a,write_xlmeta(a)),i.metadata.push(a),add_rels(t.wbrels,-1,"metadata."+r,RELS.XLMETA),zip_add_file(n,"[Content_Types].xml",write_ct(i,t)),zip_add_file(n,"_rels/.rels",write_rels(t.rels)),zip_add_file(n,"xl/_rels/workbook."+r+".rels",write_rels(t.wbrels)),delete t.revssf,delete t.ssf,n}function write_zip_xlsx(e,t){_shapeid=1024,e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),t.revssf=evert_num(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,browser_has_Map?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=VBAFMTS.indexOf(t.bookType)>-1,i=new_ct();fix_write_opts(t=t||{});var n=zip_new(),a="",o=0;if(t.cellXfs=[],get_cell_style(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",zip_add_file(n,a,write_core_props(e.Props,t)),i.coreprops.push(a),add_rels(t.rels,2,a,RELS.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&d.push(e.SheetNames[l]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(n,a,write_ext_props(e.Props)),i.extprops.push(a),add_rels(t.rels,3,a,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(a="docProps/custom.xml",zip_add_file(n,a,write_cust_props(e.Custprops)),i.custprops.push(a),add_rels(t.rels,4,a,RELS.CUST_PROPS));var c=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},u=e.Sheets[e.SheetNames[o-1]],h=(u||{})["!type"]||"sheet";switch(h){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,zip_add_file(n,a,write_ws_xml(o-1,t,e,f)),i.sheets.push(a),add_rels(t.wbrels,-1,"worksheets/sheet"+o+"."+r,RELS.WS[0])}if(u){var g=u["!comments"],p=!1,x="";if(g&&g.length>0){var E=!1;g.forEach(function(S){S[1].forEach(function(P){P.T==!0&&(E=!0)})}),E&&(x="xl/threadedComments/threadedComment"+o+"."+r,zip_add_file(n,x,write_tcmnt_xml(g,c,t)),i.threadedcomments.push(x),add_rels(f,-1,"../threadedComments/threadedComment"+o+"."+r,RELS.TCMNT)),x="xl/comments"+o+"."+r,zip_add_file(n,x,write_comments_xml(g)),i.comments.push(x),add_rels(f,-1,"../comments"+o+"."+r,RELS.CMNT),p=!0}u["!legacy"]&&p&&zip_add_file(n,"xl/drawings/vmlDrawing"+o+".vml",write_comments_vml(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}f["!id"].rId1&&zip_add_file(n,get_rels_path(a),write_rels(f))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,zip_add_file(n,a,write_sst_xml(t.Strings,t)),i.strs.push(a),add_rels(t.wbrels,-1,"sharedStrings."+r,RELS.SST)),a="xl/workbook."+r,zip_add_file(n,a,write_wb_xml(e)),i.workbooks.push(a),add_rels(t.rels,1,a,RELS.WB),a="xl/theme/theme1.xml",zip_add_file(n,a,write_theme(e.Themes,t)),i.themes.push(a),add_rels(t.wbrels,-1,"theme/theme1.xml",RELS.THEME),a="xl/styles."+r,zip_add_file(n,a,write_sty_xml(e,t)),i.styles.push(a),add_rels(t.wbrels,-1,"styles."+r,RELS.STY),e.vbaraw&&s&&(a="xl/vbaProject.bin",zip_add_file(n,a,e.vbaraw),i.vba.push(a),add_rels(t.wbrels,-1,"vbaProject.bin",RELS.VBA)),a="xl/metadata."+r,zip_add_file(n,a,write_xlmeta_xml()),i.metadata.push(a),add_rels(t.wbrels,-1,"metadata."+r,RELS.XLMETA),c.length>1&&(a="xl/persons/person.xml",zip_add_file(n,a,write_people_xml(c)),i.people.push(a),add_rels(t.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(n,"[Content_Types].xml",write_ct(i,t)),zip_add_file(n,"_rels/.rels",write_rels(t.rels)),zip_add_file(n,"xl/_rels/workbook."+r+".rels",write_rels(t.wbrels)),delete t.revssf,delete t.ssf,n}function firstbyte(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Base64_decode(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function write_cfb_ctr(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return write_dl(t.file,CFB.write(e,{type:has_buf?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return CFB.write(e,t)}function write_zip_type(e,t){var r=dup(t||{}),s=write_zip(e,r);return write_zip_denouement(s,r)}function write_zip_denouement(e,t){var r={},s=has_buf?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?CFB.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(s2ab(i))}return t.password&&typeof encrypt_agile<"u"?write_cfb_ctr(encrypt_agile(i,t.password),t):t.type==="file"?write_dl(t.file,i):t.type=="string"?utf8read(i):i}function write_cfb_type(e,t){var r=t||{},s=write_xlscfb(e,r);return write_cfb_ctr(s,r)}function write_string_type(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return Base64_encode(utf8write(s));case"binary":return utf8write(s);case"string":return e;case"file":return write_dl(t.file,s,"utf8");case"buffer":return has_buf?Buffer_from(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):write_string_type(s,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function write_stxt_type(e,t){switch(t.type){case"base64":return Base64_encode(e);case"binary":return e;case"string":return e;case"file":return write_dl(t.file,e,"binary");case"buffer":return has_buf?Buffer_from(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function write_binary_type(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?Base64_encode(r):t.type=="string"?utf8read(r):r;case"file":return write_dl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function writeSync(e,t){reset_cp(),check_wb(e);var r=dup(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=writeSync(e,r);return r.type="array",s2ab(s)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return write_string_type(write_xlml(e,r),r);case"slk":case"sylk":return write_string_type(SYLK.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return write_string_type(sheet_to_html(e.Sheets[e.SheetNames[i]],r),r);case"txt":return write_stxt_type(sheet_to_txt(e.Sheets[e.SheetNames[i]],r),r);case"csv":return write_string_type(sheet_to_csv(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return write_string_type(DIF.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return write_binary_type(DBF.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return write_string_type(PRN.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return write_string_type(RTF.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return write_string_type(ETH.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return write_string_type(write_ods(e,r),r);case"wk1":return write_binary_type(WK_.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return write_binary_type(WK_.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),write_binary_type(write_biff_buf(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),write_cfb_type(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return write_zip_type(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function make_json_row(e,t,r,s,i,n,a,o){var d=encode_row(r),l=o.defval,c=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,u=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:r,enumerable:!1})}catch{u.__rowNum__=r}else u.__rowNum__=r;if(!a||e[r])for(var h=t.s.c;h<=t.e.c;++h){var g=a?e[r][h]:e[s[h]+d];if(g===void 0||g.t===void 0){if(l===void 0)continue;n[h]!=null&&(u[n[h]]=l);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(n[h]!=null){if(p==null)if(g.t=="e"&&p===null)u[n[h]]=null;else if(l!==void 0)u[n[h]]=l;else if(c&&p===null)u[n[h]]=null;else continue;else u[n[h]]=c&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?p:format_cell(g,p,o);p!=null&&(f=!1)}}return{row:u,isempty:f}}function sheet_to_json(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,i=1,n=[],a=0,o="",d={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},c=l.range!=null?l.range:e["!ref"];switch(l.header===1?s=1:l.header==="A"?s=2:Array.isArray(l.header)?s=3:l.header==null&&(s=0),typeof c){case"string":d=safe_decode_range(c);break;case"number":d=safe_decode_range(e["!ref"]),d.s.r=c;break;default:d=c}s>0&&(i=0);var f=encode_row(d.s.r),u=[],h=[],g=0,p=0,x=Array.isArray(e),E=d.s.r,S=0,P={};x&&!e[E]&&(e[E]=[]);var F=l.skipHidden&&e["!cols"]||[],A=l.skipHidden&&e["!rows"]||[];for(S=d.s.c;S<=d.e.c;++S)if(!(F[S]||{}).hidden)switch(u[S]=encode_col(S),r=x?e[E][S]:e[u[S]+f],s){case 1:n[S]=S-d.s.c;break;case 2:n[S]=u[S];break;case 3:n[S]=l.header[S-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=format_cell(r,null,l),p=P[a]||0,!p)P[a]=1;else{do o=a+"_"+p++;while(P[o]);P[a]=p,P[o]=1}n[S]=o}for(E=d.s.r+i;E<=d.e.r;++E)if(!(A[E]||{}).hidden){var C=make_json_row(e,d,E,u,s,n,x,l);(C.isempty===!1||(s===1?l.blankrows!==!1:l.blankrows))&&(h[g++]=C.row)}return h.length=g,h}var qreg=/"/g;function make_csv_row(e,t,r,s,i,n,a,o){for(var d=!0,l=[],c="",f=encode_row(r),u=t.s.c;u<=t.e.c;++u)if(s[u]){var h=o.dense?(e[r]||[])[u]:e[s[u]+f];if(h==null)c="";else if(h.v!=null){d=!1,c=""+(o.rawNumbers&&h.t=="n"?h.v:format_cell(h,null,o));for(var g=0,p=0;g!==c.length;++g)if((p=c.charCodeAt(g))===i||p===n||p===34||o.forceQuotes){c='"'+c.replace(qreg,'""')+'"';break}c=="ID"&&(c='"ID"')}else h.f!=null&&!h.F?(d=!1,c="="+h.f,c.indexOf(",")>=0&&(c='"'+c.replace(qreg,'""')+'"')):c="";l.push(c)}return o.blankrows===!1&&d?null:l.join(a)}function sheet_to_csv(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var i=safe_decode_range(e["!ref"]),n=s.FS!==void 0?s.FS:",",a=n.charCodeAt(0),o=s.RS!==void 0?s.RS:`
`,d=o.charCodeAt(0),l=new RegExp((n=="|"?"\\|":n)+"+$"),c="",f=[];s.dense=Array.isArray(e);for(var u=s.skipHidden&&e["!cols"]||[],h=s.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(u[g]||{}).hidden||(f[g]=encode_col(g));for(var p=0,x=i.s.r;x<=i.e.r;++x)(h[x]||{}).hidden||(c=make_csv_row(e,i,x,f,a,d,n,s),c!=null&&(s.strip&&(c=c.replace(l,"")),(c||s.blankrows!==!1)&&r.push((p++?o:"")+c)));return delete s.dense,r.join("")}function sheet_to_txt(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=sheet_to_csv(e,t);return r}function sheet_to_formulae(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var i=safe_decode_range(e["!ref"]),n="",a=[],o,d=[],l=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=encode_col(o);for(var c=i.s.r;c<=i.e.r;++c)for(n=encode_row(c),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+n,r=l?(e[c]||[])[o]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}d[d.length]=t+"="+s}return d}function sheet_add_json(e,t,r){var s=r||{},i=+!s.skipHeader,n=e||{},a=0,o=0;if(n&&s.origin!=null)if(typeof s.origin=="number")a=s.origin;else{var d=typeof s.origin=="string"?decode_cell(s.origin):s.origin;a=d.r,o=d.c}var l,c={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(n["!ref"]){var f=safe_decode_range(n["!ref"]);c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),a==-1&&(a=f.e.r+1,c.e.r=a+t.length-1+i)}else a==-1&&(a=0,c.e.r=t.length-1+i);var u=s.header||[],h=0;t.forEach(function(p,x){keys(p).forEach(function(E){(h=u.indexOf(E))==-1&&(u[h=u.length]=E);var S=p[E],P="z",F="",A=encode_cell({c:o+h,r:a+x+i});l=ws_get_cell_stub(n,A),S&&typeof S=="object"&&!(S instanceof Date)?n[A]=S:(typeof S=="number"?P="n":typeof S=="boolean"?P="b":typeof S=="string"?P="s":S instanceof Date?(P="d",s.cellDates||(P="n",S=datenum(S)),F=s.dateNF||table_fmt[14]):S===null&&s.nullError&&(P="e",S=0),l?(l.t=P,l.v=S,delete l.w,delete l.R,F&&(l.z=F)):n[A]=l={t:P,v:S},F&&(l.z=F))})}),c.e.c=Math.max(c.e.c,o+u.length-1);var g=encode_row(a);if(i)for(h=0;h<u.length;++h)n[encode_col(h+o)+g]={t:"s",v:u[h]};return n["!ref"]=encode_range(c),n}function json_to_sheet(e,t){return sheet_add_json(null,e,t)}function ws_get_cell_stub(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=decode_cell(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ws_get_cell_stub(e,encode_cell(t)):ws_get_cell_stub(e,encode_cell({r:t,c:r||0}))}function wb_sheet_idx(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(e,t,r,s){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var n=r.match(/(^.*?)(\d+)$/);i=n&&+n[2]||0;var a=n&&n[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(check_ws_name(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function book_set_sheet_visibility(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=wb_sheet_idx(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function cell_set_number_format(e,t){return e.z=t,e}function cell_set_hyperlink(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function cell_set_internal_link(e,t,r){return cell_set_hyperlink(e,"#"+t,r)}function cell_add_comment(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function sheet_set_array_formula(e,t,r,s){for(var i=typeof t!="string"?t:safe_decode_range(t),n=typeof t=="string"?t:encode_range(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var d=ws_get_cell_stub(e,a,o);d.t="n",d.F=n,delete d.v,a==i.s.r&&o==i.s.c&&(d.f=r,s&&(d.D=!0))}return e}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function downloadMonitoringExcelTemplate(e){var C,_;const t=utils.book_new(),r=[["MPFM Monitor - Registro de Monitoramento Diário"],[""],["Unidade:","FPSO Bacalhau"],["Operador:","Equinor Brasil Energia Ltda."],["Período:",`${((C=e[0])==null?void 0:C.date)||"-"} a ${((_=e[e.length-1])==null?void 0:_.date)||"-"}`],["Total de Registros:",e.length],["Gerado em:",new Date().toLocaleString("pt-BR")],[""],["RESUMO ESTATÍSTICO"],[""]];if(e.length>0){const w=calculateStats(e);r.push(["Variável","Mínimo","Máximo","Média","Último Valor"],["Balanço HC (%)",w.hcBalTS.min.toFixed(2),w.hcBalTS.max.toFixed(2),w.hcBalTS.avg.toFixed(2),w.hcBalTS.last.toFixed(2)],["Balanço Total (%)",w.totalBalTS.min.toFixed(2),w.totalBalTS.max.toFixed(2),w.totalBalTS.avg.toFixed(2),w.totalBalTS.last.toFixed(2)],["HC Subsea (t)",w.subHC.min.toFixed(2),w.subHC.max.toFixed(2),w.subHC.avg.toFixed(2),w.subHC.last.toFixed(2)],["HC Topside (t)",w.topHC.min.toFixed(2),w.topHC.max.toFixed(2),w.topHC.avg.toFixed(2),w.topHC.last.toFixed(2)],["HC Separador (t)",w.sepHC.min.toFixed(2),w.sepHC.max.toFixed(2),w.sepHC.avg.toFixed(2),w.sepHC.last.toFixed(2)])}const s=utils.aoa_to_sheet(r);s["!cols"]=[{wch:20},{wch:12},{wch:12},{wch:12},{wch:12}],utils.book_append_sheet(t,s,"Resumo");const i=["Data","Óleo Sub (t)","Gás Sub (t)","Água Sub (t)","HC Sub (t)","Óleo Top (t)","Gás Top (t)","Água Top (t)","HC Top (t)","Óleo Sep (t)","Gás Sep (t)","Água Sep (t)","HC Sep (t)","Balanço HC (%)","Balanço Total (%)","Status HC","Status Total","Ação","Dias Consec. Sub-Sep","Dias Consec. Top-Sep","Dias Consec. Top-Sub"],n=e.map(w=>[w.date,w.subOil||0,w.subGas||0,w.subWater||0,w.subHC||0,w.topOil||0,w.topGas||0,w.topWater||0,w.topHC||0,w.sepOil||0,w.sepGas||0,w.sepWater||0,w.sepHC||0,w.hcBalTS||0,w.totalBalTS||0,w.hcStatus||"-",w.totalStatus||"-",w.action||"-",w.subVsTS||0,w.topVsTS||0,w.topVsSub||0]),a=utils.aoa_to_sheet([i,...n]);a["!cols"]=[{wch:12},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:12},{wch:14},{wch:10},{wch:12},{wch:12},{wch:18},{wch:18},{wch:18}],utils.book_append_sheet(t,a,"Monitoramento Diário");const o=["Data","Medidor","Óleo (t)","Gás (t)","Água (t)","HC (t)","Total (t)"],d=e.map(w=>[w.date,"Subsea MPFM",w.subOil||0,w.subGas||0,w.subWater||0,w.subHC||0,(w.subHC||0)+(w.subWater||0)]),l=utils.aoa_to_sheet([o,...d]);utils.book_append_sheet(t,l,"Subsea");const c=["Data","Medidor","Óleo (t)","Gás (t)","Água (t)","HC (t)","Total (t)"],f=e.map(w=>[w.date,"Topside MPFM",w.topOil||0,w.topGas||0,w.topWater||0,w.topHC||0,(w.topHC||0)+(w.topWater||0)]),u=utils.aoa_to_sheet([c,...f]);utils.book_append_sheet(t,u,"Topside");const h=["Data","Referência","Óleo (t)","Gás (t)","Água (t)","HC (t)","Total (t)"],g=e.map(w=>[w.date,"Test Separator",w.sepOil||0,w.sepGas||0,w.sepWater||0,w.sepHC||0,(w.sepHC||0)+(w.sepWater||0)]),p=utils.aoa_to_sheet([h,...g]);utils.book_append_sheet(t,p,"Separador");const x=["Data","HC Subsea (t)","HC Topside (t)","HC Separator (t)","Balanço Sub-Sep (%)","Balanço Top-Sep (%)","Balanço Top-Sub (%)","Status HC","Ação"],E=e.map(w=>{const T=w.sepHC>0?(w.subHC-w.sepHC)/w.sepHC*100:0,M=w.subHC>0?(w.topHC-w.subHC)/w.subHC*100:0;return[w.date,w.subHC||0,w.topHC||0,w.sepHC||0,T.toFixed(2),(w.hcBalTS||0).toFixed(2),M.toFixed(2),w.hcStatus||"-",w.action||"-"]}),S=utils.aoa_to_sheet([x,...E]);utils.book_append_sheet(t,S,"Balanços");const P=writeSync(t,{bookType:"xlsx",type:"array"}),F=new Blob([P],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),A=`MPFM_Monitoramento_${new Date().toISOString().split("T")[0]}.xlsx`;downloadBlob(F,A)}function calculateStats(e){const t=r=>{const s=e.map(i=>i[r]).filter(i=>i!=null&&!isNaN(i));return s.length===0?{min:0,max:0,avg:0,last:0}:{min:Math.min(...s),max:Math.max(...s),avg:s.reduce((i,n)=>i+n,0)/s.length,last:s[s.length-1]}};return{hcBalTS:t("hcBalTS"),totalBalTS:t("totalBalTS"),subHC:t("subHC"),topHC:t("topHC"),sepHC:t("sepHC")}}function downloadBlob(e,t){const r=URL.createObjectURL(e),s=document.createElement("a");s.href=r,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}const AVAILABLE_VARIABLES=[{id:"subOil",name:"Óleo Subsea",unit:"t",color:"#3b82f6",category:"production",dataKey:"subOil",icon:Droplets},{id:"subGas",name:"Gás Subsea",unit:"t",color:"#60a5fa",category:"production",dataKey:"subGas",icon:Flame},{id:"subWater",name:"Água Subsea",unit:"t",color:"#93c5fd",category:"production",dataKey:"subWater",icon:Droplets},{id:"subHC",name:"HC Subsea",unit:"t",color:"#2563eb",category:"production",dataKey:"subHC",icon:Activity},{id:"topOil",name:"Óleo Topside",unit:"t",color:"#8b5cf6",category:"production",dataKey:"topOil",icon:Droplets},{id:"topGas",name:"Gás Topside",unit:"t",color:"#a78bfa",category:"production",dataKey:"topGas",icon:Flame},{id:"topWater",name:"Água Topside",unit:"t",color:"#c4b5fd",category:"production",dataKey:"topWater",icon:Droplets},{id:"topHC",name:"HC Topside",unit:"t",color:"#7c3aed",category:"production",dataKey:"topHC",icon:Activity},{id:"sepOil",name:"Óleo Separador",unit:"t",color:"#10b981",category:"production",dataKey:"sepOil",icon:Droplets},{id:"sepGas",name:"Gás Separador",unit:"t",color:"#34d399",category:"production",dataKey:"sepGas",icon:Flame},{id:"sepWater",name:"Água Separador",unit:"t",color:"#6ee7b7",category:"production",dataKey:"sepWater",icon:Droplets},{id:"sepHC",name:"HC Separador",unit:"t",color:"#059669",category:"production",dataKey:"sepHC",icon:Activity},{id:"hcBalTS",name:"Balanço HC Top vs Sep",unit:"%",color:"#f59e0b",category:"balance",dataKey:"hcBalTS",icon:TrendingUp},{id:"totalBalTS",name:"Balanço Total Top vs Sep",unit:"%",color:"#f97316",category:"balance",dataKey:"totalBalTS",icon:TrendingUp},{id:"hcBalSS",name:"Balanço HC Sub vs Sep",unit:"%",color:"#eab308",category:"balance",dataKey:"hcBalSS",icon:TrendingUp},{id:"subVsTS",name:"Dias Consec. Sub vs TS",unit:"d",color:"#ef4444",category:"operational",dataKey:"subVsTS",icon:Calendar},{id:"topVsTS",name:"Dias Consec. Top vs TS",unit:"d",color:"#dc2626",category:"operational",dataKey:"topVsTS",icon:Calendar},{id:"topVsSub",name:"Dias Consec. Top vs Sub",unit:"d",color:"#b91c1c",category:"operational",dataKey:"topVsSub",icon:Calendar}];function RegistroDiario(){const{monitoringData:e,setShowImportModal:t}=useAppStore(),[r,s]=reactExports.useState(""),[i,n]=reactExports.useState(""),[a,o]=reactExports.useState(["subHC","topHC","sepHC","hcBalTS"]),[d,l]=reactExports.useState("line"),[c,f]=reactExports.useState("grafico"),[u,h]=reactExports.useState("all"),g=reactExports.useMemo(()=>{let F=[...e];return r&&(F=F.filter(A=>A.date>=r)),i&&(F=F.filter(A=>A.date<=i)),F.sort((A,C)=>A.date.localeCompare(C.date)),F},[e,r,i]),p=reactExports.useMemo(()=>u==="all"?AVAILABLE_VARIABLES:AVAILABLE_VARIABLES.filter(F=>F.category===u),[u]),x=F=>{o(A=>A.includes(F)?A.filter(C=>C!==F):[...A,F])},E=reactExports.useMemo(()=>{const F={};return a.forEach(A=>{const C=g.map(_=>_[A]).filter(_=>_!=null&&!isNaN(_));C.length>0&&(F[A]={min:Math.min(...C),max:Math.max(...C),avg:C.reduce((_,w)=>_+w,0)/C.length,last:C[C.length-1]})}),F},[g,a]),S=()=>{downloadMonitoringExcelTemplate(g)},P=()=>{if(g.length===0)return jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-80 text-zinc-500",children:[jsxRuntimeExports.jsx(Database,{className:"w-12 h-12 mb-4"}),jsxRuntimeExports.jsx("p",{children:"Nenhum dado disponível para visualização"}),jsxRuntimeExports.jsx(Button,{variant:"secondary",className:"mt-4",onClick:()=>t(!0),children:"Importar Dados"})]});const F=AVAILABLE_VARIABLES.filter(_=>a.includes(_.id)),A={data:g,margin:{top:10,right:30,left:0,bottom:0}},C=d==="line"?LineChart:d==="area"?AreaChart:BarChart;return jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:400,children:jsxRuntimeExports.jsxs(C,{...A,children:[jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3",stroke:"#27272a"}),jsxRuntimeExports.jsx(XAxis,{dataKey:"date",stroke:"#71717a",fontSize:11,tickFormatter:_=>_.slice(5)}),jsxRuntimeExports.jsx(YAxis,{stroke:"#71717a",fontSize:11}),jsxRuntimeExports.jsx(Tooltip,{contentStyle:{backgroundColor:"#18181b",border:"1px solid #27272a",borderRadius:"8px",fontSize:"12px"},labelFormatter:_=>`Data: ${_}`}),jsxRuntimeExports.jsx(Legend,{wrapperStyle:{fontSize:"11px"}}),a.some(_=>_.includes("Bal"))&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ReferenceLine,{y:10,stroke:"#ef4444",strokeDasharray:"5 5",label:"±10%"}),jsxRuntimeExports.jsx(ReferenceLine,{y:-10,stroke:"#ef4444",strokeDasharray:"5 5"}),jsxRuntimeExports.jsx(ReferenceLine,{y:7,stroke:"#f59e0b",strokeDasharray:"3 3",label:"±7%"}),jsxRuntimeExports.jsx(ReferenceLine,{y:-7,stroke:"#f59e0b",strokeDasharray:"3 3"})]}),F.map(_=>d==="line"?jsxRuntimeExports.jsx(Line,{type:"monotone",dataKey:_.dataKey,stroke:_.color,name:_.name,strokeWidth:2,dot:{r:3},activeDot:{r:5}},_.id):d==="area"?jsxRuntimeExports.jsx(Area,{type:"monotone",dataKey:_.dataKey,stroke:_.color,fill:_.color,fillOpacity:.3,name:_.name,strokeWidth:2},_.id):jsxRuntimeExports.jsx(Bar,{dataKey:_.dataKey,fill:_.color,name:_.name,radius:[4,4,0,0]},_.id)),jsxRuntimeExports.jsx(Brush,{dataKey:"date",height:30,stroke:"#3b82f6",fill:"#18181b",tickFormatter:_=>_.slice(5)})]})})};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h1",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[jsxRuntimeExports.jsx(Activity,{className:"w-6 h-6 text-blue-500"}),"Registro Diário de Variáveis"]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-zinc-400 mt-1",children:"Visualização e análise de variáveis operacionais com gráficos interativos"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs(Button,{variant:"secondary",onClick:()=>t(!0),children:[jsxRuntimeExports.jsx(Database,{className:"w-4 h-4 mr-2"}),"Importar"]}),jsxRuntimeExports.jsxs(Button,{onClick:S,disabled:g.length===0,children:[jsxRuntimeExports.jsx(FileSpreadsheet,{className:"w-4 h-4 mr-2"}),"Exportar Excel"]})]})]}),jsxRuntimeExports.jsx(Card,{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Calendar,{className:"w-4 h-4 text-zinc-400"}),jsxRuntimeExports.jsx(Input,{type:"date",value:r,onChange:F=>s(F.target.value),className:"w-40",placeholder:"Data inicial"}),jsxRuntimeExports.jsx("span",{className:"text-zinc-500",children:"até"}),jsxRuntimeExports.jsx(Input,{type:"date",value:i,onChange:F=>n(F.target.value),className:"w-40",placeholder:"Data final"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Filter,{className:"w-4 h-4 text-zinc-400"}),jsxRuntimeExports.jsx(Select,{value:u,onChange:F=>h(F.target.value),options:[{value:"all",label:"Todas Categorias"},{value:"production",label:"Produção"},{value:"balance",label:"Balanços"},{value:"operational",label:"Operacional"}]})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:jsxRuntimeExports.jsx(Select,{value:d,onChange:F=>l(F.target.value),options:[{value:"line",label:"📈 Linha"},{value:"area",label:"📊 Área"},{value:"bar",label:"📶 Barras"}]})}),jsxRuntimeExports.jsxs(Button,{variant:"ghost",size:"sm",onClick:()=>{s(""),n(""),h("all")},children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 mr-1"}),"Limpar"]}),jsxRuntimeExports.jsxs(Badge,{variant:"info",children:[g.length," registros"]})]})}),jsxRuntimeExports.jsx(Tabs,{activeTab:c,onChange:f,tabs:[{id:"grafico",label:"Gráfico",icon:TrendingUp},{id:"tabela",label:"Tabela de Dados",icon:Database},{id:"estatisticas",label:"Estatísticas",icon:Activity}]}),c==="grafico"&&jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-white flex items-center gap-2",children:[jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4"}),"Variáveis no Gráfico"]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:()=>o(p.map(F=>F.id)),children:"Selecionar Todas"}),jsxRuntimeExports.jsxs(Button,{variant:"ghost",size:"sm",onClick:()=>o([]),children:[jsxRuntimeExports.jsx(EyeOff,{className:"w-4 h-4 mr-1"}),"Limpar"]})]})]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(F=>{const A=a.includes(F.id),C=F.icon;return jsxRuntimeExports.jsxs("button",{onClick:()=>x(F.id),className:`
                    flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm transition-all
                    ${A?"bg-blue-500/20 text-blue-400 border border-blue-500/50":"bg-zinc-800 text-zinc-400 border border-zinc-700 hover:border-zinc-600"}
                  `,children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:A?F.color:"#52525b"}}),jsxRuntimeExports.jsx(C,{className:"w-3 h-3"}),F.name,jsxRuntimeExports.jsxs("span",{className:"text-xs opacity-60",children:["(",F.unit,")"]})]},F.id)})})]}),c==="grafico"&&jsxRuntimeExports.jsx(Card,{className:"p-4",children:P()}),c==="tabela"&&jsxRuntimeExports.jsxs(Card,{noPadding:!0,children:[jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-sm",children:[jsxRuntimeExports.jsx("thead",{className:"bg-zinc-800 sticky top-0",children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{className:"text-left p-3 text-zinc-400 font-medium",children:"Data"}),a.map(F=>{const A=AVAILABLE_VARIABLES.find(C=>C.id===F);return jsxRuntimeExports.jsxs("th",{className:"text-right p-3 text-zinc-400 font-medium",children:[A==null?void 0:A.name," (",A==null?void 0:A.unit,")"]},F)})]})}),jsxRuntimeExports.jsx("tbody",{className:"divide-y divide-zinc-800",children:g.map((F,A)=>jsxRuntimeExports.jsxs("tr",{className:"hover:bg-zinc-800/50",children:[jsxRuntimeExports.jsx("td",{className:"p-3 text-white font-mono",children:F.date}),a.map(C=>{const _=F[C],T=C.includes("Bal")&&Math.abs(_||0)>10;return jsxRuntimeExports.jsx("td",{className:`p-3 text-right font-mono ${T?"text-red-400":"text-zinc-300"}`,children:_!==void 0?_.toFixed(2):"-"},C)})]},F.id||A))})]})}),g.length===0&&jsxRuntimeExports.jsx("div",{className:"p-8 text-center text-zinc-500",children:"Nenhum dado disponível"})]}),c==="estatisticas"&&jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.map(F=>{const A=AVAILABLE_VARIABLES.find(w=>w.id===F),C=E[F],_=(A==null?void 0:A.icon)||Activity;return!C||!A?null:jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:`${A.color}20`},children:jsxRuntimeExports.jsx(_,{className:"w-5 h-5",style:{color:A.color}})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-white",children:A.name}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:A.unit})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Mínimo"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-mono text-white",children:C.min.toFixed(2)})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Máximo"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-mono text-white",children:C.max.toFixed(2)})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Média"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-mono text-white",children:C.avg.toFixed(2)})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Último Valor"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-mono text-blue-400",children:C.last.toFixed(2)})]})]})]},F)}),a.length===0&&jsxRuntimeExports.jsx(Card,{className:"col-span-full p-8 text-center text-zinc-500",children:"Selecione variáveis no gráfico para ver as estatísticas"})]})]})}const initialFormData={tag:"",name:"",location:"TOPSIDE",status:"active",serialNumber:"",manufacturer:"Pietro Fiorentini",model:"Flowtwin",lastCalibration:new Date().toISOString().split("T")[0],kOil:1,kGas:1,kWater:1,daysToCalibration:365},NewMeterModal=({isOpen:e,onClose:t,editingMeter:r})=>{const{addMeter:s,updateMeter:i}=useAppStore(),[n,a]=reactExports.useState(r?{tag:r.tag,name:r.name,location:r.location,status:r.status,serialNumber:r.serialNumber,manufacturer:r.manufacturer,model:r.model,lastCalibration:r.lastCalibration,kOil:r.kOil,kGas:r.kGas,kWater:r.kWater,daysToCalibration:r.daysToCalibration}:initialFormData),[o,d]=reactExports.useState({}),l=reactExports.useCallback((h,g)=>{a(p=>({...p,[h]:g})),d(p=>({...p,[h]:void 0}))},[]),c=()=>{const h={};return n.tag.trim()?/^[A-Z0-9_-]+$/i.test(n.tag)||(h.tag="Tag deve conter apenas letras, números, - ou _"):h.tag="Tag é obrigatório",n.name.trim()||(h.name="Nome é obrigatório"),n.serialNumber.trim()||(h.serialNumber="Número de série é obrigatório"),n.manufacturer.trim()||(h.manufacturer="Fabricante é obrigatório"),n.model.trim()||(h.model="Modelo é obrigatório"),(n.kOil<.8||n.kOil>1.2)&&(h.kOil="K-factor deve estar entre 0.8 e 1.2"),(n.kGas<.8||n.kGas>1.2)&&(h.kGas="K-factor deve estar entre 0.8 e 1.2"),(n.kWater<.8||n.kWater>1.2)&&(h.kWater="K-factor deve estar entre 0.8 e 1.2"),d(h),Object.keys(h).length===0},f=h=>{h.preventDefault(),c()&&(r?i(r.id,n):s(n),a(initialFormData),t())},u=()=>{a(initialFormData),d({}),t()};return jsxRuntimeExports.jsx(Modal,{isOpen:e,onClose:u,title:r?"Editar Medidor":"Novo Medidor MPFM",size:"lg",children:jsxRuntimeExports.jsxs("form",{onSubmit:f,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Identificação"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(Input,{label:"Tag do Medidor *",placeholder:"Ex: MPFM-P55-001",value:n.tag,onChange:h=>l("tag",h.target.value.toUpperCase()),error:o.tag}),jsxRuntimeExports.jsx(Input,{label:"Nome *",placeholder:"Nome descritivo",value:n.name,onChange:h=>l("name",h.target.value),error:o.name})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[jsxRuntimeExports.jsx(Select,{label:"Localização *",value:n.location,onChange:h=>l("location",h.target.value),options:[{value:"TOPSIDE",label:"Topside"},{value:"SUBSEA",label:"Subsea"}]}),jsxRuntimeExports.jsx(Select,{label:"Status *",value:n.status,onChange:h=>l("status",h.target.value),options:[{value:"active",label:"Ativo"},{value:"inactive",label:"Inativo"}]})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Informações Técnicas"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[jsxRuntimeExports.jsx(Input,{label:"Número de Série *",placeholder:"SN-XXXXXX",value:n.serialNumber,onChange:h=>l("serialNumber",h.target.value),error:o.serialNumber}),jsxRuntimeExports.jsx(Input,{label:"Fabricante *",placeholder:"Pietro Fiorentini",value:n.manufacturer,onChange:h=>l("manufacturer",h.target.value),error:o.manufacturer}),jsxRuntimeExports.jsx(Input,{label:"Modelo *",placeholder:"Flowtwin",value:n.model,onChange:h=>l("model",h.target.value),error:o.model})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Calibração"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(Input,{label:"Última Calibração",type:"date",value:n.lastCalibration,onChange:h=>l("lastCalibration",h.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Dias até Próxima Calibração",type:"number",value:n.daysToCalibration,onChange:h=>l("daysToCalibration",parseInt(h.target.value)||0)})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"K-Factors (faixa válida: 0.8 - 1.2)"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[jsxRuntimeExports.jsx(Input,{label:"K-Factor Óleo",type:"number",step:"0.001",min:"0.8",max:"1.2",value:n.kOil,onChange:h=>l("kOil",parseFloat(h.target.value)||1),error:o.kOil}),jsxRuntimeExports.jsx(Input,{label:"K-Factor Gás",type:"number",step:"0.001",min:"0.8",max:"1.2",value:n.kGas,onChange:h=>l("kGas",parseFloat(h.target.value)||1),error:o.kGas}),jsxRuntimeExports.jsx(Input,{label:"K-Factor Água",type:"number",step:"0.001",min:"0.8",max:"1.2",value:n.kWater,onChange:h=>l("kWater",parseFloat(h.target.value)||1),error:o.kWater})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",onClick:u,children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{type:"submit",variant:"primary",children:r?"Salvar Alterações":"Adicionar Medidor"})]})]})})};function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports$1){(function(t,r){module.exports=t.pdfjsLib=r()})(globalThis,()=>(()=>{var __webpack_modules__=[,(e,t)=>{var ot;Object.defineProperty(t,"__esModule",{value:!0}),t.VerbosityLevel=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.RenderingIntentFlag=t.PromiseCapability=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.PageActionEventType=t.OPS=t.MissingPDFException=t.MAX_IMAGE_SIZE_TO_CACHE=t.LINE_FACTOR=t.LINE_DESCENT_FACTOR=t.InvalidPDFException=t.ImageKind=t.IDENTITY_MATRIX=t.FormatError=t.FeatureTest=t.FONT_IDENTITY_MATRIX=t.DocumentActionEventType=t.CMapCompressionType=t.BaseException=t.BASELINE_FACTOR=t.AnnotationType=t.AnnotationReplyType=t.AnnotationPrefix=t.AnnotationMode=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationEditorType=t.AnnotationEditorPrefix=t.AnnotationEditorParamsType=t.AnnotationBorderStyleType=t.AnnotationActionEventType=t.AbortException=void 0,t.assert=H,t.bytesToString=ve,t.createValidAbsoluteUrl=le,t.getModificationDate=Le,t.getUuid=Je,t.getVerbosityLevel=Q,t.info=oe,t.isArrayBuffer=he,t.isArrayEqual=ze,t.isNodeJS=void 0,t.normalizeUnicode=Xe,t.objectFromMap=ke,t.objectSize=Ae,t.setVerbosityLevel=ae,t.shadow=N,t.string32=Re,t.stringToBytes=xe,t.stringToPDFString=Fe,t.stringToUTF8String=De,t.unreachable=me,t.utf8StringToString=Pe,t.warn=re;const r=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");t.isNodeJS=r;const s=[1,0,0,1,0,0];t.IDENTITY_MATRIX=s;const i=[.001,0,0,.001,0,0];t.FONT_IDENTITY_MATRIX=i;const n=1e7;t.MAX_IMAGE_SIZE_TO_CACHE=n;const a=1.35;t.LINE_FACTOR=a;const o=.35;t.LINE_DESCENT_FACTOR=o;const d=o/a;t.BASELINE_FACTOR=d;const l={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};t.RenderingIntentFlag=l;const c={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};t.AnnotationMode=c;const f="pdfjs_internal_editor_";t.AnnotationEditorPrefix=f;const u={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};t.AnnotationEditorType=u;const h={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};t.AnnotationEditorParamsType=h;const g={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};t.PermissionFlag=g;const p={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};t.TextRenderingMode=p;const x={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};t.ImageKind=x;const E={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};t.AnnotationType=E;const S={GROUP:"Group",REPLY:"R"};t.AnnotationReplyType=S;const P={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};t.AnnotationFlag=P;const F={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};t.AnnotationFieldFlag=F;const A={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};t.AnnotationBorderStyleType=A;const C={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};t.AnnotationActionEventType=C;const _={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};t.DocumentActionEventType=_;const w={O:"PageOpen",C:"PageClose"};t.PageActionEventType=w;const T={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=T;const M={NONE:0,BINARY:1};t.CMapCompressionType=M;const R={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};t.OPS=R;const k={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};t.PasswordResponses=k;let L=T.WARNINGS;function ae(Me){Number.isInteger(Me)&&(L=Me)}function Q(){return L}function oe(Me){L>=T.INFOS&&console.log(`Info: ${Me}`)}function re(Me){L>=T.WARNINGS&&console.log(`Warning: ${Me}`)}function me(Me){throw new Error(Me)}function H(Me,ge){Me||me(ge)}function ie(Me){switch(Me==null?void 0:Me.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function le(Me,ge=null,be=null){if(!Me)return null;try{if(be&&typeof Me=="string"){if(be.addDefaultProtocol&&Me.startsWith("www.")){const st=Me.match(/\./g);(st==null?void 0:st.length)>=2&&(Me=`http://${Me}`)}if(be.tryConvertEncoding)try{Me=De(Me)}catch{}}const Ve=ge?new URL(Me,ge):new URL(Me);if(ie(Ve))return Ve}catch{}return null}function N(Me,ge,be,Ve=!1){return Object.defineProperty(Me,ge,{value:be,enumerable:!Ve,configurable:!0,writable:!1}),be}const b=function(){function ge(be,Ve){this.constructor===ge&&me("Cannot initialize BaseException."),this.message=be,this.name=Ve}return ge.prototype=new Error,ge.constructor=ge,ge}();t.BaseException=b;class v extends b{constructor(ge,be){super(ge,"PasswordException"),this.code=be}}t.PasswordException=v;class j extends b{constructor(ge,be){super(ge,"UnknownErrorException"),this.details=be}}t.UnknownErrorException=j;class D extends b{constructor(ge){super(ge,"InvalidPDFException")}}t.InvalidPDFException=D;class U extends b{constructor(ge){super(ge,"MissingPDFException")}}t.MissingPDFException=U;class W extends b{constructor(ge,be){super(ge,"UnexpectedResponseException"),this.status=be}}t.UnexpectedResponseException=W;class Z extends b{constructor(ge){super(ge,"FormatError")}}t.FormatError=Z;class te extends b{constructor(ge){super(ge,"AbortException")}}t.AbortException=te;function ve(Me){(typeof Me!="object"||(Me==null?void 0:Me.length)===void 0)&&me("Invalid argument for bytesToString");const ge=Me.length,be=8192;if(ge<be)return String.fromCharCode.apply(null,Me);const Ve=[];for(let st=0;st<ge;st+=be){const rt=Math.min(st+be,ge),ee=Me.subarray(st,rt);Ve.push(String.fromCharCode.apply(null,ee))}return Ve.join("")}function xe(Me){typeof Me!="string"&&me("Invalid argument for stringToBytes");const ge=Me.length,be=new Uint8Array(ge);for(let Ve=0;Ve<ge;++Ve)be[Ve]=Me.charCodeAt(Ve)&255;return be}function Re(Me){return String.fromCharCode(Me>>24&255,Me>>16&255,Me>>8&255,Me&255)}function Ae(Me){return Object.keys(Me).length}function ke(Me){const ge=Object.create(null);for(const[be,Ve]of Me)ge[be]=Ve;return ge}function ue(){const Me=new Uint8Array(4);return Me[0]=1,new Uint32Array(Me.buffer,0,1)[0]===1}function se(){try{return new Function(""),!0}catch{return!1}}class z{static get isLittleEndian(){return N(this,"isLittleEndian",ue())}static get isEvalSupported(){return N(this,"isEvalSupported",se())}static get isOffscreenCanvasSupported(){return N(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?N(this,"platform",{isWin:!1,isMac:!1}):N(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var ge,be;return N(this,"isCSSRoundSupported",(be=(ge=globalThis.CSS)==null?void 0:ge.supports)==null?void 0:be.call(ge,"width: round(1.5px, 1px)"))}}t.FeatureTest=z;const J=[...Array(256).keys()].map(Me=>Me.toString(16).padStart(2,"0"));class de{static makeHexColor(ge,be,Ve){return`#${J[ge]}${J[be]}${J[Ve]}`}static scaleMinMax(ge,be){let Ve;ge[0]?(ge[0]<0&&(Ve=be[0],be[0]=be[1],be[1]=Ve),be[0]*=ge[0],be[1]*=ge[0],ge[3]<0&&(Ve=be[2],be[2]=be[3],be[3]=Ve),be[2]*=ge[3],be[3]*=ge[3]):(Ve=be[0],be[0]=be[2],be[2]=Ve,Ve=be[1],be[1]=be[3],be[3]=Ve,ge[1]<0&&(Ve=be[2],be[2]=be[3],be[3]=Ve),be[2]*=ge[1],be[3]*=ge[1],ge[2]<0&&(Ve=be[0],be[0]=be[1],be[1]=Ve),be[0]*=ge[2],be[1]*=ge[2]),be[0]+=ge[4],be[1]+=ge[4],be[2]+=ge[5],be[3]+=ge[5]}static transform(ge,be){return[ge[0]*be[0]+ge[2]*be[1],ge[1]*be[0]+ge[3]*be[1],ge[0]*be[2]+ge[2]*be[3],ge[1]*be[2]+ge[3]*be[3],ge[0]*be[4]+ge[2]*be[5]+ge[4],ge[1]*be[4]+ge[3]*be[5]+ge[5]]}static applyTransform(ge,be){const Ve=ge[0]*be[0]+ge[1]*be[2]+be[4],st=ge[0]*be[1]+ge[1]*be[3]+be[5];return[Ve,st]}static applyInverseTransform(ge,be){const Ve=be[0]*be[3]-be[1]*be[2],st=(ge[0]*be[3]-ge[1]*be[2]+be[2]*be[5]-be[4]*be[3])/Ve,rt=(-ge[0]*be[1]+ge[1]*be[0]+be[4]*be[1]-be[5]*be[0])/Ve;return[st,rt]}static getAxialAlignedBoundingBox(ge,be){const Ve=this.applyTransform(ge,be),st=this.applyTransform(ge.slice(2,4),be),rt=this.applyTransform([ge[0],ge[3]],be),ee=this.applyTransform([ge[2],ge[1]],be);return[Math.min(Ve[0],st[0],rt[0],ee[0]),Math.min(Ve[1],st[1],rt[1],ee[1]),Math.max(Ve[0],st[0],rt[0],ee[0]),Math.max(Ve[1],st[1],rt[1],ee[1])]}static inverseTransform(ge){const be=ge[0]*ge[3]-ge[1]*ge[2];return[ge[3]/be,-ge[1]/be,-ge[2]/be,ge[0]/be,(ge[2]*ge[5]-ge[4]*ge[3])/be,(ge[4]*ge[1]-ge[5]*ge[0])/be]}static singularValueDecompose2dScale(ge){const be=[ge[0],ge[2],ge[1],ge[3]],Ve=ge[0]*be[0]+ge[1]*be[2],st=ge[0]*be[1]+ge[1]*be[3],rt=ge[2]*be[0]+ge[3]*be[2],ee=ge[2]*be[1]+ge[3]*be[3],Ne=(Ve+ee)/2,Be=Math.sqrt((Ve+ee)**2-4*(Ve*ee-rt*st))/2,qe=Ne+Be||1,Ye=Ne-Be||1;return[Math.sqrt(qe),Math.sqrt(Ye)]}static normalizeRect(ge){const be=ge.slice(0);return ge[0]>ge[2]&&(be[0]=ge[2],be[2]=ge[0]),ge[1]>ge[3]&&(be[1]=ge[3],be[3]=ge[1]),be}static intersect(ge,be){const Ve=Math.max(Math.min(ge[0],ge[2]),Math.min(be[0],be[2])),st=Math.min(Math.max(ge[0],ge[2]),Math.max(be[0],be[2]));if(Ve>st)return null;const rt=Math.max(Math.min(ge[1],ge[3]),Math.min(be[1],be[3])),ee=Math.min(Math.max(ge[1],ge[3]),Math.max(be[1],be[3]));return rt>ee?null:[Ve,rt,st,ee]}static bezierBoundingBox(ge,be,Ve,st,rt,ee,Ne,Be){const qe=[],Ye=[[],[]];let Ge,Y,V,ne,ye,Te,Ie,Oe;for(let K=0;K<2;++K){if(K===0?(Y=6*ge-12*Ve+6*rt,Ge=-3*ge+9*Ve-9*rt+3*Ne,V=3*Ve-3*ge):(Y=6*be-12*st+6*ee,Ge=-3*be+9*st-9*ee+3*Be,V=3*st-3*be),Math.abs(Ge)<1e-12){if(Math.abs(Y)<1e-12)continue;ne=-V/Y,0<ne&&ne<1&&qe.push(ne);continue}Ie=Y*Y-4*V*Ge,Oe=Math.sqrt(Ie),!(Ie<0)&&(ye=(-Y+Oe)/(2*Ge),0<ye&&ye<1&&qe.push(ye),Te=(-Y-Oe)/(2*Ge),0<Te&&Te<1&&qe.push(Te))}let $e=qe.length,Ke;const I=$e;for(;$e--;)ne=qe[$e],Ke=1-ne,Ye[0][$e]=Ke*Ke*Ke*ge+3*Ke*Ke*ne*Ve+3*Ke*ne*ne*rt+ne*ne*ne*Ne,Ye[1][$e]=Ke*Ke*Ke*be+3*Ke*Ke*ne*st+3*Ke*ne*ne*ee+ne*ne*ne*Be;return Ye[0][I]=ge,Ye[1][I]=be,Ye[0][I+1]=Ne,Ye[1][I+1]=Be,Ye[0].length=Ye[1].length=I+2,[Math.min(...Ye[0]),Math.min(...Ye[1]),Math.max(...Ye[0]),Math.max(...Ye[1])]}}t.Util=de;const fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Fe(Me){if(Me[0]>="ï"){let be;if(Me[0]==="þ"&&Me[1]==="ÿ"?be="utf-16be":Me[0]==="ÿ"&&Me[1]==="þ"?be="utf-16le":Me[0]==="ï"&&Me[1]==="»"&&Me[2]==="¿"&&(be="utf-8"),be)try{const Ve=new TextDecoder(be,{fatal:!0}),st=xe(Me);return Ve.decode(st)}catch(Ve){re(`stringToPDFString: "${Ve}".`)}}const ge=[];for(let be=0,Ve=Me.length;be<Ve;be++){const st=fe[Me.charCodeAt(be)];ge.push(st?String.fromCharCode(st):Me.charAt(be))}return ge.join("")}function De(Me){return decodeURIComponent(escape(Me))}function Pe(Me){return unescape(encodeURIComponent(Me))}function he(Me){return typeof Me=="object"&&(Me==null?void 0:Me.byteLength)!==void 0}function ze(Me,ge){if(Me.length!==ge.length)return!1;for(let be=0,Ve=Me.length;be<Ve;be++)if(Me[be]!==ge[be])return!1;return!0}function Le(Me=new Date){return[Me.getUTCFullYear().toString(),(Me.getUTCMonth()+1).toString().padStart(2,"0"),Me.getUTCDate().toString().padStart(2,"0"),Me.getUTCHours().toString().padStart(2,"0"),Me.getUTCMinutes().toString().padStart(2,"0"),Me.getUTCSeconds().toString().padStart(2,"0")].join("")}class tt{constructor(){_e(this,ot,!1);this.promise=new Promise((ge,be)=>{this.resolve=Ve=>{Ee(this,ot,!0),ge(Ve)},this.reject=Ve=>{Ee(this,ot,!0),be(Ve)}})}get settled(){return y(this,ot)}}ot=new WeakMap,t.PromiseCapability=tt;let et=null,it=null;function Xe(Me){return et||(et=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,it=new Map([["ﬅ","ſt"]])),Me.replaceAll(et,(ge,be,Ve)=>be?be.normalize("NFKC"):it.get(Ve))}function Je(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const Me=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(Me);else for(let ge=0;ge<32;ge++)Me[ge]=Math.floor(Math.random()*255);return ve(Me)}const nt="pdfjs_internal_id_";t.AnnotationPrefix=nt},(__unused_webpack_module,exports$1,__w_pdfjs_require__)=>{var e,r,s,i,gt,kt,o,d,l,c,f,u,h,g,p,It,E,S,$t,F,A;Object.defineProperty(exports$1,"__esModule",{value:!0}),exports$1.RenderTask=exports$1.PDFWorkerUtil=exports$1.PDFWorker=exports$1.PDFPageProxy=exports$1.PDFDocumentProxy=exports$1.PDFDocumentLoadingTask=exports$1.PDFDataRangeTransport=exports$1.LoopbackPort=exports$1.DefaultStandardFontDataFactory=exports$1.DefaultFilterFactory=exports$1.DefaultCanvasFactory=exports$1.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports$1,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports$1.build=void 0,exports$1.getDocument=getDocument,exports$1.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports$1.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports$1.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports$1.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports$1.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(_){if(typeof _=="string"||_ instanceof URL?_={url:_}:(0,_util.isArrayBuffer)(_)&&(_={data:_}),typeof _!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!_.url&&!_.data&&!_.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const w=new PDFDocumentLoadingTask,{docId:T}=w,M=_.url?getUrlProp(_.url):null,R=_.data?getDataProp(_.data):null,k=_.httpHeaders||null,L=_.withCredentials===!0,ae=_.password??null,Q=_.range instanceof PDFDataRangeTransport?_.range:null,oe=Number.isInteger(_.rangeChunkSize)&&_.rangeChunkSize>0?_.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let re=_.worker instanceof PDFWorker?_.worker:null;const me=_.verbosity,H=typeof _.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(_.docBaseUrl)?_.docBaseUrl:null,ie=typeof _.cMapUrl=="string"?_.cMapUrl:null,le=_.cMapPacked!==!1,N=_.CMapReaderFactory||DefaultCMapReaderFactory,b=typeof _.standardFontDataUrl=="string"?_.standardFontDataUrl:null,v=_.StandardFontDataFactory||DefaultStandardFontDataFactory,j=_.stopAtErrors!==!0,D=Number.isInteger(_.maxImageSize)&&_.maxImageSize>-1?_.maxImageSize:-1,U=_.isEvalSupported!==!1,W=typeof _.isOffscreenCanvasSupported=="boolean"?_.isOffscreenCanvasSupported:!_util.isNodeJS,Z=Number.isInteger(_.canvasMaxAreaInBytes)?_.canvasMaxAreaInBytes:-1,te=typeof _.disableFontFace=="boolean"?_.disableFontFace:_util.isNodeJS,ve=_.fontExtraProperties===!0,xe=_.enableXfa===!0,Re=_.ownerDocument||globalThis.document,Ae=_.disableRange===!0,ke=_.disableStream===!0,ue=_.disableAutoFetch===!0,se=_.pdfBug===!0,z=Q?Q.length:_.length??NaN,J=typeof _.useSystemFonts=="boolean"?_.useSystemFonts:!_util.isNodeJS&&!te,de=typeof _.useWorkerFetch=="boolean"?_.useWorkerFetch:N===_display_utils.DOMCMapReaderFactory&&v===_display_utils.DOMStandardFontDataFactory&&ie&&b&&(0,_display_utils.isValidFetchUrl)(ie,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(b,document.baseURI),fe=_.canvasFactory||new DefaultCanvasFactory({ownerDocument:Re}),Fe=_.filterFactory||new DefaultFilterFactory({docId:T,ownerDocument:Re}),De=null;(0,_util.setVerbosityLevel)(me);const Pe={canvasFactory:fe,filterFactory:Fe};if(de||(Pe.cMapReaderFactory=new N({baseUrl:ie,isCompressed:le}),Pe.standardFontDataFactory=new v({baseUrl:b})),!re){const Le={verbosity:me,port:_worker_options.GlobalWorkerOptions.workerPort};re=Le.port?PDFWorker.fromPort(Le):new PDFWorker(Le),w._worker=re}const he={docId:T,apiVersion:"3.11.174",data:R,password:ae,disableAutoFetch:ue,rangeChunkSize:oe,length:z,docBaseUrl:H,enableXfa:xe,evaluatorOptions:{maxImageSize:D,disableFontFace:te,ignoreErrors:j,isEvalSupported:U,isOffscreenCanvasSupported:W,canvasMaxAreaInBytes:Z,fontExtraProperties:ve,useSystemFonts:J,cMapUrl:de?ie:null,standardFontDataUrl:de?b:null}},ze={ignoreErrors:j,isEvalSupported:U,disableFontFace:te,fontExtraProperties:ve,enableXfa:xe,ownerDocument:Re,disableAutoFetch:ue,pdfBug:se,styleElement:De};return re.promise.then(function(){if(w.destroyed)throw new Error("Loading aborted");const Le=_fetchDocument(re,he),tt=new Promise(function(et){let it;Q?it=new _transport_stream.PDFDataTransportStream({length:z,initialData:Q.initialData,progressiveDone:Q.progressiveDone,contentDispositionFilename:Q.contentDispositionFilename,disableRange:Ae,disableStream:ke},Q):R||(it=(Je=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(Je):(0,_display_utils.isValidFetchUrl)(Je.url)?new _displayFetch_stream.PDFFetchStream(Je):new _displayNetwork.PDFNetworkStream(Je))({url:M,length:z,httpHeaders:k,withCredentials:L,rangeChunkSize:oe,disableRange:Ae,disableStream:ke})),et(it)});return Promise.all([Le,tt]).then(function([et,it]){if(w.destroyed)throw new Error("Loading aborted");const Xe=new _message_handler.MessageHandler(T,et,re.port),Je=new WorkerTransport(Xe,w,it,ze,Pe);w._transport=Je,Xe.send("Ready",null)})}).catch(w._capability.reject),w}async function _fetchDocument(_,w){if(_.destroyed)throw new Error("Worker was destroyed");const T=await _.messageHandler.sendWithPromise("GetDocRequest",w,w.data?[w.data.buffer]:null);if(_.destroyed)throw new Error("Worker was destroyed");return T}function getUrlProp(_){if(_ instanceof URL)return _.href;try{return new URL(_,window.location).href}catch{if(_util.isNodeJS&&typeof _=="string")return _}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(_){if(_util.isNodeJS&&typeof Buffer<"u"&&_ instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(_ instanceof Uint8Array&&_.byteLength===_.buffer.byteLength)return _;if(typeof _=="string")return(0,_util.stringToBytes)(_);if(typeof _=="object"&&!isNaN(_==null?void 0:_.length)||(0,_util.isArrayBuffer)(_))return new Uint8Array(_);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const t=class t{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${At(t,e)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var w,T,M;this.destroyed=!0;try{(w=this._worker)!=null&&w.port&&(this._worker._pendingDestroy=!0),await((T=this._transport)==null?void 0:T.destroy())}catch(R){throw(M=this._worker)!=null&&M.port&&delete this._worker._pendingDestroy,R}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};e=new WeakMap,_e(t,e,0);let PDFDocumentLoadingTask=t;exports$1.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(w,T,M=!1,R=null){this.length=w,this.initialData=T,this.progressiveDone=M,this.contentDispositionFilename=R,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(w){this._rangeListeners.push(w)}addProgressListener(w){this._progressListeners.push(w)}addProgressiveReadListener(w){this._progressiveReadListeners.push(w)}addProgressiveDoneListener(w){this._progressiveDoneListeners.push(w)}onDataRange(w,T){for(const M of this._rangeListeners)M(w,T)}onDataProgress(w,T){this._readyCapability.promise.then(()=>{for(const M of this._progressListeners)M(w,T)})}onDataProgressiveRead(w){this._readyCapability.promise.then(()=>{for(const T of this._progressiveReadListeners)T(w)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const w of this._progressiveDoneListeners)w()})}transportReady(){this._readyCapability.resolve()}requestDataRange(w,T){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports$1.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(w,T){this._pdfInfo=w,this._transport=T,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(M=>{if(!M)return M;const R=[];for(const k in M)R.push(...M[k]);return R}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(w){return this._transport.getPage(w)}getPageIndex(w){return this._transport.getPageIndex(w)}getDestinations(){return this._transport.getDestinations()}getDestination(w){return this._transport.getDestination(w)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(w=!1){return this._transport.startCleanup(w||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports$1.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(w,T,M,R=!1){_e(this,i);_e(this,r,null);_e(this,s,!1);this._pageIndex=w,this._pageInfo=T,this._transport=M,this._stats=R?new _display_utils.StatTimer:null,this._pdfBug=R,this.commonObjs=M.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:w,rotation:T=this.rotate,offsetX:M=0,offsetY:R=0,dontFlip:k=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:w,rotation:T,offsetX:M,offsetY:R,dontFlip:k})}getAnnotations({intent:w="display"}={}){const T=this._transport.getRenderingIntent(w);return this._transport.getAnnotations(this._pageIndex,T.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var w;return((w=this._transport._htmlForXfa)==null?void 0:w.children[this._pageIndex])||null}render({canvasContext:w,viewport:T,intent:M="display",annotationMode:R=_util.AnnotationMode.ENABLE,transform:k=null,background:L=null,optionalContentConfigPromise:ae=null,annotationCanvasMap:Q=null,pageColors:oe=null,printAnnotationStorage:re=null}){var v,j;(v=this._stats)==null||v.time("Overall");const me=this._transport.getRenderingIntent(M,R,re);Ee(this,s,!1),ce(this,i,kt).call(this),ae||(ae=this._transport.getOptionalContentConfig());let H=this._intentStates.get(me.cacheKey);H||(H=Object.create(null),this._intentStates.set(me.cacheKey,H)),H.streamReaderCancelTimeout&&(clearTimeout(H.streamReaderCancelTimeout),H.streamReaderCancelTimeout=null);const ie=!!(me.renderingIntent&_util.RenderingIntentFlag.PRINT);H.displayReadyCapability||(H.displayReadyCapability=new _util.PromiseCapability,H.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(j=this._stats)==null||j.time("Page Request"),this._pumpOperatorList(me));const le=D=>{var U,W;H.renderTasks.delete(N),(this._maybeCleanupAfterRender||ie)&&Ee(this,s,!0),ce(this,i,gt).call(this,!ie),D?(N.capability.reject(D),this._abortOperatorList({intentState:H,reason:D instanceof Error?D:new Error(D)})):N.capability.resolve(),(U=this._stats)==null||U.timeEnd("Rendering"),(W=this._stats)==null||W.timeEnd("Overall")},N=new InternalRenderTask({callback:le,params:{canvasContext:w,viewport:T,transform:k,background:L},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Q,operatorList:H.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!ie,pdfBug:this._pdfBug,pageColors:oe});(H.renderTasks||(H.renderTasks=new Set)).add(N);const b=N.task;return Promise.all([H.displayReadyCapability.promise,ae]).then(([D,U])=>{var W;if(this.destroyed){le();return}(W=this._stats)==null||W.time("Rendering"),N.initializeGraphics({transparency:D,optionalContentConfig:U}),N.operatorListChanged()}).catch(le),b}getOperatorList({intent:w="display",annotationMode:T=_util.AnnotationMode.ENABLE,printAnnotationStorage:M=null}={}){var Q;function R(){L.operatorList.lastChunk&&(L.opListReadCapability.resolve(L.operatorList),L.renderTasks.delete(ae))}const k=this._transport.getRenderingIntent(w,T,M,!0);let L=this._intentStates.get(k.cacheKey);L||(L=Object.create(null),this._intentStates.set(k.cacheKey,L));let ae;return L.opListReadCapability||(ae=Object.create(null),ae.operatorListChanged=R,L.opListReadCapability=new _util.PromiseCapability,(L.renderTasks||(L.renderTasks=new Set)).add(ae),L.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Q=this._stats)==null||Q.time("Page Request"),this._pumpOperatorList(k)),L.opListReadCapability.promise}streamTextContent({includeMarkedContent:w=!1,disableNormalization:T=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:w===!0,disableNormalization:T===!0},{highWaterMark:100,size(R){return R.items.length}})}getTextContent(w={}){if(this._transport._htmlForXfa)return this.getXfa().then(M=>_xfa_text.XfaText.textContent(M));const T=this.streamTextContent(w);return new Promise(function(M,R){function k(){L.read().then(function({value:Q,done:oe}){if(oe){M(ae);return}Object.assign(ae.styles,Q.styles),ae.items.push(...Q.items),k()},R)}const L=T.getReader(),ae={items:[],styles:Object.create(null)};k()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const w=[];for(const T of this._intentStates.values())if(this._abortOperatorList({intentState:T,reason:new Error("Page was destroyed."),force:!0}),!T.opListReadCapability)for(const M of T.renderTasks)w.push(M.completed),M.cancel();return this.objs.clear(),Ee(this,s,!1),ce(this,i,kt).call(this),Promise.all(w)}cleanup(w=!1){Ee(this,s,!0);const T=ce(this,i,gt).call(this,!1);return w&&T&&this._stats&&(this._stats=new _display_utils.StatTimer),T}_startRenderPage(w,T){var R,k;const M=this._intentStates.get(T);M&&((R=this._stats)==null||R.timeEnd("Page Request"),(k=M.displayReadyCapability)==null||k.resolve(w))}_renderPageChunk(w,T){for(let M=0,R=w.length;M<R;M++)T.operatorList.fnArray.push(w.fnArray[M]),T.operatorList.argsArray.push(w.argsArray[M]);T.operatorList.lastChunk=w.lastChunk,T.operatorList.separateAnnots=w.separateAnnots;for(const M of T.renderTasks)M.operatorListChanged();w.lastChunk&&ce(this,i,gt).call(this,!0)}_pumpOperatorList({renderingIntent:w,cacheKey:T,annotationStorageSerializable:M}){const{map:R,transfers:k}=M,ae=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:w,cacheKey:T,annotationStorage:R},k).getReader(),Q=this._intentStates.get(T);Q.streamReader=ae;const oe=()=>{ae.read().then(({value:re,done:me})=>{if(me){Q.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(re,Q),oe())},re=>{if(Q.streamReader=null,!this._transport.destroyed){if(Q.operatorList){Q.operatorList.lastChunk=!0;for(const me of Q.renderTasks)me.operatorListChanged();ce(this,i,gt).call(this,!0)}if(Q.displayReadyCapability)Q.displayReadyCapability.reject(re);else if(Q.opListReadCapability)Q.opListReadCapability.reject(re);else throw re}})};oe()}_abortOperatorList({intentState:w,reason:T,force:M=!1}){if(w.streamReader){if(w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null),!M){if(w.renderTasks.size>0)return;if(T instanceof _display_utils.RenderingCancelledException){let R=RENDERING_CANCELLED_TIMEOUT;T.extraDelay>0&&T.extraDelay<1e3&&(R+=T.extraDelay),w.streamReaderCancelTimeout=setTimeout(()=>{w.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:w,reason:T,force:!0})},R);return}}if(w.streamReader.cancel(new _util.AbortException(T.message)).catch(()=>{}),w.streamReader=null,!this._transport.destroyed){for(const[R,k]of this._intentStates)if(k===w){this._intentStates.delete(R);break}this.cleanup()}}}get stats(){return this._stats}}r=new WeakMap,s=new WeakMap,i=new WeakSet,gt=function(w=!1){if(ce(this,i,kt).call(this),!y(this,s)||this.destroyed)return!1;if(w)return Ee(this,r,setTimeout(()=>{Ee(this,r,null),ce(this,i,gt).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:T,operatorList:M}of this._intentStates.values())if(T.size>0||!M.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Ee(this,s,!1),!0},kt=function(){y(this,r)&&(clearTimeout(y(this,r)),Ee(this,r,null))},exports$1.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){_e(this,o,new Set);_e(this,d,Promise.resolve())}postMessage(w,T){const M={data:structuredClone(w,T?{transfer:T}:null)};y(this,d).then(()=>{for(const R of y(this,o))R.call(this,M)})}addEventListener(w,T){y(this,o).add(T)}removeEventListener(w,T){y(this,o).delete(T)}terminate(){y(this,o).clear()}}o=new WeakMap,d=new WeakMap,exports$1.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports$1.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const _=(l=document==null?void 0:document.currentScript)==null?void 0:l.src;_&&(PDFWorkerUtil.fallbackWorkerSrc=_.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(_,w){let T;try{if(T=new URL(_),!T.origin||T.origin==="null")return!1}catch{return!1}const M=new URL(w,T);return T.origin===M.origin},PDFWorkerUtil.createCDNWrapper=function(_){const w=`importScripts("${_}");`;return URL.createObjectURL(new Blob([w]))}}const _PDFWorker=class _PDFWorker{constructor({name:_=null,port:w=null,verbosity:T=(0,_util.getVerbosityLevel)()}={}){var M;if(this.name=_,this.destroyed=!1,this.verbosity=T,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,w){if((M=y(_PDFWorker,c))!=null&&M.has(w))throw new Error("Cannot use more than one PDFWorker per port.");(y(_PDFWorker,c)||Ee(_PDFWorker,c,new WeakMap)).set(w,this),this._initializeFromPort(w);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(_){this._port=_,this._messageHandler=new _message_handler.MessageHandler("main","worker",_),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:_}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,_)||(_=PDFWorkerUtil.createCDNWrapper(new URL(_,window.location).href));const w=new Worker(_),T=new _message_handler.MessageHandler("main","worker",w),M=()=>{w.removeEventListener("error",R),T.destroy(),w.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},R=()=>{this._webWorker||M()};w.addEventListener("error",R),T.on("test",L=>{if(w.removeEventListener("error",R),this.destroyed){M();return}L?(this._messageHandler=T,this._port=w,this._webWorker=w,this._readyCapability.resolve(),T.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),T.destroy(),w.terminate())}),T.on("ready",L=>{if(w.removeEventListener("error",R),this.destroyed){M();return}try{k()}catch{this._setupFakeWorker()}});const k=()=>{const L=new Uint8Array;T.send("test",L,[L.buffer])};k();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(_=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const w=new LoopbackPort;this._port=w;const T=`fake${PDFWorkerUtil.fakeWorkerId++}`,M=new _message_handler.MessageHandler(T+"_worker",T,w);_.setup(M,w);const R=new _message_handler.MessageHandler(T,T+"_worker",w);this._messageHandler=R,this._readyCapability.resolve(),R.send("configure",{verbosity:this.verbosity})}).catch(_=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${_.message}".`))})}destroy(){var _;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(_=y(_PDFWorker,c))==null||_.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(_){var T;if(!(_!=null&&_.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const w=(T=y(this,c))==null?void 0:T.get(_.port);if(w){if(w._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return w}return new _PDFWorker(_)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var _;try{return((_=globalThis.pdfjsWorker)==null?void 0:_.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};c=new WeakMap,_e(_PDFWorker,c);let PDFWorker=_PDFWorker;exports$1.PDFWorker=PDFWorker;class WorkerTransport{constructor(w,T,M,R,k){_e(this,p);_e(this,f,new Map);_e(this,u,new Map);_e(this,h,new Map);_e(this,g,null);this.messageHandler=w,this.loadingTask=T,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:R.ownerDocument,styleElement:R.styleElement}),this._params=R,this.canvasFactory=k.canvasFactory,this.filterFactory=k.filterFactory,this.cMapReaderFactory=k.cMapReaderFactory,this.standardFontDataFactory=k.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=M,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(w,T=_util.AnnotationMode.ENABLE,M=null,R=!1){let k=_util.RenderingIntentFlag.DISPLAY,L=_annotation_storage.SerializableEmpty;switch(w){case"any":k=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":k=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${w}`)}switch(T){case _util.AnnotationMode.DISABLE:k+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:k+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:k+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,L=(k&_util.RenderingIntentFlag.PRINT&&M instanceof _annotation_storage.PrintAnnotationStorage?M:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${T}`)}return R&&(k+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:k,cacheKey:`${k}_${L.hash}`,annotationStorageSerializable:L}}destroy(){var M;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(M=y(this,g))==null||M.reject(new Error("Worker was destroyed during onPassword callback"));const w=[];for(const R of y(this,u).values())w.push(R._destroy());y(this,u).clear(),y(this,h).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const T=this.messageHandler.sendWithPromise("Terminate",null);return w.push(T),Promise.all(w).then(()=>{var R;this.commonObjs.clear(),this.fontLoader.clear(),y(this,f).clear(),this.filterFactory.destroy(),(R=this._networkStream)==null||R.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:w,loadingTask:T}=this;w.on("GetReader",(M,R)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=k=>{this._lastProgress={loaded:k.loaded,total:k.total}},R.onPull=()=>{this._fullReader.read().then(function({value:k,done:L}){if(L){R.close();return}(0,_util.assert)(k instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),R.enqueue(new Uint8Array(k),1,[k])}).catch(k=>{R.error(k)})},R.onCancel=k=>{this._fullReader.cancel(k),R.ready.catch(L=>{if(!this.destroyed)throw L})}}),w.on("ReaderHeadersReady",M=>{const R=new _util.PromiseCapability,k=this._fullReader;return k.headersReady.then(()=>{var L;(!k.isStreamingSupported||!k.isRangeSupported)&&(this._lastProgress&&((L=T.onProgress)==null||L.call(T,this._lastProgress)),k.onProgress=ae=>{var Q;(Q=T.onProgress)==null||Q.call(T,{loaded:ae.loaded,total:ae.total})}),R.resolve({isStreamingSupported:k.isStreamingSupported,isRangeSupported:k.isRangeSupported,contentLength:k.contentLength})},R.reject),R.promise}),w.on("GetRangeReader",(M,R)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const k=this._networkStream.getRangeReader(M.begin,M.end);if(!k){R.close();return}R.onPull=()=>{k.read().then(function({value:L,done:ae}){if(ae){R.close();return}(0,_util.assert)(L instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),R.enqueue(new Uint8Array(L),1,[L])}).catch(L=>{R.error(L)})},R.onCancel=L=>{k.cancel(L),R.ready.catch(ae=>{if(!this.destroyed)throw ae})}}),w.on("GetDoc",({pdfInfo:M})=>{this._numPages=M.numPages,this._htmlForXfa=M.htmlForXfa,delete M.htmlForXfa,T._capability.resolve(new PDFDocumentProxy(M,this))}),w.on("DocException",function(M){let R;switch(M.name){case"PasswordException":R=new _util.PasswordException(M.message,M.code);break;case"InvalidPDFException":R=new _util.InvalidPDFException(M.message);break;case"MissingPDFException":R=new _util.MissingPDFException(M.message);break;case"UnexpectedResponseException":R=new _util.UnexpectedResponseException(M.message,M.status);break;case"UnknownErrorException":R=new _util.UnknownErrorException(M.message,M.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}T._capability.reject(R)}),w.on("PasswordRequest",M=>{if(Ee(this,g,new _util.PromiseCapability),T.onPassword){const R=k=>{k instanceof Error?y(this,g).reject(k):y(this,g).resolve({password:k})};try{T.onPassword(R,M.code)}catch(k){y(this,g).reject(k)}}else y(this,g).reject(new _util.PasswordException(M.message,M.code));return y(this,g).promise}),w.on("DataLoaded",M=>{var R;(R=T.onProgress)==null||R.call(T,{loaded:M.length,total:M.length}),this.downloadInfoCapability.resolve(M)}),w.on("StartRenderPage",M=>{if(this.destroyed)return;y(this,u).get(M.pageIndex)._startRenderPage(M.transparency,M.cacheKey)}),w.on("commonobj",([M,R,k])=>{var L;if(!this.destroyed&&!this.commonObjs.has(M))switch(R){case"Font":const ae=this._params;if("error"in k){const re=k.error;(0,_util.warn)(`Error during font loading: ${re}`),this.commonObjs.resolve(M,re);break}const Q=ae.pdfBug&&((L=globalThis.FontInspector)!=null&&L.enabled)?(re,me)=>globalThis.FontInspector.fontAdded(re,me):null,oe=new _font_loader.FontFaceObject(k,{isEvalSupported:ae.isEvalSupported,disableFontFace:ae.disableFontFace,ignoreErrors:ae.ignoreErrors,inspectFont:Q});this.fontLoader.bind(oe).catch(re=>w.sendWithPromise("FontFallback",{id:M})).finally(()=>{!ae.fontExtraProperties&&oe.data&&(oe.data=null),this.commonObjs.resolve(M,oe)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(M,k);break;default:throw new Error(`Got unknown common object type ${R}`)}}),w.on("obj",([M,R,k,L])=>{var Q;if(this.destroyed)return;const ae=y(this,u).get(R);if(!ae.objs.has(M))switch(k){case"Image":if(ae.objs.resolve(M,L),L){let oe;if(L.bitmap){const{width:re,height:me}=L;oe=re*me*4}else oe=((Q=L.data)==null?void 0:Q.length)||0;oe>_util.MAX_IMAGE_SIZE_TO_CACHE&&(ae._maybeCleanupAfterRender=!0)}break;case"Pattern":ae.objs.resolve(M,L);break;default:throw new Error(`Got unknown object type ${k}`)}}),w.on("DocProgress",M=>{var R;this.destroyed||(R=T.onProgress)==null||R.call(T,{loaded:M.loaded,total:M.total})}),w.on("FetchBuiltInCMap",M=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(M):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),w.on("FetchStandardFontData",M=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(M):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var M;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:w,transfers:T}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:w,filename:((M=this._fullReader)==null?void 0:M.filename)??null},T).finally(()=>{this.annotationStorage.resetModified()})}getPage(w){if(!Number.isInteger(w)||w<=0||w>this._numPages)return Promise.reject(new Error("Invalid page request."));const T=w-1,M=y(this,h).get(T);if(M)return M;const R=this.messageHandler.sendWithPromise("GetPage",{pageIndex:T}).then(k=>{if(this.destroyed)throw new Error("Transport destroyed");const L=new PDFPageProxy(T,k,this,this._params.pdfBug);return y(this,u).set(T,L),L});return y(this,h).set(T,R),R}getPageIndex(w){return typeof w!="object"||w===null||!Number.isInteger(w.num)||w.num<0||!Number.isInteger(w.gen)||w.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:w.num,gen:w.gen})}getAnnotations(w,T){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:w,intent:T})}getFieldObjects(){return ce(this,p,It).call(this,"GetFieldObjects")}hasJSActions(){return ce(this,p,It).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(w){return typeof w!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:w})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return ce(this,p,It).call(this,"GetDocJSActions")}getPageJSActions(w){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:w})}getStructTree(w){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:w})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(w=>new _optional_content_config.OptionalContentConfig(w))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const w="GetMetadata",T=y(this,f).get(w);if(T)return T;const M=this.messageHandler.sendWithPromise(w,null).then(R=>{var k,L;return{info:R[0],metadata:R[1]?new _metadata.Metadata(R[1]):null,contentDispositionFilename:((k=this._fullReader)==null?void 0:k.filename)??null,contentLength:((L=this._fullReader)==null?void 0:L.contentLength)??null}});return y(this,f).set(w,M),M}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(w=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const T of y(this,u).values())if(!T.cleanup())throw new Error(`startCleanup: Page ${T.pageNumber} is currently rendering.`);this.commonObjs.clear(),w||this.fontLoader.clear(),y(this,f).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:w,enableXfa:T}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:w,enableXfa:T})}}f=new WeakMap,u=new WeakMap,h=new WeakMap,g=new WeakMap,p=new WeakSet,It=function(w,T=null){const M=y(this,f).get(w);if(M)return M;const R=this.messageHandler.sendWithPromise(w,T);return y(this,f).set(w,R),R};class PDFObjects{constructor(){_e(this,S);_e(this,E,Object.create(null))}get(w,T=null){if(T){const R=ce(this,S,$t).call(this,w);return R.capability.promise.then(()=>T(R.data)),null}const M=y(this,E)[w];if(!(M!=null&&M.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${w}.`);return M.data}has(w){const T=y(this,E)[w];return(T==null?void 0:T.capability.settled)||!1}resolve(w,T=null){const M=ce(this,S,$t).call(this,w);M.data=T,M.capability.resolve()}clear(){var w;for(const T in y(this,E)){const{data:M}=y(this,E)[T];(w=M==null?void 0:M.bitmap)==null||w.close()}Ee(this,E,Object.create(null))}}E=new WeakMap,S=new WeakSet,$t=function(w){var T;return(T=y(this,E))[w]||(T[w]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(w){_e(this,F,null);Ee(this,F,w),this.onContinue=null}get promise(){return y(this,F).capability.promise}cancel(w=0){y(this,F).cancel(null,w)}get separateAnnots(){const{separateAnnots:w}=y(this,F).operatorList;if(!w)return!1;const{annotationCanvasMap:T}=y(this,F);return w.form||w.canvas&&(T==null?void 0:T.size)>0}}F=new WeakMap,exports$1.RenderTask=RenderTask;const C=class C{constructor({callback:w,params:T,objs:M,commonObjs:R,annotationCanvasMap:k,operatorList:L,pageIndex:ae,canvasFactory:Q,filterFactory:oe,useRequestAnimationFrame:re=!1,pdfBug:me=!1,pageColors:H=null}){this.callback=w,this.params=T,this.objs=M,this.commonObjs=R,this.annotationCanvasMap=k,this.operatorListIdx=null,this.operatorList=L,this._pageIndex=ae,this.canvasFactory=Q,this.filterFactory=oe,this._pdfBug=me,this.pageColors=H,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=re===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=T.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:w=!1,optionalContentConfig:T}){var ae,Q;if(this.cancelled)return;if(this._canvas){if(y(C,A).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");y(C,A).add(this._canvas)}this._pdfBug&&((ae=globalThis.StepperManager)!=null&&ae.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:M,viewport:R,transform:k,background:L}=this.params;this.gfx=new _canvas.CanvasGraphics(M,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:T},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:k,viewport:R,transparency:w,background:L}),this.operatorListIdx=0,this.graphicsReady=!0,(Q=this.graphicsReadyCallback)==null||Q.call(this)}cancel(w=null,T=0){var M;this.running=!1,this.cancelled=!0,(M=this.gfx)==null||M.endDrawing(),y(C,A).delete(this._canvas),this.callback(w||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,T))}operatorListChanged(){var w;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(w=this.stepper)==null||w.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),y(C,A).delete(this._canvas),this.callback())))}};A=new WeakMap,_e(C,A,new WeakSet);let InternalRenderTask=C;const version="3.11.174";exports$1.version=version;const build="ce8716743";exports$1.build=build},(e,t,r)=>{var l,c,f,Fr,h;Object.defineProperty(t,"__esModule",{value:!0}),t.SerializableEmpty=t.PrintAnnotationStorage=t.AnnotationStorage=void 0;var s=r(1),i=r(4),n=r(8);const a=Object.freeze({map:null,hash:"",transfers:void 0});t.SerializableEmpty=a;class o{constructor(){_e(this,f);_e(this,l,!1);_e(this,c,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(p,x){const E=y(this,c).get(p);return E===void 0?x:Object.assign(x,E)}getRawValue(p){return y(this,c).get(p)}remove(p){if(y(this,c).delete(p),y(this,c).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const x of y(this,c).values())if(x instanceof i.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(p,x){const E=y(this,c).get(p);let S=!1;if(E!==void 0)for(const[P,F]of Object.entries(x))E[P]!==F&&(S=!0,E[P]=F);else S=!0,y(this,c).set(p,x);S&&ce(this,f,Fr).call(this),x instanceof i.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(x.constructor._type)}has(p){return y(this,c).has(p)}getAll(){return y(this,c).size>0?(0,s.objectFromMap)(y(this,c)):null}setAll(p){for(const[x,E]of Object.entries(p))this.setValue(x,E)}get size(){return y(this,c).size}resetModified(){y(this,l)&&(Ee(this,l,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new d(this)}get serializable(){if(y(this,c).size===0)return a;const p=new Map,x=new n.MurmurHash3_64,E=[],S=Object.create(null);let P=!1;for(const[F,A]of y(this,c)){const C=A instanceof i.AnnotationEditor?A.serialize(!1,S):A;C&&(p.set(F,C),x.update(`${F}:${JSON.stringify(C)}`),P||(P=!!C.bitmap))}if(P)for(const F of p.values())F.bitmap&&E.push(F.bitmap);return p.size>0?{map:p,hash:x.hexdigest(),transfers:E}:a}}l=new WeakMap,c=new WeakMap,f=new WeakSet,Fr=function(){y(this,l)||(Ee(this,l,!0),typeof this.onSetModified=="function"&&this.onSetModified())},t.AnnotationStorage=o;class d extends o{constructor(x){super();_e(this,h);const{map:E,hash:S,transfers:P}=x.serializable,F=structuredClone(E,P?{transfer:P}:null);Ee(this,h,{map:F,hash:S,transfers:P})}get print(){(0,s.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return y(this,h)}}h=new WeakMap,t.PrintAnnotationStorage=d},(e,t,r)=>{var d,l,c,f,u,h,g,p,x,E,S,P,F,A,C,Yt,Jt,T,Zt,Qt,Nr,Pr,kr,er,Ir;Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditor=void 0;var s=r(5),i=r(1),n=r(6);const re=class re{constructor(H){_e(this,C);_e(this,d,"");_e(this,l,!1);_e(this,c,null);_e(this,f,null);_e(this,u,null);_e(this,h,!1);_e(this,g,null);_e(this,p,this.focusin.bind(this));_e(this,x,this.focusout.bind(this));_e(this,E,!1);_e(this,S,!1);_e(this,P,!1);lt(this,"_initialOptions",Object.create(null));lt(this,"_uiManager",null);lt(this,"_focusEventsAllowed",!0);lt(this,"_l10nPromise",null);_e(this,F,!1);_e(this,A,re._zIndex++);this.constructor===re&&(0,i.unreachable)("Cannot initialize AnnotationEditor."),this.parent=H.parent,this.id=H.id,this.width=this.height=null,this.pageIndex=H.parent.pageIndex,this.name=H.name,this.div=null,this._uiManager=H.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=H.isCentered,this._structTreeParentId=null;const{rotation:ie,rawDims:{pageWidth:le,pageHeight:N,pageX:b,pageY:v}}=this.parent.viewport;this.rotation=ie,this.pageRotation=(360+ie-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[le,N],this.pageTranslation=[b,v];const[j,D]=this.parentDimensions;this.x=H.x/j,this.y=H.y/D,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,i.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(H){const ie=new o({id:H.parent.getNextId(),parent:H.parent,uiManager:H._uiManager});ie.annotationElementId=H.annotationElementId,ie.deleted=!0,ie._uiManager.addToAnnotationStorage(ie)}static initialize(H,ie=null){if(re._l10nPromise||(re._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(N=>[N,H.get(N)]))),ie!=null&&ie.strings)for(const N of ie.strings)re._l10nPromise.set(N,H.get(N));if(re._borderLineWidth!==-1)return;const le=getComputedStyle(document.documentElement);re._borderLineWidth=parseFloat(le.getPropertyValue("--outline-width"))||0}static updateDefaultParams(H,ie){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(H){return!1}static paste(H,ie){(0,i.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return y(this,F)}set _isDraggable(H){var ie;Ee(this,F,H),(ie=this.div)==null||ie.classList.toggle("draggable",H)}center(){const[H,ie]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*ie/(H*2),this.y+=this.width*H/(ie*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*ie/(H*2),this.y-=this.width*H/(ie*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(H){this._uiManager.addCommands(H)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=y(this,A)}setParent(H){H!==null&&(this.pageIndex=H.pageIndex,this.pageDimensions=H.pageDimensions),this.parent=H}focusin(H){this._focusEventsAllowed&&(y(this,E)?Ee(this,E,!1):this.parent.setSelected(this))}focusout(H){var le;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const ie=H.relatedTarget;ie!=null&&ie.closest(`#${this.id}`)||(H.preventDefault(),(le=this.parent)!=null&&le.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(H,ie,le,N){const[b,v]=this.parentDimensions;[le,N]=this.screenToPageTranslation(le,N),this.x=(H+le)/b,this.y=(ie+N)/v,this.fixAndSetPosition()}translate(H,ie){ce(this,C,Yt).call(this,this.parentDimensions,H,ie)}translateInPage(H,ie){ce(this,C,Yt).call(this,this.pageDimensions,H,ie),this.div.scrollIntoView({block:"nearest"})}drag(H,ie){const[le,N]=this.parentDimensions;if(this.x+=H/le,this.y+=ie/N,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:U,y:W}=this.div.getBoundingClientRect();this.parent.findNewParent(this,U,W)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:b,y:v}=this;const[j,D]=ce(this,C,Jt).call(this);b+=j,v+=D,this.div.style.left=`${(100*b).toFixed(2)}%`,this.div.style.top=`${(100*v).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[H,ie]=this.pageDimensions;let{x:le,y:N,width:b,height:v}=this;switch(b*=H,v*=ie,le*=H,N*=ie,this.rotation){case 0:le=Math.max(0,Math.min(H-b,le)),N=Math.max(0,Math.min(ie-v,N));break;case 90:le=Math.max(0,Math.min(H-v,le)),N=Math.min(ie,Math.max(b,N));break;case 180:le=Math.min(H,Math.max(b,le)),N=Math.min(ie,Math.max(v,N));break;case 270:le=Math.min(H,Math.max(v,le)),N=Math.max(0,Math.min(ie-b,N));break}this.x=le/=H,this.y=N/=ie;const[j,D]=ce(this,C,Jt).call(this);le+=j,N+=D;const{style:U}=this.div;U.left=`${(100*le).toFixed(2)}%`,U.top=`${(100*N).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(H,ie){var le;return ce(le=re,T,Zt).call(le,H,ie,this.parentRotation)}pageTranslationToScreen(H,ie){var le;return ce(le=re,T,Zt).call(le,H,ie,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:H,pageDimensions:[ie,le]}=this,N=ie*H,b=le*H;return i.FeatureTest.isCSSRoundSupported?[Math.round(N),Math.round(b)]:[N,b]}setDims(H,ie){var b;const[le,N]=this.parentDimensions;this.div.style.width=`${(100*H/le).toFixed(2)}%`,y(this,h)||(this.div.style.height=`${(100*ie/N).toFixed(2)}%`),(b=y(this,c))==null||b.classList.toggle("small",H<re.SMALL_EDITOR_SIZE||ie<re.SMALL_EDITOR_SIZE)}fixDims(){const{style:H}=this.div,{height:ie,width:le}=H,N=le.endsWith("%"),b=!y(this,h)&&ie.endsWith("%");if(N&&b)return;const[v,j]=this.parentDimensions;N||(H.width=`${(100*parseFloat(le)/v).toFixed(2)}%`),!y(this,h)&&!b&&(H.height=`${(100*parseFloat(ie)/j).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(y(this,c))return;const H=Ee(this,c,document.createElement("button"));H.className="altText";const ie=await re._l10nPromise.get("editor_alt_text_button_label");H.textContent=ie,H.setAttribute("aria-label",ie),H.tabIndex="0",H.addEventListener("contextmenu",n.noContextMenu),H.addEventListener("pointerdown",le=>le.stopPropagation()),H.addEventListener("click",le=>{le.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),H.addEventListener("keydown",le=>{le.target===H&&le.key==="Enter"&&(le.preventDefault(),this._uiManager.editAltText(this))}),ce(this,C,er).call(this),this.div.append(H),re.SMALL_EDITOR_SIZE||(re.SMALL_EDITOR_SIZE=Math.min(128,Math.round(H.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:y(this,d),decorative:y(this,l)}}set altTextData({altText:H,decorative:ie}){y(this,d)===H&&y(this,l)===ie||(Ee(this,d,H),Ee(this,l,ie),ce(this,C,er).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",y(this,p)),this.div.addEventListener("focusout",y(this,x));const[H,ie]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*ie/H).toFixed(2)}%`,this.div.style.maxHeight=`${(100*H/ie).toFixed(2)}%`);const[le,N]=this.getInitialTranslation();return this.translate(le,N),(0,s.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(H){const{isMac:ie}=i.FeatureTest.platform;if(H.button!==0||H.ctrlKey&&ie){H.preventDefault();return}Ee(this,E,!0),ce(this,C,Ir).call(this,H)}moveInDOM(){var H;(H=this.parent)==null||H.moveEditorInDOM(this)}_setParentAndPosition(H,ie,le){H.changeParent(this),this.x=ie,this.y=le,this.fixAndSetPosition()}getRect(H,ie){const le=this.parentScale,[N,b]=this.pageDimensions,[v,j]=this.pageTranslation,D=H/le,U=ie/le,W=this.x*N,Z=this.y*b,te=this.width*N,ve=this.height*b;switch(this.rotation){case 0:return[W+D+v,b-Z-U-ve+j,W+D+te+v,b-Z-U+j];case 90:return[W+U+v,b-Z+D+j,W+U+ve+v,b-Z+D+te+j];case 180:return[W-D-te+v,b-Z+U+j,W-D+v,b-Z+U+ve+j];case 270:return[W-U-ve+v,b-Z-D-te+j,W-U+v,b-Z-D+j];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(H,ie){const[le,N,b,v]=H,j=b-le,D=v-N;switch(this.rotation){case 0:return[le,ie-v,j,D];case 90:return[le,ie-N,D,j];case 180:return[b,ie-N,j,D];case 270:return[b,ie-v,D,j];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Ee(this,P,!0)}disableEditMode(){Ee(this,P,!1)}isInEditMode(){return y(this,P)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var H,ie;(H=this.div)==null||H.addEventListener("focusin",y(this,p)),(ie=this.div)==null||ie.addEventListener("focusout",y(this,x))}serialize(H=!1,ie=null){(0,i.unreachable)("An editor must be serializable")}static deserialize(H,ie,le){const N=new this.prototype.constructor({parent:ie,id:ie.getNextId(),uiManager:le});N.rotation=H.rotation;const[b,v]=N.pageDimensions,[j,D,U,W]=N.getRectInCurrentCoords(H.rect,v);return N.x=j/b,N.y=D/v,N.width=U/b,N.height=W/v,N}remove(){var H;this.div.removeEventListener("focusin",y(this,p)),this.div.removeEventListener("focusout",y(this,x)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(H=y(this,c))==null||H.remove(),Ee(this,c,null),Ee(this,f,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(ce(this,C,Nr).call(this),y(this,g).classList.remove("hidden"))}select(){var H;this.makeResizable(),(H=this.div)==null||H.classList.add("selectedEditor")}unselect(){var H,ie,le;(H=y(this,g))==null||H.classList.add("hidden"),(ie=this.div)==null||ie.classList.remove("selectedEditor"),(le=this.div)!=null&&le.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(H,ie){}disableEditing(){y(this,c)&&(y(this,c).hidden=!0)}enableEditing(){y(this,c)&&(y(this,c).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return y(this,S)}set isEditing(H){Ee(this,S,H),this.parent&&(H?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(H,ie){Ee(this,h,!0);const le=H/ie,{style:N}=this.div;N.aspectRatio=le,N.height="auto"}static get MIN_SIZE(){return 16}};d=new WeakMap,l=new WeakMap,c=new WeakMap,f=new WeakMap,u=new WeakMap,h=new WeakMap,g=new WeakMap,p=new WeakMap,x=new WeakMap,E=new WeakMap,S=new WeakMap,P=new WeakMap,F=new WeakMap,A=new WeakMap,C=new WeakSet,Yt=function([H,ie],le,N){[le,N]=this.screenToPageTranslation(le,N),this.x+=le/H,this.y+=N/ie,this.fixAndSetPosition()},Jt=function(){const[H,ie]=this.parentDimensions,{_borderLineWidth:le}=re,N=le/H,b=le/ie;switch(this.rotation){case 90:return[-N,b];case 180:return[N,b];case 270:return[N,-b];default:return[-N,-b]}},T=new WeakSet,Zt=function(H,ie,le){switch(le){case 90:return[ie,-H];case 180:return[-H,-ie];case 270:return[-ie,H];default:return[H,ie]}},Qt=function(H){switch(H){case 90:{const[ie,le]=this.pageDimensions;return[0,-ie/le,le/ie,0]}case 180:return[-1,0,0,-1];case 270:{const[ie,le]=this.pageDimensions;return[0,ie/le,-le/ie,0]}default:return[1,0,0,1]}},Nr=function(){if(y(this,g))return;Ee(this,g,document.createElement("div")),y(this,g).classList.add("resizers");const H=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||H.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const ie of H){const le=document.createElement("div");y(this,g).append(le),le.classList.add("resizer",ie),le.addEventListener("pointerdown",ce(this,C,Pr).bind(this,ie)),le.addEventListener("contextmenu",n.noContextMenu)}this.div.prepend(y(this,g))},Pr=function(H,ie){ie.preventDefault();const{isMac:le}=i.FeatureTest.platform;if(ie.button!==0||ie.ctrlKey&&le)return;const N=ce(this,C,kr).bind(this,H),b=this._isDraggable;this._isDraggable=!1;const v={passive:!0,capture:!0};window.addEventListener("pointermove",N,v);const j=this.x,D=this.y,U=this.width,W=this.height,Z=this.parent.div.style.cursor,te=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(ie.target).cursor;const ve=()=>{this._isDraggable=b,window.removeEventListener("pointerup",ve),window.removeEventListener("blur",ve),window.removeEventListener("pointermove",N,v),this.parent.div.style.cursor=Z,this.div.style.cursor=te;const xe=this.x,Re=this.y,Ae=this.width,ke=this.height;xe===j&&Re===D&&Ae===U&&ke===W||this.addCommands({cmd:()=>{this.width=Ae,this.height=ke,this.x=xe,this.y=Re;const[ue,se]=this.parentDimensions;this.setDims(ue*Ae,se*ke),this.fixAndSetPosition()},undo:()=>{this.width=U,this.height=W,this.x=j,this.y=D;const[ue,se]=this.parentDimensions;this.setDims(ue*U,se*W),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",ve),window.addEventListener("blur",ve)},kr=function(H,ie){const[le,N]=this.parentDimensions,b=this.x,v=this.y,j=this.width,D=this.height,U=re.MIN_SIZE/le,W=re.MIN_SIZE/N,Z=Xe=>Math.round(Xe*1e4)/1e4,te=ce(this,C,Qt).call(this,this.rotation),ve=(Xe,Je)=>[te[0]*Xe+te[2]*Je,te[1]*Xe+te[3]*Je],xe=ce(this,C,Qt).call(this,360-this.rotation),Re=(Xe,Je)=>[xe[0]*Xe+xe[2]*Je,xe[1]*Xe+xe[3]*Je];let Ae,ke,ue=!1,se=!1;switch(H){case"topLeft":ue=!0,Ae=(Xe,Je)=>[0,0],ke=(Xe,Je)=>[Xe,Je];break;case"topMiddle":Ae=(Xe,Je)=>[Xe/2,0],ke=(Xe,Je)=>[Xe/2,Je];break;case"topRight":ue=!0,Ae=(Xe,Je)=>[Xe,0],ke=(Xe,Je)=>[0,Je];break;case"middleRight":se=!0,Ae=(Xe,Je)=>[Xe,Je/2],ke=(Xe,Je)=>[0,Je/2];break;case"bottomRight":ue=!0,Ae=(Xe,Je)=>[Xe,Je],ke=(Xe,Je)=>[0,0];break;case"bottomMiddle":Ae=(Xe,Je)=>[Xe/2,Je],ke=(Xe,Je)=>[Xe/2,0];break;case"bottomLeft":ue=!0,Ae=(Xe,Je)=>[0,Je],ke=(Xe,Je)=>[Xe,0];break;case"middleLeft":se=!0,Ae=(Xe,Je)=>[0,Je/2],ke=(Xe,Je)=>[Xe,Je/2];break}const z=Ae(j,D),J=ke(j,D);let de=ve(...J);const fe=Z(b+de[0]),Fe=Z(v+de[1]);let De=1,Pe=1,[he,ze]=this.screenToPageTranslation(ie.movementX,ie.movementY);if([he,ze]=Re(he/le,ze/N),ue){const Xe=Math.hypot(j,D);De=Pe=Math.max(Math.min(Math.hypot(J[0]-z[0]-he,J[1]-z[1]-ze)/Xe,1/j,1/D),U/j,W/D)}else se?De=Math.max(U,Math.min(1,Math.abs(J[0]-z[0]-he)))/j:Pe=Math.max(W,Math.min(1,Math.abs(J[1]-z[1]-ze)))/D;const Le=Z(j*De),tt=Z(D*Pe);de=ve(...ke(Le,tt));const et=fe-de[0],it=Fe-de[1];this.width=Le,this.height=tt,this.x=et,this.y=it,this.setDims(le*Le,N*tt),this.fixAndSetPosition()},er=async function(){var le;const H=y(this,c);if(!H)return;if(!y(this,d)&&!y(this,l)){H.classList.remove("done"),(le=y(this,f))==null||le.remove();return}re._l10nPromise.get("editor_alt_text_edit_button_label").then(N=>{H.setAttribute("aria-label",N)});let ie=y(this,f);if(!ie){Ee(this,f,ie=document.createElement("span")),ie.className="tooltip",ie.setAttribute("role","tooltip");const N=ie.id=`alt-text-tooltip-${this.id}`;H.setAttribute("aria-describedby",N);const b=100;H.addEventListener("mouseenter",()=>{Ee(this,u,setTimeout(()=>{Ee(this,u,null),y(this,f).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},b))}),H.addEventListener("mouseleave",()=>{var v;clearTimeout(y(this,u)),Ee(this,u,null),(v=y(this,f))==null||v.classList.remove("show")})}H.classList.add("done"),ie.innerText=y(this,l)?await re._l10nPromise.get("editor_alt_text_decorative_tooltip"):y(this,d),ie.parentNode||H.append(ie)},Ir=function(H){if(!this._isDraggable)return;const ie=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let le,N;ie&&(le={passive:!0,capture:!0},N=v=>{const[j,D]=this.screenToPageTranslation(v.movementX,v.movementY);this._uiManager.dragSelectedEditors(j,D)},window.addEventListener("pointermove",N,le));const b=()=>{if(window.removeEventListener("pointerup",b),window.removeEventListener("blur",b),ie&&window.removeEventListener("pointermove",N,le),Ee(this,E,!1),!this._uiManager.endDragSession()){const{isMac:v}=i.FeatureTest.platform;H.ctrlKey&&!v||H.shiftKey||H.metaKey&&v?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",b),window.addEventListener("blur",b)},_e(re,T),lt(re,"_borderLineWidth",-1),lt(re,"_colorManager",new s.ColorManager),lt(re,"_zIndex",1),lt(re,"SMALL_EDITOR_SIZE",0);let a=re;t.AnnotationEditor=a;class o extends a{constructor(H){super(H),this.annotationElementId=H.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(e,t,r)=>{var h,g,p,x,E,tr,F,A,C,_,w,Mr,R,k,L,ae,Q,oe,re,me,H,ie,le,N,b,v,j,D,U,W,Z,te,ve,xe,Re,Ae,ke,ue,se,z,J,de,fe,Fe,De,Pe,he,Dr,rr,sr,Mt,ir,nr,ht,Tt,Or,Lr,ar,Rt,or;Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardManager=t.CommandManager=t.ColorManager=t.AnnotationEditorUIManager=void 0,t.bindEvents=n,t.opacityToHex=a;var s=r(1),i=r(6);function n(rt,ee,Ne){for(const Be of Ne)ee.addEventListener(Be,rt[Be].bind(rt))}function a(rt){return Math.round(Math.min(255,Math.max(1,255*rt))).toString(16).padStart(2,"0")}class o{constructor(){_e(this,h,0)}getId(){return`${s.AnnotationEditorPrefix}${At(this,h)._++}`}}h=new WeakMap;const P=class P{constructor(){_e(this,E);_e(this,g,(0,s.getUuid)());_e(this,p,0);_e(this,x,null)}static get _isSVGFittingCanvas(){const ee='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Be=new OffscreenCanvas(1,3).getContext("2d"),qe=new Image;qe.src=ee;const Ye=qe.decode().then(()=>(Be.drawImage(qe,0,0,1,1,0,0,1,3),new Uint32Array(Be.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,s.shadow)(this,"_isSVGFittingCanvas",Ye)}async getFromFile(ee){const{lastModified:Ne,name:Be,size:qe,type:Ye}=ee;return ce(this,E,tr).call(this,`${Ne}_${Be}_${qe}_${Ye}`,ee)}async getFromUrl(ee){return ce(this,E,tr).call(this,ee,ee)}async getFromId(ee){y(this,x)||Ee(this,x,new Map);const Ne=y(this,x).get(ee);return Ne?Ne.bitmap?(Ne.refCounter+=1,Ne):Ne.file?this.getFromFile(Ne.file):this.getFromUrl(Ne.url):null}getSvgUrl(ee){const Ne=y(this,x).get(ee);return Ne!=null&&Ne.isSvg?Ne.svgUrl:null}deleteId(ee){y(this,x)||Ee(this,x,new Map);const Ne=y(this,x).get(ee);Ne&&(Ne.refCounter-=1,Ne.refCounter===0&&(Ne.bitmap=null))}isValidId(ee){return ee.startsWith(`image_${y(this,g)}_`)}};g=new WeakMap,p=new WeakMap,x=new WeakMap,E=new WeakSet,tr=async function(ee,Ne){y(this,x)||Ee(this,x,new Map);let Be=y(this,x).get(ee);if(Be===null)return null;if(Be!=null&&Be.bitmap)return Be.refCounter+=1,Be;try{Be||(Be={bitmap:null,id:`image_${y(this,g)}_${At(this,p)._++}`,refCounter:0,isSvg:!1});let qe;if(typeof Ne=="string"){Be.url=Ne;const Ye=await fetch(Ne);if(!Ye.ok)throw new Error(Ye.statusText);qe=await Ye.blob()}else qe=Be.file=Ne;if(qe.type==="image/svg+xml"){const Ye=P._isSVGFittingCanvas,Ge=new FileReader,Y=new Image,V=new Promise((ne,ye)=>{Y.onload=()=>{Be.bitmap=Y,Be.isSvg=!0,ne()},Ge.onload=async()=>{const Te=Be.svgUrl=Ge.result;Y.src=await Ye?`${Te}#svgView(preserveAspectRatio(none))`:Te},Y.onerror=Ge.onerror=ye});Ge.readAsDataURL(qe),await V}else Be.bitmap=await createImageBitmap(qe);Be.refCounter=1}catch(qe){console.error(qe),Be=null}return y(this,x).set(ee,Be),Be&&y(this,x).set(Be.id,Be),Be};let d=P;class l{constructor(ee=128){_e(this,F,[]);_e(this,A,!1);_e(this,C);_e(this,_,-1);Ee(this,C,ee)}add({cmd:ee,undo:Ne,mustExec:Be,type:qe=NaN,overwriteIfSameType:Ye=!1,keepUndo:Ge=!1}){if(Be&&ee(),y(this,A))return;const Y={cmd:ee,undo:Ne,type:qe};if(y(this,_)===-1){y(this,F).length>0&&(y(this,F).length=0),Ee(this,_,0),y(this,F).push(Y);return}if(Ye&&y(this,F)[y(this,_)].type===qe){Ge&&(Y.undo=y(this,F)[y(this,_)].undo),y(this,F)[y(this,_)]=Y;return}const V=y(this,_)+1;V===y(this,C)?y(this,F).splice(0,1):(Ee(this,_,V),V<y(this,F).length&&y(this,F).splice(V)),y(this,F).push(Y)}undo(){y(this,_)!==-1&&(Ee(this,A,!0),y(this,F)[y(this,_)].undo(),Ee(this,A,!1),Ee(this,_,y(this,_)-1))}redo(){y(this,_)<y(this,F).length-1&&(Ee(this,_,y(this,_)+1),Ee(this,A,!0),y(this,F)[y(this,_)].cmd(),Ee(this,A,!1))}hasSomethingToUndo(){return y(this,_)!==-1}hasSomethingToRedo(){return y(this,_)<y(this,F).length-1}destroy(){Ee(this,F,null)}}F=new WeakMap,A=new WeakMap,C=new WeakMap,_=new WeakMap,t.CommandManager=l;class c{constructor(ee){_e(this,w);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:Ne}=s.FeatureTest.platform;for(const[Be,qe,Ye={}]of ee)for(const Ge of Be){const Y=Ge.startsWith("mac+");Ne&&Y?(this.callbacks.set(Ge.slice(4),{callback:qe,options:Ye}),this.allKeys.add(Ge.split("+").at(-1))):!Ne&&!Y&&(this.callbacks.set(Ge,{callback:qe,options:Ye}),this.allKeys.add(Ge.split("+").at(-1)))}}exec(ee,Ne){if(!this.allKeys.has(Ne.key))return;const Be=this.callbacks.get(ce(this,w,Mr).call(this,Ne));if(!Be)return;const{callback:qe,options:{bubbles:Ye=!1,args:Ge=[],checker:Y=null}}=Be;Y&&!Y(ee,Ne)||(qe.bind(ee,...Ge)(),Ye||(Ne.stopPropagation(),Ne.preventDefault()))}}w=new WeakSet,Mr=function(ee){ee.altKey&&this.buffer.push("alt"),ee.ctrlKey&&this.buffer.push("ctrl"),ee.metaKey&&this.buffer.push("meta"),ee.shiftKey&&this.buffer.push("shift"),this.buffer.push(ee.key);const Ne=this.buffer.join("+");return this.buffer.length=0,Ne},t.KeyboardManager=c;const M=class M{get _colors(){const ee=new Map([["CanvasText",null],["Canvas",null]]);return(0,i.getColorValues)(ee),(0,s.shadow)(this,"_colors",ee)}convert(ee){const Ne=(0,i.getRGB)(ee);if(!window.matchMedia("(forced-colors: active)").matches)return Ne;for(const[Be,qe]of this._colors)if(qe.every((Ye,Ge)=>Ye===Ne[Ge]))return M._colorsMapping.get(Be);return Ne}getHexCode(ee){const Ne=this._colors.get(ee);return Ne?s.Util.makeHexColor(...Ne):ee}};lt(M,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let f=M;t.ColorManager=f;const st=class st{constructor(ee,Ne,Be,qe,Ye,Ge){_e(this,he);_e(this,R,null);_e(this,k,new Map);_e(this,L,new Map);_e(this,ae,null);_e(this,Q,null);_e(this,oe,new l);_e(this,re,0);_e(this,me,new Set);_e(this,H,null);_e(this,ie,null);_e(this,le,new Set);_e(this,N,null);_e(this,b,new o);_e(this,v,!1);_e(this,j,!1);_e(this,D,null);_e(this,U,s.AnnotationEditorType.NONE);_e(this,W,new Set);_e(this,Z,null);_e(this,te,this.blur.bind(this));_e(this,ve,this.focus.bind(this));_e(this,xe,this.copy.bind(this));_e(this,Re,this.cut.bind(this));_e(this,Ae,this.paste.bind(this));_e(this,ke,this.keydown.bind(this));_e(this,ue,this.onEditingAction.bind(this));_e(this,se,this.onPageChanging.bind(this));_e(this,z,this.onScaleChanging.bind(this));_e(this,J,this.onRotationChanging.bind(this));_e(this,de,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});_e(this,fe,[0,0]);_e(this,Fe,null);_e(this,De,null);_e(this,Pe,null);Ee(this,De,ee),Ee(this,Pe,Ne),Ee(this,ae,Be),this._eventBus=qe,this._eventBus._on("editingaction",y(this,ue)),this._eventBus._on("pagechanging",y(this,se)),this._eventBus._on("scalechanging",y(this,z)),this._eventBus._on("rotationchanging",y(this,J)),Ee(this,Q,Ye.annotationStorage),Ee(this,N,Ye.filterFactory),Ee(this,Z,Ge),this.viewParameters={realScale:i.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const ee=st.prototype,Ne=Ye=>{const{activeElement:Ge}=document;return Ge&&y(Ye,De).contains(Ge)&&Ye.hasSomethingToControl()},Be=this.TRANSLATE_SMALL,qe=this.TRANSLATE_BIG;return(0,s.shadow)(this,"_keyboardManager",new c([[["ctrl+a","mac+meta+a"],ee.selectAll],[["ctrl+z","mac+meta+z"],ee.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],ee.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],ee.delete],[["Escape","mac+Escape"],ee.unselectAll],[["ArrowLeft","mac+ArrowLeft"],ee.translateSelectedEditors,{args:[-Be,0],checker:Ne}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],ee.translateSelectedEditors,{args:[-qe,0],checker:Ne}],[["ArrowRight","mac+ArrowRight"],ee.translateSelectedEditors,{args:[Be,0],checker:Ne}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],ee.translateSelectedEditors,{args:[qe,0],checker:Ne}],[["ArrowUp","mac+ArrowUp"],ee.translateSelectedEditors,{args:[0,-Be],checker:Ne}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],ee.translateSelectedEditors,{args:[0,-qe],checker:Ne}],[["ArrowDown","mac+ArrowDown"],ee.translateSelectedEditors,{args:[0,Be],checker:Ne}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],ee.translateSelectedEditors,{args:[0,qe],checker:Ne}]]))}destroy(){ce(this,he,Mt).call(this),ce(this,he,rr).call(this),this._eventBus._off("editingaction",y(this,ue)),this._eventBus._off("pagechanging",y(this,se)),this._eventBus._off("scalechanging",y(this,z)),this._eventBus._off("rotationchanging",y(this,J));for(const ee of y(this,L).values())ee.destroy();y(this,L).clear(),y(this,k).clear(),y(this,le).clear(),Ee(this,R,null),y(this,W).clear(),y(this,oe).destroy(),y(this,ae).destroy()}get hcmFilter(){return(0,s.shadow)(this,"hcmFilter",y(this,Z)?y(this,N).addHCMFilter(y(this,Z).foreground,y(this,Z).background):"none")}get direction(){return(0,s.shadow)(this,"direction",getComputedStyle(y(this,De)).direction)}editAltText(ee){var Ne;(Ne=y(this,ae))==null||Ne.editAltText(this,ee)}onPageChanging({pageNumber:ee}){Ee(this,re,ee-1)}focusMainContainer(){y(this,De).focus()}findParent(ee,Ne){for(const Be of y(this,L).values()){const{x:qe,y:Ye,width:Ge,height:Y}=Be.div.getBoundingClientRect();if(ee>=qe&&ee<=qe+Ge&&Ne>=Ye&&Ne<=Ye+Y)return Be}return null}disableUserSelect(ee=!1){y(this,Pe).classList.toggle("noUserSelect",ee)}addShouldRescale(ee){y(this,le).add(ee)}removeShouldRescale(ee){y(this,le).delete(ee)}onScaleChanging({scale:ee}){this.commitOrRemove(),this.viewParameters.realScale=ee*i.PixelsPerInch.PDF_TO_CSS_UNITS;for(const Ne of y(this,le))Ne.onScaleChanging()}onRotationChanging({pagesRotation:ee}){this.commitOrRemove(),this.viewParameters.rotation=ee}addToAnnotationStorage(ee){!ee.isEmpty()&&y(this,Q)&&!y(this,Q).has(ee.id)&&y(this,Q).setValue(ee.id,ee)}blur(){if(!this.hasSelection)return;const{activeElement:ee}=document;for(const Ne of y(this,W))if(Ne.div.contains(ee)){Ee(this,D,[Ne,ee]),Ne._focusEventsAllowed=!1;break}}focus(){if(!y(this,D))return;const[ee,Ne]=y(this,D);Ee(this,D,null),Ne.addEventListener("focusin",()=>{ee._focusEventsAllowed=!0},{once:!0}),Ne.focus()}addEditListeners(){ce(this,he,sr).call(this),ce(this,he,ir).call(this)}removeEditListeners(){ce(this,he,Mt).call(this),ce(this,he,nr).call(this)}copy(ee){var Be;if(ee.preventDefault(),(Be=y(this,R))==null||Be.commitOrRemove(),!this.hasSelection)return;const Ne=[];for(const qe of y(this,W)){const Ye=qe.serialize(!0);Ye&&Ne.push(Ye)}Ne.length!==0&&ee.clipboardData.setData("application/pdfjs",JSON.stringify(Ne))}cut(ee){this.copy(ee),this.delete()}paste(ee){ee.preventDefault();const{clipboardData:Ne}=ee;for(const Ye of Ne.items)for(const Ge of y(this,ie))if(Ge.isHandlingMimeForPasting(Ye.type)){Ge.paste(Ye,this.currentLayer);return}let Be=Ne.getData("application/pdfjs");if(!Be)return;try{Be=JSON.parse(Be)}catch(Ye){(0,s.warn)(`paste: "${Ye.message}".`);return}if(!Array.isArray(Be))return;this.unselectAll();const qe=this.currentLayer;try{const Ye=[];for(const V of Be){const ne=qe.deserialize(V);if(!ne)return;Ye.push(ne)}const Ge=()=>{for(const V of Ye)ce(this,he,ar).call(this,V);ce(this,he,or).call(this,Ye)},Y=()=>{for(const V of Ye)V.remove()};this.addCommands({cmd:Ge,undo:Y,mustExec:!0})}catch(Ye){(0,s.warn)(`paste: "${Ye.message}".`)}}keydown(ee){var Ne;(Ne=this.getActive())!=null&&Ne.shouldGetKeyboardEvents()||st._keyboardManager.exec(this,ee)}onEditingAction(ee){["undo","redo","delete","selectAll"].includes(ee.name)&&this[ee.name]()}setEditingState(ee){ee?(ce(this,he,Dr).call(this),ce(this,he,sr).call(this),ce(this,he,ir).call(this),ce(this,he,ht).call(this,{isEditing:y(this,U)!==s.AnnotationEditorType.NONE,isEmpty:ce(this,he,Rt).call(this),hasSomethingToUndo:y(this,oe).hasSomethingToUndo(),hasSomethingToRedo:y(this,oe).hasSomethingToRedo(),hasSelectedEditor:!1})):(ce(this,he,rr).call(this),ce(this,he,Mt).call(this),ce(this,he,nr).call(this),ce(this,he,ht).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(ee){if(!y(this,ie)){Ee(this,ie,ee);for(const Ne of y(this,ie))ce(this,he,Tt).call(this,Ne.defaultPropertiesToUpdate)}}getId(){return y(this,b).getId()}get currentLayer(){return y(this,L).get(y(this,re))}getLayer(ee){return y(this,L).get(ee)}get currentPageIndex(){return y(this,re)}addLayer(ee){y(this,L).set(ee.pageIndex,ee),y(this,v)?ee.enable():ee.disable()}removeLayer(ee){y(this,L).delete(ee.pageIndex)}updateMode(ee,Ne=null){if(y(this,U)!==ee){if(Ee(this,U,ee),ee===s.AnnotationEditorType.NONE){this.setEditingState(!1),ce(this,he,Lr).call(this);return}this.setEditingState(!0),ce(this,he,Or).call(this),this.unselectAll();for(const Be of y(this,L).values())Be.updateMode(ee);if(Ne){for(const Be of y(this,k).values())if(Be.annotationElementId===Ne){this.setSelected(Be),Be.enterInEditMode();break}}}}updateToolbar(ee){ee!==y(this,U)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:ee})}updateParams(ee,Ne){if(y(this,ie)){if(ee===s.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(ee);return}for(const Be of y(this,W))Be.updateParams(ee,Ne);for(const Be of y(this,ie))Be.updateDefaultParams(ee,Ne)}}enableWaiting(ee=!1){if(y(this,j)!==ee){Ee(this,j,ee);for(const Ne of y(this,L).values())ee?Ne.disableClick():Ne.enableClick(),Ne.div.classList.toggle("waiting",ee)}}getEditors(ee){const Ne=[];for(const Be of y(this,k).values())Be.pageIndex===ee&&Ne.push(Be);return Ne}getEditor(ee){return y(this,k).get(ee)}addEditor(ee){y(this,k).set(ee.id,ee)}removeEditor(ee){var Ne;y(this,k).delete(ee.id),this.unselect(ee),(!ee.annotationElementId||!y(this,me).has(ee.annotationElementId))&&((Ne=y(this,Q))==null||Ne.remove(ee.id))}addDeletedAnnotationElement(ee){y(this,me).add(ee.annotationElementId),ee.deleted=!0}isDeletedAnnotationElement(ee){return y(this,me).has(ee)}removeDeletedAnnotationElement(ee){y(this,me).delete(ee.annotationElementId),ee.deleted=!1}setActiveEditor(ee){y(this,R)!==ee&&(Ee(this,R,ee),ee&&ce(this,he,Tt).call(this,ee.propertiesToUpdate))}toggleSelected(ee){if(y(this,W).has(ee)){y(this,W).delete(ee),ee.unselect(),ce(this,he,ht).call(this,{hasSelectedEditor:this.hasSelection});return}y(this,W).add(ee),ee.select(),ce(this,he,Tt).call(this,ee.propertiesToUpdate),ce(this,he,ht).call(this,{hasSelectedEditor:!0})}setSelected(ee){for(const Ne of y(this,W))Ne!==ee&&Ne.unselect();y(this,W).clear(),y(this,W).add(ee),ee.select(),ce(this,he,Tt).call(this,ee.propertiesToUpdate),ce(this,he,ht).call(this,{hasSelectedEditor:!0})}isSelected(ee){return y(this,W).has(ee)}unselect(ee){ee.unselect(),y(this,W).delete(ee),ce(this,he,ht).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return y(this,W).size!==0}undo(){y(this,oe).undo(),ce(this,he,ht).call(this,{hasSomethingToUndo:y(this,oe).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ce(this,he,Rt).call(this)})}redo(){y(this,oe).redo(),ce(this,he,ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:y(this,oe).hasSomethingToRedo(),isEmpty:ce(this,he,Rt).call(this)})}addCommands(ee){y(this,oe).add(ee),ce(this,he,ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ce(this,he,Rt).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const ee=[...y(this,W)],Ne=()=>{for(const qe of ee)qe.remove()},Be=()=>{for(const qe of ee)ce(this,he,ar).call(this,qe)};this.addCommands({cmd:Ne,undo:Be,mustExec:!0})}commitOrRemove(){var ee;(ee=y(this,R))==null||ee.commitOrRemove()}hasSomethingToControl(){return y(this,R)||this.hasSelection}selectAll(){for(const ee of y(this,W))ee.commit();ce(this,he,or).call(this,y(this,k).values())}unselectAll(){if(y(this,R)){y(this,R).commitOrRemove();return}if(this.hasSelection){for(const ee of y(this,W))ee.unselect();y(this,W).clear(),ce(this,he,ht).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(ee,Ne,Be=!1){if(Be||this.commitOrRemove(),!this.hasSelection)return;y(this,fe)[0]+=ee,y(this,fe)[1]+=Ne;const[qe,Ye]=y(this,fe),Ge=[...y(this,W)],Y=1e3;y(this,Fe)&&clearTimeout(y(this,Fe)),Ee(this,Fe,setTimeout(()=>{Ee(this,Fe,null),y(this,fe)[0]=y(this,fe)[1]=0,this.addCommands({cmd:()=>{for(const V of Ge)y(this,k).has(V.id)&&V.translateInPage(qe,Ye)},undo:()=>{for(const V of Ge)y(this,k).has(V.id)&&V.translateInPage(-qe,-Ye)},mustExec:!1})},Y));for(const V of Ge)V.translateInPage(ee,Ne)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Ee(this,H,new Map);for(const ee of y(this,W))y(this,H).set(ee,{savedX:ee.x,savedY:ee.y,savedPageIndex:ee.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!y(this,H))return!1;this.disableUserSelect(!1);const ee=y(this,H);Ee(this,H,null);let Ne=!1;for(const[{x:qe,y:Ye,pageIndex:Ge},Y]of ee)Y.newX=qe,Y.newY=Ye,Y.newPageIndex=Ge,Ne||(Ne=qe!==Y.savedX||Ye!==Y.savedY||Ge!==Y.savedPageIndex);if(!Ne)return!1;const Be=(qe,Ye,Ge,Y)=>{if(y(this,k).has(qe.id)){const V=y(this,L).get(Y);V?qe._setParentAndPosition(V,Ye,Ge):(qe.pageIndex=Y,qe.x=Ye,qe.y=Ge)}};return this.addCommands({cmd:()=>{for(const[qe,{newX:Ye,newY:Ge,newPageIndex:Y}]of ee)Be(qe,Ye,Ge,Y)},undo:()=>{for(const[qe,{savedX:Ye,savedY:Ge,savedPageIndex:Y}]of ee)Be(qe,Ye,Ge,Y)},mustExec:!0}),!0}dragSelectedEditors(ee,Ne){if(y(this,H))for(const Be of y(this,H).keys())Be.drag(ee,Ne)}rebuild(ee){if(ee.parent===null){const Ne=this.getLayer(ee.pageIndex);Ne?(Ne.changeParent(ee),Ne.addOrRebuild(ee)):(this.addEditor(ee),this.addToAnnotationStorage(ee),ee.rebuild())}else ee.parent.addOrRebuild(ee)}isActive(ee){return y(this,R)===ee}getActive(){return y(this,R)}getMode(){return y(this,U)}get imageManager(){return(0,s.shadow)(this,"imageManager",new d)}};R=new WeakMap,k=new WeakMap,L=new WeakMap,ae=new WeakMap,Q=new WeakMap,oe=new WeakMap,re=new WeakMap,me=new WeakMap,H=new WeakMap,ie=new WeakMap,le=new WeakMap,N=new WeakMap,b=new WeakMap,v=new WeakMap,j=new WeakMap,D=new WeakMap,U=new WeakMap,W=new WeakMap,Z=new WeakMap,te=new WeakMap,ve=new WeakMap,xe=new WeakMap,Re=new WeakMap,Ae=new WeakMap,ke=new WeakMap,ue=new WeakMap,se=new WeakMap,z=new WeakMap,J=new WeakMap,de=new WeakMap,fe=new WeakMap,Fe=new WeakMap,De=new WeakMap,Pe=new WeakMap,he=new WeakSet,Dr=function(){window.addEventListener("focus",y(this,ve)),window.addEventListener("blur",y(this,te))},rr=function(){window.removeEventListener("focus",y(this,ve)),window.removeEventListener("blur",y(this,te))},sr=function(){window.addEventListener("keydown",y(this,ke),{capture:!0})},Mt=function(){window.removeEventListener("keydown",y(this,ke),{capture:!0})},ir=function(){document.addEventListener("copy",y(this,xe)),document.addEventListener("cut",y(this,Re)),document.addEventListener("paste",y(this,Ae))},nr=function(){document.removeEventListener("copy",y(this,xe)),document.removeEventListener("cut",y(this,Re)),document.removeEventListener("paste",y(this,Ae))},ht=function(ee){Object.entries(ee).some(([Be,qe])=>y(this,de)[Be]!==qe)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(y(this,de),ee)})},Tt=function(ee){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:ee})},Or=function(){if(!y(this,v)){Ee(this,v,!0);for(const ee of y(this,L).values())ee.enable()}},Lr=function(){if(this.unselectAll(),y(this,v)){Ee(this,v,!1);for(const ee of y(this,L).values())ee.disable()}},ar=function(ee){const Ne=y(this,L).get(ee.pageIndex);Ne?Ne.addOrRebuild(ee):this.addEditor(ee)},Rt=function(){if(y(this,k).size===0)return!0;if(y(this,k).size===1)for(const ee of y(this,k).values())return ee.isEmpty();return!1},or=function(ee){y(this,W).clear();for(const Ne of ee)Ne.isEmpty()||(y(this,W).add(Ne),Ne.select());ce(this,he,ht).call(this,{hasSelectedEditor:!0})},lt(st,"TRANSLATE_SMALL",1),lt(st,"TRANSLATE_BIG",10);let u=st;t.AnnotationEditorUIManager=u},(e,t,r)=>{var re,me,H,ie,le,N,b,v,j,D,U,W,_t,vt,lr,Dt,Ot,Ct,jt;Object.defineProperty(t,"__esModule",{value:!0}),t.StatTimer=t.RenderingCancelledException=t.PixelsPerInch=t.PageViewport=t.PDFDateString=t.DOMStandardFontDataFactory=t.DOMSVGFactory=t.DOMFilterFactory=t.DOMCanvasFactory=t.DOMCMapReaderFactory=void 0,t.deprecated=_,t.getColorValues=k,t.getCurrentTransform=L,t.getCurrentTransformInverse=ae,t.getFilenameFromUrl=E,t.getPdfFilenameFromUrl=S,t.getRGB=R,t.getXfaPageViewport=M,t.isDataScheme=p,t.isPdfFile=x,t.isValidFetchUrl=F,t.loadScript=C,t.noContextMenu=A,t.setLayerDimensions=Q;var s=r(7),i=r(1);const n="http://www.w3.org/2000/svg",oe=class oe{};lt(oe,"CSS",96),lt(oe,"PDF",72),lt(oe,"PDF_TO_CSS_UNITS",oe.CSS/oe.PDF);let a=oe;t.PixelsPerInch=a;class o extends s.BaseFilterFactory{constructor({docId:z,ownerDocument:J=globalThis.document}={}){super();_e(this,W);_e(this,re);_e(this,me);_e(this,H);_e(this,ie);_e(this,le);_e(this,N);_e(this,b);_e(this,v);_e(this,j);_e(this,D);_e(this,U,0);Ee(this,H,z),Ee(this,ie,J)}addFilter(z){if(!z)return"none";let J=y(this,W,_t).get(z);if(J)return J;let de,fe,Fe,De;if(z.length===1){const Le=z[0],tt=new Array(256);for(let et=0;et<256;et++)tt[et]=Le[et]/255;De=de=fe=Fe=tt.join(",")}else{const[Le,tt,et]=z,it=new Array(256),Xe=new Array(256),Je=new Array(256);for(let nt=0;nt<256;nt++)it[nt]=Le[nt]/255,Xe[nt]=tt[nt]/255,Je[nt]=et[nt]/255;de=it.join(","),fe=Xe.join(","),Fe=Je.join(","),De=`${de}${fe}${Fe}`}if(J=y(this,W,_t).get(De),J)return y(this,W,_t).set(z,J),J;const Pe=`g_${y(this,H)}_transfer_map_${At(this,U)._++}`,he=`url(#${Pe})`;y(this,W,_t).set(z,he),y(this,W,_t).set(De,he);const ze=ce(this,W,Dt).call(this,Pe);return ce(this,W,Ct).call(this,de,fe,Fe,ze),he}addHCMFilter(z,J){var tt;const de=`${z}-${J}`;if(y(this,N)===de)return y(this,b);if(Ee(this,N,de),Ee(this,b,"none"),(tt=y(this,le))==null||tt.remove(),!z||!J)return y(this,b);const fe=ce(this,W,jt).call(this,z);z=i.Util.makeHexColor(...fe);const Fe=ce(this,W,jt).call(this,J);if(J=i.Util.makeHexColor(...Fe),y(this,W,vt).style.color="",z==="#000000"&&J==="#ffffff"||z===J)return y(this,b);const De=new Array(256);for(let et=0;et<=255;et++){const it=et/255;De[et]=it<=.03928?it/12.92:((it+.055)/1.055)**2.4}const Pe=De.join(","),he=`g_${y(this,H)}_hcm_filter`,ze=Ee(this,v,ce(this,W,Dt).call(this,he));ce(this,W,Ct).call(this,Pe,Pe,Pe,ze),ce(this,W,lr).call(this,ze);const Le=(et,it)=>{const Xe=fe[et]/255,Je=Fe[et]/255,nt=new Array(it+1);for(let ot=0;ot<=it;ot++)nt[ot]=Xe+ot/it*(Je-Xe);return nt.join(",")};return ce(this,W,Ct).call(this,Le(0,5),Le(1,5),Le(2,5),ze),Ee(this,b,`url(#${he})`),y(this,b)}addHighlightHCMFilter(z,J,de,fe){var Je;const Fe=`${z}-${J}-${de}-${fe}`;if(y(this,j)===Fe)return y(this,D);if(Ee(this,j,Fe),Ee(this,D,"none"),(Je=y(this,v))==null||Je.remove(),!z||!J)return y(this,D);const[De,Pe]=[z,J].map(ce(this,W,jt).bind(this));let he=Math.round(.2126*De[0]+.7152*De[1]+.0722*De[2]),ze=Math.round(.2126*Pe[0]+.7152*Pe[1]+.0722*Pe[2]),[Le,tt]=[de,fe].map(ce(this,W,jt).bind(this));ze<he&&([he,ze,Le,tt]=[ze,he,tt,Le]),y(this,W,vt).style.color="";const et=(nt,ot,Me)=>{const ge=new Array(256),be=(ze-he)/Me,Ve=nt/255,st=(ot-nt)/(255*Me);let rt=0;for(let ee=0;ee<=Me;ee++){const Ne=Math.round(he+ee*be),Be=Ve+ee*st;for(let qe=rt;qe<=Ne;qe++)ge[qe]=Be;rt=Ne+1}for(let ee=rt;ee<256;ee++)ge[ee]=ge[rt-1];return ge.join(",")},it=`g_${y(this,H)}_hcm_highlight_filter`,Xe=Ee(this,v,ce(this,W,Dt).call(this,it));return ce(this,W,lr).call(this,Xe),ce(this,W,Ct).call(this,et(Le[0],tt[0],5),et(Le[1],tt[1],5),et(Le[2],tt[2],5),Xe),Ee(this,D,`url(#${it})`),y(this,D)}destroy(z=!1){z&&(y(this,b)||y(this,D))||(y(this,me)&&(y(this,me).parentNode.parentNode.remove(),Ee(this,me,null)),y(this,re)&&(y(this,re).clear(),Ee(this,re,null)),Ee(this,U,0))}}re=new WeakMap,me=new WeakMap,H=new WeakMap,ie=new WeakMap,le=new WeakMap,N=new WeakMap,b=new WeakMap,v=new WeakMap,j=new WeakMap,D=new WeakMap,U=new WeakMap,W=new WeakSet,_t=function(){return y(this,re)||Ee(this,re,new Map)},vt=function(){if(!y(this,me)){const z=y(this,ie).createElement("div"),{style:J}=z;J.visibility="hidden",J.contain="strict",J.width=J.height=0,J.position="absolute",J.top=J.left=0,J.zIndex=-1;const de=y(this,ie).createElementNS(n,"svg");de.setAttribute("width",0),de.setAttribute("height",0),Ee(this,me,y(this,ie).createElementNS(n,"defs")),z.append(de),de.append(y(this,me)),y(this,ie).body.append(z)}return y(this,me)},lr=function(z){const J=y(this,ie).createElementNS(n,"feColorMatrix");J.setAttribute("type","matrix"),J.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),z.append(J)},Dt=function(z){const J=y(this,ie).createElementNS(n,"filter");return J.setAttribute("color-interpolation-filters","sRGB"),J.setAttribute("id",z),y(this,W,vt).append(J),J},Ot=function(z,J,de){const fe=y(this,ie).createElementNS(n,J);fe.setAttribute("type","discrete"),fe.setAttribute("tableValues",de),z.append(fe)},Ct=function(z,J,de,fe){const Fe=y(this,ie).createElementNS(n,"feComponentTransfer");fe.append(Fe),ce(this,W,Ot).call(this,Fe,"feFuncR",z),ce(this,W,Ot).call(this,Fe,"feFuncG",J),ce(this,W,Ot).call(this,Fe,"feFuncB",de)},jt=function(z){return y(this,W,vt).style.color=z,R(getComputedStyle(y(this,W,vt)).getPropertyValue("color"))},t.DOMFilterFactory=o;class d extends s.BaseCanvasFactory{constructor({ownerDocument:se=globalThis.document}={}){super(),this._document=se}_createCanvas(se,z){const J=this._document.createElement("canvas");return J.width=se,J.height=z,J}}t.DOMCanvasFactory=d;async function l(ue,se=!1){if(F(ue,document.baseURI)){const z=await fetch(ue);if(!z.ok)throw new Error(z.statusText);return se?new Uint8Array(await z.arrayBuffer()):(0,i.stringToBytes)(await z.text())}return new Promise((z,J)=>{const de=new XMLHttpRequest;de.open("GET",ue,!0),se&&(de.responseType="arraybuffer"),de.onreadystatechange=()=>{if(de.readyState===XMLHttpRequest.DONE){if(de.status===200||de.status===0){let fe;if(se&&de.response?fe=new Uint8Array(de.response):!se&&de.responseText&&(fe=(0,i.stringToBytes)(de.responseText)),fe){z(fe);return}}J(new Error(de.statusText))}},de.send(null)})}class c extends s.BaseCMapReaderFactory{_fetchData(se,z){return l(se,this.isCompressed).then(J=>({cMapData:J,compressionType:z}))}}t.DOMCMapReaderFactory=c;class f extends s.BaseStandardFontDataFactory{_fetchData(se){return l(se,!0)}}t.DOMStandardFontDataFactory=f;class u extends s.BaseSVGFactory{_createSVG(se){return document.createElementNS(n,se)}}t.DOMSVGFactory=u;class h{constructor({viewBox:se,scale:z,rotation:J,offsetX:de=0,offsetY:fe=0,dontFlip:Fe=!1}){this.viewBox=se,this.scale=z,this.rotation=J,this.offsetX=de,this.offsetY=fe;const De=(se[2]+se[0])/2,Pe=(se[3]+se[1])/2;let he,ze,Le,tt;switch(J%=360,J<0&&(J+=360),J){case 180:he=-1,ze=0,Le=0,tt=1;break;case 90:he=0,ze=1,Le=1,tt=0;break;case 270:he=0,ze=-1,Le=-1,tt=0;break;case 0:he=1,ze=0,Le=0,tt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Fe&&(Le=-Le,tt=-tt);let et,it,Xe,Je;he===0?(et=Math.abs(Pe-se[1])*z+de,it=Math.abs(De-se[0])*z+fe,Xe=(se[3]-se[1])*z,Je=(se[2]-se[0])*z):(et=Math.abs(De-se[0])*z+de,it=Math.abs(Pe-se[1])*z+fe,Xe=(se[2]-se[0])*z,Je=(se[3]-se[1])*z),this.transform=[he*z,ze*z,Le*z,tt*z,et-he*z*De-Le*z*Pe,it-ze*z*De-tt*z*Pe],this.width=Xe,this.height=Je}get rawDims(){const{viewBox:se}=this;return(0,i.shadow)(this,"rawDims",{pageWidth:se[2]-se[0],pageHeight:se[3]-se[1],pageX:se[0],pageY:se[1]})}clone({scale:se=this.scale,rotation:z=this.rotation,offsetX:J=this.offsetX,offsetY:de=this.offsetY,dontFlip:fe=!1}={}){return new h({viewBox:this.viewBox.slice(),scale:se,rotation:z,offsetX:J,offsetY:de,dontFlip:fe})}convertToViewportPoint(se,z){return i.Util.applyTransform([se,z],this.transform)}convertToViewportRectangle(se){const z=i.Util.applyTransform([se[0],se[1]],this.transform),J=i.Util.applyTransform([se[2],se[3]],this.transform);return[z[0],z[1],J[0],J[1]]}convertToPdfPoint(se,z){return i.Util.applyInverseTransform([se,z],this.transform)}}t.PageViewport=h;class g extends i.BaseException{constructor(se,z=0){super(se,"RenderingCancelledException"),this.extraDelay=z}}t.RenderingCancelledException=g;function p(ue){const se=ue.length;let z=0;for(;z<se&&ue[z].trim()==="";)z++;return ue.substring(z,z+5).toLowerCase()==="data:"}function x(ue){return typeof ue=="string"&&/\.pdf$/i.test(ue)}function E(ue,se=!1){return se||([ue]=ue.split(/[#?]/,1)),ue.substring(ue.lastIndexOf("/")+1)}function S(ue,se="document.pdf"){if(typeof ue!="string")return se;if(p(ue))return(0,i.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),se;const z=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,J=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,de=z.exec(ue);let fe=J.exec(de[1])||J.exec(de[2])||J.exec(de[3]);if(fe&&(fe=fe[0],fe.includes("%")))try{fe=J.exec(decodeURIComponent(fe))[0]}catch{}return fe||se}class P{constructor(){lt(this,"started",Object.create(null));lt(this,"times",[])}time(se){se in this.started&&(0,i.warn)(`Timer is already running for ${se}`),this.started[se]=Date.now()}timeEnd(se){se in this.started||(0,i.warn)(`Timer has not been started for ${se}`),this.times.push({name:se,start:this.started[se],end:Date.now()}),delete this.started[se]}toString(){const se=[];let z=0;for(const{name:J}of this.times)z=Math.max(J.length,z);for(const{name:J,start:de,end:fe}of this.times)se.push(`${J.padEnd(z)} ${fe-de}ms
`);return se.join("")}}t.StatTimer=P;function F(ue,se){try{const{protocol:z}=se?new URL(ue,se):new URL(ue);return z==="http:"||z==="https:"}catch{return!1}}function A(ue){ue.preventDefault()}function C(ue,se=!1){return new Promise((z,J)=>{const de=document.createElement("script");de.src=ue,de.onload=function(fe){se&&de.remove(),z(fe)},de.onerror=function(){J(new Error(`Cannot load script at: ${de.src}`))},(document.head||document.documentElement).append(de)})}function _(ue){console.log("Deprecated API usage: "+ue)}let w;class T{static toDateObject(se){if(!se||typeof se!="string")return null;w||(w=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const z=w.exec(se);if(!z)return null;const J=parseInt(z[1],10);let de=parseInt(z[2],10);de=de>=1&&de<=12?de-1:0;let fe=parseInt(z[3],10);fe=fe>=1&&fe<=31?fe:1;let Fe=parseInt(z[4],10);Fe=Fe>=0&&Fe<=23?Fe:0;let De=parseInt(z[5],10);De=De>=0&&De<=59?De:0;let Pe=parseInt(z[6],10);Pe=Pe>=0&&Pe<=59?Pe:0;const he=z[7]||"Z";let ze=parseInt(z[8],10);ze=ze>=0&&ze<=23?ze:0;let Le=parseInt(z[9],10)||0;return Le=Le>=0&&Le<=59?Le:0,he==="-"?(Fe+=ze,De+=Le):he==="+"&&(Fe-=ze,De-=Le),new Date(Date.UTC(J,de,fe,Fe,De,Pe))}}t.PDFDateString=T;function M(ue,{scale:se=1,rotation:z=0}){const{width:J,height:de}=ue.attributes.style,fe=[0,0,parseInt(J),parseInt(de)];return new h({viewBox:fe,scale:se,rotation:z})}function R(ue){if(ue.startsWith("#")){const se=parseInt(ue.slice(1),16);return[(se&16711680)>>16,(se&65280)>>8,se&255]}return ue.startsWith("rgb(")?ue.slice(4,-1).split(",").map(se=>parseInt(se)):ue.startsWith("rgba(")?ue.slice(5,-1).split(",").map(se=>parseInt(se)).slice(0,3):((0,i.warn)(`Not a valid color format: "${ue}"`),[0,0,0])}function k(ue){const se=document.createElement("span");se.style.visibility="hidden",document.body.append(se);for(const z of ue.keys()){se.style.color=z;const J=window.getComputedStyle(se).color;ue.set(z,R(J))}se.remove()}function L(ue){const{a:se,b:z,c:J,d:de,e:fe,f:Fe}=ue.getTransform();return[se,z,J,de,fe,Fe]}function ae(ue){const{a:se,b:z,c:J,d:de,e:fe,f:Fe}=ue.getTransform().invertSelf();return[se,z,J,de,fe,Fe]}function Q(ue,se,z=!1,J=!0){if(se instanceof h){const{pageWidth:de,pageHeight:fe}=se.rawDims,{style:Fe}=ue,De=i.FeatureTest.isCSSRoundSupported,Pe=`var(--scale-factor) * ${de}px`,he=`var(--scale-factor) * ${fe}px`,ze=De?`round(${Pe}, 1px)`:`calc(${Pe})`,Le=De?`round(${he}, 1px)`:`calc(${he})`;!z||se.rotation%180===0?(Fe.width=ze,Fe.height=Le):(Fe.width=Le,Fe.height=ze)}J&&ue.setAttribute("data-main-rotation",se.rotation)}},(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStandardFontDataFactory=t.BaseSVGFactory=t.BaseFilterFactory=t.BaseCanvasFactory=t.BaseCMapReaderFactory=void 0;var s=r(1);class i{constructor(){this.constructor===i&&(0,s.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(c){return"none"}addHCMFilter(c,f){return"none"}addHighlightHCMFilter(c,f,u,h){return"none"}destroy(c=!1){}}t.BaseFilterFactory=i;class n{constructor(){this.constructor===n&&(0,s.unreachable)("Cannot initialize BaseCanvasFactory.")}create(c,f){if(c<=0||f<=0)throw new Error("Invalid canvas size");const u=this._createCanvas(c,f);return{canvas:u,context:u.getContext("2d")}}reset(c,f,u){if(!c.canvas)throw new Error("Canvas is not specified");if(f<=0||u<=0)throw new Error("Invalid canvas size");c.canvas.width=f,c.canvas.height=u}destroy(c){if(!c.canvas)throw new Error("Canvas is not specified");c.canvas.width=0,c.canvas.height=0,c.canvas=null,c.context=null}_createCanvas(c,f){(0,s.unreachable)("Abstract method `_createCanvas` called.")}}t.BaseCanvasFactory=n;class a{constructor({baseUrl:c=null,isCompressed:f=!0}){this.constructor===a&&(0,s.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=c,this.isCompressed=f}async fetch({name:c}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!c)throw new Error("CMap name must be specified.");const f=this.baseUrl+c+(this.isCompressed?".bcmap":""),u=this.isCompressed?s.CMapCompressionType.BINARY:s.CMapCompressionType.NONE;return this._fetchData(f,u).catch(h=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${f}`)})}_fetchData(c,f){(0,s.unreachable)("Abstract method `_fetchData` called.")}}t.BaseCMapReaderFactory=a;class o{constructor({baseUrl:c=null}){this.constructor===o&&(0,s.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=c}async fetch({filename:c}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!c)throw new Error("Font filename must be specified.");const f=`${this.baseUrl}${c}`;return this._fetchData(f).catch(u=>{throw new Error(`Unable to load font data at: ${f}`)})}_fetchData(c){(0,s.unreachable)("Abstract method `_fetchData` called.")}}t.BaseStandardFontDataFactory=o;class d{constructor(){this.constructor===d&&(0,s.unreachable)("Cannot initialize BaseSVGFactory.")}create(c,f,u=!1){if(c<=0||f<=0)throw new Error("Invalid SVG dimensions");const h=this._createSVG("svg:svg");return h.setAttribute("version","1.1"),u||(h.setAttribute("width",`${c}px`),h.setAttribute("height",`${f}px`)),h.setAttribute("preserveAspectRatio","none"),h.setAttribute("viewBox",`0 0 ${c} ${f}`),h}createElement(c){if(typeof c!="string")throw new Error("Invalid SVG element type");return this._createSVG(c)}_createSVG(c){(0,s.unreachable)("Abstract method `_createSVG` called.")}}t.BaseSVGFactory=d},(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MurmurHash3_64=void 0;var s=r(1);const i=3285377520,n=4294901760,a=65535;class o{constructor(l){this.h1=l?l&4294967295:i,this.h2=l?l&4294967295:i}update(l){let c,f;if(typeof l=="string"){c=new Uint8Array(l.length*2),f=0;for(let _=0,w=l.length;_<w;_++){const T=l.charCodeAt(_);T<=255?c[f++]=T:(c[f++]=T>>>8,c[f++]=T&255)}}else if((0,s.isArrayBuffer)(l))c=l.slice(),f=c.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const u=f>>2,h=f-u*4,g=new Uint32Array(c.buffer,0,u);let p=0,x=0,E=this.h1,S=this.h2;const P=3432918353,F=461845907,A=P&a,C=F&a;for(let _=0;_<u;_++)_&1?(p=g[_],p=p*P&n|p*A&a,p=p<<15|p>>>17,p=p*F&n|p*C&a,E^=p,E=E<<13|E>>>19,E=E*5+3864292196):(x=g[_],x=x*P&n|x*A&a,x=x<<15|x>>>17,x=x*F&n|x*C&a,S^=x,S=S<<13|S>>>19,S=S*5+3864292196);switch(p=0,h){case 3:p^=c[u*4+2]<<16;case 2:p^=c[u*4+1]<<8;case 1:p^=c[u*4],p=p*P&n|p*A&a,p=p<<15|p>>>17,p=p*F&n|p*C&a,u&1?E^=p:S^=p}this.h1=E,this.h2=S}hexdigest(){let l=this.h1,c=this.h2;return l^=c>>>1,l=l*3981806797&n|l*36045&a,c=c*4283543511&n|((c<<16|l>>>16)*2950163797&n)>>>16,l^=c>>>1,l=l*444984403&n|l*60499&a,c=c*3301882366&n|((c<<16|l>>>16)*3120437893&n)>>>16,l^=c>>>1,(l>>>0).toString(16).padStart(8,"0")+(c>>>0).toString(16).padStart(8,"0")}}t.MurmurHash3_64=o},(e,t,r)=>{var a;Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var s=r(1);class i{constructor({ownerDocument:d=globalThis.document,styleElement:l=null}){_e(this,a,new Set);this._document=d,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(d){this.nativeFontFaces.add(d),this._document.fonts.add(d)}removeNativeFontFace(d){this.nativeFontFaces.delete(d),this._document.fonts.delete(d)}insertRule(d){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const l=this.styleElement.sheet;l.insertRule(d,l.cssRules.length)}clear(){for(const d of this.nativeFontFaces)this._document.fonts.delete(d);this.nativeFontFaces.clear(),y(this,a).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(d){if(!(!d||y(this,a).has(d.loadedName))){if((0,s.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:l,src:c,style:f}=d,u=new FontFace(l,c,f);this.addNativeFontFace(u);try{await u.load(),y(this,a).add(l)}catch{(0,s.warn)(`Cannot load system font: ${d.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}(0,s.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(d){if(d.attached||d.missingFile&&!d.systemFontInfo)return;if(d.attached=!0,d.systemFontInfo){await this.loadSystemFont(d.systemFontInfo);return}if(this.isFontLoadingAPISupported){const c=d.createNativeFontFace();if(c){this.addNativeFontFace(c);try{await c.loaded}catch(f){throw(0,s.warn)(`Failed to load font '${c.family}': '${f}'.`),d.disableFontFace=!0,f}}return}const l=d.createFontFaceRule();if(l){if(this.insertRule(l),this.isSyncFontLoadingSupported)return;await new Promise(c=>{const f=this._queueLoadingCallback(c);this._prepareFontLoadEvent(d,f)})}}get isFontLoadingAPISupported(){var l;const d=!!((l=this._document)!=null&&l.fonts);return(0,s.shadow)(this,"isFontLoadingAPISupported",d)}get isSyncFontLoadingSupported(){let d=!1;return(s.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(d=!0),(0,s.shadow)(this,"isSyncFontLoadingSupported",d)}_queueLoadingCallback(d){function l(){for((0,s.assert)(!f.done,"completeRequest() cannot be called twice."),f.done=!0;c.length>0&&c[0].done;){const u=c.shift();setTimeout(u.callback,0)}}const{loadingRequests:c}=this,f={done:!1,complete:l,callback:d};return c.push(f),f}get _loadTestFont(){const d=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,s.shadow)(this,"_loadTestFont",d)}_prepareFontLoadEvent(d,l){function c(R,k){return R.charCodeAt(k)<<24|R.charCodeAt(k+1)<<16|R.charCodeAt(k+2)<<8|R.charCodeAt(k+3)&255}function f(R,k,L,ae){const Q=R.substring(0,k),oe=R.substring(k+L);return Q+ae+oe}let u,h;const g=this._document.createElement("canvas");g.width=1,g.height=1;const p=g.getContext("2d");let x=0;function E(R,k){if(++x>30){(0,s.warn)("Load test font never loaded."),k();return}if(p.font="30px "+R,p.fillText(".",0,20),p.getImageData(0,0,1,1).data[3]>0){k();return}setTimeout(E.bind(null,R,k))}const S=`lt${Date.now()}${this.loadTestFontId++}`;let P=this._loadTestFont;P=f(P,976,S.length,S);const A=16,C=1482184792;let _=c(P,A);for(u=0,h=S.length-3;u<h;u+=4)_=_-C+c(S,u)|0;u<S.length&&(_=_-C+c(S+"XXX",u)|0),P=f(P,A,4,(0,s.string32)(_));const w=`url(data:font/opentype;base64,${btoa(P)});`,T=`@font-face {font-family:"${S}";src:${w}}`;this.insertRule(T);const M=this._document.createElement("div");M.style.visibility="hidden",M.style.width=M.style.height="10px",M.style.position="absolute",M.style.top=M.style.left="0px";for(const R of[d.loadedName,S]){const k=this._document.createElement("span");k.textContent="Hi",k.style.fontFamily=R,M.append(k)}this._document.body.append(M),E(S,()=>{M.remove(),l.complete()})}}a=new WeakMap,t.FontLoader=i;class n{constructor(d,{isEvalSupported:l=!0,disableFontFace:c=!1,ignoreErrors:f=!1,inspectFont:u=null}){this.compiledGlyphs=Object.create(null);for(const h in d)this[h]=d[h];this.isEvalSupported=l!==!1,this.disableFontFace=c===!0,this.ignoreErrors=f===!0,this._inspectFont=u}createNativeFontFace(){var l;if(!this.data||this.disableFontFace)return null;let d;if(!this.cssFontInfo)d=new FontFace(this.loadedName,this.data,{});else{const c={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(c.style=`oblique ${this.cssFontInfo.italicAngle}deg`),d=new FontFace(this.cssFontInfo.fontFamily,this.data,c)}return(l=this._inspectFont)==null||l.call(this,this),d}createFontFaceRule(){var f;if(!this.data||this.disableFontFace)return null;const d=(0,s.bytesToString)(this.data),l=`url(data:${this.mimetype};base64,${btoa(d)});`;let c;if(!this.cssFontInfo)c=`@font-face {font-family:"${this.loadedName}";src:${l}}`;else{let u=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(u+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),c=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${u}src:${l}}`}return(f=this._inspectFont)==null||f.call(this,this,l),c}getPathGenerator(d,l){if(this.compiledGlyphs[l]!==void 0)return this.compiledGlyphs[l];let c;try{c=d.get(this.loadedName+"_path_"+l)}catch(f){if(!this.ignoreErrors)throw f;return(0,s.warn)(`getPathGenerator - ignoring character: "${f}".`),this.compiledGlyphs[l]=function(u,h){}}if(this.isEvalSupported&&s.FeatureTest.isEvalSupported){const f=[];for(const u of c){const h=u.args!==void 0?u.args.join(","):"";f.push("c.",u.cmd,"(",h,`);
`)}return this.compiledGlyphs[l]=new Function("c","size",f.join(""))}return this.compiledGlyphs[l]=function(f,u){for(const h of c)h.cmd==="scale"&&(h.args=[u,-u]),f[h.cmd].apply(f,h.args)}}}t.FontFaceObject=n},(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeStandardFontDataFactory=t.NodeFilterFactory=t.NodeCanvasFactory=t.NodeCMapReaderFactory=void 0;var s=r(7);r(1);const i=function(l){return new Promise((c,f)=>{require$$5.readFile(l,(h,g)=>{if(h||!g){f(new Error(h));return}c(new Uint8Array(g))})})};class n extends s.BaseFilterFactory{}t.NodeFilterFactory=n;class a extends s.BaseCanvasFactory{_createCanvas(c,f){return require$$5.createCanvas(c,f)}}t.NodeCanvasFactory=a;class o extends s.BaseCMapReaderFactory{_fetchData(c,f){return i(c).then(u=>({cMapData:u,compressionType:f}))}}t.NodeCMapReaderFactory=o;class d extends s.BaseStandardFontDataFactory{_fetchData(c){return i(c)}}t.NodeStandardFontDataFactory=d},(e,t,r)=>{var me,cr,dr;Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var s=r(1),i=r(6),n=r(12),a=r(13);const o=16,d=100,l=4096,c=15,f=10,u=1e3,h=16;function g(N,b){if(N._removeMirroring)throw new Error("Context is already forwarding operations.");N.__originalSave=N.save,N.__originalRestore=N.restore,N.__originalRotate=N.rotate,N.__originalScale=N.scale,N.__originalTranslate=N.translate,N.__originalTransform=N.transform,N.__originalSetTransform=N.setTransform,N.__originalResetTransform=N.resetTransform,N.__originalClip=N.clip,N.__originalMoveTo=N.moveTo,N.__originalLineTo=N.lineTo,N.__originalBezierCurveTo=N.bezierCurveTo,N.__originalRect=N.rect,N.__originalClosePath=N.closePath,N.__originalBeginPath=N.beginPath,N._removeMirroring=()=>{N.save=N.__originalSave,N.restore=N.__originalRestore,N.rotate=N.__originalRotate,N.scale=N.__originalScale,N.translate=N.__originalTranslate,N.transform=N.__originalTransform,N.setTransform=N.__originalSetTransform,N.resetTransform=N.__originalResetTransform,N.clip=N.__originalClip,N.moveTo=N.__originalMoveTo,N.lineTo=N.__originalLineTo,N.bezierCurveTo=N.__originalBezierCurveTo,N.rect=N.__originalRect,N.closePath=N.__originalClosePath,N.beginPath=N.__originalBeginPath,delete N._removeMirroring},N.save=function(){b.save(),this.__originalSave()},N.restore=function(){b.restore(),this.__originalRestore()},N.translate=function(j,D){b.translate(j,D),this.__originalTranslate(j,D)},N.scale=function(j,D){b.scale(j,D),this.__originalScale(j,D)},N.transform=function(j,D,U,W,Z,te){b.transform(j,D,U,W,Z,te),this.__originalTransform(j,D,U,W,Z,te)},N.setTransform=function(j,D,U,W,Z,te){b.setTransform(j,D,U,W,Z,te),this.__originalSetTransform(j,D,U,W,Z,te)},N.resetTransform=function(){b.resetTransform(),this.__originalResetTransform()},N.rotate=function(j){b.rotate(j),this.__originalRotate(j)},N.clip=function(j){b.clip(j),this.__originalClip(j)},N.moveTo=function(v,j){b.moveTo(v,j),this.__originalMoveTo(v,j)},N.lineTo=function(v,j){b.lineTo(v,j),this.__originalLineTo(v,j)},N.bezierCurveTo=function(v,j,D,U,W,Z){b.bezierCurveTo(v,j,D,U,W,Z),this.__originalBezierCurveTo(v,j,D,U,W,Z)},N.rect=function(v,j,D,U){b.rect(v,j,D,U),this.__originalRect(v,j,D,U)},N.closePath=function(){b.closePath(),this.__originalClosePath()},N.beginPath=function(){b.beginPath(),this.__originalBeginPath()}}class p{constructor(b){this.canvasFactory=b,this.cache=Object.create(null)}getCanvas(b,v,j){let D;return this.cache[b]!==void 0?(D=this.cache[b],this.canvasFactory.reset(D,v,j)):(D=this.canvasFactory.create(v,j),this.cache[b]=D),D}delete(b){delete this.cache[b]}clear(){for(const b in this.cache){const v=this.cache[b];this.canvasFactory.destroy(v),delete this.cache[b]}}}function x(N,b,v,j,D,U,W,Z,te,ve){const[xe,Re,Ae,ke,ue,se]=(0,i.getCurrentTransform)(N);if(Re===0&&Ae===0){const de=W*xe+ue,fe=Math.round(de),Fe=Z*ke+se,De=Math.round(Fe),Pe=(W+te)*xe+ue,he=Math.abs(Math.round(Pe)-fe)||1,ze=(Z+ve)*ke+se,Le=Math.abs(Math.round(ze)-De)||1;return N.setTransform(Math.sign(xe),0,0,Math.sign(ke),fe,De),N.drawImage(b,v,j,D,U,0,0,he,Le),N.setTransform(xe,Re,Ae,ke,ue,se),[he,Le]}if(xe===0&&ke===0){const de=Z*Ae+ue,fe=Math.round(de),Fe=W*Re+se,De=Math.round(Fe),Pe=(Z+ve)*Ae+ue,he=Math.abs(Math.round(Pe)-fe)||1,ze=(W+te)*Re+se,Le=Math.abs(Math.round(ze)-De)||1;return N.setTransform(0,Math.sign(Re),Math.sign(Ae),0,fe,De),N.drawImage(b,v,j,D,U,0,0,Le,he),N.setTransform(xe,Re,Ae,ke,ue,se),[Le,he]}N.drawImage(b,v,j,D,U,W,Z,te,ve);const z=Math.hypot(xe,Re),J=Math.hypot(Ae,ke);return[z*te,J*ve]}function E(N){const{width:b,height:v}=N;if(b>u||v>u)return null;const j=1e3,D=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),U=b+1;let W=new Uint8Array(U*(v+1)),Z,te,ve;const xe=b+7&-8;let Re=new Uint8Array(xe*v),Ae=0;for(const J of N.data){let de=128;for(;de>0;)Re[Ae++]=J&de?0:255,de>>=1}let ke=0;for(Ae=0,Re[Ae]!==0&&(W[0]=1,++ke),te=1;te<b;te++)Re[Ae]!==Re[Ae+1]&&(W[te]=Re[Ae]?2:1,++ke),Ae++;for(Re[Ae]!==0&&(W[te]=2,++ke),Z=1;Z<v;Z++){Ae=Z*xe,ve=Z*U,Re[Ae-xe]!==Re[Ae]&&(W[ve]=Re[Ae]?1:8,++ke);let J=(Re[Ae]?4:0)+(Re[Ae-xe]?8:0);for(te=1;te<b;te++)J=(J>>2)+(Re[Ae+1]?4:0)+(Re[Ae-xe+1]?8:0),D[J]&&(W[ve+te]=D[J],++ke),Ae++;if(Re[Ae-xe]!==Re[Ae]&&(W[ve+te]=Re[Ae]?2:4,++ke),ke>j)return null}for(Ae=xe*(v-1),ve=Z*U,Re[Ae]!==0&&(W[ve]=8,++ke),te=1;te<b;te++)Re[Ae]!==Re[Ae+1]&&(W[ve+te]=Re[Ae]?4:8,++ke),Ae++;if(Re[Ae]!==0&&(W[ve+te]=4,++ke),ke>j)return null;const ue=new Int32Array([0,U,-1,0,-U,0,0,0,1]),se=new Path2D;for(Z=0;ke&&Z<=v;Z++){let J=Z*U;const de=J+b;for(;J<de&&!W[J];)J++;if(J===de)continue;se.moveTo(J%U,Z);const fe=J;let Fe=W[J];do{const De=ue[Fe];do J+=De;while(!W[J]);const Pe=W[J];Pe!==5&&Pe!==10?(Fe=Pe,W[J]=0):(Fe=Pe&51*Fe>>4,W[J]&=Fe>>2|Fe<<2),se.lineTo(J%U,J/U|0),W[J]||--ke}while(fe!==J);--Z}return Re=null,W=null,function(J){J.save(),J.scale(1/b,-1/v),J.translate(0,-v),J.fill(se),J.beginPath(),J.restore()}}class S{constructor(b,v){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=s.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=s.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=s.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,b,v])}clone(){const b=Object.create(this);return b.clipBox=this.clipBox.slice(),b}setCurrentPoint(b,v){this.x=b,this.y=v}updatePathMinMax(b,v,j){[v,j]=s.Util.applyTransform([v,j],b),this.minX=Math.min(this.minX,v),this.minY=Math.min(this.minY,j),this.maxX=Math.max(this.maxX,v),this.maxY=Math.max(this.maxY,j)}updateRectMinMax(b,v){const j=s.Util.applyTransform(v,b),D=s.Util.applyTransform(v.slice(2),b);this.minX=Math.min(this.minX,j[0],D[0]),this.minY=Math.min(this.minY,j[1],D[1]),this.maxX=Math.max(this.maxX,j[0],D[0]),this.maxY=Math.max(this.maxY,j[1],D[1])}updateScalingPathMinMax(b,v){s.Util.scaleMinMax(b,v),this.minX=Math.min(this.minX,v[0]),this.maxX=Math.max(this.maxX,v[1]),this.minY=Math.min(this.minY,v[2]),this.maxY=Math.max(this.maxY,v[3])}updateCurvePathMinMax(b,v,j,D,U,W,Z,te,ve,xe){const Re=s.Util.bezierBoundingBox(v,j,D,U,W,Z,te,ve);if(xe){xe[0]=Math.min(xe[0],Re[0],Re[2]),xe[1]=Math.max(xe[1],Re[0],Re[2]),xe[2]=Math.min(xe[2],Re[1],Re[3]),xe[3]=Math.max(xe[3],Re[1],Re[3]);return}this.updateRectMinMax(b,Re)}getPathBoundingBox(b=n.PathType.FILL,v=null){const j=[this.minX,this.minY,this.maxX,this.maxY];if(b===n.PathType.STROKE){v||(0,s.unreachable)("Stroke bounding box must include transform.");const D=s.Util.singularValueDecompose2dScale(v),U=D[0]*this.lineWidth/2,W=D[1]*this.lineWidth/2;j[0]-=U,j[1]-=W,j[2]+=U,j[3]+=W}return j}updateClipFromPath(){const b=s.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(b||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(b){this.clipBox=b,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(b=n.PathType.FILL,v=null){return s.Util.intersect(this.clipBox,this.getPathBoundingBox(b,v))}}function P(N,b){if(typeof ImageData<"u"&&b instanceof ImageData){N.putImageData(b,0,0);return}const v=b.height,j=b.width,D=v%h,U=(v-D)/h,W=D===0?U:U+1,Z=N.createImageData(j,h);let te=0,ve;const xe=b.data,Re=Z.data;let Ae,ke,ue,se;if(b.kind===s.ImageKind.GRAYSCALE_1BPP){const z=xe.byteLength,J=new Uint32Array(Re.buffer,0,Re.byteLength>>2),de=J.length,fe=j+7>>3,Fe=4294967295,De=s.FeatureTest.isLittleEndian?4278190080:255;for(Ae=0;Ae<W;Ae++){for(ue=Ae<U?h:D,ve=0,ke=0;ke<ue;ke++){const Pe=z-te;let he=0;const ze=Pe>fe?j:Pe*8-7,Le=ze&-8;let tt=0,et=0;for(;he<Le;he+=8)et=xe[te++],J[ve++]=et&128?Fe:De,J[ve++]=et&64?Fe:De,J[ve++]=et&32?Fe:De,J[ve++]=et&16?Fe:De,J[ve++]=et&8?Fe:De,J[ve++]=et&4?Fe:De,J[ve++]=et&2?Fe:De,J[ve++]=et&1?Fe:De;for(;he<ze;he++)tt===0&&(et=xe[te++],tt=128),J[ve++]=et&tt?Fe:De,tt>>=1}for(;ve<de;)J[ve++]=0;N.putImageData(Z,0,Ae*h)}}else if(b.kind===s.ImageKind.RGBA_32BPP){for(ke=0,se=j*h*4,Ae=0;Ae<U;Ae++)Re.set(xe.subarray(te,te+se)),te+=se,N.putImageData(Z,0,ke),ke+=h;Ae<W&&(se=j*D*4,Re.set(xe.subarray(te,te+se)),N.putImageData(Z,0,ke))}else if(b.kind===s.ImageKind.RGB_24BPP)for(ue=h,se=j*ue,Ae=0;Ae<W;Ae++){for(Ae>=U&&(ue=D,se=j*ue),ve=0,ke=se;ke--;)Re[ve++]=xe[te++],Re[ve++]=xe[te++],Re[ve++]=xe[te++],Re[ve++]=255;N.putImageData(Z,0,Ae*h)}else throw new Error(`bad image kind: ${b.kind}`)}function F(N,b){if(b.bitmap){N.drawImage(b.bitmap,0,0);return}const v=b.height,j=b.width,D=v%h,U=(v-D)/h,W=D===0?U:U+1,Z=N.createImageData(j,h);let te=0;const ve=b.data,xe=Z.data;for(let Re=0;Re<W;Re++){const Ae=Re<U?h:D;({srcPos:te}=(0,a.convertBlackAndWhiteToRGBA)({src:ve,srcPos:te,dest:xe,width:j,height:Ae,nonBlackColor:0})),N.putImageData(Z,0,Re*h)}}function A(N,b){const v=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const j of v)N[j]!==void 0&&(b[j]=N[j]);N.setLineDash!==void 0&&(b.setLineDash(N.getLineDash()),b.lineDashOffset=N.lineDashOffset)}function C(N){if(N.strokeStyle=N.fillStyle="#000000",N.fillRule="nonzero",N.globalAlpha=1,N.lineWidth=1,N.lineCap="butt",N.lineJoin="miter",N.miterLimit=10,N.globalCompositeOperation="source-over",N.font="10px sans-serif",N.setLineDash!==void 0&&(N.setLineDash([]),N.lineDashOffset=0),!s.isNodeJS){const{filter:b}=N;b!=="none"&&b!==""&&(N.filter="none")}}function _(N,b,v,j){const D=N.length;for(let U=3;U<D;U+=4){const W=N[U];if(W===0)N[U-3]=b,N[U-2]=v,N[U-1]=j;else if(W<255){const Z=255-W;N[U-3]=N[U-3]*W+b*Z>>8,N[U-2]=N[U-2]*W+v*Z>>8,N[U-1]=N[U-1]*W+j*Z>>8}}}function w(N,b,v){const j=N.length,D=1/255;for(let U=3;U<j;U+=4){const W=v?v[N[U]]:N[U];b[U]=b[U]*W*D|0}}function T(N,b,v){const j=N.length;for(let D=3;D<j;D+=4){const U=N[D-3]*77+N[D-2]*152+N[D-1]*28;b[D]=v?b[D]*v[U>>8]>>8:b[D]*U>>16}}function M(N,b,v,j,D,U,W,Z,te,ve,xe){const Re=!!U,Ae=Re?U[0]:0,ke=Re?U[1]:0,ue=Re?U[2]:0,se=D==="Luminosity"?T:w,J=Math.min(j,Math.ceil(1048576/v));for(let de=0;de<j;de+=J){const fe=Math.min(J,j-de),Fe=N.getImageData(Z-ve,de+(te-xe),v,fe),De=b.getImageData(Z,de+te,v,fe);Re&&_(Fe.data,Ae,ke,ue),se(Fe.data,De.data,W),b.putImageData(De,Z,de+te)}}function R(N,b,v,j){const D=j[0],U=j[1],W=j[2]-D,Z=j[3]-U;W===0||Z===0||(M(b.context,v,W,Z,b.subtype,b.backdrop,b.transferMap,D,U,b.offsetX,b.offsetY),N.save(),N.globalAlpha=1,N.globalCompositeOperation="source-over",N.setTransform(1,0,0,1,0,0),N.drawImage(v.canvas,0,0),N.restore())}function k(N,b){const v=s.Util.singularValueDecompose2dScale(N);v[0]=Math.fround(v[0]),v[1]=Math.fround(v[1]);const j=Math.fround((globalThis.devicePixelRatio||1)*i.PixelsPerInch.PDF_TO_CSS_UNITS);return b!==void 0?b:v[0]<=j||v[1]<=j}const L=["butt","round","square"],ae=["miter","round","bevel"],Q={},oe={},le=class le{constructor(b,v,j,D,U,{optionalContentConfig:W,markedContentStack:Z=null},te,ve){_e(this,me);this.ctx=b,this.current=new S(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=v,this.objs=j,this.canvasFactory=D,this.filterFactory=U,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Z||[],this.optionalContentConfig=W,this.cachedCanvases=new p(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=te,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=ve,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(b,v=null){return typeof b=="string"?b.startsWith("g_")?this.commonObjs.get(b):this.objs.get(b):v}beginDrawing({transform:b,viewport:v,transparency:j=!1,background:D=null}){const U=this.ctx.canvas.width,W=this.ctx.canvas.height,Z=this.ctx.fillStyle;if(this.ctx.fillStyle=D||"#ffffff",this.ctx.fillRect(0,0,U,W),this.ctx.fillStyle=Z,j){const te=this.cachedCanvases.getCanvas("transparent",U,W);this.compositeCtx=this.ctx,this.transparentCanvas=te.canvas,this.ctx=te.context,this.ctx.save(),this.ctx.transform(...(0,i.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),C(this.ctx),b&&(this.ctx.transform(...b),this.outputScaleX=b[0],this.outputScaleY=b[0]),this.ctx.transform(...v.transform),this.viewportScale=v.scale,this.baseTransform=(0,i.getCurrentTransform)(this.ctx)}executeOperatorList(b,v,j,D){const U=b.argsArray,W=b.fnArray;let Z=v||0;const te=U.length;if(te===Z)return Z;const ve=te-Z>f&&typeof j=="function",xe=ve?Date.now()+c:0;let Re=0;const Ae=this.commonObjs,ke=this.objs;let ue;for(;;){if(D!==void 0&&Z===D.nextBreakPoint)return D.breakIt(Z,j),Z;if(ue=W[Z],ue!==s.OPS.dependency)this[ue].apply(this,U[Z]);else for(const se of U[Z]){const z=se.startsWith("g_")?Ae:ke;if(!z.has(se))return z.get(se,j),Z}if(Z++,Z===te)return Z;if(ve&&++Re>f){if(Date.now()>xe)return j(),Z;Re=0}}}endDrawing(){ce(this,me,cr).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const b of this._cachedBitmapsMap.values()){for(const v of b.values())typeof HTMLCanvasElement<"u"&&v instanceof HTMLCanvasElement&&(v.width=v.height=0);b.clear()}this._cachedBitmapsMap.clear(),ce(this,me,dr).call(this)}_scaleImage(b,v){const j=b.width,D=b.height;let U=Math.max(Math.hypot(v[0],v[1]),1),W=Math.max(Math.hypot(v[2],v[3]),1),Z=j,te=D,ve="prescale1",xe,Re;for(;U>2&&Z>1||W>2&&te>1;){let Ae=Z,ke=te;U>2&&Z>1&&(Ae=Z>=16384?Math.floor(Z/2)-1||1:Math.ceil(Z/2),U/=Z/Ae),W>2&&te>1&&(ke=te>=16384?Math.floor(te/2)-1||1:Math.ceil(te)/2,W/=te/ke),xe=this.cachedCanvases.getCanvas(ve,Ae,ke),Re=xe.context,Re.clearRect(0,0,Ae,ke),Re.drawImage(b,0,0,Z,te,0,0,Ae,ke),b=xe.canvas,Z=Ae,te=ke,ve=ve==="prescale1"?"prescale2":"prescale1"}return{img:b,paintWidth:Z,paintHeight:te}}_createMaskCanvas(b){const v=this.ctx,{width:j,height:D}=b,U=this.current.fillColor,W=this.current.patternFill,Z=(0,i.getCurrentTransform)(v);let te,ve,xe,Re;if((b.bitmap||b.data)&&b.count>1){const he=b.bitmap||b.data.buffer;ve=JSON.stringify(W?Z:[Z.slice(0,4),U]),te=this._cachedBitmapsMap.get(he),te||(te=new Map,this._cachedBitmapsMap.set(he,te));const ze=te.get(ve);if(ze&&!W){const Le=Math.round(Math.min(Z[0],Z[2])+Z[4]),tt=Math.round(Math.min(Z[1],Z[3])+Z[5]);return{canvas:ze,offsetX:Le,offsetY:tt}}xe=ze}xe||(Re=this.cachedCanvases.getCanvas("maskCanvas",j,D),F(Re.context,b));let Ae=s.Util.transform(Z,[1/j,0,0,-1/D,0,0]);Ae=s.Util.transform(Ae,[1,0,0,1,0,-D]);const ke=s.Util.applyTransform([0,0],Ae),ue=s.Util.applyTransform([j,D],Ae),se=s.Util.normalizeRect([ke[0],ke[1],ue[0],ue[1]]),z=Math.round(se[2]-se[0])||1,J=Math.round(se[3]-se[1])||1,de=this.cachedCanvases.getCanvas("fillCanvas",z,J),fe=de.context,Fe=Math.min(ke[0],ue[0]),De=Math.min(ke[1],ue[1]);fe.translate(-Fe,-De),fe.transform(...Ae),xe||(xe=this._scaleImage(Re.canvas,(0,i.getCurrentTransformInverse)(fe)),xe=xe.img,te&&W&&te.set(ve,xe)),fe.imageSmoothingEnabled=k((0,i.getCurrentTransform)(fe),b.interpolate),x(fe,xe,0,0,xe.width,xe.height,0,0,j,D),fe.globalCompositeOperation="source-in";const Pe=s.Util.transform((0,i.getCurrentTransformInverse)(fe),[1,0,0,1,-Fe,-De]);return fe.fillStyle=W?U.getPattern(v,this,Pe,n.PathType.FILL):U,fe.fillRect(0,0,j,D),te&&!W&&(this.cachedCanvases.delete("fillCanvas"),te.set(ve,de.canvas)),{canvas:de.canvas,offsetX:Math.round(Fe),offsetY:Math.round(De)}}setLineWidth(b){b!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=b,this.ctx.lineWidth=b}setLineCap(b){this.ctx.lineCap=L[b]}setLineJoin(b){this.ctx.lineJoin=ae[b]}setMiterLimit(b){this.ctx.miterLimit=b}setDash(b,v){const j=this.ctx;j.setLineDash!==void 0&&(j.setLineDash(b),j.lineDashOffset=v)}setRenderingIntent(b){}setFlatness(b){}setGState(b){for(const[v,j]of b)switch(v){case"LW":this.setLineWidth(j);break;case"LC":this.setLineCap(j);break;case"LJ":this.setLineJoin(j);break;case"ML":this.setMiterLimit(j);break;case"D":this.setDash(j[0],j[1]);break;case"RI":this.setRenderingIntent(j);break;case"FL":this.setFlatness(j);break;case"Font":this.setFont(j[0],j[1]);break;case"CA":this.current.strokeAlpha=j;break;case"ca":this.current.fillAlpha=j,this.ctx.globalAlpha=j;break;case"BM":this.ctx.globalCompositeOperation=j;break;case"SMask":this.current.activeSMask=j?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(j);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const b=this.inSMaskMode;this.current.activeSMask&&!b?this.beginSMaskMode():!this.current.activeSMask&&b&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const b=this.ctx.canvas.width,v=this.ctx.canvas.height,j="smaskGroupAt"+this.groupLevel,D=this.cachedCanvases.getCanvas(j,b,v);this.suspendedCtx=this.ctx,this.ctx=D.context;const U=this.ctx;U.setTransform(...(0,i.getCurrentTransform)(this.suspendedCtx)),A(this.suspendedCtx,U),g(U,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),A(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(b){if(!this.current.activeSMask)return;b?(b[0]=Math.floor(b[0]),b[1]=Math.floor(b[1]),b[2]=Math.ceil(b[2]),b[3]=Math.ceil(b[3])):b=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const v=this.current.activeSMask,j=this.suspendedCtx;R(j,v,this.ctx,b),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(A(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const b=this.current;this.stateStack.push(b),this.current=b.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),A(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(b,v,j,D,U,W){this.ctx.transform(b,v,j,D,U,W),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(b,v,j){const D=this.ctx,U=this.current;let W=U.x,Z=U.y,te,ve;const xe=(0,i.getCurrentTransform)(D),Re=xe[0]===0&&xe[3]===0||xe[1]===0&&xe[2]===0,Ae=Re?j.slice(0):null;for(let ke=0,ue=0,se=b.length;ke<se;ke++)switch(b[ke]|0){case s.OPS.rectangle:W=v[ue++],Z=v[ue++];const z=v[ue++],J=v[ue++],de=W+z,fe=Z+J;D.moveTo(W,Z),z===0||J===0?D.lineTo(de,fe):(D.lineTo(de,Z),D.lineTo(de,fe),D.lineTo(W,fe)),Re||U.updateRectMinMax(xe,[W,Z,de,fe]),D.closePath();break;case s.OPS.moveTo:W=v[ue++],Z=v[ue++],D.moveTo(W,Z),Re||U.updatePathMinMax(xe,W,Z);break;case s.OPS.lineTo:W=v[ue++],Z=v[ue++],D.lineTo(W,Z),Re||U.updatePathMinMax(xe,W,Z);break;case s.OPS.curveTo:te=W,ve=Z,W=v[ue+4],Z=v[ue+5],D.bezierCurveTo(v[ue],v[ue+1],v[ue+2],v[ue+3],W,Z),U.updateCurvePathMinMax(xe,te,ve,v[ue],v[ue+1],v[ue+2],v[ue+3],W,Z,Ae),ue+=6;break;case s.OPS.curveTo2:te=W,ve=Z,D.bezierCurveTo(W,Z,v[ue],v[ue+1],v[ue+2],v[ue+3]),U.updateCurvePathMinMax(xe,te,ve,W,Z,v[ue],v[ue+1],v[ue+2],v[ue+3],Ae),W=v[ue+2],Z=v[ue+3],ue+=4;break;case s.OPS.curveTo3:te=W,ve=Z,W=v[ue+2],Z=v[ue+3],D.bezierCurveTo(v[ue],v[ue+1],W,Z,W,Z),U.updateCurvePathMinMax(xe,te,ve,v[ue],v[ue+1],W,Z,W,Z,Ae),ue+=4;break;case s.OPS.closePath:D.closePath();break}Re&&U.updateScalingPathMinMax(xe,Ae),U.setCurrentPoint(W,Z)}closePath(){this.ctx.closePath()}stroke(b=!0){const v=this.ctx,j=this.current.strokeColor;v.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof j=="object"&&(j!=null&&j.getPattern)?(v.save(),v.strokeStyle=j.getPattern(v,this,(0,i.getCurrentTransformInverse)(v),n.PathType.STROKE),this.rescaleAndStroke(!1),v.restore()):this.rescaleAndStroke(!0)),b&&this.consumePath(this.current.getClippedPathBoundingBox()),v.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(b=!0){const v=this.ctx,j=this.current.fillColor,D=this.current.patternFill;let U=!1;D&&(v.save(),v.fillStyle=j.getPattern(v,this,(0,i.getCurrentTransformInverse)(v),n.PathType.FILL),U=!0);const W=this.current.getClippedPathBoundingBox();this.contentVisible&&W!==null&&(this.pendingEOFill?(v.fill("evenodd"),this.pendingEOFill=!1):v.fill()),U&&v.restore(),b&&this.consumePath(W)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Q}eoClip(){this.pendingClip=oe}beginText(){this.current.textMatrix=s.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const b=this.pendingTextPaths,v=this.ctx;if(b===void 0){v.beginPath();return}v.save(),v.beginPath();for(const j of b)v.setTransform(...j.transform),v.translate(j.x,j.y),j.addToPath(v,j.fontSize);v.restore(),v.clip(),v.beginPath(),delete this.pendingTextPaths}setCharSpacing(b){this.current.charSpacing=b}setWordSpacing(b){this.current.wordSpacing=b}setHScale(b){this.current.textHScale=b/100}setLeading(b){this.current.leading=-b}setFont(b,v){var xe;const j=this.commonObjs.get(b),D=this.current;if(!j)throw new Error(`Can't find font for ${b}`);if(D.fontMatrix=j.fontMatrix||s.FONT_IDENTITY_MATRIX,(D.fontMatrix[0]===0||D.fontMatrix[3]===0)&&(0,s.warn)("Invalid font matrix for font "+b),v<0?(v=-v,D.fontDirection=-1):D.fontDirection=1,this.current.font=j,this.current.fontSize=v,j.isType3Font)return;const U=j.loadedName||"sans-serif",W=((xe=j.systemFontInfo)==null?void 0:xe.css)||`"${U}", ${j.fallbackName}`;let Z="normal";j.black?Z="900":j.bold&&(Z="bold");const te=j.italic?"italic":"normal";let ve=v;v<o?ve=o:v>d&&(ve=d),this.current.fontSizeScale=v/ve,this.ctx.font=`${te} ${Z} ${ve}px ${W}`}setTextRenderingMode(b){this.current.textRenderingMode=b}setTextRise(b){this.current.textRise=b}moveText(b,v){this.current.x=this.current.lineX+=b,this.current.y=this.current.lineY+=v}setLeadingMoveText(b,v){this.setLeading(-v),this.moveText(b,v)}setTextMatrix(b,v,j,D,U,W){this.current.textMatrix=[b,v,j,D,U,W],this.current.textMatrixScale=Math.hypot(b,v),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(b,v,j,D){const U=this.ctx,W=this.current,Z=W.font,te=W.textRenderingMode,ve=W.fontSize/W.fontSizeScale,xe=te&s.TextRenderingMode.FILL_STROKE_MASK,Re=!!(te&s.TextRenderingMode.ADD_TO_PATH_FLAG),Ae=W.patternFill&&!Z.missingFile;let ke;(Z.disableFontFace||Re||Ae)&&(ke=Z.getPathGenerator(this.commonObjs,b)),Z.disableFontFace||Ae?(U.save(),U.translate(v,j),U.beginPath(),ke(U,ve),D&&U.setTransform(...D),(xe===s.TextRenderingMode.FILL||xe===s.TextRenderingMode.FILL_STROKE)&&U.fill(),(xe===s.TextRenderingMode.STROKE||xe===s.TextRenderingMode.FILL_STROKE)&&U.stroke(),U.restore()):((xe===s.TextRenderingMode.FILL||xe===s.TextRenderingMode.FILL_STROKE)&&U.fillText(b,v,j),(xe===s.TextRenderingMode.STROKE||xe===s.TextRenderingMode.FILL_STROKE)&&U.strokeText(b,v,j)),Re&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,i.getCurrentTransform)(U),x:v,y:j,fontSize:ve,addToPath:ke})}get isFontSubpixelAAEnabled(){const{context:b}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);b.scale(1.5,1),b.fillText("I",0,10);const v=b.getImageData(0,0,10,10).data;let j=!1;for(let D=3;D<v.length;D+=4)if(v[D]>0&&v[D]<255){j=!0;break}return(0,s.shadow)(this,"isFontSubpixelAAEnabled",j)}showText(b){const v=this.current,j=v.font;if(j.isType3Font)return this.showType3Text(b);const D=v.fontSize;if(D===0)return;const U=this.ctx,W=v.fontSizeScale,Z=v.charSpacing,te=v.wordSpacing,ve=v.fontDirection,xe=v.textHScale*ve,Re=b.length,Ae=j.vertical,ke=Ae?1:-1,ue=j.defaultVMetrics,se=D*v.fontMatrix[0],z=v.textRenderingMode===s.TextRenderingMode.FILL&&!j.disableFontFace&&!v.patternFill;U.save(),U.transform(...v.textMatrix),U.translate(v.x,v.y+v.textRise),ve>0?U.scale(xe,-1):U.scale(xe,1);let J;if(v.patternFill){U.save();const Pe=v.fillColor.getPattern(U,this,(0,i.getCurrentTransformInverse)(U),n.PathType.FILL);J=(0,i.getCurrentTransform)(U),U.restore(),U.fillStyle=Pe}let de=v.lineWidth;const fe=v.textMatrixScale;if(fe===0||de===0){const Pe=v.textRenderingMode&s.TextRenderingMode.FILL_STROKE_MASK;(Pe===s.TextRenderingMode.STROKE||Pe===s.TextRenderingMode.FILL_STROKE)&&(de=this.getSinglePixelWidth())}else de/=fe;if(W!==1&&(U.scale(W,W),de/=W),U.lineWidth=de,j.isInvalidPDFjsFont){const Pe=[];let he=0;for(const ze of b)Pe.push(ze.unicode),he+=ze.width;U.fillText(Pe.join(""),0,0),v.x+=he*se*xe,U.restore(),this.compose();return}let Fe=0,De;for(De=0;De<Re;++De){const Pe=b[De];if(typeof Pe=="number"){Fe+=ke*Pe*D/1e3;continue}let he=!1;const ze=(Pe.isSpace?te:0)+Z,Le=Pe.fontChar,tt=Pe.accent;let et,it,Xe=Pe.width;if(Ae){const nt=Pe.vmetric||ue,ot=-(Pe.vmetric?nt[1]:Xe*.5)*se,Me=nt[2]*se;Xe=nt?-nt[0]:Xe,et=ot/W,it=(Fe+Me)/W}else et=Fe/W,it=0;if(j.remeasure&&Xe>0){const nt=U.measureText(Le).width*1e3/D*W;if(Xe<nt&&this.isFontSubpixelAAEnabled){const ot=Xe/nt;he=!0,U.save(),U.scale(ot,1),et/=ot}else Xe!==nt&&(et+=(Xe-nt)/2e3*D/W)}if(this.contentVisible&&(Pe.isInFont||j.missingFile)){if(z&&!tt)U.fillText(Le,et,it);else if(this.paintChar(Le,et,it,J),tt){const nt=et+D*tt.offset.x/W,ot=it-D*tt.offset.y/W;this.paintChar(tt.fontChar,nt,ot,J)}}const Je=Ae?Xe*se-ze*ve:Xe*se+ze*ve;Fe+=Je,he&&U.restore()}Ae?v.y-=Fe:v.x+=Fe*xe,U.restore(),this.compose()}showType3Text(b){const v=this.ctx,j=this.current,D=j.font,U=j.fontSize,W=j.fontDirection,Z=D.vertical?1:-1,te=j.charSpacing,ve=j.wordSpacing,xe=j.textHScale*W,Re=j.fontMatrix||s.FONT_IDENTITY_MATRIX,Ae=b.length,ke=j.textRenderingMode===s.TextRenderingMode.INVISIBLE;let ue,se,z,J;if(!(ke||U===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,v.save(),v.transform(...j.textMatrix),v.translate(j.x,j.y),v.scale(xe,W),ue=0;ue<Ae;++ue){if(se=b[ue],typeof se=="number"){J=Z*se*U/1e3,this.ctx.translate(J,0),j.x+=J*xe;continue}const de=(se.isSpace?ve:0)+te,fe=D.charProcOperatorList[se.operatorListId];if(!fe){(0,s.warn)(`Type3 character "${se.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=se,this.save(),v.scale(U,U),v.transform(...Re),this.executeOperatorList(fe),this.restore()),z=s.Util.applyTransform([se.width,0],Re)[0]*U+de,v.translate(z,0),j.x+=z*xe}v.restore(),this.processingType3=null}}setCharWidth(b,v){}setCharWidthAndBounds(b,v,j,D,U,W){this.ctx.rect(j,D,U-j,W-D),this.ctx.clip(),this.endPath()}getColorN_Pattern(b){let v;if(b[0]==="TilingPattern"){const j=b[1],D=this.baseTransform||(0,i.getCurrentTransform)(this.ctx),U={createCanvasGraphics:W=>new le(W,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};v=new n.TilingPattern(b,j,this.ctx,U,D)}else v=this._getPattern(b[1],b[2]);return v}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(b,v,j){const D=s.Util.makeHexColor(b,v,j);this.ctx.strokeStyle=D,this.current.strokeColor=D}setFillRGBColor(b,v,j){const D=s.Util.makeHexColor(b,v,j);this.ctx.fillStyle=D,this.current.fillColor=D,this.current.patternFill=!1}_getPattern(b,v=null){let j;return this.cachedPatterns.has(b)?j=this.cachedPatterns.get(b):(j=(0,n.getShadingPattern)(this.getObject(b)),this.cachedPatterns.set(b,j)),v&&(j.matrix=v),j}shadingFill(b){if(!this.contentVisible)return;const v=this.ctx;this.save();const j=this._getPattern(b);v.fillStyle=j.getPattern(v,this,(0,i.getCurrentTransformInverse)(v),n.PathType.SHADING);const D=(0,i.getCurrentTransformInverse)(v);if(D){const{width:U,height:W}=v.canvas,[Z,te,ve,xe]=s.Util.getAxialAlignedBoundingBox([0,0,U,W],D);this.ctx.fillRect(Z,te,ve-Z,xe-te)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,s.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,s.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(b,v){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(b)&&b.length===6&&this.transform(...b),this.baseTransform=(0,i.getCurrentTransform)(this.ctx),v)){const j=v[2]-v[0],D=v[3]-v[1];this.ctx.rect(v[0],v[1],j,D),this.current.updateRectMinMax((0,i.getCurrentTransform)(this.ctx),v),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(b){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const v=this.ctx;b.isolated||(0,s.info)("TODO: Support non-isolated groups."),b.knockout&&(0,s.warn)("Knockout groups not supported.");const j=(0,i.getCurrentTransform)(v);if(b.matrix&&v.transform(...b.matrix),!b.bbox)throw new Error("Bounding box is required.");let D=s.Util.getAxialAlignedBoundingBox(b.bbox,(0,i.getCurrentTransform)(v));const U=[0,0,v.canvas.width,v.canvas.height];D=s.Util.intersect(D,U)||[0,0,0,0];const W=Math.floor(D[0]),Z=Math.floor(D[1]);let te=Math.max(Math.ceil(D[2])-W,1),ve=Math.max(Math.ceil(D[3])-Z,1),xe=1,Re=1;te>l&&(xe=te/l,te=l),ve>l&&(Re=ve/l,ve=l),this.current.startNewPathAndClipBox([0,0,te,ve]);let Ae="groupAt"+this.groupLevel;b.smask&&(Ae+="_smask_"+this.smaskCounter++%2);const ke=this.cachedCanvases.getCanvas(Ae,te,ve),ue=ke.context;ue.scale(1/xe,1/Re),ue.translate(-W,-Z),ue.transform(...j),b.smask?this.smaskStack.push({canvas:ke.canvas,context:ue,offsetX:W,offsetY:Z,scaleX:xe,scaleY:Re,subtype:b.smask.subtype,backdrop:b.smask.backdrop,transferMap:b.smask.transferMap||null,startTransformInverse:null}):(v.setTransform(1,0,0,1,0,0),v.translate(W,Z),v.scale(xe,Re),v.save()),A(v,ue),this.ctx=ue,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(v),this.groupLevel++}endGroup(b){if(!this.contentVisible)return;this.groupLevel--;const v=this.ctx,j=this.groupStack.pop();if(this.ctx=j,this.ctx.imageSmoothingEnabled=!1,b.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const D=(0,i.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...D);const U=s.Util.getAxialAlignedBoundingBox([0,0,v.canvas.width,v.canvas.height],D);this.ctx.drawImage(v.canvas,0,0),this.ctx.restore(),this.compose(U)}}beginAnnotation(b,v,j,D,U){if(ce(this,me,cr).call(this),C(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(v)&&v.length===4){const W=v[2]-v[0],Z=v[3]-v[1];if(U&&this.annotationCanvasMap){j=j.slice(),j[4]-=v[0],j[5]-=v[1],v=v.slice(),v[0]=v[1]=0,v[2]=W,v[3]=Z;const[te,ve]=s.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(this.ctx)),{viewportScale:xe}=this,Re=Math.ceil(W*this.outputScaleX*xe),Ae=Math.ceil(Z*this.outputScaleY*xe);this.annotationCanvas=this.canvasFactory.create(Re,Ae);const{canvas:ke,context:ue}=this.annotationCanvas;this.annotationCanvasMap.set(b,ke),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ue,this.ctx.save(),this.ctx.setTransform(te,0,0,-ve,0,Z*ve),C(this.ctx)}else C(this.ctx),this.ctx.rect(v[0],v[1],W,Z),this.ctx.clip(),this.endPath()}this.current=new S(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...j),this.transform(...D)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),ce(this,me,dr).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(b){if(!this.contentVisible)return;const v=b.count;b=this.getObject(b.data,b),b.count=v;const j=this.ctx,D=this.processingType3;if(D&&(D.compiled===void 0&&(D.compiled=E(b)),D.compiled)){D.compiled(j);return}const U=this._createMaskCanvas(b),W=U.canvas;j.save(),j.setTransform(1,0,0,1,0,0),j.drawImage(W,U.offsetX,U.offsetY),j.restore(),this.compose()}paintImageMaskXObjectRepeat(b,v,j=0,D=0,U,W){if(!this.contentVisible)return;b=this.getObject(b.data,b);const Z=this.ctx;Z.save();const te=(0,i.getCurrentTransform)(Z);Z.transform(v,j,D,U,0,0);const ve=this._createMaskCanvas(b);Z.setTransform(1,0,0,1,ve.offsetX-te[4],ve.offsetY-te[5]);for(let xe=0,Re=W.length;xe<Re;xe+=2){const Ae=s.Util.transform(te,[v,j,D,U,W[xe],W[xe+1]]),[ke,ue]=s.Util.applyTransform([0,0],Ae);Z.drawImage(ve.canvas,ke,ue)}Z.restore(),this.compose()}paintImageMaskXObjectGroup(b){if(!this.contentVisible)return;const v=this.ctx,j=this.current.fillColor,D=this.current.patternFill;for(const U of b){const{data:W,width:Z,height:te,transform:ve}=U,xe=this.cachedCanvases.getCanvas("maskCanvas",Z,te),Re=xe.context;Re.save();const Ae=this.getObject(W,U);F(Re,Ae),Re.globalCompositeOperation="source-in",Re.fillStyle=D?j.getPattern(Re,this,(0,i.getCurrentTransformInverse)(v),n.PathType.FILL):j,Re.fillRect(0,0,Z,te),Re.restore(),v.save(),v.transform(...ve),v.scale(1,-1),x(v,xe.canvas,0,0,Z,te,0,-1,1,1),v.restore()}this.compose()}paintImageXObject(b){if(!this.contentVisible)return;const v=this.getObject(b);if(!v){(0,s.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(v)}paintImageXObjectRepeat(b,v,j,D){if(!this.contentVisible)return;const U=this.getObject(b);if(!U){(0,s.warn)("Dependent image isn't ready yet");return}const W=U.width,Z=U.height,te=[];for(let ve=0,xe=D.length;ve<xe;ve+=2)te.push({transform:[v,0,0,j,D[ve],D[ve+1]],x:0,y:0,w:W,h:Z});this.paintInlineImageXObjectGroup(U,te)}applyTransferMapsToCanvas(b){return this.current.transferMaps!=="none"&&(b.filter=this.current.transferMaps,b.drawImage(b.canvas,0,0),b.filter="none"),b.canvas}applyTransferMapsToBitmap(b){if(this.current.transferMaps==="none")return b.bitmap;const{bitmap:v,width:j,height:D}=b,U=this.cachedCanvases.getCanvas("inlineImage",j,D),W=U.context;return W.filter=this.current.transferMaps,W.drawImage(v,0,0),W.filter="none",U.canvas}paintInlineImageXObject(b){if(!this.contentVisible)return;const v=b.width,j=b.height,D=this.ctx;if(this.save(),!s.isNodeJS){const{filter:Z}=D;Z!=="none"&&Z!==""&&(D.filter="none")}D.scale(1/v,-1/j);let U;if(b.bitmap)U=this.applyTransferMapsToBitmap(b);else if(typeof HTMLElement=="function"&&b instanceof HTMLElement||!b.data)U=b;else{const te=this.cachedCanvases.getCanvas("inlineImage",v,j).context;P(te,b),U=this.applyTransferMapsToCanvas(te)}const W=this._scaleImage(U,(0,i.getCurrentTransformInverse)(D));D.imageSmoothingEnabled=k((0,i.getCurrentTransform)(D),b.interpolate),x(D,W.img,0,0,W.paintWidth,W.paintHeight,0,-j,v,j),this.compose(),this.restore()}paintInlineImageXObjectGroup(b,v){if(!this.contentVisible)return;const j=this.ctx;let D;if(b.bitmap)D=b.bitmap;else{const U=b.width,W=b.height,te=this.cachedCanvases.getCanvas("inlineImage",U,W).context;P(te,b),D=this.applyTransferMapsToCanvas(te)}for(const U of v)j.save(),j.transform(...U.transform),j.scale(1,-1),x(j,D,U.x,U.y,U.w,U.h,0,-1,1,1),j.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(b){}markPointProps(b,v){}beginMarkedContent(b){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(b,v){b==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(v)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(b){const v=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(b);const j=this.ctx;this.pendingClip&&(v||(this.pendingClip===oe?j.clip("evenodd"):j.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),j.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const b=(0,i.getCurrentTransform)(this.ctx);if(b[1]===0&&b[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(b[0]),Math.abs(b[3]));else{const v=Math.abs(b[0]*b[3]-b[2]*b[1]),j=Math.hypot(b[0],b[2]),D=Math.hypot(b[1],b[3]);this._cachedGetSinglePixelWidth=Math.max(j,D)/v}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:b}=this.current,{a:v,b:j,c:D,d:U}=this.ctx.getTransform();let W,Z;if(j===0&&D===0){const te=Math.abs(v),ve=Math.abs(U);if(te===ve)if(b===0)W=Z=1/te;else{const xe=te*b;W=Z=xe<1?1/xe:1}else if(b===0)W=1/te,Z=1/ve;else{const xe=te*b,Re=ve*b;W=xe<1?1/xe:1,Z=Re<1?1/Re:1}}else{const te=Math.abs(v*U-j*D),ve=Math.hypot(v,j),xe=Math.hypot(D,U);if(b===0)W=xe/te,Z=ve/te;else{const Re=b*te;W=xe>Re?xe/Re:1,Z=ve>Re?ve/Re:1}}this._cachedScaleForStroking[0]=W,this._cachedScaleForStroking[1]=Z}return this._cachedScaleForStroking}rescaleAndStroke(b){const{ctx:v}=this,{lineWidth:j}=this.current,[D,U]=this.getScaleForStroking();if(v.lineWidth=j||1,D===1&&U===1){v.stroke();return}const W=v.getLineDash();if(b&&v.save(),v.scale(D,U),W.length>0){const Z=Math.max(D,U);v.setLineDash(W.map(te=>te/Z)),v.lineDashOffset/=Z}v.stroke(),b&&v.restore()}isContentVisible(){for(let b=this.markedContentStack.length-1;b>=0;b--)if(!this.markedContentStack[b].visible)return!1;return!0}};me=new WeakSet,cr=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},dr=function(){if(this.pageColors){const b=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(b!=="none"){const v=this.ctx.filter;this.ctx.filter=b,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=v}}};let re=le;t.CanvasGraphics=re;for(const N in s.OPS)re.prototype[N]!==void 0&&(re.prototype[s.OPS[N]]=re.prototype[N])},(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TilingPattern=t.PathType=void 0,t.getShadingPattern=h;var s=r(1),i=r(6);const n={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};t.PathType=n;function a(E,S){if(!S)return;const P=S[2]-S[0],F=S[3]-S[1],A=new Path2D;A.rect(S[0],S[1],P,F),E.clip(A)}class o{constructor(){this.constructor===o&&(0,s.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,s.unreachable)("Abstract method `getPattern` called.")}}class d extends o{constructor(S){super(),this._type=S[1],this._bbox=S[2],this._colorStops=S[3],this._p0=S[4],this._p1=S[5],this._r0=S[6],this._r1=S[7],this.matrix=null}_createGradient(S){let P;this._type==="axial"?P=S.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(P=S.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const F of this._colorStops)P.addColorStop(F[0],F[1]);return P}getPattern(S,P,F,A){let C;if(A===n.STROKE||A===n.FILL){const _=P.current.getClippedPathBoundingBox(A,(0,i.getCurrentTransform)(S))||[0,0,0,0],w=Math.ceil(_[2]-_[0])||1,T=Math.ceil(_[3]-_[1])||1,M=P.cachedCanvases.getCanvas("pattern",w,T,!0),R=M.context;R.clearRect(0,0,R.canvas.width,R.canvas.height),R.beginPath(),R.rect(0,0,R.canvas.width,R.canvas.height),R.translate(-_[0],-_[1]),F=s.Util.transform(F,[1,0,0,1,_[0],_[1]]),R.transform(...P.baseTransform),this.matrix&&R.transform(...this.matrix),a(R,this._bbox),R.fillStyle=this._createGradient(R),R.fill(),C=S.createPattern(M.canvas,"no-repeat");const k=new DOMMatrix(F);C.setTransform(k)}else a(S,this._bbox),C=this._createGradient(S);return C}}function l(E,S,P,F,A,C,_,w){const T=S.coords,M=S.colors,R=E.data,k=E.width*4;let L;T[P+1]>T[F+1]&&(L=P,P=F,F=L,L=C,C=_,_=L),T[F+1]>T[A+1]&&(L=F,F=A,A=L,L=_,_=w,w=L),T[P+1]>T[F+1]&&(L=P,P=F,F=L,L=C,C=_,_=L);const ae=(T[P]+S.offsetX)*S.scaleX,Q=(T[P+1]+S.offsetY)*S.scaleY,oe=(T[F]+S.offsetX)*S.scaleX,re=(T[F+1]+S.offsetY)*S.scaleY,me=(T[A]+S.offsetX)*S.scaleX,H=(T[A+1]+S.offsetY)*S.scaleY;if(Q>=H)return;const ie=M[C],le=M[C+1],N=M[C+2],b=M[_],v=M[_+1],j=M[_+2],D=M[w],U=M[w+1],W=M[w+2],Z=Math.round(Q),te=Math.round(H);let ve,xe,Re,Ae,ke,ue,se,z;for(let J=Z;J<=te;J++){if(J<re){const Pe=J<Q?0:(Q-J)/(Q-re);ve=ae-(ae-oe)*Pe,xe=ie-(ie-b)*Pe,Re=le-(le-v)*Pe,Ae=N-(N-j)*Pe}else{let Pe;J>H?Pe=1:re===H?Pe=0:Pe=(re-J)/(re-H),ve=oe-(oe-me)*Pe,xe=b-(b-D)*Pe,Re=v-(v-U)*Pe,Ae=j-(j-W)*Pe}let de;J<Q?de=0:J>H?de=1:de=(Q-J)/(Q-H),ke=ae-(ae-me)*de,ue=ie-(ie-D)*de,se=le-(le-U)*de,z=N-(N-W)*de;const fe=Math.round(Math.min(ve,ke)),Fe=Math.round(Math.max(ve,ke));let De=k*J+fe*4;for(let Pe=fe;Pe<=Fe;Pe++)de=(ve-Pe)/(ve-ke),de<0?de=0:de>1&&(de=1),R[De++]=xe-(xe-ue)*de|0,R[De++]=Re-(Re-se)*de|0,R[De++]=Ae-(Ae-z)*de|0,R[De++]=255}}function c(E,S,P){const F=S.coords,A=S.colors;let C,_;switch(S.type){case"lattice":const w=S.verticesPerRow,T=Math.floor(F.length/w)-1,M=w-1;for(C=0;C<T;C++){let R=C*w;for(let k=0;k<M;k++,R++)l(E,P,F[R],F[R+1],F[R+w],A[R],A[R+1],A[R+w]),l(E,P,F[R+w+1],F[R+1],F[R+w],A[R+w+1],A[R+1],A[R+w])}break;case"triangles":for(C=0,_=F.length;C<_;C+=3)l(E,P,F[C],F[C+1],F[C+2],A[C],A[C+1],A[C+2]);break;default:throw new Error("illegal figure")}}class f extends o{constructor(S){super(),this._coords=S[2],this._colors=S[3],this._figures=S[4],this._bounds=S[5],this._bbox=S[7],this._background=S[8],this.matrix=null}_createMeshCanvas(S,P,F){const w=Math.floor(this._bounds[0]),T=Math.floor(this._bounds[1]),M=Math.ceil(this._bounds[2])-w,R=Math.ceil(this._bounds[3])-T,k=Math.min(Math.ceil(Math.abs(M*S[0]*1.1)),3e3),L=Math.min(Math.ceil(Math.abs(R*S[1]*1.1)),3e3),ae=M/k,Q=R/L,oe={coords:this._coords,colors:this._colors,offsetX:-w,offsetY:-T,scaleX:1/ae,scaleY:1/Q},re=k+2*2,me=L+2*2,H=F.getCanvas("mesh",re,me,!1),ie=H.context,le=ie.createImageData(k,L);if(P){const b=le.data;for(let v=0,j=b.length;v<j;v+=4)b[v]=P[0],b[v+1]=P[1],b[v+2]=P[2],b[v+3]=255}for(const b of this._figures)c(le,b,oe);return ie.putImageData(le,2,2),{canvas:H.canvas,offsetX:w-2*ae,offsetY:T-2*Q,scaleX:ae,scaleY:Q}}getPattern(S,P,F,A){a(S,this._bbox);let C;if(A===n.SHADING)C=s.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(S));else if(C=s.Util.singularValueDecompose2dScale(P.baseTransform),this.matrix){const w=s.Util.singularValueDecompose2dScale(this.matrix);C=[C[0]*w[0],C[1]*w[1]]}const _=this._createMeshCanvas(C,A===n.SHADING?null:this._background,P.cachedCanvases);return A!==n.SHADING&&(S.setTransform(...P.baseTransform),this.matrix&&S.transform(...this.matrix)),S.translate(_.offsetX,_.offsetY),S.scale(_.scaleX,_.scaleY),S.createPattern(_.canvas,"no-repeat")}}class u extends o{getPattern(){return"hotpink"}}function h(E){switch(E[0]){case"RadialAxial":return new d(E);case"Mesh":return new f(E);case"Dummy":return new u}throw new Error(`Unknown IR type: ${E[0]}`)}const g={COLORED:1,UNCOLORED:2},x=class x{constructor(S,P,F,A,C){this.operatorList=S[2],this.matrix=S[3]||[1,0,0,1,0,0],this.bbox=S[4],this.xstep=S[5],this.ystep=S[6],this.paintType=S[7],this.tilingType=S[8],this.color=P,this.ctx=F,this.canvasGraphicsFactory=A,this.baseTransform=C}createPatternCanvas(S){const P=this.operatorList,F=this.bbox,A=this.xstep,C=this.ystep,_=this.paintType,w=this.tilingType,T=this.color,M=this.canvasGraphicsFactory;(0,s.info)("TilingType: "+w);const R=F[0],k=F[1],L=F[2],ae=F[3],Q=s.Util.singularValueDecompose2dScale(this.matrix),oe=s.Util.singularValueDecompose2dScale(this.baseTransform),re=[Q[0]*oe[0],Q[1]*oe[1]],me=this.getSizeAndScale(A,this.ctx.canvas.width,re[0]),H=this.getSizeAndScale(C,this.ctx.canvas.height,re[1]),ie=S.cachedCanvases.getCanvas("pattern",me.size,H.size,!0),le=ie.context,N=M.createCanvasGraphics(le);N.groupLevel=S.groupLevel,this.setFillAndStrokeStyleToContext(N,_,T);let b=R,v=k,j=L,D=ae;return R<0&&(b=0,j+=Math.abs(R)),k<0&&(v=0,D+=Math.abs(k)),le.translate(-(me.scale*b),-(H.scale*v)),N.transform(me.scale,0,0,H.scale,0,0),le.save(),this.clipBbox(N,b,v,j,D),N.baseTransform=(0,i.getCurrentTransform)(N.ctx),N.executeOperatorList(P),N.endDrawing(),{canvas:ie.canvas,scaleX:me.scale,scaleY:H.scale,offsetX:b,offsetY:v}}getSizeAndScale(S,P,F){S=Math.abs(S);const A=Math.max(x.MAX_PATTERN_SIZE,P);let C=Math.ceil(S*F);return C>=A?C=A:F=C/S,{scale:F,size:C}}clipBbox(S,P,F,A,C){const _=A-P,w=C-F;S.ctx.rect(P,F,_,w),S.current.updateRectMinMax((0,i.getCurrentTransform)(S.ctx),[P,F,A,C]),S.clip(),S.endPath()}setFillAndStrokeStyleToContext(S,P,F){const A=S.ctx,C=S.current;switch(P){case g.COLORED:const _=this.ctx;A.fillStyle=_.fillStyle,A.strokeStyle=_.strokeStyle,C.fillColor=_.fillStyle,C.strokeColor=_.strokeStyle;break;case g.UNCOLORED:const w=s.Util.makeHexColor(F[0],F[1],F[2]);A.fillStyle=w,A.strokeStyle=w,C.fillColor=w,C.strokeColor=w;break;default:throw new s.FormatError(`Unsupported paint type: ${P}`)}}getPattern(S,P,F,A){let C=F;A!==n.SHADING&&(C=s.Util.transform(C,P.baseTransform),this.matrix&&(C=s.Util.transform(C,this.matrix)));const _=this.createPatternCanvas(P);let w=new DOMMatrix(C);w=w.translate(_.offsetX,_.offsetY),w=w.scale(1/_.scaleX,1/_.scaleY);const T=S.createPattern(_.canvas,"repeat");return T.setTransform(w),T}};lt(x,"MAX_PATTERN_SIZE",3e3);let p=x;t.TilingPattern=p},(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertBlackAndWhiteToRGBA=n,t.convertToRGBA=i,t.grayToRGBA=o;var s=r(1);function i(d){switch(d.kind){case s.ImageKind.GRAYSCALE_1BPP:return n(d);case s.ImageKind.RGB_24BPP:return a(d)}return null}function n({src:d,srcPos:l=0,dest:c,width:f,height:u,nonBlackColor:h=4294967295,inverseDecode:g=!1}){const p=s.FeatureTest.isLittleEndian?4278190080:255,[x,E]=g?[h,p]:[p,h],S=f>>3,P=f&7,F=d.length;c=new Uint32Array(c.buffer);let A=0;for(let C=0;C<u;C++){for(const w=l+S;l<w;l++){const T=l<F?d[l]:255;c[A++]=T&128?E:x,c[A++]=T&64?E:x,c[A++]=T&32?E:x,c[A++]=T&16?E:x,c[A++]=T&8?E:x,c[A++]=T&4?E:x,c[A++]=T&2?E:x,c[A++]=T&1?E:x}if(P===0)continue;const _=l<F?d[l++]:255;for(let w=0;w<P;w++)c[A++]=_&1<<7-w?E:x}return{srcPos:l,destPos:A}}function a({src:d,srcPos:l=0,dest:c,destPos:f=0,width:u,height:h}){let g=0;const p=d.length>>2,x=new Uint32Array(d.buffer,l,p);if(s.FeatureTest.isLittleEndian){for(;g<p-2;g+=3,f+=4){const E=x[g],S=x[g+1],P=x[g+2];c[f]=E|4278190080,c[f+1]=E>>>24|S<<8|4278190080,c[f+2]=S>>>16|P<<16|4278190080,c[f+3]=P>>>8|4278190080}for(let E=g*4,S=d.length;E<S;E+=3)c[f++]=d[E]|d[E+1]<<8|d[E+2]<<16|4278190080}else{for(;g<p-2;g+=3,f+=4){const E=x[g],S=x[g+1],P=x[g+2];c[f]=E|255,c[f+1]=E<<24|S>>>8|255,c[f+2]=S<<16|P>>>16|255,c[f+3]=P<<8|255}for(let E=g*4,S=d.length;E<S;E+=3)c[f++]=d[E]<<24|d[E+1]<<16|d[E+2]<<8|255}return{srcPos:l,destPos:f}}function o(d,l){if(s.FeatureTest.isLittleEndian)for(let c=0,f=d.length;c<f;c++)l[c]=d[c]*65793|4278190080;else for(let c=0,f=d.length;c<f;c++)l[c]=d[c]*16843008|255}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;const r=Object.create(null);t.GlobalWorkerOptions=r,r.workerPort=null,r.workerSrc=""},(e,t,r)=>{var d,Br,zr,Lt;Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var s=r(1);const i={DATA:1,ERROR:2},n={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function a(u){switch(u instanceof Error||typeof u=="object"&&u!==null||(0,s.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),u.name){case"AbortException":return new s.AbortException(u.message);case"MissingPDFException":return new s.MissingPDFException(u.message);case"PasswordException":return new s.PasswordException(u.message,u.code);case"UnexpectedResponseException":return new s.UnexpectedResponseException(u.message,u.status);case"UnknownErrorException":return new s.UnknownErrorException(u.message,u.details);default:return new s.UnknownErrorException(u.message,u.toString())}}class o{constructor(h,g,p){_e(this,d);this.sourceName=h,this.targetName=g,this.comObj=p,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=x=>{const E=x.data;if(E.targetName!==this.sourceName)return;if(E.stream){ce(this,d,zr).call(this,E);return}if(E.callback){const P=E.callbackId,F=this.callbackCapabilities[P];if(!F)throw new Error(`Cannot resolve callback ${P}`);if(delete this.callbackCapabilities[P],E.callback===i.DATA)F.resolve(E.data);else if(E.callback===i.ERROR)F.reject(a(E.reason));else throw new Error("Unexpected callback case");return}const S=this.actionHandler[E.action];if(!S)throw new Error(`Unknown action from worker: ${E.action}`);if(E.callbackId){const P=this.sourceName,F=E.sourceName;new Promise(function(A){A(S(E.data))}).then(function(A){p.postMessage({sourceName:P,targetName:F,callback:i.DATA,callbackId:E.callbackId,data:A})},function(A){p.postMessage({sourceName:P,targetName:F,callback:i.ERROR,callbackId:E.callbackId,reason:a(A)})});return}if(E.streamId){ce(this,d,Br).call(this,E);return}S(E.data)},p.addEventListener("message",this._onComObjOnMessage)}on(h,g){const p=this.actionHandler;if(p[h])throw new Error(`There is already an actionName called "${h}"`);p[h]=g}send(h,g,p){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,data:g},p)}sendWithPromise(h,g,p){const x=this.callbackId++,E=new s.PromiseCapability;this.callbackCapabilities[x]=E;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,callbackId:x,data:g},p)}catch(S){E.reject(S)}return E.promise}sendWithStream(h,g,p,x){const E=this.streamId++,S=this.sourceName,P=this.targetName,F=this.comObj;return new ReadableStream({start:A=>{const C=new s.PromiseCapability;return this.streamControllers[E]={controller:A,startCall:C,pullCall:null,cancelCall:null,isClosed:!1},F.postMessage({sourceName:S,targetName:P,action:h,streamId:E,data:g,desiredSize:A.desiredSize},x),C.promise},pull:A=>{const C=new s.PromiseCapability;return this.streamControllers[E].pullCall=C,F.postMessage({sourceName:S,targetName:P,stream:n.PULL,streamId:E,desiredSize:A.desiredSize}),C.promise},cancel:A=>{(0,s.assert)(A instanceof Error,"cancel must have a valid reason");const C=new s.PromiseCapability;return this.streamControllers[E].cancelCall=C,this.streamControllers[E].isClosed=!0,F.postMessage({sourceName:S,targetName:P,stream:n.CANCEL,streamId:E,reason:a(A)}),C.promise}},p)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}d=new WeakSet,Br=function(h){const g=h.streamId,p=this.sourceName,x=h.sourceName,E=this.comObj,S=this,P=this.actionHandler[h.action],F={enqueue(A,C=1,_){if(this.isCancelled)return;const w=this.desiredSize;this.desiredSize-=C,w>0&&this.desiredSize<=0&&(this.sinkCapability=new s.PromiseCapability,this.ready=this.sinkCapability.promise),E.postMessage({sourceName:p,targetName:x,stream:n.ENQUEUE,streamId:g,chunk:A},_)},close(){this.isCancelled||(this.isCancelled=!0,E.postMessage({sourceName:p,targetName:x,stream:n.CLOSE,streamId:g}),delete S.streamSinks[g])},error(A){(0,s.assert)(A instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,E.postMessage({sourceName:p,targetName:x,stream:n.ERROR,streamId:g,reason:a(A)}))},sinkCapability:new s.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:h.desiredSize,ready:null};F.sinkCapability.resolve(),F.ready=F.sinkCapability.promise,this.streamSinks[g]=F,new Promise(function(A){A(P(h.data,F))}).then(function(){E.postMessage({sourceName:p,targetName:x,stream:n.START_COMPLETE,streamId:g,success:!0})},function(A){E.postMessage({sourceName:p,targetName:x,stream:n.START_COMPLETE,streamId:g,reason:a(A)})})},zr=function(h){const g=h.streamId,p=this.sourceName,x=h.sourceName,E=this.comObj,S=this.streamControllers[g],P=this.streamSinks[g];switch(h.stream){case n.START_COMPLETE:h.success?S.startCall.resolve():S.startCall.reject(a(h.reason));break;case n.PULL_COMPLETE:h.success?S.pullCall.resolve():S.pullCall.reject(a(h.reason));break;case n.PULL:if(!P){E.postMessage({sourceName:p,targetName:x,stream:n.PULL_COMPLETE,streamId:g,success:!0});break}P.desiredSize<=0&&h.desiredSize>0&&P.sinkCapability.resolve(),P.desiredSize=h.desiredSize,new Promise(function(F){var A;F((A=P.onPull)==null?void 0:A.call(P))}).then(function(){E.postMessage({sourceName:p,targetName:x,stream:n.PULL_COMPLETE,streamId:g,success:!0})},function(F){E.postMessage({sourceName:p,targetName:x,stream:n.PULL_COMPLETE,streamId:g,reason:a(F)})});break;case n.ENQUEUE:if((0,s.assert)(S,"enqueue should have stream controller"),S.isClosed)break;S.controller.enqueue(h.chunk);break;case n.CLOSE:if((0,s.assert)(S,"close should have stream controller"),S.isClosed)break;S.isClosed=!0,S.controller.close(),ce(this,d,Lt).call(this,S,g);break;case n.ERROR:(0,s.assert)(S,"error should have stream controller"),S.controller.error(a(h.reason)),ce(this,d,Lt).call(this,S,g);break;case n.CANCEL_COMPLETE:h.success?S.cancelCall.resolve():S.cancelCall.reject(a(h.reason)),ce(this,d,Lt).call(this,S,g);break;case n.CANCEL:if(!P)break;new Promise(function(F){var A;F((A=P.onCancel)==null?void 0:A.call(P,a(h.reason)))}).then(function(){E.postMessage({sourceName:p,targetName:x,stream:n.CANCEL_COMPLETE,streamId:g,success:!0})},function(F){E.postMessage({sourceName:p,targetName:x,stream:n.CANCEL_COMPLETE,streamId:g,reason:a(F)})}),P.sinkCapability.reject(a(h.reason)),P.isCancelled=!0,delete this.streamSinks[g];break;default:throw new Error("Unexpected stream case")}},Lt=async function(h,g){var p,x,E;await Promise.allSettled([(p=h.startCall)==null?void 0:p.promise,(x=h.pullCall)==null?void 0:x.promise,(E=h.cancelCall)==null?void 0:E.promise]),delete this.streamControllers[g]},t.MessageHandler=o},(e,t,r)=>{var n,a;Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var s=r(1);class i{constructor({parsedData:d,rawData:l}){_e(this,n);_e(this,a);Ee(this,n,d),Ee(this,a,l)}getRaw(){return y(this,a)}get(d){return y(this,n).get(d)??null}getAll(){return(0,s.objectFromMap)(y(this,n))}has(d){return y(this,n).has(d)}}n=new WeakMap,a=new WeakMap,t.Metadata=i},(e,t,r)=>{var d,l,c,f,u,h,ur;Object.defineProperty(t,"__esModule",{value:!0}),t.OptionalContentConfig=void 0;var s=r(1),i=r(8);const n=Symbol("INTERNAL");class a{constructor(x,E){_e(this,d,!0);this.name=x,this.intent=E}get visible(){return y(this,d)}_setVisible(x,E){x!==n&&(0,s.unreachable)("Internal method `_setVisible` called."),Ee(this,d,E)}}d=new WeakMap;class o{constructor(x){_e(this,h);_e(this,l,null);_e(this,c,new Map);_e(this,f,null);_e(this,u,null);if(this.name=null,this.creator=null,x!==null){this.name=x.name,this.creator=x.creator,Ee(this,u,x.order);for(const E of x.groups)y(this,c).set(E.id,new a(E.name,E.intent));if(x.baseState==="OFF")for(const E of y(this,c).values())E._setVisible(n,!1);for(const E of x.on)y(this,c).get(E)._setVisible(n,!0);for(const E of x.off)y(this,c).get(E)._setVisible(n,!1);Ee(this,f,this.getHash())}}isVisible(x){if(y(this,c).size===0)return!0;if(!x)return(0,s.warn)("Optional content group not defined."),!0;if(x.type==="OCG")return y(this,c).has(x.id)?y(this,c).get(x.id).visible:((0,s.warn)(`Optional content group not found: ${x.id}`),!0);if(x.type==="OCMD"){if(x.expression)return ce(this,h,ur).call(this,x.expression);if(!x.policy||x.policy==="AnyOn"){for(const E of x.ids){if(!y(this,c).has(E))return(0,s.warn)(`Optional content group not found: ${E}`),!0;if(y(this,c).get(E).visible)return!0}return!1}else if(x.policy==="AllOn"){for(const E of x.ids){if(!y(this,c).has(E))return(0,s.warn)(`Optional content group not found: ${E}`),!0;if(!y(this,c).get(E).visible)return!1}return!0}else if(x.policy==="AnyOff"){for(const E of x.ids){if(!y(this,c).has(E))return(0,s.warn)(`Optional content group not found: ${E}`),!0;if(!y(this,c).get(E).visible)return!0}return!1}else if(x.policy==="AllOff"){for(const E of x.ids){if(!y(this,c).has(E))return(0,s.warn)(`Optional content group not found: ${E}`),!0;if(y(this,c).get(E).visible)return!1}return!0}return(0,s.warn)(`Unknown optional content policy ${x.policy}.`),!0}return(0,s.warn)(`Unknown group type ${x.type}.`),!0}setVisibility(x,E=!0){if(!y(this,c).has(x)){(0,s.warn)(`Optional content group not found: ${x}`);return}y(this,c).get(x)._setVisible(n,!!E),Ee(this,l,null)}get hasInitialVisibility(){return y(this,f)===null||this.getHash()===y(this,f)}getOrder(){return y(this,c).size?y(this,u)?y(this,u).slice():[...y(this,c).keys()]:null}getGroups(){return y(this,c).size>0?(0,s.objectFromMap)(y(this,c)):null}getGroup(x){return y(this,c).get(x)||null}getHash(){if(y(this,l)!==null)return y(this,l);const x=new i.MurmurHash3_64;for(const[E,S]of y(this,c))x.update(`${E}:${S.visible}`);return Ee(this,l,x.hexdigest())}}l=new WeakMap,c=new WeakMap,f=new WeakMap,u=new WeakMap,h=new WeakSet,ur=function(x){const E=x.length;if(E<2)return!0;const S=x[0];for(let P=1;P<E;P++){const F=x[P];let A;if(Array.isArray(F))A=ce(this,h,ur).call(this,F);else if(y(this,c).has(F))A=y(this,c).get(F).visible;else return(0,s.warn)(`Optional content group not found: ${F}`),!0;switch(S){case"And":if(!A)return!1;break;case"Or":if(A)return!0;break;case"Not":return!A;default:return!0}}return S==="And"},t.OptionalContentConfig=o},(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var s=r(1),i=r(6);class n{constructor({length:l,initialData:c,progressiveDone:f=!1,contentDispositionFilename:u=null,disableRange:h=!1,disableStream:g=!1},p){if((0,s.assert)(p,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=f,this._contentDispositionFilename=u,(c==null?void 0:c.length)>0){const x=c instanceof Uint8Array&&c.byteLength===c.buffer.byteLength?c.buffer:new Uint8Array(c).buffer;this._queuedChunks.push(x)}this._pdfDataRangeTransport=p,this._isStreamingSupported=!g,this._isRangeSupported=!h,this._contentLength=l,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((x,E)=>{this._onReceiveData({begin:x,chunk:E})}),this._pdfDataRangeTransport.addProgressListener((x,E)=>{this._onProgress({loaded:x,total:E})}),this._pdfDataRangeTransport.addProgressiveReadListener(x=>{this._onReceiveData({chunk:x})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:l,chunk:c}){const f=c instanceof Uint8Array&&c.byteLength===c.buffer.byteLength?c.buffer:new Uint8Array(c).buffer;if(l===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(f):this._queuedChunks.push(f);else{const u=this._rangeReaders.some(function(h){return h._begin!==l?!1:(h._enqueue(f),!0)});(0,s.assert)(u,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var l;return((l=this._fullRequestReader)==null?void 0:l._loaded)??0}_onProgress(l){var c,f,u,h;l.total===void 0?(f=(c=this._rangeReaders[0])==null?void 0:c.onProgress)==null||f.call(c,{loaded:l.loaded}):(h=(u=this._fullRequestReader)==null?void 0:u.onProgress)==null||h.call(u,{loaded:l.loaded,total:l.total})}_onProgressiveDone(){var l;(l=this._fullRequestReader)==null||l.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(l){const c=this._rangeReaders.indexOf(l);c>=0&&this._rangeReaders.splice(c,1)}getFullReader(){(0,s.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const l=this._queuedChunks;return this._queuedChunks=null,new a(this,l,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(l,c){if(c<=this._progressiveDataLength)return null;const f=new o(this,l,c);return this._pdfDataRangeTransport.requestDataRange(l,c),this._rangeReaders.push(f),f}cancelAllRequests(l){var c;(c=this._fullRequestReader)==null||c.cancel(l);for(const f of this._rangeReaders.slice(0))f.cancel(l);this._pdfDataRangeTransport.abort()}}t.PDFDataTransportStream=n;class a{constructor(l,c,f=!1,u=null){this._stream=l,this._done=f||!1,this._filename=(0,i.isPdfFile)(u)?u:null,this._queuedChunks=c||[],this._loaded=0;for(const h of this._queuedChunks)this._loaded+=h.byteLength;this._requests=[],this._headersReady=Promise.resolve(),l._fullRequestReader=this,this.onProgress=null}_enqueue(l){this._done||(this._requests.length>0?this._requests.shift().resolve({value:l,done:!1}):this._queuedChunks.push(l),this._loaded+=l.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const l=new s.PromiseCapability;return this._requests.push(l),l.promise}cancel(l){this._done=!0;for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class o{constructor(l,c,f){this._stream=l,this._begin=c,this._end=f,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(l){if(!this._done){if(this._requests.length===0)this._queuedChunk=l;else{this._requests.shift().resolve({value:l,done:!1});for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const c=this._queuedChunk;return this._queuedChunk=null,{value:c,done:!1}}if(this._done)return{value:void 0,done:!0};const l=new s.PromiseCapability;return this._requests.push(l),l.promise}cancel(l){this._done=!0;for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var s=r(1),i=r(20);function n(f,u,h){return{method:"GET",headers:f,signal:h.signal,mode:"cors",credentials:u?"include":"same-origin",redirect:"follow"}}function a(f){const u=new Headers;for(const h in f){const g=f[h];g!==void 0&&u.append(h,g)}return u}function o(f){return f instanceof Uint8Array?f.buffer:f instanceof ArrayBuffer?f:((0,s.warn)(`getArrayBuffer - unexpected data format: ${f}`),new Uint8Array(f).buffer)}class d{constructor(u){this.source=u,this.isHttp=/^https?:/i.test(u.url),this.httpHeaders=this.isHttp&&u.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var u;return((u=this._fullRequestReader)==null?void 0:u._loaded)??0}getFullReader(){return(0,s.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new l(this),this._fullRequestReader}getRangeReader(u,h){if(h<=this._progressiveDataLength)return null;const g=new c(this,u,h);return this._rangeRequestReaders.push(g),g}cancelAllRequests(u){var h;(h=this._fullRequestReader)==null||h.cancel(u);for(const g of this._rangeRequestReaders.slice(0))g.cancel(u)}}t.PDFFetchStream=d;class l{constructor(u){this._stream=u,this._reader=null,this._loaded=0,this._filename=null;const h=u.source;this._withCredentials=h.withCredentials||!1,this._contentLength=h.length,this._headersCapability=new s.PromiseCapability,this._disableRange=h.disableRange||!1,this._rangeChunkSize=h.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!h.disableStream,this._isRangeSupported=!h.disableRange,this._headers=a(this._stream.httpHeaders);const g=h.url;fetch(g,n(this._headers,this._withCredentials,this._abortController)).then(p=>{if(!(0,i.validateResponseStatus)(p.status))throw(0,i.createResponseStatusError)(p.status,g);this._reader=p.body.getReader(),this._headersCapability.resolve();const x=P=>p.headers.get(P),{allowRangeRequests:E,suggestedLength:S}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=E,this._contentLength=S||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(x),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new s.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var g;await this._headersCapability.promise;const{value:u,done:h}=await this._reader.read();return h?{value:u,done:h}:(this._loaded+=u.byteLength,(g=this.onProgress)==null||g.call(this,{loaded:this._loaded,total:this._contentLength}),{value:o(u),done:!1})}cancel(u){var h;(h=this._reader)==null||h.cancel(u),this._abortController.abort()}}class c{constructor(u,h,g){this._stream=u,this._reader=null,this._loaded=0;const p=u.source;this._withCredentials=p.withCredentials||!1,this._readCapability=new s.PromiseCapability,this._isStreamingSupported=!p.disableStream,this._abortController=new AbortController,this._headers=a(this._stream.httpHeaders),this._headers.append("Range",`bytes=${h}-${g-1}`);const x=p.url;fetch(x,n(this._headers,this._withCredentials,this._abortController)).then(E=>{if(!(0,i.validateResponseStatus)(E.status))throw(0,i.createResponseStatusError)(E.status,x);this._readCapability.resolve(),this._reader=E.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var g;await this._readCapability.promise;const{value:u,done:h}=await this._reader.read();return h?{value:u,done:h}:(this._loaded+=u.byteLength,(g=this.onProgress)==null||g.call(this,{loaded:this._loaded}),{value:o(u),done:!1})}cancel(u){var h;(h=this._reader)==null||h.cancel(u),this._abortController.abort()}}},(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=d,t.extractFilenameFromHeader=o,t.validateRangeRequestCapabilities=a,t.validateResponseStatus=l;var s=r(1),i=r(21),n=r(6);function a({getResponseHeader:c,isHttp:f,rangeChunkSize:u,disableRange:h}){const g={allowRangeRequests:!1,suggestedLength:void 0},p=parseInt(c("Content-Length"),10);return!Number.isInteger(p)||(g.suggestedLength=p,p<=2*u)||h||!f||c("Accept-Ranges")!=="bytes"||(c("Content-Encoding")||"identity")!=="identity"||(g.allowRangeRequests=!0),g}function o(c){const f=c("Content-Disposition");if(f){let u=(0,i.getFilenameFromContentDispositionHeader)(f);if(u.includes("%"))try{u=decodeURIComponent(u)}catch{}if((0,n.isPdfFile)(u))return u}return null}function d(c,f){return c===404||c===0&&f.startsWith("file:")?new s.MissingPDFException('Missing PDF "'+f+'".'):new s.UnexpectedResponseException(`Unexpected server response (${c}) while retrieving PDF "${f}".`,c)}function l(c){return c===200||c===206}},(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=i;var s=r(1);function i(n){let a=!0,o=d("filename\\*","i").exec(n);if(o){o=o[1];let p=u(o);return p=unescape(p),p=h(p),p=g(p),c(p)}if(o=f(n),o){const p=g(o);return c(p)}if(o=d("filename","i").exec(n),o){o=o[1];let p=u(o);return p=g(p),c(p)}function d(p,x){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',x)}function l(p,x){if(p){if(!/^[\x00-\xFF]+$/.test(x))return x;try{const E=new TextDecoder(p,{fatal:!0}),S=(0,s.stringToBytes)(x);x=E.decode(S),a=!1}catch{}}return x}function c(p){return a&&/[\x80-\xff]/.test(p)&&(p=l("utf-8",p),a&&(p=l("iso-8859-1",p))),p}function f(p){const x=[];let E;const S=d("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(E=S.exec(p))!==null;){let[,F,A,C]=E;if(F=parseInt(F,10),F in x){if(F===0)break;continue}x[F]=[A,C]}const P=[];for(let F=0;F<x.length&&F in x;++F){let[A,C]=x[F];C=u(C),A&&(C=unescape(C),F===0&&(C=h(C))),P.push(C)}return P.join("")}function u(p){if(p.startsWith('"')){const x=p.slice(1).split('\\"');for(let E=0;E<x.length;++E){const S=x[E].indexOf('"');S!==-1&&(x[E]=x[E].slice(0,S),x.length=E+1),x[E]=x[E].replaceAll(/\\(.)/g,"$1")}p=x.join('"')}return p}function h(p){const x=p.indexOf("'");if(x===-1)return p;const E=p.slice(0,x),P=p.slice(x+1).replace(/^[^']*'/,"");return l(E,P)}function g(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(x,E,S,P){if(S==="q"||S==="Q")return P=P.replaceAll("_"," "),P=P.replaceAll(/=([0-9a-fA-F]{2})/g,function(F,A){return String.fromCharCode(parseInt(A,16))}),l(E,P);try{P=atob(P)}catch{}return l(E,P)})}return""}},(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var s=r(1),i=r(20);const n=200,a=206;function o(u){const h=u.response;return typeof h!="string"?h:(0,s.stringToBytes)(h).buffer}class d{constructor(h,g={}){this.url=h,this.isHttp=/^https?:/i.test(h),this.httpHeaders=this.isHttp&&g.httpHeaders||Object.create(null),this.withCredentials=g.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(h,g,p){const x={begin:h,end:g};for(const E in p)x[E]=p[E];return this.request(x)}requestFull(h){return this.request(h)}request(h){const g=new XMLHttpRequest,p=this.currXhrId++,x=this.pendingRequests[p]={xhr:g};g.open("GET",this.url),g.withCredentials=this.withCredentials;for(const E in this.httpHeaders){const S=this.httpHeaders[E];S!==void 0&&g.setRequestHeader(E,S)}return this.isHttp&&"begin"in h&&"end"in h?(g.setRequestHeader("Range",`bytes=${h.begin}-${h.end-1}`),x.expectedStatus=a):x.expectedStatus=n,g.responseType="arraybuffer",h.onError&&(g.onerror=function(E){h.onError(g.status)}),g.onreadystatechange=this.onStateChange.bind(this,p),g.onprogress=this.onProgress.bind(this,p),x.onHeadersReceived=h.onHeadersReceived,x.onDone=h.onDone,x.onError=h.onError,x.onProgress=h.onProgress,g.send(null),p}onProgress(h,g){var x;const p=this.pendingRequests[h];p&&((x=p.onProgress)==null||x.call(p,g))}onStateChange(h,g){var F,A,C;const p=this.pendingRequests[h];if(!p)return;const x=p.xhr;if(x.readyState>=2&&p.onHeadersReceived&&(p.onHeadersReceived(),delete p.onHeadersReceived),x.readyState!==4||!(h in this.pendingRequests))return;if(delete this.pendingRequests[h],x.status===0&&this.isHttp){(F=p.onError)==null||F.call(p,x.status);return}const E=x.status||n;if(!(E===n&&p.expectedStatus===a)&&E!==p.expectedStatus){(A=p.onError)==null||A.call(p,x.status);return}const P=o(x);if(E===a){const _=x.getResponseHeader("Content-Range"),w=/bytes (\d+)-(\d+)\/(\d+)/.exec(_);p.onDone({begin:parseInt(w[1],10),chunk:P})}else P?p.onDone({begin:0,chunk:P}):(C=p.onError)==null||C.call(p,x.status)}getRequestXhr(h){return this.pendingRequests[h].xhr}isPendingRequest(h){return h in this.pendingRequests}abortRequest(h){const g=this.pendingRequests[h].xhr;delete this.pendingRequests[h],g.abort()}}class l{constructor(h){this._source=h,this._manager=new d(h.url,{httpHeaders:h.httpHeaders,withCredentials:h.withCredentials}),this._rangeChunkSize=h.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(h){const g=this._rangeRequestReaders.indexOf(h);g>=0&&this._rangeRequestReaders.splice(g,1)}getFullReader(){return(0,s.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new c(this._manager,this._source),this._fullRequestReader}getRangeReader(h,g){const p=new f(this._manager,h,g);return p.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(p),p}cancelAllRequests(h){var g;(g=this._fullRequestReader)==null||g.cancel(h);for(const p of this._rangeRequestReaders.slice(0))p.cancel(h)}}t.PDFNetworkStream=l;class c{constructor(h,g){this._manager=h;const p={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=g.url,this._fullRequestId=h.requestFull(p),this._headersReceivedCapability=new s.PromiseCapability,this._disableRange=g.disableRange||!1,this._contentLength=g.length,this._rangeChunkSize=g.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const h=this._fullRequestId,g=this._manager.getRequestXhr(h),p=S=>g.getResponseHeader(S),{allowRangeRequests:x,suggestedLength:E}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:p,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});x&&(this._isRangeSupported=!0),this._contentLength=E||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(p),this._isRangeSupported&&this._manager.abortRequest(h),this._headersReceivedCapability.resolve()}_onDone(h){if(h&&(this._requests.length>0?this._requests.shift().resolve({value:h.chunk,done:!1}):this._cachedChunks.push(h.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(h){this._storedError=(0,i.createResponseStatusError)(h,this._url),this._headersReceivedCapability.reject(this._storedError);for(const g of this._requests)g.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(h){var g;(g=this.onProgress)==null||g.call(this,{loaded:h.loaded,total:h.lengthComputable?h.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const h=new s.PromiseCapability;return this._requests.push(h),h.promise}cancel(h){this._done=!0,this._headersReceivedCapability.reject(h);for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class f{constructor(h,g,p){this._manager=h;const x={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=h.url,this._requestId=h.requestRange(g,p,x),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var h;(h=this.onClosed)==null||h.call(this,this)}_onDone(h){const g=h.chunk;this._requests.length>0?this._requests.shift().resolve({value:g,done:!1}):this._queuedChunk=g,this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(h){this._storedError=(0,i.createResponseStatusError)(h,this._url);for(const g of this._requests)g.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(h){var g;this.isStreamingSupported||(g=this.onProgress)==null||g.call(this,{loaded:h.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const g=this._queuedChunk;return this._queuedChunk=null,{value:g,done:!1}}if(this._done)return{value:void 0,done:!0};const h=new s.PromiseCapability;return this._requests.push(h),h.promise}cancel(h){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var s=r(1),i=r(20);const n=/^file:\/\/\/[a-zA-Z]:\//;function a(p){const x=require$$5,E=x.parse(p);return E.protocol==="file:"||E.host?E:/^[a-z]:[/\\]/i.test(p)?x.parse(`file:///${p}`):(E.host||(E.protocol="file:"),E)}class o{constructor(x){this.source=x,this.url=a(x.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&x.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var x;return((x=this._fullRequestReader)==null?void 0:x._loaded)??0}getFullReader(){return(0,s.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new h(this):new f(this),this._fullRequestReader}getRangeReader(x,E){if(E<=this._progressiveDataLength)return null;const S=this.isFsUrl?new g(this,x,E):new u(this,x,E);return this._rangeRequestReaders.push(S),S}cancelAllRequests(x){var E;(E=this._fullRequestReader)==null||E.cancel(x);for(const S of this._rangeRequestReaders.slice(0))S.cancel(x)}}t.PDFNodeStream=o;class d{constructor(x){this._url=x.url,this._done=!1,this._storedError=null,this.onProgress=null;const E=x.source;this._contentLength=E.length,this._loaded=0,this._filename=null,this._disableRange=E.disableRange||!1,this._rangeChunkSize=E.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!E.disableStream,this._isRangeSupported=!E.disableRange,this._readableStream=null,this._readCapability=new s.PromiseCapability,this._headersCapability=new s.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var S;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const x=this._readableStream.read();return x===null?(this._readCapability=new s.PromiseCapability,this.read()):(this._loaded+=x.length,(S=this.onProgress)==null||S.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(x).buffer,done:!1})}cancel(x){if(!this._readableStream){this._error(x);return}this._readableStream.destroy(x)}_error(x){this._storedError=x,this._readCapability.resolve()}_setReadableStream(x){this._readableStream=x,x.on("readable",()=>{this._readCapability.resolve()}),x.on("end",()=>{x.destroy(),this._done=!0,this._readCapability.resolve()}),x.on("error",E=>{this._error(E)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new s.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class l{constructor(x){this._url=x.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new s.PromiseCapability;const E=x.source;this._isStreamingSupported=!E.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var S;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const x=this._readableStream.read();return x===null?(this._readCapability=new s.PromiseCapability,this.read()):(this._loaded+=x.length,(S=this.onProgress)==null||S.call(this,{loaded:this._loaded}),{value:new Uint8Array(x).buffer,done:!1})}cancel(x){if(!this._readableStream){this._error(x);return}this._readableStream.destroy(x)}_error(x){this._storedError=x,this._readCapability.resolve()}_setReadableStream(x){this._readableStream=x,x.on("readable",()=>{this._readCapability.resolve()}),x.on("end",()=>{x.destroy(),this._done=!0,this._readCapability.resolve()}),x.on("error",E=>{this._error(E)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function c(p,x){return{protocol:p.protocol,auth:p.auth,host:p.hostname,port:p.port,path:p.path,method:"GET",headers:x}}class f extends d{constructor(x){super(x);const E=S=>{if(S.statusCode===404){const C=new s.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=C,this._headersCapability.reject(C);return}this._headersCapability.resolve(),this._setReadableStream(S);const P=C=>this._readableStream.headers[C.toLowerCase()],{allowRangeRequests:F,suggestedLength:A}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:P,isHttp:x.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=F,this._contentLength=A||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(P)};if(this._request=null,this._url.protocol==="http:"){const S=require$$5;this._request=S.request(c(this._url,x.httpHeaders),E)}else{const S=require$$5;this._request=S.request(c(this._url,x.httpHeaders),E)}this._request.on("error",S=>{this._storedError=S,this._headersCapability.reject(S)}),this._request.end()}}class u extends l{constructor(x,E,S){super(x),this._httpHeaders={};for(const F in x.httpHeaders){const A=x.httpHeaders[F];A!==void 0&&(this._httpHeaders[F]=A)}this._httpHeaders.Range=`bytes=${E}-${S-1}`;const P=F=>{if(F.statusCode===404){const A=new s.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=A;return}this._setReadableStream(F)};if(this._request=null,this._url.protocol==="http:"){const F=require$$5;this._request=F.request(c(this._url,this._httpHeaders),P)}else{const F=require$$5;this._request=F.request(c(this._url,this._httpHeaders),P)}this._request.on("error",F=>{this._storedError=F}),this._request.end()}}class h extends d{constructor(x){super(x);let E=decodeURIComponent(this._url.path);n.test(this._url.href)&&(E=E.replace(/^\//,""));const S=require$$5;S.lstat(E,(P,F)=>{if(P){P.code==="ENOENT"&&(P=new s.MissingPDFException(`Missing PDF "${E}".`)),this._storedError=P,this._headersCapability.reject(P);return}this._contentLength=F.size,this._setReadableStream(S.createReadStream(E)),this._headersCapability.resolve()})}}class g extends l{constructor(x,E,S){super(x);let P=decodeURIComponent(this._url.path);n.test(this._url.href)&&(P=P.replace(/^\//,""));const F=require$$5;this._setReadableStream(F.createReadStream(P,{start:E,end:S-1}))}}},(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var s=r(6),i=r(1);const n={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},a="http://www.w3.org/XML/1998/namespace",o="http://www.w3.org/1999/xlink",d=["butt","round","square"],l=["miter","round","bevel"],c=function(F,A="",C=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!C)return URL.createObjectURL(new Blob([F],{type:A}));const _="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let w=`data:${A};base64,`;for(let T=0,M=F.length;T<M;T+=3){const R=F[T]&255,k=F[T+1]&255,L=F[T+2]&255,ae=R>>2,Q=(R&3)<<4|k>>4,oe=T+1<M?(k&15)<<2|L>>6:64,re=T+2<M?L&63:64;w+=_[ae]+_[Q]+_[oe]+_[re]}return w},f=function(){const F=new Uint8Array([137,80,78,71,13,10,26,10]),A=12,C=new Int32Array(256);for(let L=0;L<256;L++){let ae=L;for(let Q=0;Q<8;Q++)ae=ae&1?3988292384^ae>>1&2147483647:ae>>1&2147483647;C[L]=ae}function _(L,ae,Q){let oe=-1;for(let re=ae;re<Q;re++){const me=(oe^L[re])&255,H=C[me];oe=oe>>>8^H}return oe^-1}function w(L,ae,Q,oe){let re=oe;const me=ae.length;Q[re]=me>>24&255,Q[re+1]=me>>16&255,Q[re+2]=me>>8&255,Q[re+3]=me&255,re+=4,Q[re]=L.charCodeAt(0)&255,Q[re+1]=L.charCodeAt(1)&255,Q[re+2]=L.charCodeAt(2)&255,Q[re+3]=L.charCodeAt(3)&255,re+=4,Q.set(ae,re),re+=ae.length;const H=_(Q,oe+4,re);Q[re]=H>>24&255,Q[re+1]=H>>16&255,Q[re+2]=H>>8&255,Q[re+3]=H&255}function T(L,ae,Q){let oe=1,re=0;for(let me=ae;me<Q;++me)oe=(oe+(L[me]&255))%65521,re=(re+oe)%65521;return re<<16|oe}function M(L){if(!i.isNodeJS)return R(L);try{const ae=parseInt(process.versions.node)>=8?L:Buffer.from(L),Q=require$$5.deflateSync(ae,{level:9});return Q instanceof Uint8Array?Q:new Uint8Array(Q)}catch(ae){(0,i.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+ae)}return R(L)}function R(L){let ae=L.length;const Q=65535,oe=Math.ceil(ae/Q),re=new Uint8Array(2+ae+oe*5+4);let me=0;re[me++]=120,re[me++]=156;let H=0;for(;ae>Q;)re[me++]=0,re[me++]=255,re[me++]=255,re[me++]=0,re[me++]=0,re.set(L.subarray(H,H+Q),me),me+=Q,H+=Q,ae-=Q;re[me++]=1,re[me++]=ae&255,re[me++]=ae>>8&255,re[me++]=~ae&65535&255,re[me++]=(~ae&65535)>>8&255,re.set(L.subarray(H),me),me+=L.length-H;const ie=T(L,0,L.length);return re[me++]=ie>>24&255,re[me++]=ie>>16&255,re[me++]=ie>>8&255,re[me++]=ie&255,re}function k(L,ae,Q,oe){const re=L.width,me=L.height;let H,ie,le;const N=L.data;switch(ae){case i.ImageKind.GRAYSCALE_1BPP:ie=0,H=1,le=re+7>>3;break;case i.ImageKind.RGB_24BPP:ie=2,H=8,le=re*3;break;case i.ImageKind.RGBA_32BPP:ie=6,H=8,le=re*4;break;default:throw new Error("invalid format")}const b=new Uint8Array((1+le)*me);let v=0,j=0;for(let ve=0;ve<me;++ve)b[v++]=0,b.set(N.subarray(j,j+le),v),j+=le,v+=le;if(ae===i.ImageKind.GRAYSCALE_1BPP&&oe){v=0;for(let ve=0;ve<me;ve++){v++;for(let xe=0;xe<le;xe++)b[v++]^=255}}const D=new Uint8Array([re>>24&255,re>>16&255,re>>8&255,re&255,me>>24&255,me>>16&255,me>>8&255,me&255,H,ie,0,0,0]),U=M(b),W=F.length+A*3+D.length+U.length,Z=new Uint8Array(W);let te=0;return Z.set(F,te),te+=F.length,w("IHDR",D,Z,te),te+=A+D.length,w("IDATA",U,Z,te),te+=A+U.length,w("IEND",new Uint8Array(0),Z,te),c(Z,"image/png",Q)}return function(ae,Q,oe){const re=ae.kind===void 0?i.ImageKind.GRAYSCALE_1BPP:ae.kind;return k(ae,re,Q,oe)}}();class u{constructor(){this.fontSizeScale=1,this.fontWeight=n.fontWeight,this.fontSize=0,this.textMatrix=i.IDENTITY_MATRIX,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=i.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=n.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(A,C){this.x=A,this.y=C}}function h(F){let A=[];const C=[];for(const _ of F){if(_.fn==="save"){A.push({fnId:92,fn:"group",items:[]}),C.push(A),A=A.at(-1).items;continue}_.fn==="restore"?A=C.pop():A.push(_)}return A}function g(F){if(Number.isInteger(F))return F.toString();const A=F.toFixed(10);let C=A.length-1;if(A[C]!=="0")return A;do C--;while(A[C]==="0");return A.substring(0,A[C]==="."?C:C+1)}function p(F){if(F[4]===0&&F[5]===0){if(F[1]===0&&F[2]===0)return F[0]===1&&F[3]===1?"":`scale(${g(F[0])} ${g(F[3])})`;if(F[0]===F[3]&&F[1]===-F[2]){const A=Math.acos(F[0])*180/Math.PI;return`rotate(${g(A)})`}}else if(F[0]===1&&F[1]===0&&F[2]===0&&F[3]===1)return`translate(${g(F[4])} ${g(F[5])})`;return`matrix(${g(F[0])} ${g(F[1])} ${g(F[2])} ${g(F[3])} ${g(F[4])} ${g(F[5])})`}let x=0,E=0,S=0;class P{constructor(A,C,_=!1){(0,s.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new s.DOMSVGFactory,this.current=new u,this.transformMatrix=i.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=A,this.objs=C,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!_,this._operatorIdMapping=[];for(const w in i.OPS)this._operatorIdMapping[i.OPS[w]]=w}getObject(A,C=null){return typeof A=="string"?A.startsWith("g_")?this.commonObjs.get(A):this.objs.get(A):C}save(){this.transformStack.push(this.transformMatrix);const A=this.current;this.extraStack.push(A),this.current=A.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(A){this.save(),this.executeOpTree(A),this.restore()}loadDependencies(A){const C=A.fnArray,_=A.argsArray;for(let w=0,T=C.length;w<T;w++)if(C[w]===i.OPS.dependency)for(const M of _[w]){const R=M.startsWith("g_")?this.commonObjs:this.objs,k=new Promise(L=>{R.get(M,L)});this.current.dependencies.push(k)}return Promise.all(this.current.dependencies)}transform(A,C,_,w,T,M){const R=[A,C,_,w,T,M];this.transformMatrix=i.Util.transform(this.transformMatrix,R),this.tgrp=null}getSVG(A,C){this.viewport=C;const _=this._initialize(C);return this.loadDependencies(A).then(()=>(this.transformMatrix=i.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(A)),_))}convertOpList(A){const C=this._operatorIdMapping,_=A.argsArray,w=A.fnArray,T=[];for(let M=0,R=w.length;M<R;M++){const k=w[M];T.push({fnId:k,fn:C[k],args:_[M]})}return h(T)}executeOpTree(A){for(const C of A){const _=C.fn,w=C.fnId,T=C.args;switch(w|0){case i.OPS.beginText:this.beginText();break;case i.OPS.dependency:break;case i.OPS.setLeading:this.setLeading(T);break;case i.OPS.setLeadingMoveText:this.setLeadingMoveText(T[0],T[1]);break;case i.OPS.setFont:this.setFont(T);break;case i.OPS.showText:this.showText(T[0]);break;case i.OPS.showSpacedText:this.showText(T[0]);break;case i.OPS.endText:this.endText();break;case i.OPS.moveText:this.moveText(T[0],T[1]);break;case i.OPS.setCharSpacing:this.setCharSpacing(T[0]);break;case i.OPS.setWordSpacing:this.setWordSpacing(T[0]);break;case i.OPS.setHScale:this.setHScale(T[0]);break;case i.OPS.setTextMatrix:this.setTextMatrix(T[0],T[1],T[2],T[3],T[4],T[5]);break;case i.OPS.setTextRise:this.setTextRise(T[0]);break;case i.OPS.setTextRenderingMode:this.setTextRenderingMode(T[0]);break;case i.OPS.setLineWidth:this.setLineWidth(T[0]);break;case i.OPS.setLineJoin:this.setLineJoin(T[0]);break;case i.OPS.setLineCap:this.setLineCap(T[0]);break;case i.OPS.setMiterLimit:this.setMiterLimit(T[0]);break;case i.OPS.setFillRGBColor:this.setFillRGBColor(T[0],T[1],T[2]);break;case i.OPS.setStrokeRGBColor:this.setStrokeRGBColor(T[0],T[1],T[2]);break;case i.OPS.setStrokeColorN:this.setStrokeColorN(T);break;case i.OPS.setFillColorN:this.setFillColorN(T);break;case i.OPS.shadingFill:this.shadingFill(T[0]);break;case i.OPS.setDash:this.setDash(T[0],T[1]);break;case i.OPS.setRenderingIntent:this.setRenderingIntent(T[0]);break;case i.OPS.setFlatness:this.setFlatness(T[0]);break;case i.OPS.setGState:this.setGState(T[0]);break;case i.OPS.fill:this.fill();break;case i.OPS.eoFill:this.eoFill();break;case i.OPS.stroke:this.stroke();break;case i.OPS.fillStroke:this.fillStroke();break;case i.OPS.eoFillStroke:this.eoFillStroke();break;case i.OPS.clip:this.clip("nonzero");break;case i.OPS.eoClip:this.clip("evenodd");break;case i.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case i.OPS.paintImageXObject:this.paintImageXObject(T[0]);break;case i.OPS.paintInlineImageXObject:this.paintInlineImageXObject(T[0]);break;case i.OPS.paintImageMaskXObject:this.paintImageMaskXObject(T[0]);break;case i.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(T[0],T[1]);break;case i.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case i.OPS.closePath:this.closePath();break;case i.OPS.closeStroke:this.closeStroke();break;case i.OPS.closeFillStroke:this.closeFillStroke();break;case i.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case i.OPS.nextLine:this.nextLine();break;case i.OPS.transform:this.transform(T[0],T[1],T[2],T[3],T[4],T[5]);break;case i.OPS.constructPath:this.constructPath(T[0],T[1]);break;case i.OPS.endPath:this.endPath();break;case 92:this.group(C.items);break;default:(0,i.warn)(`Unimplemented operator ${_}`);break}}}setWordSpacing(A){this.current.wordSpacing=A}setCharSpacing(A){this.current.charSpacing=A}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(A,C,_,w,T,M){const R=this.current;R.textMatrix=R.lineMatrix=[A,C,_,w,T,M],R.textMatrixScale=Math.hypot(A,C),R.x=R.lineX=0,R.y=R.lineY=0,R.xcoords=[],R.ycoords=[],R.tspan=this.svgFactory.createElement("svg:tspan"),R.tspan.setAttributeNS(null,"font-family",R.fontFamily),R.tspan.setAttributeNS(null,"font-size",`${g(R.fontSize)}px`),R.tspan.setAttributeNS(null,"y",g(-R.y)),R.txtElement=this.svgFactory.createElement("svg:text"),R.txtElement.append(R.tspan)}beginText(){const A=this.current;A.x=A.lineX=0,A.y=A.lineY=0,A.textMatrix=i.IDENTITY_MATRIX,A.lineMatrix=i.IDENTITY_MATRIX,A.textMatrixScale=1,A.tspan=this.svgFactory.createElement("svg:tspan"),A.txtElement=this.svgFactory.createElement("svg:text"),A.txtgrp=this.svgFactory.createElement("svg:g"),A.xcoords=[],A.ycoords=[]}moveText(A,C){const _=this.current;_.x=_.lineX+=A,_.y=_.lineY+=C,_.xcoords=[],_.ycoords=[],_.tspan=this.svgFactory.createElement("svg:tspan"),_.tspan.setAttributeNS(null,"font-family",_.fontFamily),_.tspan.setAttributeNS(null,"font-size",`${g(_.fontSize)}px`),_.tspan.setAttributeNS(null,"y",g(-_.y))}showText(A){const C=this.current,_=C.font,w=C.fontSize;if(w===0)return;const T=C.fontSizeScale,M=C.charSpacing,R=C.wordSpacing,k=C.fontDirection,L=C.textHScale*k,ae=_.vertical,Q=ae?1:-1,oe=_.defaultVMetrics,re=w*C.fontMatrix[0];let me=0;for(const le of A){if(le===null){me+=k*R;continue}else if(typeof le=="number"){me+=Q*le*w/1e3;continue}const N=(le.isSpace?R:0)+M,b=le.fontChar;let v,j,D=le.width;if(ae){let W;const Z=le.vmetric||oe;W=le.vmetric?Z[1]:D*.5,W=-W*re;const te=Z[2]*re;D=Z?-Z[0]:D,v=W/T,j=(me+te)/T}else v=me/T,j=0;(le.isInFont||_.missingFile)&&(C.xcoords.push(C.x+v),ae&&C.ycoords.push(-C.y+j),C.tspan.textContent+=b);const U=ae?D*re-N*k:D*re+N*k;me+=U}C.tspan.setAttributeNS(null,"x",C.xcoords.map(g).join(" ")),ae?C.tspan.setAttributeNS(null,"y",C.ycoords.map(g).join(" ")):C.tspan.setAttributeNS(null,"y",g(-C.y)),ae?C.y-=me:C.x+=me*L,C.tspan.setAttributeNS(null,"font-family",C.fontFamily),C.tspan.setAttributeNS(null,"font-size",`${g(C.fontSize)}px`),C.fontStyle!==n.fontStyle&&C.tspan.setAttributeNS(null,"font-style",C.fontStyle),C.fontWeight!==n.fontWeight&&C.tspan.setAttributeNS(null,"font-weight",C.fontWeight);const H=C.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;if(H===i.TextRenderingMode.FILL||H===i.TextRenderingMode.FILL_STROKE?(C.fillColor!==n.fillColor&&C.tspan.setAttributeNS(null,"fill",C.fillColor),C.fillAlpha<1&&C.tspan.setAttributeNS(null,"fill-opacity",C.fillAlpha)):C.textRenderingMode===i.TextRenderingMode.ADD_TO_PATH?C.tspan.setAttributeNS(null,"fill","transparent"):C.tspan.setAttributeNS(null,"fill","none"),H===i.TextRenderingMode.STROKE||H===i.TextRenderingMode.FILL_STROKE){const le=1/(C.textMatrixScale||1);this._setStrokeAttributes(C.tspan,le)}let ie=C.textMatrix;C.textRise!==0&&(ie=ie.slice(),ie[5]+=C.textRise),C.txtElement.setAttributeNS(null,"transform",`${p(ie)} scale(${g(L)}, -1)`),C.txtElement.setAttributeNS(a,"xml:space","preserve"),C.txtElement.append(C.tspan),C.txtgrp.append(C.txtElement),this._ensureTransformGroup().append(C.txtElement)}setLeadingMoveText(A,C){this.setLeading(-C),this.moveText(A,C)}addFontStyle(A){if(!A.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const C=c(A.data,A.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${A.loadedName}"; src: url(${C}); }
`}setFont(A){const C=this.current,_=this.commonObjs.get(A[0]);let w=A[1];C.font=_,this.embedFonts&&!_.missingFile&&!this.embeddedFonts[_.loadedName]&&(this.addFontStyle(_),this.embeddedFonts[_.loadedName]=_),C.fontMatrix=_.fontMatrix||i.FONT_IDENTITY_MATRIX;let T="normal";_.black?T="900":_.bold&&(T="bold");const M=_.italic?"italic":"normal";w<0?(w=-w,C.fontDirection=-1):C.fontDirection=1,C.fontSize=w,C.fontFamily=_.loadedName,C.fontWeight=T,C.fontStyle=M,C.tspan=this.svgFactory.createElement("svg:tspan"),C.tspan.setAttributeNS(null,"y",g(-C.y)),C.xcoords=[],C.ycoords=[]}endText(){var C;const A=this.current;A.textRenderingMode&i.TextRenderingMode.ADD_TO_PATH_FLAG&&((C=A.txtElement)!=null&&C.hasChildNodes())&&(A.element=A.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(A){A>0&&(this.current.lineWidth=A)}setLineCap(A){this.current.lineCap=d[A]}setLineJoin(A){this.current.lineJoin=l[A]}setMiterLimit(A){this.current.miterLimit=A}setStrokeAlpha(A){this.current.strokeAlpha=A}setStrokeRGBColor(A,C,_){this.current.strokeColor=i.Util.makeHexColor(A,C,_)}setFillAlpha(A){this.current.fillAlpha=A}setFillRGBColor(A,C,_){this.current.fillColor=i.Util.makeHexColor(A,C,_),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(A){this.current.strokeColor=this._makeColorN_Pattern(A)}setFillColorN(A){this.current.fillColor=this._makeColorN_Pattern(A)}shadingFill(A){const{width:C,height:_}=this.viewport,w=i.Util.inverseTransform(this.transformMatrix),[T,M,R,k]=i.Util.getAxialAlignedBoundingBox([0,0,C,_],w),L=this.svgFactory.createElement("svg:rect");L.setAttributeNS(null,"x",T),L.setAttributeNS(null,"y",M),L.setAttributeNS(null,"width",R-T),L.setAttributeNS(null,"height",k-M),L.setAttributeNS(null,"fill",this._makeShadingPattern(A)),this.current.fillAlpha<1&&L.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(L)}_makeColorN_Pattern(A){return A[0]==="TilingPattern"?this._makeTilingPattern(A):this._makeShadingPattern(A)}_makeTilingPattern(A){const C=A[1],_=A[2],w=A[3]||i.IDENTITY_MATRIX,[T,M,R,k]=A[4],L=A[5],ae=A[6],Q=A[7],oe=`shading${S++}`,[re,me,H,ie]=i.Util.normalizeRect([...i.Util.applyTransform([T,M],w),...i.Util.applyTransform([R,k],w)]),[le,N]=i.Util.singularValueDecompose2dScale(w),b=L*le,v=ae*N,j=this.svgFactory.createElement("svg:pattern");j.setAttributeNS(null,"id",oe),j.setAttributeNS(null,"patternUnits","userSpaceOnUse"),j.setAttributeNS(null,"width",b),j.setAttributeNS(null,"height",v),j.setAttributeNS(null,"x",`${re}`),j.setAttributeNS(null,"y",`${me}`);const D=this.svg,U=this.transformMatrix,W=this.current.fillColor,Z=this.current.strokeColor,te=this.svgFactory.create(H-re,ie-me);if(this.svg=te,this.transformMatrix=w,Q===2){const ve=i.Util.makeHexColor(...C);this.current.fillColor=ve,this.current.strokeColor=ve}return this.executeOpTree(this.convertOpList(_)),this.svg=D,this.transformMatrix=U,this.current.fillColor=W,this.current.strokeColor=Z,j.append(te.childNodes[0]),this.defs.append(j),`url(#${oe})`}_makeShadingPattern(A){switch(typeof A=="string"&&(A=this.objs.get(A)),A[0]){case"RadialAxial":const C=`shading${S++}`,_=A[3];let w;switch(A[1]){case"axial":const T=A[4],M=A[5];w=this.svgFactory.createElement("svg:linearGradient"),w.setAttributeNS(null,"id",C),w.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),w.setAttributeNS(null,"x1",T[0]),w.setAttributeNS(null,"y1",T[1]),w.setAttributeNS(null,"x2",M[0]),w.setAttributeNS(null,"y2",M[1]);break;case"radial":const R=A[4],k=A[5],L=A[6],ae=A[7];w=this.svgFactory.createElement("svg:radialGradient"),w.setAttributeNS(null,"id",C),w.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),w.setAttributeNS(null,"cx",k[0]),w.setAttributeNS(null,"cy",k[1]),w.setAttributeNS(null,"r",ae),w.setAttributeNS(null,"fx",R[0]),w.setAttributeNS(null,"fy",R[1]),w.setAttributeNS(null,"fr",L);break;default:throw new Error(`Unknown RadialAxial type: ${A[1]}`)}for(const T of _){const M=this.svgFactory.createElement("svg:stop");M.setAttributeNS(null,"offset",T[0]),M.setAttributeNS(null,"stop-color",T[1]),w.append(M)}return this.defs.append(w),`url(#${C})`;case"Mesh":return(0,i.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${A[0]}`)}}setDash(A,C){this.current.dashArray=A,this.current.dashPhase=C}constructPath(A,C){const _=this.current;let w=_.x,T=_.y,M=[],R=0;for(const k of A)switch(k|0){case i.OPS.rectangle:w=C[R++],T=C[R++];const L=C[R++],ae=C[R++],Q=w+L,oe=T+ae;M.push("M",g(w),g(T),"L",g(Q),g(T),"L",g(Q),g(oe),"L",g(w),g(oe),"Z");break;case i.OPS.moveTo:w=C[R++],T=C[R++],M.push("M",g(w),g(T));break;case i.OPS.lineTo:w=C[R++],T=C[R++],M.push("L",g(w),g(T));break;case i.OPS.curveTo:w=C[R+4],T=C[R+5],M.push("C",g(C[R]),g(C[R+1]),g(C[R+2]),g(C[R+3]),g(w),g(T)),R+=6;break;case i.OPS.curveTo2:M.push("C",g(w),g(T),g(C[R]),g(C[R+1]),g(C[R+2]),g(C[R+3])),w=C[R+2],T=C[R+3],R+=4;break;case i.OPS.curveTo3:w=C[R+2],T=C[R+3],M.push("C",g(C[R]),g(C[R+1]),g(w),g(T),g(w),g(T)),R+=4;break;case i.OPS.closePath:M.push("Z");break}M=M.join(" "),_.path&&A.length>0&&A[0]!==i.OPS.rectangle&&A[0]!==i.OPS.moveTo?M=_.path.getAttributeNS(null,"d")+M:(_.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(_.path)),_.path.setAttributeNS(null,"d",M),_.path.setAttributeNS(null,"fill","none"),_.element=_.path,_.setCurrentPoint(w,T)}endPath(){const A=this.current;if(A.path=null,!this.pendingClip)return;if(!A.element){this.pendingClip=null;return}const C=`clippath${x++}`,_=this.svgFactory.createElement("svg:clipPath");_.setAttributeNS(null,"id",C),_.setAttributeNS(null,"transform",p(this.transformMatrix));const w=A.element.cloneNode(!0);if(this.pendingClip==="evenodd"?w.setAttributeNS(null,"clip-rule","evenodd"):w.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,_.append(w),this.defs.append(_),A.activeClipUrl){A.clipGroup=null;for(const T of this.extraStack)T.clipGroup=null;_.setAttributeNS(null,"clip-path",A.activeClipUrl)}A.activeClipUrl=`url(#${C})`,this.tgrp=null}clip(A){this.pendingClip=A}closePath(){const A=this.current;if(A.path){const C=`${A.path.getAttributeNS(null,"d")}Z`;A.path.setAttributeNS(null,"d",C)}}setLeading(A){this.current.leading=-A}setTextRise(A){this.current.textRise=A}setTextRenderingMode(A){this.current.textRenderingMode=A}setHScale(A){this.current.textHScale=A/100}setRenderingIntent(A){}setFlatness(A){}setGState(A){for(const[C,_]of A)switch(C){case"LW":this.setLineWidth(_);break;case"LC":this.setLineCap(_);break;case"LJ":this.setLineJoin(_);break;case"ML":this.setMiterLimit(_);break;case"D":this.setDash(_[0],_[1]);break;case"RI":this.setRenderingIntent(_);break;case"FL":this.setFlatness(_);break;case"Font":this.setFont(_);break;case"CA":this.setStrokeAlpha(_);break;case"ca":this.setFillAlpha(_);break;default:(0,i.warn)(`Unimplemented graphic state operator ${C}`);break}}fill(){const A=this.current;A.element&&(A.element.setAttributeNS(null,"fill",A.fillColor),A.element.setAttributeNS(null,"fill-opacity",A.fillAlpha),this.endPath())}stroke(){const A=this.current;A.element&&(this._setStrokeAttributes(A.element),A.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(A,C=1){const _=this.current;let w=_.dashArray;C!==1&&w.length>0&&(w=w.map(function(T){return C*T})),A.setAttributeNS(null,"stroke",_.strokeColor),A.setAttributeNS(null,"stroke-opacity",_.strokeAlpha),A.setAttributeNS(null,"stroke-miterlimit",g(_.miterLimit)),A.setAttributeNS(null,"stroke-linecap",_.lineCap),A.setAttributeNS(null,"stroke-linejoin",_.lineJoin),A.setAttributeNS(null,"stroke-width",g(C*_.lineWidth)+"px"),A.setAttributeNS(null,"stroke-dasharray",w.map(g).join(" ")),A.setAttributeNS(null,"stroke-dashoffset",g(C*_.dashPhase)+"px")}eoFill(){var A;(A=this.current.element)==null||A.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var A;(A=this.current.element)==null||A.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const A=this.svgFactory.createElement("svg:rect");A.setAttributeNS(null,"x","0"),A.setAttributeNS(null,"y","0"),A.setAttributeNS(null,"width","1px"),A.setAttributeNS(null,"height","1px"),A.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(A)}paintImageXObject(A){const C=this.getObject(A);if(!C){(0,i.warn)(`Dependent image with object ID ${A} is not ready yet`);return}this.paintInlineImageXObject(C)}paintInlineImageXObject(A,C){const _=A.width,w=A.height,T=f(A,this.forceDataSchema,!!C),M=this.svgFactory.createElement("svg:rect");M.setAttributeNS(null,"x","0"),M.setAttributeNS(null,"y","0"),M.setAttributeNS(null,"width",g(_)),M.setAttributeNS(null,"height",g(w)),this.current.element=M,this.clip("nonzero");const R=this.svgFactory.createElement("svg:image");R.setAttributeNS(o,"xlink:href",T),R.setAttributeNS(null,"x","0"),R.setAttributeNS(null,"y",g(-w)),R.setAttributeNS(null,"width",g(_)+"px"),R.setAttributeNS(null,"height",g(w)+"px"),R.setAttributeNS(null,"transform",`scale(${g(1/_)} ${g(-1/w)})`),C?C.append(R):this._ensureTransformGroup().append(R)}paintImageMaskXObject(A){const C=this.getObject(A.data,A);if(C.bitmap){(0,i.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const _=this.current,w=C.width,T=C.height,M=_.fillColor;_.maskId=`mask${E++}`;const R=this.svgFactory.createElement("svg:mask");R.setAttributeNS(null,"id",_.maskId);const k=this.svgFactory.createElement("svg:rect");k.setAttributeNS(null,"x","0"),k.setAttributeNS(null,"y","0"),k.setAttributeNS(null,"width",g(w)),k.setAttributeNS(null,"height",g(T)),k.setAttributeNS(null,"fill",M),k.setAttributeNS(null,"mask",`url(#${_.maskId})`),this.defs.append(R),this._ensureTransformGroup().append(k),this.paintInlineImageXObject(C,R)}paintFormXObjectBegin(A,C){if(Array.isArray(A)&&A.length===6&&this.transform(A[0],A[1],A[2],A[3],A[4],A[5]),C){const _=C[2]-C[0],w=C[3]-C[1],T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x",C[0]),T.setAttributeNS(null,"y",C[1]),T.setAttributeNS(null,"width",g(_)),T.setAttributeNS(null,"height",g(w)),this.current.element=T,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(A){const C=this.svgFactory.create(A.width,A.height),_=this.svgFactory.createElement("svg:defs");C.append(_),this.defs=_;const w=this.svgFactory.createElement("svg:g");return w.setAttributeNS(null,"transform",p(A.transform)),C.append(w),this.svg=w,C}_ensureClipGroup(){if(!this.current.clipGroup){const A=this.svgFactory.createElement("svg:g");A.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(A),this.current.clipGroup=A}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",p(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}t.SVGGraphics=P},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaText=void 0;class r{static textContent(i){const n=[],a={items:n,styles:Object.create(null)};function o(d){var f;if(!d)return;let l=null;const c=d.name;if(c==="#text")l=d.value;else if(r.shouldBuildText(c))(f=d==null?void 0:d.attributes)!=null&&f.textContent?l=d.attributes.textContent:d.value&&(l=d.value);else return;if(l!==null&&n.push({str:l}),!!d.children)for(const u of d.children)o(u)}return o(i),a}static shouldBuildText(i){return!(i==="textarea"||i==="input"||i==="option"||i==="select")}}t.XfaText=r},(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayerRenderTask=void 0,t.renderTextLayer=p,t.updateTextLayer=x;var s=r(1),i=r(6);const n=1e5,a=30,o=.8,d=new Map;function l(E,S){let P;if(S&&s.FeatureTest.isOffscreenCanvasSupported)P=new OffscreenCanvas(E,E).getContext("2d",{alpha:!1});else{const F=document.createElement("canvas");F.width=F.height=E,P=F.getContext("2d",{alpha:!1})}return P}function c(E,S){const P=d.get(E);if(P)return P;const F=l(a,S);F.font=`${a}px ${E}`;const A=F.measureText("");let C=A.fontBoundingBoxAscent,_=Math.abs(A.fontBoundingBoxDescent);if(C){const T=C/(C+_);return d.set(E,T),F.canvas.width=F.canvas.height=0,T}F.strokeStyle="red",F.clearRect(0,0,a,a),F.strokeText("g",0,0);let w=F.getImageData(0,0,a,a).data;_=0;for(let T=w.length-1-3;T>=0;T-=4)if(w[T]>0){_=Math.ceil(T/4/a);break}F.clearRect(0,0,a,a),F.strokeText("A",0,a),w=F.getImageData(0,0,a,a).data,C=0;for(let T=0,M=w.length;T<M;T+=4)if(w[T]>0){C=a-Math.floor(T/4/a);break}if(F.canvas.width=F.canvas.height=0,C){const T=C/(C+_);return d.set(E,T),T}return d.set(E,o),o}function f(E,S,P){const F=document.createElement("span"),A={angle:0,canvasWidth:0,hasText:S.str!=="",hasEOL:S.hasEOL,fontSize:0};E._textDivs.push(F);const C=s.Util.transform(E._transform,S.transform);let _=Math.atan2(C[1],C[0]);const w=P[S.fontName];w.vertical&&(_+=Math.PI/2);const T=Math.hypot(C[2],C[3]),M=T*c(w.fontFamily,E._isOffscreenCanvasSupported);let R,k;_===0?(R=C[4],k=C[5]-M):(R=C[4]+M*Math.sin(_),k=C[5]-M*Math.cos(_));const L="calc(var(--scale-factor)*",ae=F.style;E._container===E._rootContainer?(ae.left=`${(100*R/E._pageWidth).toFixed(2)}%`,ae.top=`${(100*k/E._pageHeight).toFixed(2)}%`):(ae.left=`${L}${R.toFixed(2)}px)`,ae.top=`${L}${k.toFixed(2)}px)`),ae.fontSize=`${L}${T.toFixed(2)}px)`,ae.fontFamily=w.fontFamily,A.fontSize=T,F.setAttribute("role","presentation"),F.textContent=S.str,F.dir=S.dir,E._fontInspectorEnabled&&(F.dataset.fontName=S.fontName),_!==0&&(A.angle=_*(180/Math.PI));let Q=!1;if(S.str.length>1)Q=!0;else if(S.str!==" "&&S.transform[0]!==S.transform[3]){const oe=Math.abs(S.transform[0]),re=Math.abs(S.transform[3]);oe!==re&&Math.max(oe,re)/Math.min(oe,re)>1.5&&(Q=!0)}Q&&(A.canvasWidth=w.vertical?S.height:S.width),E._textDivProperties.set(F,A),E._isReadableStream&&E._layoutText(F)}function u(E){const{div:S,scale:P,properties:F,ctx:A,prevFontSize:C,prevFontFamily:_}=E,{style:w}=S;let T="";if(F.canvasWidth!==0&&F.hasText){const{fontFamily:M}=w,{canvasWidth:R,fontSize:k}=F;(C!==k||_!==M)&&(A.font=`${k*P}px ${M}`,E.prevFontSize=k,E.prevFontFamily=M);const{width:L}=A.measureText(S.textContent);L>0&&(T=`scaleX(${R*P/L})`)}F.angle!==0&&(T=`rotate(${F.angle}deg) ${T}`),T.length>0&&(w.transform=T)}function h(E){if(E._canceled)return;const S=E._textDivs,P=E._capability;if(S.length>n){P.resolve();return}if(!E._isReadableStream)for(const A of S)E._layoutText(A);P.resolve()}class g{constructor({textContentSource:S,container:P,viewport:F,textDivs:A,textDivProperties:C,textContentItemsStr:_,isOffscreenCanvasSupported:w}){var L;this._textContentSource=S,this._isReadableStream=S instanceof ReadableStream,this._container=this._rootContainer=P,this._textDivs=A||[],this._textContentItemsStr=_||[],this._isOffscreenCanvasSupported=w,this._fontInspectorEnabled=!!((L=globalThis.FontInspector)!=null&&L.enabled),this._reader=null,this._textDivProperties=C||new WeakMap,this._canceled=!1,this._capability=new s.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:F.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:l(0,w)};const{pageWidth:T,pageHeight:M,pageX:R,pageY:k}=F.rawDims;this._transform=[1,0,0,-1,-R,k+M],this._pageWidth=T,this._pageHeight=M,(0,i.setLayerDimensions)(P,F),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new s.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new s.AbortException("TextLayer task cancelled."))}_processItems(S,P){for(const F of S){if(F.str===void 0){if(F.type==="beginMarkedContentProps"||F.type==="beginMarkedContent"){const A=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),F.id!==null&&this._container.setAttribute("id",`${F.id}`),A.append(this._container)}else F.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(F.str),f(this,F,P)}}_layoutText(S){const P=this._layoutTextParams.properties=this._textDivProperties.get(S);if(this._layoutTextParams.div=S,u(this._layoutTextParams),P.hasText&&this._container.append(S),P.hasEOL){const F=document.createElement("br");F.setAttribute("role","presentation"),this._container.append(F)}}_render(){const S=new s.PromiseCapability;let P=Object.create(null);if(this._isReadableStream){const F=()=>{this._reader.read().then(({value:A,done:C})=>{if(C){S.resolve();return}Object.assign(P,A.styles),this._processItems(A.items,P),F()},S.reject)};this._reader=this._textContentSource.getReader(),F()}else if(this._textContentSource){const{items:F,styles:A}=this._textContentSource;this._processItems(F,A),S.resolve()}else throw new Error('No "textContentSource" parameter specified.');S.promise.then(()=>{P=null,h(this)},this._capability.reject)}}t.TextLayerRenderTask=g;function p(E){!E.textContentSource&&(E.textContent||E.textContentStream)&&((0,i.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),E.textContentSource=E.textContent||E.textContentStream);const{container:S,viewport:P}=E,F=getComputedStyle(S),A=F.getPropertyValue("visibility"),C=parseFloat(F.getPropertyValue("--scale-factor"));A==="visible"&&(!C||Math.abs(C-P.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const _=new g(E);return _._render(),_}function x({container:E,viewport:S,textDivs:P,textDivProperties:F,isOffscreenCanvasSupported:A,mustRotate:C=!0,mustRescale:_=!0}){if(C&&(0,i.setLayerDimensions)(E,{rotation:S.rotation}),_){const w=l(0,A),M={prevFontSize:null,prevFontFamily:null,div:null,scale:S.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:w};for(const R of P)M.properties=F.get(R),M.div=R,u(M)}}},(e,t,r)=>{var c,f,u,h,g,p,x,E,S,P,F,hr,Bt,fr,pr;Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditorLayer=void 0;var s=r(1),i=r(4),n=r(28),a=r(33),o=r(6),d=r(34);const T=class T{constructor({uiManager:R,pageIndex:k,div:L,accessibilityManager:ae,annotationLayer:Q,viewport:oe,l10n:re}){_e(this,F);_e(this,c);_e(this,f,!1);_e(this,u,null);_e(this,h,this.pointerup.bind(this));_e(this,g,this.pointerdown.bind(this));_e(this,p,new Map);_e(this,x,!1);_e(this,E,!1);_e(this,S,!1);_e(this,P);const me=[n.FreeTextEditor,a.InkEditor,d.StampEditor];if(!T._initialized){T._initialized=!0;for(const H of me)H.initialize(re)}R.registerEditorTypes(me),Ee(this,P,R),this.pageIndex=k,this.div=L,Ee(this,c,ae),Ee(this,u,Q),this.viewport=oe,y(this,P).addLayer(this)}get isEmpty(){return y(this,p).size===0}updateToolbar(R){y(this,P).updateToolbar(R)}updateMode(R=y(this,P).getMode()){ce(this,F,pr).call(this),R===s.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),R!==s.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",R===s.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",R===s.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",R===s.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(R){if(!R&&y(this,P).getMode()!==s.AnnotationEditorType.INK)return;if(!R){for(const L of y(this,p).values())if(L.isEmpty()){L.setInBackground();return}}ce(this,F,Bt).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(R){y(this,P).setEditingState(R)}addCommands(R){y(this,P).addCommands(R)}enable(){this.div.style.pointerEvents="auto";const R=new Set;for(const L of y(this,p).values())L.enableEditing(),L.annotationElementId&&R.add(L.annotationElementId);if(!y(this,u))return;const k=y(this,u).getEditableAnnotations();for(const L of k){if(L.hide(),y(this,P).isDeletedAnnotationElement(L.data.id)||R.has(L.data.id))continue;const ae=this.deserialize(L);ae&&(this.addOrRebuild(ae),ae.enableEditing())}}disable(){var k;Ee(this,S,!0),this.div.style.pointerEvents="none";const R=new Set;for(const L of y(this,p).values()){if(L.disableEditing(),!L.annotationElementId||L.serialize()!==null){R.add(L.annotationElementId);continue}(k=this.getEditableAnnotation(L.annotationElementId))==null||k.show(),L.remove()}if(y(this,u)){const L=y(this,u).getEditableAnnotations();for(const ae of L){const{id:Q}=ae.data;R.has(Q)||y(this,P).isDeletedAnnotationElement(Q)||ae.show()}}ce(this,F,pr).call(this),this.isEmpty&&(this.div.hidden=!0),Ee(this,S,!1)}getEditableAnnotation(R){var k;return((k=y(this,u))==null?void 0:k.getEditableAnnotation(R))||null}setActiveEditor(R){y(this,P).getActive()!==R&&y(this,P).setActiveEditor(R)}enableClick(){this.div.addEventListener("pointerdown",y(this,g)),this.div.addEventListener("pointerup",y(this,h))}disableClick(){this.div.removeEventListener("pointerdown",y(this,g)),this.div.removeEventListener("pointerup",y(this,h))}attach(R){y(this,p).set(R.id,R);const{annotationElementId:k}=R;k&&y(this,P).isDeletedAnnotationElement(k)&&y(this,P).removeDeletedAnnotationElement(R)}detach(R){var k;y(this,p).delete(R.id),(k=y(this,c))==null||k.removePointerInTextLayer(R.contentDiv),!y(this,S)&&R.annotationElementId&&y(this,P).addDeletedAnnotationElement(R)}remove(R){this.detach(R),y(this,P).removeEditor(R),R.div.contains(document.activeElement)&&setTimeout(()=>{y(this,P).focusMainContainer()},0),R.div.remove(),R.isAttachedToDOM=!1,y(this,E)||this.addInkEditorIfNeeded(!1)}changeParent(R){var k;R.parent!==this&&(R.annotationElementId&&(y(this,P).addDeletedAnnotationElement(R.annotationElementId),i.AnnotationEditor.deleteAnnotationElement(R),R.annotationElementId=null),this.attach(R),(k=R.parent)==null||k.detach(R),R.setParent(this),R.div&&R.isAttachedToDOM&&(R.div.remove(),this.div.append(R.div)))}add(R){if(this.changeParent(R),y(this,P).addEditor(R),this.attach(R),!R.isAttachedToDOM){const k=R.render();this.div.append(k),R.isAttachedToDOM=!0}R.fixAndSetPosition(),R.onceAdded(),y(this,P).addToAnnotationStorage(R)}moveEditorInDOM(R){var L;if(!R.isAttachedToDOM)return;const{activeElement:k}=document;R.div.contains(k)&&(R._focusEventsAllowed=!1,setTimeout(()=>{R.div.contains(document.activeElement)?R._focusEventsAllowed=!0:(R.div.addEventListener("focusin",()=>{R._focusEventsAllowed=!0},{once:!0}),k.focus())},0)),R._structTreeParentId=(L=y(this,c))==null?void 0:L.moveElementInDOM(this.div,R.div,R.contentDiv,!0)}addOrRebuild(R){R.needsToBeRebuilt()?R.rebuild():this.add(R)}addUndoableEditor(R){const k=()=>R._uiManager.rebuild(R),L=()=>{R.remove()};this.addCommands({cmd:k,undo:L,mustExec:!1})}getNextId(){return y(this,P).getId()}pasteEditor(R,k){y(this,P).updateToolbar(R),y(this,P).updateMode(R);const{offsetX:L,offsetY:ae}=ce(this,F,fr).call(this),Q=this.getNextId(),oe=ce(this,F,hr).call(this,{parent:this,id:Q,x:L,y:ae,uiManager:y(this,P),isCentered:!0,...k});oe&&this.add(oe)}deserialize(R){switch(R.annotationType??R.annotationEditorType){case s.AnnotationEditorType.FREETEXT:return n.FreeTextEditor.deserialize(R,this,y(this,P));case s.AnnotationEditorType.INK:return a.InkEditor.deserialize(R,this,y(this,P));case s.AnnotationEditorType.STAMP:return d.StampEditor.deserialize(R,this,y(this,P))}return null}addNewEditor(){ce(this,F,Bt).call(this,ce(this,F,fr).call(this),!0)}setSelected(R){y(this,P).setSelected(R)}toggleSelected(R){y(this,P).toggleSelected(R)}isSelected(R){return y(this,P).isSelected(R)}unselect(R){y(this,P).unselect(R)}pointerup(R){const{isMac:k}=s.FeatureTest.platform;if(!(R.button!==0||R.ctrlKey&&k)&&R.target===this.div&&y(this,x)){if(Ee(this,x,!1),!y(this,f)){Ee(this,f,!0);return}if(y(this,P).getMode()===s.AnnotationEditorType.STAMP){y(this,P).unselectAll();return}ce(this,F,Bt).call(this,R,!1)}}pointerdown(R){if(y(this,x)){Ee(this,x,!1);return}const{isMac:k}=s.FeatureTest.platform;if(R.button!==0||R.ctrlKey&&k||R.target!==this.div)return;Ee(this,x,!0);const L=y(this,P).getActive();Ee(this,f,!L||L.isEmpty())}findNewParent(R,k,L){const ae=y(this,P).findParent(k,L);return ae===null||ae===this?!1:(ae.changeParent(R),!0)}destroy(){var R,k;((R=y(this,P).getActive())==null?void 0:R.parent)===this&&(y(this,P).commitOrRemove(),y(this,P).setActiveEditor(null));for(const L of y(this,p).values())(k=y(this,c))==null||k.removePointerInTextLayer(L.contentDiv),L.setParent(null),L.isAttachedToDOM=!1,L.div.remove();this.div=null,y(this,p).clear(),y(this,P).removeLayer(this)}render({viewport:R}){this.viewport=R,(0,o.setLayerDimensions)(this.div,R);for(const k of y(this,P).getEditors(this.pageIndex))this.add(k);this.updateMode()}update({viewport:R}){y(this,P).commitOrRemove(),this.viewport=R,(0,o.setLayerDimensions)(this.div,{rotation:R.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:R,pageHeight:k}=this.viewport.rawDims;return[R,k]}};c=new WeakMap,f=new WeakMap,u=new WeakMap,h=new WeakMap,g=new WeakMap,p=new WeakMap,x=new WeakMap,E=new WeakMap,S=new WeakMap,P=new WeakMap,F=new WeakSet,hr=function(R){switch(y(this,P).getMode()){case s.AnnotationEditorType.FREETEXT:return new n.FreeTextEditor(R);case s.AnnotationEditorType.INK:return new a.InkEditor(R);case s.AnnotationEditorType.STAMP:return new d.StampEditor(R)}return null},Bt=function(R,k){const L=this.getNextId(),ae=ce(this,F,hr).call(this,{parent:this,id:L,x:R.offsetX,y:R.offsetY,uiManager:y(this,P),isCentered:k});return ae&&this.add(ae),ae},fr=function(){const{x:R,y:k,width:L,height:ae}=this.div.getBoundingClientRect(),Q=Math.max(0,R),oe=Math.max(0,k),re=Math.min(window.innerWidth,R+L),me=Math.min(window.innerHeight,k+ae),H=(Q+re)/2-R,ie=(oe+me)/2-k,[le,N]=this.viewport.rotation%180===0?[H,ie]:[ie,H];return{offsetX:le,offsetY:N}},pr=function(){Ee(this,E,!0);for(const R of y(this,p).values())R.isEmpty()&&R.remove();Ee(this,E,!1)},lt(T,"_initialized",!1);let l=T;t.AnnotationEditorLayer=l},(e,t,r)=>{var d,l,c,f,u,h,g,p,x,E,Ur,Wr,Hr,Ft,mr,Gr,xr;Object.defineProperty(t,"__esModule",{value:!0}),t.FreeTextEditor=void 0;var s=r(1),i=r(5),n=r(4),a=r(29);const T=class T extends n.AnnotationEditor{constructor(k){super({...k,name:"freeTextEditor"});_e(this,E);_e(this,d,this.editorDivBlur.bind(this));_e(this,l,this.editorDivFocus.bind(this));_e(this,c,this.editorDivInput.bind(this));_e(this,f,this.editorDivKeydown.bind(this));_e(this,u);_e(this,h,"");_e(this,g,`${this.id}-editor`);_e(this,p);_e(this,x,null);Ee(this,u,k.color||T._defaultColor||n.AnnotationEditor._defaultLineColor),Ee(this,p,k.fontSize||T._defaultFontSize)}static get _keyboardManager(){const k=T.prototype,L=oe=>oe.isEmpty(),ae=i.AnnotationEditorUIManager.TRANSLATE_SMALL,Q=i.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,s.shadow)(this,"_keyboardManager",new i.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],k.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],k.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],k._translateEmpty,{args:[-ae,0],checker:L}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],k._translateEmpty,{args:[-Q,0],checker:L}],[["ArrowRight","mac+ArrowRight"],k._translateEmpty,{args:[ae,0],checker:L}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],k._translateEmpty,{args:[Q,0],checker:L}],[["ArrowUp","mac+ArrowUp"],k._translateEmpty,{args:[0,-ae],checker:L}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],k._translateEmpty,{args:[0,-Q],checker:L}],[["ArrowDown","mac+ArrowDown"],k._translateEmpty,{args:[0,ae],checker:L}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],k._translateEmpty,{args:[0,Q],checker:L}]]))}static initialize(k){n.AnnotationEditor.initialize(k,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const L=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(L.getPropertyValue("--freetext-padding"))}static updateDefaultParams(k,L){switch(k){case s.AnnotationEditorParamsType.FREETEXT_SIZE:T._defaultFontSize=L;break;case s.AnnotationEditorParamsType.FREETEXT_COLOR:T._defaultColor=L;break}}updateParams(k,L){switch(k){case s.AnnotationEditorParamsType.FREETEXT_SIZE:ce(this,E,Ur).call(this,L);break;case s.AnnotationEditorParamsType.FREETEXT_COLOR:ce(this,E,Wr).call(this,L);break}}static get defaultPropertiesToUpdate(){return[[s.AnnotationEditorParamsType.FREETEXT_SIZE,T._defaultFontSize],[s.AnnotationEditorParamsType.FREETEXT_COLOR,T._defaultColor||n.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[s.AnnotationEditorParamsType.FREETEXT_SIZE,y(this,p)],[s.AnnotationEditorParamsType.FREETEXT_COLOR,y(this,u)]]}_translateEmpty(k,L){this._uiManager.translateSelectedEditors(k,L,!0)}getInitialTranslation(){const k=this.parentScale;return[-T._internalPadding*k,-(T._internalPadding+y(this,p))*k]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(s.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",y(this,f)),this.editorDiv.addEventListener("focus",y(this,l)),this.editorDiv.addEventListener("blur",y(this,d)),this.editorDiv.addEventListener("input",y(this,c)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",y(this,g)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",y(this,f)),this.editorDiv.removeEventListener("focus",y(this,l)),this.editorDiv.removeEventListener("blur",y(this,d)),this.editorDiv.removeEventListener("input",y(this,c)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(k){this._focusEventsAllowed&&(super.focusin(k),k.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var k;if(this.width){ce(this,E,xr).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(k=this._initialOptions)!=null&&k.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const k=y(this,h),L=Ee(this,h,ce(this,E,Hr).call(this).trimEnd());if(k===L)return;const ae=Q=>{if(Ee(this,h,Q),!Q){this.remove();return}ce(this,E,mr).call(this),this._uiManager.rebuild(this),ce(this,E,Ft).call(this)};this.addCommands({cmd:()=>{ae(L)},undo:()=>{ae(k)},mustExec:!1}),ce(this,E,Ft).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(k){this.enterInEditMode()}keydown(k){k.target===this.div&&k.key==="Enter"&&(this.enterInEditMode(),k.preventDefault())}editorDivKeydown(k){T._keyboardManager.exec(this,k)}editorDivFocus(k){this.isEditing=!0}editorDivBlur(k){this.isEditing=!1}editorDivInput(k){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let k,L;this.width&&(k=this.x,L=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",y(this,g)),this.enableEditing(),n.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Q=>{var oe;return(oe=this.editorDiv)==null?void 0:oe.setAttribute("aria-label",Q)}),n.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Q=>{var oe;return(oe=this.editorDiv)==null?void 0:oe.setAttribute("default-content",Q)}),this.editorDiv.contentEditable=!0;const{style:ae}=this.editorDiv;if(ae.fontSize=`calc(${y(this,p)}px * var(--scale-factor))`,ae.color=y(this,u),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,i.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Q,oe]=this.parentDimensions;if(this.annotationElementId){const{position:re}=y(this,x);let[me,H]=this.getInitialTranslation();[me,H]=this.pageTranslationToScreen(me,H);const[ie,le]=this.pageDimensions,[N,b]=this.pageTranslation;let v,j;switch(this.rotation){case 0:v=k+(re[0]-N)/ie,j=L+this.height-(re[1]-b)/le;break;case 90:v=k+(re[0]-N)/ie,j=L-(re[1]-b)/le,[me,H]=[H,-me];break;case 180:v=k-this.width+(re[0]-N)/ie,j=L-(re[1]-b)/le,[me,H]=[-me,-H];break;case 270:v=k+(re[0]-N-this.height*le)/ie,j=L+(re[1]-b-this.width*ie)/le,[me,H]=[-H,me];break}this.setAt(v*Q,j*oe,me,H)}else this.setAt(k*Q,L*oe,this.width*Q,this.height*oe);ce(this,E,mr).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(k,L,ae){let Q=null;if(k instanceof a.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:re,fontColor:me},rect:H,rotation:ie,id:le},textContent:N,textPosition:b,parent:{page:{pageNumber:v}}}=k;if(!N||N.length===0)return null;Q=k={annotationType:s.AnnotationEditorType.FREETEXT,color:Array.from(me),fontSize:re,value:N.join(`
`),position:b,pageIndex:v-1,rect:H,rotation:ie,id:le,deleted:!1}}const oe=super.deserialize(k,L,ae);return Ee(oe,p,k.fontSize),Ee(oe,u,s.Util.makeHexColor(...k.color)),Ee(oe,h,k.value),oe.annotationElementId=k.id||null,Ee(oe,x,Q),oe}serialize(k=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const L=T._internalPadding*this.parentScale,ae=this.getRect(L,L),Q=n.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:y(this,u)),oe={annotationType:s.AnnotationEditorType.FREETEXT,color:Q,fontSize:y(this,p),value:y(this,h),pageIndex:this.pageIndex,rect:ae,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return k?oe:this.annotationElementId&&!ce(this,E,Gr).call(this,oe)?null:(oe.id=this.annotationElementId,oe)}};d=new WeakMap,l=new WeakMap,c=new WeakMap,f=new WeakMap,u=new WeakMap,h=new WeakMap,g=new WeakMap,p=new WeakMap,x=new WeakMap,E=new WeakSet,Ur=function(k){const L=Q=>{this.editorDiv.style.fontSize=`calc(${Q}px * var(--scale-factor))`,this.translate(0,-(Q-y(this,p))*this.parentScale),Ee(this,p,Q),ce(this,E,Ft).call(this)},ae=y(this,p);this.addCommands({cmd:()=>{L(k)},undo:()=>{L(ae)},mustExec:!0,type:s.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Wr=function(k){const L=y(this,u);this.addCommands({cmd:()=>{Ee(this,u,this.editorDiv.style.color=k)},undo:()=>{Ee(this,u,this.editorDiv.style.color=L)},mustExec:!0,type:s.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Hr=function(){const k=this.editorDiv.getElementsByTagName("div");if(k.length===0)return this.editorDiv.innerText;const L=[];for(const ae of k)L.push(ae.innerText.replace(/\r\n?|\n/,""));return L.join(`
`)},Ft=function(){const[k,L]=this.parentDimensions;let ae;if(this.isAttachedToDOM)ae=this.div.getBoundingClientRect();else{const{currentLayer:Q,div:oe}=this,re=oe.style.display;oe.style.display="hidden",Q.div.append(this.div),ae=oe.getBoundingClientRect(),oe.remove(),oe.style.display=re}this.rotation%180===this.parentRotation%180?(this.width=ae.width/k,this.height=ae.height/L):(this.width=ae.height/k,this.height=ae.width/L),this.fixAndSetPosition()},mr=function(){if(this.editorDiv.replaceChildren(),!!y(this,h))for(const k of y(this,h).split(`
`)){const L=document.createElement("div");L.append(k?document.createTextNode(k):document.createElement("br")),this.editorDiv.append(L)}},Gr=function(k){const{value:L,fontSize:ae,color:Q,rect:oe,pageIndex:re}=y(this,x);return k.value!==L||k.fontSize!==ae||k.rect.some((me,H)=>Math.abs(me-oe[H])>=1)||k.color.some((me,H)=>me!==Q[H])||k.pageIndex!==re},xr=function(k=!1){if(!this.annotationElementId)return;if(ce(this,E,Ft).call(this),!k&&(this.width===0||this.height===0)){setTimeout(()=>ce(this,E,xr).call(this,!0),0);return}const L=T._internalPadding*this.parentScale;y(this,x).rect=this.getRect(L,L)},lt(T,"_freeTextDefaultContent",""),lt(T,"_internalPadding",0),lt(T,"_defaultColor",null),lt(T,"_defaultFontSize",10),lt(T,"_type","freetext");let o=T;t.FreeTextEditor=o},(e,t,r)=>{var j,U,xt,Vr,te,ve,xe,Re,Ae,ke,ue,se,z,J,de,fe,Fe,De,Pe,he,ze,Le,Xr,zt,gr,_r,Je,nt,ot,Me,ge,be,Ve,vr,rt,ee,Ne,Be,Kr,Er;Object.defineProperty(t,"__esModule",{value:!0}),t.StampAnnotationElement=t.InkAnnotationElement=t.FreeTextAnnotationElement=t.AnnotationLayer=void 0;var s=r(1),i=r(6),n=r(3),a=r(30),o=r(31),d=r(32);const l=1e3,c=9,f=new WeakSet;function u(Ge){return{width:Ge[2]-Ge[0],height:Ge[3]-Ge[1]}}class h{static create(Y){switch(Y.data.annotationType){case s.AnnotationType.LINK:return new p(Y);case s.AnnotationType.TEXT:return new x(Y);case s.AnnotationType.WIDGET:switch(Y.data.fieldType){case"Tx":return new S(Y);case"Btn":return Y.data.radioButton?new A(Y):Y.data.checkBox?new F(Y):new C(Y);case"Ch":return new _(Y);case"Sig":return new P(Y)}return new E(Y);case s.AnnotationType.POPUP:return new w(Y);case s.AnnotationType.FREETEXT:return new M(Y);case s.AnnotationType.LINE:return new R(Y);case s.AnnotationType.SQUARE:return new k(Y);case s.AnnotationType.CIRCLE:return new L(Y);case s.AnnotationType.POLYLINE:return new ae(Y);case s.AnnotationType.CARET:return new oe(Y);case s.AnnotationType.INK:return new re(Y);case s.AnnotationType.POLYGON:return new Q(Y);case s.AnnotationType.HIGHLIGHT:return new me(Y);case s.AnnotationType.UNDERLINE:return new H(Y);case s.AnnotationType.SQUIGGLY:return new ie(Y);case s.AnnotationType.STRIKEOUT:return new le(Y);case s.AnnotationType.STAMP:return new N(Y);case s.AnnotationType.FILEATTACHMENT:return new b(Y);default:return new g(Y)}}}const D=class D{constructor(Y,{isRenderable:V=!1,ignoreBorder:ne=!1,createQuadrilaterals:ye=!1}={}){_e(this,j,!1);this.isRenderable=V,this.data=Y.data,this.layer=Y.layer,this.linkService=Y.linkService,this.downloadManager=Y.downloadManager,this.imageResourcesPath=Y.imageResourcesPath,this.renderForms=Y.renderForms,this.svgFactory=Y.svgFactory,this.annotationStorage=Y.annotationStorage,this.enableScripting=Y.enableScripting,this.hasJSActions=Y.hasJSActions,this._fieldObjects=Y.fieldObjects,this.parent=Y.parent,V&&(this.container=this._createContainer(ne)),ye&&this._createQuadrilaterals()}static _hasPopupData({titleObj:Y,contentsObj:V,richText:ne}){return!!(Y!=null&&Y.str||V!=null&&V.str||ne!=null&&ne.str)}get hasPopupData(){return D._hasPopupData(this.data)}_createContainer(Y){const{data:V,parent:{page:ne,viewport:ye}}=this,Te=document.createElement("section");Te.setAttribute("data-annotation-id",V.id),this instanceof E||(Te.tabIndex=l),Te.style.zIndex=this.parent.zIndex++,this.data.popupRef&&Te.setAttribute("aria-haspopup","dialog"),V.noRotate&&Te.classList.add("norotate");const{pageWidth:Ie,pageHeight:Oe,pageX:$e,pageY:Ke}=ye.rawDims;if(!V.rect||this instanceof w){const{rotation:G}=V;return!V.hasOwnCanvas&&G!==0&&this.setRotation(G,Te),Te}const{width:I,height:K}=u(V.rect),O=s.Util.normalizeRect([V.rect[0],ne.view[3]-V.rect[1]+ne.view[1],V.rect[2],ne.view[3]-V.rect[3]+ne.view[1]]);if(!Y&&V.borderStyle.width>0){Te.style.borderWidth=`${V.borderStyle.width}px`;const G=V.borderStyle.horizontalCornerRadius,q=V.borderStyle.verticalCornerRadius;if(G>0||q>0){const je=`calc(${G}px * var(--scale-factor)) / calc(${q}px * var(--scale-factor))`;Te.style.borderRadius=je}else if(this instanceof A){const je=`calc(${I}px * var(--scale-factor)) / calc(${K}px * var(--scale-factor))`;Te.style.borderRadius=je}switch(V.borderStyle.style){case s.AnnotationBorderStyleType.SOLID:Te.style.borderStyle="solid";break;case s.AnnotationBorderStyleType.DASHED:Te.style.borderStyle="dashed";break;case s.AnnotationBorderStyleType.BEVELED:(0,s.warn)("Unimplemented border style: beveled");break;case s.AnnotationBorderStyleType.INSET:(0,s.warn)("Unimplemented border style: inset");break;case s.AnnotationBorderStyleType.UNDERLINE:Te.style.borderBottomStyle="solid";break}const pe=V.borderColor||null;pe?(Ee(this,j,!0),Te.style.borderColor=s.Util.makeHexColor(pe[0]|0,pe[1]|0,pe[2]|0)):Te.style.borderWidth=0}Te.style.left=`${100*(O[0]-$e)/Ie}%`,Te.style.top=`${100*(O[1]-Ke)/Oe}%`;const{rotation:B}=V;return V.hasOwnCanvas||B===0?(Te.style.width=`${100*I/Ie}%`,Te.style.height=`${100*K/Oe}%`):this.setRotation(B,Te),Te}setRotation(Y,V=this.container){if(!this.data.rect)return;const{pageWidth:ne,pageHeight:ye}=this.parent.viewport.rawDims,{width:Te,height:Ie}=u(this.data.rect);let Oe,$e;Y%180===0?(Oe=100*Te/ne,$e=100*Ie/ye):(Oe=100*Ie/ne,$e=100*Te/ye),V.style.width=`${Oe}%`,V.style.height=`${$e}%`,V.setAttribute("data-main-rotation",(360-Y)%360)}get _commonActions(){const Y=(V,ne,ye)=>{const Te=ye.detail[V],Ie=Te[0],Oe=Te.slice(1);ye.target.style[ne]=a.ColorConverters[`${Ie}_HTML`](Oe),this.annotationStorage.setValue(this.data.id,{[ne]:a.ColorConverters[`${Ie}_rgb`](Oe)})};return(0,s.shadow)(this,"_commonActions",{display:V=>{const{display:ne}=V.detail,ye=ne%2===1;this.container.style.visibility=ye?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:ye,noPrint:ne===1||ne===2})},print:V=>{this.annotationStorage.setValue(this.data.id,{noPrint:!V.detail.print})},hidden:V=>{const{hidden:ne}=V.detail;this.container.style.visibility=ne?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:ne,noView:ne})},focus:V=>{setTimeout(()=>V.target.focus({preventScroll:!1}),0)},userName:V=>{V.target.title=V.detail.userName},readonly:V=>{V.target.disabled=V.detail.readonly},required:V=>{this._setRequired(V.target,V.detail.required)},bgColor:V=>{Y("bgColor","backgroundColor",V)},fillColor:V=>{Y("fillColor","backgroundColor",V)},fgColor:V=>{Y("fgColor","color",V)},textColor:V=>{Y("textColor","color",V)},borderColor:V=>{Y("borderColor","borderColor",V)},strokeColor:V=>{Y("strokeColor","borderColor",V)},rotation:V=>{const ne=V.detail.rotation;this.setRotation(ne),this.annotationStorage.setValue(this.data.id,{rotation:ne})}})}_dispatchEventFromSandbox(Y,V){const ne=this._commonActions;for(const ye of Object.keys(V.detail)){const Te=Y[ye]||ne[ye];Te==null||Te(V)}}_setDefaultPropertiesFromJS(Y){if(!this.enableScripting)return;const V=this.annotationStorage.getRawValue(this.data.id);if(!V)return;const ne=this._commonActions;for(const[ye,Te]of Object.entries(V)){const Ie=ne[ye];if(Ie){const Oe={detail:{[ye]:Te},target:Y};Ie(Oe),delete V[ye]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:Y}=this.data;if(!Y)return;const[V,ne,ye,Te]=this.data.rect;if(Y.length===1){const[,{x:q,y:pe},{x:je,y:Se}]=Y[0];if(ye===q&&Te===pe&&V===je&&ne===Se)return}const{style:Ie}=this.container;let Oe;if(y(this,j)){const{borderColor:q,borderWidth:pe}=Ie;Ie.borderWidth=0,Oe=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${q}" stroke-width="${pe}">`],this.container.classList.add("hasBorder")}const $e=ye-V,Ke=Te-ne,{svgFactory:I}=this,K=I.createElement("svg");K.classList.add("quadrilateralsContainer"),K.setAttribute("width",0),K.setAttribute("height",0);const O=I.createElement("defs");K.append(O);const B=I.createElement("clipPath"),G=`clippath_${this.data.id}`;B.setAttribute("id",G),B.setAttribute("clipPathUnits","objectBoundingBox"),O.append(B);for(const[,{x:q,y:pe},{x:je,y:Se}]of Y){const we=I.createElement("rect"),Ce=(je-V)/$e,Ue=(Te-pe)/Ke,We=(q-je)/$e,Qe=(pe-Se)/Ke;we.setAttribute("x",Ce),we.setAttribute("y",Ue),we.setAttribute("width",We),we.setAttribute("height",Qe),B.append(we),Oe==null||Oe.push(`<rect vector-effect="non-scaling-stroke" x="${Ce}" y="${Ue}" width="${We}" height="${Qe}"/>`)}y(this,j)&&(Oe.push("</g></svg>')"),Ie.backgroundImage=Oe.join("")),this.container.append(K),this.container.style.clipPath=`url(#${G})`}_createPopup(){const{container:Y,data:V}=this;Y.setAttribute("aria-haspopup","dialog");const ne=new w({data:{color:V.color,titleObj:V.titleObj,modificationDate:V.modificationDate,contentsObj:V.contentsObj,richText:V.richText,parentRect:V.rect,borderStyle:0,id:`popup_${V.id}`,rotation:V.rotation},parent:this.parent,elements:[this]});this.parent.div.append(ne.render())}render(){(0,s.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(Y,V=null){const ne=[];if(this._fieldObjects){const ye=this._fieldObjects[Y];if(ye)for(const{page:Te,id:Ie,exportValues:Oe}of ye){if(Te===-1||Ie===V)continue;const $e=typeof Oe=="string"?Oe:null,Ke=document.querySelector(`[data-element-id="${Ie}"]`);if(Ke&&!f.has(Ke)){(0,s.warn)(`_getElementsByName - element not allowed: ${Ie}`);continue}ne.push({id:Ie,exportValue:$e,domElement:Ke})}return ne}for(const ye of document.getElementsByName(Y)){const{exportValue:Te}=ye,Ie=ye.getAttribute("data-element-id");Ie!==V&&f.has(ye)&&ne.push({id:Ie,exportValue:Te,domElement:ye})}return ne}show(){var Y;this.container&&(this.container.hidden=!1),(Y=this.popup)==null||Y.maybeShow()}hide(){var Y;this.container&&(this.container.hidden=!0),(Y=this.popup)==null||Y.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const Y=this.getElementsToTriggerPopup();if(Array.isArray(Y))for(const V of Y)V.classList.add("highlightArea");else Y.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:Y,data:{id:V}}=this;this.container.addEventListener("dblclick",()=>{var ne;(ne=this.linkService.eventBus)==null||ne.dispatch("switchannotationeditormode",{source:this,mode:Y,editId:V})})}};j=new WeakMap;let g=D;class p extends g{constructor(V,ne=null){super(V,{isRenderable:!0,ignoreBorder:!!(ne!=null&&ne.ignoreBorder),createQuadrilaterals:!0});_e(this,U);this.isTooltipOnly=V.data.isTooltipOnly}render(){const{data:V,linkService:ne}=this,ye=document.createElement("a");ye.setAttribute("data-element-id",V.id);let Te=!1;return V.url?(ne.addLinkAttributes(ye,V.url,V.newWindow),Te=!0):V.action?(this._bindNamedAction(ye,V.action),Te=!0):V.attachment?(this._bindAttachment(ye,V.attachment),Te=!0):V.setOCGState?(ce(this,U,Vr).call(this,ye,V.setOCGState),Te=!0):V.dest?(this._bindLink(ye,V.dest),Te=!0):(V.actions&&(V.actions.Action||V.actions["Mouse Up"]||V.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(ye,V),Te=!0),V.resetForm?(this._bindResetFormAction(ye,V.resetForm),Te=!0):this.isTooltipOnly&&!Te&&(this._bindLink(ye,""),Te=!0)),this.container.classList.add("linkAnnotation"),Te&&this.container.append(ye),this.container}_bindLink(V,ne){V.href=this.linkService.getDestinationHash(ne),V.onclick=()=>(ne&&this.linkService.goToDestination(ne),!1),(ne||ne==="")&&ce(this,U,xt).call(this)}_bindNamedAction(V,ne){V.href=this.linkService.getAnchorUrl(""),V.onclick=()=>(this.linkService.executeNamedAction(ne),!1),ce(this,U,xt).call(this)}_bindAttachment(V,ne){V.href=this.linkService.getAnchorUrl(""),V.onclick=()=>{var ye;return(ye=this.downloadManager)==null||ye.openOrDownloadData(this.container,ne.content,ne.filename),!1},ce(this,U,xt).call(this)}_bindJSAction(V,ne){V.href=this.linkService.getAnchorUrl("");const ye=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const Te of Object.keys(ne.actions)){const Ie=ye.get(Te);Ie&&(V[Ie]=()=>{var Oe;return(Oe=this.linkService.eventBus)==null||Oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ne.id,name:Te}}),!1})}V.onclick||(V.onclick=()=>!1),ce(this,U,xt).call(this)}_bindResetFormAction(V,ne){const ye=V.onclick;if(ye||(V.href=this.linkService.getAnchorUrl("")),ce(this,U,xt).call(this),!this._fieldObjects){(0,s.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),ye||(V.onclick=()=>!1);return}V.onclick=()=>{var K;ye==null||ye();const{fields:Te,refs:Ie,include:Oe}=ne,$e=[];if(Te.length!==0||Ie.length!==0){const O=new Set(Ie);for(const B of Te){const G=this._fieldObjects[B]||[];for(const{id:q}of G)O.add(q)}for(const B of Object.values(this._fieldObjects))for(const G of B)O.has(G.id)===Oe&&$e.push(G)}else for(const O of Object.values(this._fieldObjects))$e.push(...O);const Ke=this.annotationStorage,I=[];for(const O of $e){const{id:B}=O;switch(I.push(B),O.type){case"text":{const q=O.defaultValue||"";Ke.setValue(B,{value:q});break}case"checkbox":case"radiobutton":{const q=O.defaultValue===O.exportValues;Ke.setValue(B,{value:q});break}case"combobox":case"listbox":{const q=O.defaultValue||"";Ke.setValue(B,{value:q});break}default:continue}const G=document.querySelector(`[data-element-id="${B}"]`);if(G){if(!f.has(G)){(0,s.warn)(`_bindResetFormAction - element not allowed: ${B}`);continue}}else continue;G.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((K=this.linkService.eventBus)==null||K.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:I,name:"ResetForm"}})),!1}}}U=new WeakSet,xt=function(){this.container.setAttribute("data-internal-link","")},Vr=function(V,ne){V.href=this.linkService.getAnchorUrl(""),V.onclick=()=>(this.linkService.executeSetOCGState(ne),!1),ce(this,U,xt).call(this)};class x extends g{constructor(Y){super(Y,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const Y=document.createElement("img");return Y.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",Y.alt="[{{type}} Annotation]",Y.dataset.l10nId="text_annotation_type",Y.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(Y),this.container}}class E extends g{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(Y){var V;this.data.hasOwnCanvas&&(((V=Y.previousSibling)==null?void 0:V.nodeName)==="CANVAS"&&(Y.previousSibling.hidden=!0),Y.hidden=!1)}_getKeyModifier(Y){const{isWin:V,isMac:ne}=s.FeatureTest.platform;return V&&Y.ctrlKey||ne&&Y.metaKey}_setEventListener(Y,V,ne,ye,Te){ne.includes("mouse")?Y.addEventListener(ne,Ie=>{var Oe;(Oe=this.linkService.eventBus)==null||Oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:ye,value:Te(Ie),shift:Ie.shiftKey,modifier:this._getKeyModifier(Ie)}})}):Y.addEventListener(ne,Ie=>{var Oe;if(ne==="blur"){if(!V.focused||!Ie.relatedTarget)return;V.focused=!1}else if(ne==="focus"){if(V.focused)return;V.focused=!0}Te&&((Oe=this.linkService.eventBus)==null||Oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:ye,value:Te(Ie)}}))})}_setEventListeners(Y,V,ne,ye){var Te,Ie,Oe;for(const[$e,Ke]of ne)(Ke==="Action"||(Te=this.data.actions)!=null&&Te[Ke])&&((Ke==="Focus"||Ke==="Blur")&&(V||(V={focused:!1})),this._setEventListener(Y,V,$e,Ke,ye),Ke==="Focus"&&!((Ie=this.data.actions)!=null&&Ie.Blur)?this._setEventListener(Y,V,"blur","Blur",null):Ke==="Blur"&&!((Oe=this.data.actions)!=null&&Oe.Focus)&&this._setEventListener(Y,V,"focus","Focus",null))}_setBackgroundColor(Y){const V=this.data.backgroundColor||null;Y.style.backgroundColor=V===null?"transparent":s.Util.makeHexColor(V[0],V[1],V[2])}_setTextStyle(Y){const V=["left","center","right"],{fontColor:ne}=this.data.defaultAppearanceData,ye=this.data.defaultAppearanceData.fontSize||c,Te=Y.style;let Ie;const Oe=2,$e=Ke=>Math.round(10*Ke)/10;if(this.data.multiLine){const Ke=Math.abs(this.data.rect[3]-this.data.rect[1]-Oe),I=Math.round(Ke/(s.LINE_FACTOR*ye))||1,K=Ke/I;Ie=Math.min(ye,$e(K/s.LINE_FACTOR))}else{const Ke=Math.abs(this.data.rect[3]-this.data.rect[1]-Oe);Ie=Math.min(ye,$e(Ke/s.LINE_FACTOR))}Te.fontSize=`calc(${Ie}px * var(--scale-factor))`,Te.color=s.Util.makeHexColor(ne[0],ne[1],ne[2]),this.data.textAlignment!==null&&(Te.textAlign=V[this.data.textAlignment])}_setRequired(Y,V){V?Y.setAttribute("required",!0):Y.removeAttribute("required"),Y.setAttribute("aria-required",V)}}class S extends E{constructor(Y){const V=Y.renderForms||!Y.data.hasAppearance&&!!Y.data.fieldValue;super(Y,{isRenderable:V})}setPropertyOnSiblings(Y,V,ne,ye){const Te=this.annotationStorage;for(const Ie of this._getElementsByName(Y.name,Y.id))Ie.domElement&&(Ie.domElement[V]=ne),Te.setValue(Ie.id,{[ye]:ne})}render(){var ye,Te;const Y=this.annotationStorage,V=this.data.id;this.container.classList.add("textWidgetAnnotation");let ne=null;if(this.renderForms){const Ie=Y.getValue(V,{value:this.data.fieldValue});let Oe=Ie.value||"";const $e=Y.getValue(V,{charLimit:this.data.maxLen}).charLimit;$e&&Oe.length>$e&&(Oe=Oe.slice(0,$e));let Ke=Ie.formattedValue||((ye=this.data.textContent)==null?void 0:ye.join(`
`))||null;Ke&&this.data.comb&&(Ke=Ke.replaceAll(/\s+/g,""));const I={userValue:Oe,formattedValue:Ke,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(ne=document.createElement("textarea"),ne.textContent=Ke??Oe,this.data.doNotScroll&&(ne.style.overflowY="hidden")):(ne=document.createElement("input"),ne.type="text",ne.setAttribute("value",Ke??Oe),this.data.doNotScroll&&(ne.style.overflowX="hidden")),this.data.hasOwnCanvas&&(ne.hidden=!0),f.add(ne),ne.setAttribute("data-element-id",V),ne.disabled=this.data.readOnly,ne.name=this.data.fieldName,ne.tabIndex=l,this._setRequired(ne,this.data.required),$e&&(ne.maxLength=$e),ne.addEventListener("input",O=>{Y.setValue(V,{value:O.target.value}),this.setPropertyOnSiblings(ne,"value",O.target.value,"value"),I.formattedValue=null}),ne.addEventListener("resetform",O=>{const B=this.data.defaultFieldValue??"";ne.value=I.userValue=B,I.formattedValue=null});let K=O=>{const{formattedValue:B}=I;B!=null&&(O.target.value=B),O.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){ne.addEventListener("focus",B=>{if(I.focused)return;const{target:G}=B;I.userValue&&(G.value=I.userValue),I.lastCommittedValue=G.value,I.commitKey=1,I.focused=!0}),ne.addEventListener("updatefromsandbox",B=>{this.showElementAndHideCanvas(B.target);const G={value(q){I.userValue=q.detail.value??"",Y.setValue(V,{value:I.userValue.toString()}),q.target.value=I.userValue},formattedValue(q){const{formattedValue:pe}=q.detail;I.formattedValue=pe,pe!=null&&q.target!==document.activeElement&&(q.target.value=pe),Y.setValue(V,{formattedValue:pe})},selRange(q){q.target.setSelectionRange(...q.detail.selRange)},charLimit:q=>{var we;const{charLimit:pe}=q.detail,{target:je}=q;if(pe===0){je.removeAttribute("maxLength");return}je.setAttribute("maxLength",pe);let Se=I.userValue;!Se||Se.length<=pe||(Se=Se.slice(0,pe),je.value=I.userValue=Se,Y.setValue(V,{value:Se}),(we=this.linkService.eventBus)==null||we.dispatch("dispatcheventinsandbox",{source:this,detail:{id:V,name:"Keystroke",value:Se,willCommit:!0,commitKey:1,selStart:je.selectionStart,selEnd:je.selectionEnd}}))}};this._dispatchEventFromSandbox(G,B)}),ne.addEventListener("keydown",B=>{var pe;I.commitKey=1;let G=-1;if(B.key==="Escape"?G=0:B.key==="Enter"&&!this.data.multiLine?G=2:B.key==="Tab"&&(I.commitKey=3),G===-1)return;const{value:q}=B.target;I.lastCommittedValue!==q&&(I.lastCommittedValue=q,I.userValue=q,(pe=this.linkService.eventBus)==null||pe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:V,name:"Keystroke",value:q,willCommit:!0,commitKey:G,selStart:B.target.selectionStart,selEnd:B.target.selectionEnd}}))});const O=K;K=null,ne.addEventListener("blur",B=>{var q;if(!I.focused||!B.relatedTarget)return;I.focused=!1;const{value:G}=B.target;I.userValue=G,I.lastCommittedValue!==G&&((q=this.linkService.eventBus)==null||q.dispatch("dispatcheventinsandbox",{source:this,detail:{id:V,name:"Keystroke",value:G,willCommit:!0,commitKey:I.commitKey,selStart:B.target.selectionStart,selEnd:B.target.selectionEnd}})),O(B)}),(Te=this.data.actions)!=null&&Te.Keystroke&&ne.addEventListener("beforeinput",B=>{var Ue;I.lastCommittedValue=null;const{data:G,target:q}=B,{value:pe,selectionStart:je,selectionEnd:Se}=q;let we=je,Ce=Se;switch(B.inputType){case"deleteWordBackward":{const We=pe.substring(0,je).match(/\w*[^\w]*$/);We&&(we-=We[0].length);break}case"deleteWordForward":{const We=pe.substring(je).match(/^[^\w]*\w*/);We&&(Ce+=We[0].length);break}case"deleteContentBackward":je===Se&&(we-=1);break;case"deleteContentForward":je===Se&&(Ce+=1);break}B.preventDefault(),(Ue=this.linkService.eventBus)==null||Ue.dispatch("dispatcheventinsandbox",{source:this,detail:{id:V,name:"Keystroke",value:pe,change:G||"",willCommit:!1,selStart:we,selEnd:Ce}})}),this._setEventListeners(ne,I,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],B=>B.target.value)}if(K&&ne.addEventListener("blur",K),this.data.comb){const B=(this.data.rect[2]-this.data.rect[0])/$e;ne.classList.add("comb"),ne.style.letterSpacing=`calc(${B}px * var(--scale-factor) - 1ch)`}}else ne=document.createElement("div"),ne.textContent=this.data.fieldValue,ne.style.verticalAlign="middle",ne.style.display="table-cell";return this._setTextStyle(ne),this._setBackgroundColor(ne),this._setDefaultPropertiesFromJS(ne),this.container.append(ne),this.container}}class P extends E{constructor(Y){super(Y,{isRenderable:!!Y.data.hasOwnCanvas})}}class F extends E{constructor(Y){super(Y,{isRenderable:Y.renderForms})}render(){const Y=this.annotationStorage,V=this.data,ne=V.id;let ye=Y.getValue(ne,{value:V.exportValue===V.fieldValue}).value;typeof ye=="string"&&(ye=ye!=="Off",Y.setValue(ne,{value:ye})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const Te=document.createElement("input");return f.add(Te),Te.setAttribute("data-element-id",ne),Te.disabled=V.readOnly,this._setRequired(Te,this.data.required),Te.type="checkbox",Te.name=V.fieldName,ye&&Te.setAttribute("checked",!0),Te.setAttribute("exportValue",V.exportValue),Te.tabIndex=l,Te.addEventListener("change",Ie=>{const{name:Oe,checked:$e}=Ie.target;for(const Ke of this._getElementsByName(Oe,ne)){const I=$e&&Ke.exportValue===V.exportValue;Ke.domElement&&(Ke.domElement.checked=I),Y.setValue(Ke.id,{value:I})}Y.setValue(ne,{value:$e})}),Te.addEventListener("resetform",Ie=>{const Oe=V.defaultFieldValue||"Off";Ie.target.checked=Oe===V.exportValue}),this.enableScripting&&this.hasJSActions&&(Te.addEventListener("updatefromsandbox",Ie=>{const Oe={value($e){$e.target.checked=$e.detail.value!=="Off",Y.setValue(ne,{value:$e.target.checked})}};this._dispatchEventFromSandbox(Oe,Ie)}),this._setEventListeners(Te,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ie=>Ie.target.checked)),this._setBackgroundColor(Te),this._setDefaultPropertiesFromJS(Te),this.container.append(Te),this.container}}class A extends E{constructor(Y){super(Y,{isRenderable:Y.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const Y=this.annotationStorage,V=this.data,ne=V.id;let ye=Y.getValue(ne,{value:V.fieldValue===V.buttonValue}).value;typeof ye=="string"&&(ye=ye!==V.buttonValue,Y.setValue(ne,{value:ye}));const Te=document.createElement("input");if(f.add(Te),Te.setAttribute("data-element-id",ne),Te.disabled=V.readOnly,this._setRequired(Te,this.data.required),Te.type="radio",Te.name=V.fieldName,ye&&Te.setAttribute("checked",!0),Te.tabIndex=l,Te.addEventListener("change",Ie=>{const{name:Oe,checked:$e}=Ie.target;for(const Ke of this._getElementsByName(Oe,ne))Y.setValue(Ke.id,{value:!1});Y.setValue(ne,{value:$e})}),Te.addEventListener("resetform",Ie=>{const Oe=V.defaultFieldValue;Ie.target.checked=Oe!=null&&Oe===V.buttonValue}),this.enableScripting&&this.hasJSActions){const Ie=V.buttonValue;Te.addEventListener("updatefromsandbox",Oe=>{const $e={value:Ke=>{const I=Ie===Ke.detail.value;for(const K of this._getElementsByName(Ke.target.name)){const O=I&&K.id===ne;K.domElement&&(K.domElement.checked=O),Y.setValue(K.id,{value:O})}}};this._dispatchEventFromSandbox($e,Oe)}),this._setEventListeners(Te,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Oe=>Oe.target.checked)}return this._setBackgroundColor(Te),this._setDefaultPropertiesFromJS(Te),this.container.append(Te),this.container}}class C extends p{constructor(Y){super(Y,{ignoreBorder:Y.data.hasAppearance})}render(){const Y=super.render();Y.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(Y.title=this.data.alternativeText);const V=Y.lastChild;return this.enableScripting&&this.hasJSActions&&V&&(this._setDefaultPropertiesFromJS(V),V.addEventListener("updatefromsandbox",ne=>{this._dispatchEventFromSandbox({},ne)})),Y}}class _ extends E{constructor(Y){super(Y,{isRenderable:Y.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const Y=this.annotationStorage,V=this.data.id,ne=Y.getValue(V,{value:this.data.fieldValue}),ye=document.createElement("select");f.add(ye),ye.setAttribute("data-element-id",V),ye.disabled=this.data.readOnly,this._setRequired(ye,this.data.required),ye.name=this.data.fieldName,ye.tabIndex=l;let Te=this.data.combo&&this.data.options.length>0;this.data.combo||(ye.size=this.data.options.length,this.data.multiSelect&&(ye.multiple=!0)),ye.addEventListener("resetform",I=>{const K=this.data.defaultFieldValue;for(const O of ye.options)O.selected=O.value===K});for(const I of this.data.options){const K=document.createElement("option");K.textContent=I.displayValue,K.value=I.exportValue,ne.value.includes(I.exportValue)&&(K.setAttribute("selected",!0),Te=!1),ye.append(K)}let Ie=null;if(Te){const I=document.createElement("option");I.value=" ",I.setAttribute("hidden",!0),I.setAttribute("selected",!0),ye.prepend(I),Ie=()=>{I.remove(),ye.removeEventListener("input",Ie),Ie=null},ye.addEventListener("input",Ie)}const Oe=I=>{const K=I?"value":"textContent",{options:O,multiple:B}=ye;return B?Array.prototype.filter.call(O,G=>G.selected).map(G=>G[K]):O.selectedIndex===-1?null:O[O.selectedIndex][K]};let $e=Oe(!1);const Ke=I=>{const K=I.target.options;return Array.prototype.map.call(K,O=>({displayValue:O.textContent,exportValue:O.value}))};return this.enableScripting&&this.hasJSActions?(ye.addEventListener("updatefromsandbox",I=>{const K={value(O){Ie==null||Ie();const B=O.detail.value,G=new Set(Array.isArray(B)?B:[B]);for(const q of ye.options)q.selected=G.has(q.value);Y.setValue(V,{value:Oe(!0)}),$e=Oe(!1)},multipleSelection(O){ye.multiple=!0},remove(O){const B=ye.options,G=O.detail.remove;B[G].selected=!1,ye.remove(G),B.length>0&&Array.prototype.findIndex.call(B,pe=>pe.selected)===-1&&(B[0].selected=!0),Y.setValue(V,{value:Oe(!0),items:Ke(O)}),$e=Oe(!1)},clear(O){for(;ye.length!==0;)ye.remove(0);Y.setValue(V,{value:null,items:[]}),$e=Oe(!1)},insert(O){const{index:B,displayValue:G,exportValue:q}=O.detail.insert,pe=ye.children[B],je=document.createElement("option");je.textContent=G,je.value=q,pe?pe.before(je):ye.append(je),Y.setValue(V,{value:Oe(!0),items:Ke(O)}),$e=Oe(!1)},items(O){const{items:B}=O.detail;for(;ye.length!==0;)ye.remove(0);for(const G of B){const{displayValue:q,exportValue:pe}=G,je=document.createElement("option");je.textContent=q,je.value=pe,ye.append(je)}ye.options.length>0&&(ye.options[0].selected=!0),Y.setValue(V,{value:Oe(!0),items:Ke(O)}),$e=Oe(!1)},indices(O){const B=new Set(O.detail.indices);for(const G of O.target.options)G.selected=B.has(G.index);Y.setValue(V,{value:Oe(!0)}),$e=Oe(!1)},editable(O){O.target.disabled=!O.detail.editable}};this._dispatchEventFromSandbox(K,I)}),ye.addEventListener("input",I=>{var O;const K=Oe(!0);Y.setValue(V,{value:K}),I.preventDefault(),(O=this.linkService.eventBus)==null||O.dispatch("dispatcheventinsandbox",{source:this,detail:{id:V,name:"Keystroke",value:$e,changeEx:K,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(ye,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],I=>I.target.value)):ye.addEventListener("input",function(I){Y.setValue(V,{value:Oe(!0)})}),this.data.combo&&this._setTextStyle(ye),this._setBackgroundColor(ye),this._setDefaultPropertiesFromJS(ye),this.container.append(ye),this.container}}class w extends g{constructor(Y){const{data:V,elements:ne}=Y;super(Y,{isRenderable:g._hasPopupData(V)}),this.elements=ne}render(){this.container.classList.add("popupAnnotation");const Y=new T({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),V=[];for(const ne of this.elements)ne.popup=Y,V.push(ne.data.id),ne.addHighlightArea();return this.container.setAttribute("aria-controls",V.map(ne=>`${s.AnnotationPrefix}${ne}`).join(",")),this.container}}class T{constructor({container:Y,color:V,elements:ne,titleObj:ye,modificationDate:Te,contentsObj:Ie,richText:Oe,parent:$e,rect:Ke,parentRect:I,open:K}){_e(this,Le);_e(this,te,null);_e(this,ve,ce(this,Le,Xr).bind(this));_e(this,xe,ce(this,Le,_r).bind(this));_e(this,Re,ce(this,Le,gr).bind(this));_e(this,Ae,ce(this,Le,zt).bind(this));_e(this,ke,null);_e(this,ue,null);_e(this,se,null);_e(this,z,null);_e(this,J,null);_e(this,de,null);_e(this,fe,!1);_e(this,Fe,null);_e(this,De,null);_e(this,Pe,null);_e(this,he,null);_e(this,ze,!1);var B;Ee(this,ue,Y),Ee(this,he,ye),Ee(this,se,Ie),Ee(this,Pe,Oe),Ee(this,J,$e),Ee(this,ke,V),Ee(this,De,Ke),Ee(this,de,I),Ee(this,z,ne);const O=i.PDFDateString.toDateObject(Te);O&&Ee(this,te,$e.l10n.get("annotation_date_string",{date:O.toLocaleDateString(),time:O.toLocaleTimeString()})),this.trigger=ne.flatMap(G=>G.getElementsToTriggerPopup());for(const G of this.trigger)G.addEventListener("click",y(this,Ae)),G.addEventListener("mouseenter",y(this,Re)),G.addEventListener("mouseleave",y(this,xe)),G.classList.add("popupTriggerArea");for(const G of ne)(B=G.container)==null||B.addEventListener("keydown",y(this,ve));y(this,ue).hidden=!0,K&&ce(this,Le,zt).call(this)}render(){if(y(this,Fe))return;const{page:{view:Y},viewport:{rawDims:{pageWidth:V,pageHeight:ne,pageX:ye,pageY:Te}}}=y(this,J),Ie=Ee(this,Fe,document.createElement("div"));if(Ie.className="popup",y(this,ke)){const we=Ie.style.outlineColor=s.Util.makeHexColor(...y(this,ke));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?Ie.style.backgroundColor=`color-mix(in srgb, ${we} 30%, white)`:Ie.style.backgroundColor=s.Util.makeHexColor(...y(this,ke).map(Ue=>Math.floor(.7*(255-Ue)+Ue)))}const Oe=document.createElement("span");Oe.className="header";const $e=document.createElement("h1");if(Oe.append($e),{dir:$e.dir,str:$e.textContent}=y(this,he),Ie.append(Oe),y(this,te)){const we=document.createElement("span");we.classList.add("popupDate"),y(this,te).then(Ce=>{we.textContent=Ce}),Oe.append(we)}const Ke=y(this,se),I=y(this,Pe);if(I!=null&&I.str&&(!(Ke!=null&&Ke.str)||Ke.str===I.str))d.XfaLayer.render({xfaHtml:I.html,intent:"richText",div:Ie}),Ie.lastChild.classList.add("richText","popupContent");else{const we=this._formatContents(Ke);Ie.append(we)}let K=!!y(this,de),O=K?y(this,de):y(this,De);for(const we of y(this,z))if(!O||s.Util.intersect(we.data.rect,O)!==null){O=we.data.rect,K=!0;break}const B=s.Util.normalizeRect([O[0],Y[3]-O[1]+Y[1],O[2],Y[3]-O[3]+Y[1]]),q=K?O[2]-O[0]+5:0,pe=B[0]+q,je=B[1],{style:Se}=y(this,ue);Se.left=`${100*(pe-ye)/V}%`,Se.top=`${100*(je-Te)/ne}%`,y(this,ue).append(Ie)}_formatContents({str:Y,dir:V}){const ne=document.createElement("p");ne.classList.add("popupContent"),ne.dir=V;const ye=Y.split(/(?:\r\n?|\n)/);for(let Te=0,Ie=ye.length;Te<Ie;++Te){const Oe=ye[Te];ne.append(document.createTextNode(Oe)),Te<Ie-1&&ne.append(document.createElement("br"))}return ne}forceHide(){Ee(this,ze,this.isVisible),y(this,ze)&&(y(this,ue).hidden=!0)}maybeShow(){y(this,ze)&&(Ee(this,ze,!1),y(this,ue).hidden=!1)}get isVisible(){return y(this,ue).hidden===!1}}te=new WeakMap,ve=new WeakMap,xe=new WeakMap,Re=new WeakMap,Ae=new WeakMap,ke=new WeakMap,ue=new WeakMap,se=new WeakMap,z=new WeakMap,J=new WeakMap,de=new WeakMap,fe=new WeakMap,Fe=new WeakMap,De=new WeakMap,Pe=new WeakMap,he=new WeakMap,ze=new WeakMap,Le=new WeakSet,Xr=function(Y){Y.altKey||Y.shiftKey||Y.ctrlKey||Y.metaKey||(Y.key==="Enter"||Y.key==="Escape"&&y(this,fe))&&ce(this,Le,zt).call(this)},zt=function(){Ee(this,fe,!y(this,fe)),y(this,fe)?(ce(this,Le,gr).call(this),y(this,ue).addEventListener("click",y(this,Ae)),y(this,ue).addEventListener("keydown",y(this,ve))):(ce(this,Le,_r).call(this),y(this,ue).removeEventListener("click",y(this,Ae)),y(this,ue).removeEventListener("keydown",y(this,ve)))},gr=function(){y(this,Fe)||this.render(),this.isVisible?y(this,fe)&&y(this,ue).classList.add("focused"):(y(this,ue).hidden=!1,y(this,ue).style.zIndex=parseInt(y(this,ue).style.zIndex)+1e3)},_r=function(){y(this,ue).classList.remove("focused"),!(y(this,fe)||!this.isVisible)&&(y(this,ue).hidden=!0,y(this,ue).style.zIndex=parseInt(y(this,ue).style.zIndex)-1e3)};class M extends g{constructor(Y){super(Y,{isRenderable:!0,ignoreBorder:!0}),this.textContent=Y.data.textContent,this.textPosition=Y.data.textPosition,this.annotationEditorType=s.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const Y=document.createElement("div");Y.classList.add("annotationTextContent"),Y.setAttribute("role","comment");for(const V of this.textContent){const ne=document.createElement("span");ne.textContent=V,Y.append(ne)}this.container.append(Y)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}t.FreeTextAnnotationElement=M;class R extends g{constructor(V){super(V,{isRenderable:!0,ignoreBorder:!0});_e(this,Je,null)}render(){this.container.classList.add("lineAnnotation");const V=this.data,{width:ne,height:ye}=u(V.rect),Te=this.svgFactory.create(ne,ye,!0),Ie=Ee(this,Je,this.svgFactory.createElement("svg:line"));return Ie.setAttribute("x1",V.rect[2]-V.lineCoordinates[0]),Ie.setAttribute("y1",V.rect[3]-V.lineCoordinates[1]),Ie.setAttribute("x2",V.rect[2]-V.lineCoordinates[2]),Ie.setAttribute("y2",V.rect[3]-V.lineCoordinates[3]),Ie.setAttribute("stroke-width",V.borderStyle.width||1),Ie.setAttribute("stroke","transparent"),Ie.setAttribute("fill","transparent"),Te.append(Ie),this.container.append(Te),!V.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return y(this,Je)}addHighlightArea(){this.container.classList.add("highlightArea")}}Je=new WeakMap;class k extends g{constructor(V){super(V,{isRenderable:!0,ignoreBorder:!0});_e(this,nt,null)}render(){this.container.classList.add("squareAnnotation");const V=this.data,{width:ne,height:ye}=u(V.rect),Te=this.svgFactory.create(ne,ye,!0),Ie=V.borderStyle.width,Oe=Ee(this,nt,this.svgFactory.createElement("svg:rect"));return Oe.setAttribute("x",Ie/2),Oe.setAttribute("y",Ie/2),Oe.setAttribute("width",ne-Ie),Oe.setAttribute("height",ye-Ie),Oe.setAttribute("stroke-width",Ie||1),Oe.setAttribute("stroke","transparent"),Oe.setAttribute("fill","transparent"),Te.append(Oe),this.container.append(Te),!V.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return y(this,nt)}addHighlightArea(){this.container.classList.add("highlightArea")}}nt=new WeakMap;class L extends g{constructor(V){super(V,{isRenderable:!0,ignoreBorder:!0});_e(this,ot,null)}render(){this.container.classList.add("circleAnnotation");const V=this.data,{width:ne,height:ye}=u(V.rect),Te=this.svgFactory.create(ne,ye,!0),Ie=V.borderStyle.width,Oe=Ee(this,ot,this.svgFactory.createElement("svg:ellipse"));return Oe.setAttribute("cx",ne/2),Oe.setAttribute("cy",ye/2),Oe.setAttribute("rx",ne/2-Ie/2),Oe.setAttribute("ry",ye/2-Ie/2),Oe.setAttribute("stroke-width",Ie||1),Oe.setAttribute("stroke","transparent"),Oe.setAttribute("fill","transparent"),Te.append(Oe),this.container.append(Te),!V.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return y(this,ot)}addHighlightArea(){this.container.classList.add("highlightArea")}}ot=new WeakMap;class ae extends g{constructor(V){super(V,{isRenderable:!0,ignoreBorder:!0});_e(this,Me,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const V=this.data,{width:ne,height:ye}=u(V.rect),Te=this.svgFactory.create(ne,ye,!0);let Ie=[];for(const $e of V.vertices){const Ke=$e.x-V.rect[0],I=V.rect[3]-$e.y;Ie.push(Ke+","+I)}Ie=Ie.join(" ");const Oe=Ee(this,Me,this.svgFactory.createElement(this.svgElementName));return Oe.setAttribute("points",Ie),Oe.setAttribute("stroke-width",V.borderStyle.width||1),Oe.setAttribute("stroke","transparent"),Oe.setAttribute("fill","transparent"),Te.append(Oe),this.container.append(Te),!V.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return y(this,Me)}addHighlightArea(){this.container.classList.add("highlightArea")}}Me=new WeakMap;class Q extends ae{constructor(Y){super(Y),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class oe extends g{constructor(Y){super(Y,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class re extends g{constructor(V){super(V,{isRenderable:!0,ignoreBorder:!0});_e(this,ge,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=s.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const V=this.data,{width:ne,height:ye}=u(V.rect),Te=this.svgFactory.create(ne,ye,!0);for(const Ie of V.inkLists){let Oe=[];for(const Ke of Ie){const I=Ke.x-V.rect[0],K=V.rect[3]-Ke.y;Oe.push(`${I},${K}`)}Oe=Oe.join(" ");const $e=this.svgFactory.createElement(this.svgElementName);y(this,ge).push($e),$e.setAttribute("points",Oe),$e.setAttribute("stroke-width",V.borderStyle.width||1),$e.setAttribute("stroke","transparent"),$e.setAttribute("fill","transparent"),!V.popupRef&&this.hasPopupData&&this._createPopup(),Te.append($e)}return this.container.append(Te),this.container}getElementsToTriggerPopup(){return y(this,ge)}addHighlightArea(){this.container.classList.add("highlightArea")}}ge=new WeakMap,t.InkAnnotationElement=re;class me extends g{constructor(Y){super(Y,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class H extends g{constructor(Y){super(Y,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class ie extends g{constructor(Y){super(Y,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class le extends g{constructor(Y){super(Y,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class N extends g{constructor(Y){super(Y,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}t.StampAnnotationElement=N;class b extends g{constructor(V){var Te;super(V,{isRenderable:!0});_e(this,Ve);_e(this,be,null);const{filename:ne,content:ye}=this.data.file;this.filename=(0,i.getFilenameFromUrl)(ne,!0),this.content=ye,(Te=this.linkService.eventBus)==null||Te.dispatch("fileattachmentannotation",{source:this,filename:ne,content:ye})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:V,data:ne}=this;let ye;ne.hasAppearance||ne.fillAlpha===0?ye=document.createElement("div"):(ye=document.createElement("img"),ye.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(ne.name)?"paperclip":"pushpin"}.svg`,ne.fillAlpha&&ne.fillAlpha<1&&(ye.style=`filter: opacity(${Math.round(ne.fillAlpha*100)}%);`)),ye.addEventListener("dblclick",ce(this,Ve,vr).bind(this)),Ee(this,be,ye);const{isMac:Te}=s.FeatureTest.platform;return V.addEventListener("keydown",Ie=>{Ie.key==="Enter"&&(Te?Ie.metaKey:Ie.ctrlKey)&&ce(this,Ve,vr).call(this)}),!ne.popupRef&&this.hasPopupData?this._createPopup():ye.classList.add("popupTriggerArea"),V.append(ye),V}getElementsToTriggerPopup(){return y(this,be)}addHighlightArea(){this.container.classList.add("highlightArea")}}be=new WeakMap,Ve=new WeakSet,vr=function(){var V;(V=this.downloadManager)==null||V.openOrDownloadData(this.container,this.content,this.filename)};class v{constructor({div:Y,accessibilityManager:V,annotationCanvasMap:ne,l10n:ye,page:Te,viewport:Ie}){_e(this,Be);_e(this,rt,null);_e(this,ee,null);_e(this,Ne,new Map);this.div=Y,Ee(this,rt,V),Ee(this,ee,ne),this.l10n=ye,this.page=Te,this.viewport=Ie,this.zIndex=0,this.l10n||(this.l10n=o.NullL10n)}async render(Y){const{annotations:V}=Y,ne=this.div;(0,i.setLayerDimensions)(ne,this.viewport);const ye=new Map,Te={data:null,layer:ne,linkService:Y.linkService,downloadManager:Y.downloadManager,imageResourcesPath:Y.imageResourcesPath||"",renderForms:Y.renderForms!==!1,svgFactory:new i.DOMSVGFactory,annotationStorage:Y.annotationStorage||new n.AnnotationStorage,enableScripting:Y.enableScripting===!0,hasJSActions:Y.hasJSActions,fieldObjects:Y.fieldObjects,parent:this,elements:null};for(const Ie of V){if(Ie.noHTML)continue;const Oe=Ie.annotationType===s.AnnotationType.POPUP;if(Oe){const I=ye.get(Ie.id);if(!I)continue;Te.elements=I}else{const{width:I,height:K}=u(Ie.rect);if(I<=0||K<=0)continue}Te.data=Ie;const $e=h.create(Te);if(!$e.isRenderable)continue;if(!Oe&&Ie.popupRef){const I=ye.get(Ie.popupRef);I?I.push($e):ye.set(Ie.popupRef,[$e])}$e.annotationEditorType>0&&y(this,Ne).set($e.data.id,$e);const Ke=$e.render();Ie.hidden&&(Ke.style.visibility="hidden"),ce(this,Be,Kr).call(this,Ke,Ie.id)}ce(this,Be,Er).call(this),await this.l10n.translate(ne)}update({viewport:Y}){const V=this.div;this.viewport=Y,(0,i.setLayerDimensions)(V,{rotation:Y.rotation}),ce(this,Be,Er).call(this),V.hidden=!1}getEditableAnnotations(){return Array.from(y(this,Ne).values())}getEditableAnnotation(Y){return y(this,Ne).get(Y)}}rt=new WeakMap,ee=new WeakMap,Ne=new WeakMap,Be=new WeakSet,Kr=function(Y,V){var ye;const ne=Y.firstChild||Y;ne.id=`${s.AnnotationPrefix}${V}`,this.div.append(Y),(ye=y(this,rt))==null||ye.moveElementInDOM(this.div,Y,ne,!1)},Er=function(){if(!y(this,ee))return;const Y=this.div;for(const[V,ne]of y(this,ee)){const ye=Y.querySelector(`[data-annotation-id="${V}"]`);if(!ye)continue;const{firstChild:Te}=ye;Te?Te.nodeName==="CANVAS"?Te.replaceWith(ne):Te.before(ne):ye.append(ne)}y(this,ee).clear()},t.AnnotationLayer=v},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorConverters=void 0;function r(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function s(n){return Math.max(0,Math.min(255,255*n))}class i{static CMYK_G([a,o,d,l]){return["G",1-Math.min(1,.3*a+.59*d+.11*o+l)]}static G_CMYK([a]){return["CMYK",0,0,0,1-a]}static G_RGB([a]){return["RGB",a,a,a]}static G_rgb([a]){return a=s(a),[a,a,a]}static G_HTML([a]){const o=r(a);return`#${o}${o}${o}`}static RGB_G([a,o,d]){return["G",.3*a+.59*o+.11*d]}static RGB_rgb(a){return a.map(s)}static RGB_HTML(a){return`#${a.map(r).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([a,o,d,l]){return["RGB",1-Math.min(1,a+l),1-Math.min(1,d+l),1-Math.min(1,o+l)]}static CMYK_rgb([a,o,d,l]){return[s(1-Math.min(1,a+l)),s(1-Math.min(1,d+l)),s(1-Math.min(1,o+l))]}static CMYK_HTML(a){const o=this.CMYK_RGB(a).slice(1);return this.RGB_HTML(o)}static RGB_CMYK([a,o,d]){const l=1-a,c=1-o,f=1-d,u=Math.min(l,c,f);return["CMYK",l,c,f,u]}}t.ColorConverters=i},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullL10n=void 0,t.getL10nFallback=s;const r={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};r.print_progress_percent="{{progress}}%";function s(a,o){switch(a){case"find_match_count":a=`find_match_count[${o.total===1?"one":"other"}]`;break;case"find_match_count_limit":a=`find_match_count_limit[${o.limit===1?"one":"other"}]`;break}return r[a]||""}function i(a,o){return o?a.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(d,l)=>l in o?o[l]:"{{"+l+"}}"):a}const n={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(a,o=null,d=s(a,o)){return i(d,o)},async translate(a){}};t.NullL10n=n},(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaLayer=void 0;var s=r(25);class i{static setupStorage(a,o,d,l,c){const f=l.getValue(o,{value:null});switch(d.name){case"textarea":if(f.value!==null&&(a.textContent=f.value),c==="print")break;a.addEventListener("input",u=>{l.setValue(o,{value:u.target.value})});break;case"input":if(d.attributes.type==="radio"||d.attributes.type==="checkbox"){if(f.value===d.attributes.xfaOn?a.setAttribute("checked",!0):f.value===d.attributes.xfaOff&&a.removeAttribute("checked"),c==="print")break;a.addEventListener("change",u=>{l.setValue(o,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(f.value!==null&&a.setAttribute("value",f.value),c==="print")break;a.addEventListener("input",u=>{l.setValue(o,{value:u.target.value})})}break;case"select":if(f.value!==null){a.setAttribute("value",f.value);for(const u of d.children)u.attributes.value===f.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}a.addEventListener("input",u=>{const h=u.target.options,g=h.selectedIndex===-1?"":h[h.selectedIndex].value;l.setValue(o,{value:g})});break}}static setAttributes({html:a,element:o,storage:d=null,intent:l,linkService:c}){const{attributes:f}=o,u=a instanceof HTMLAnchorElement;f.type==="radio"&&(f.name=`${f.name}-${l}`);for(const[h,g]of Object.entries(f))if(g!=null)switch(h){case"class":g.length&&a.setAttribute(h,g.join(" "));break;case"dataId":break;case"id":a.setAttribute("data-element-id",g);break;case"style":Object.assign(a.style,g);break;case"textContent":a.textContent=g;break;default:(!u||h!=="href"&&h!=="newWindow")&&a.setAttribute(h,g)}u&&c.addLinkAttributes(a,f.href,f.newWindow),d&&f.dataId&&this.setupStorage(a,f.dataId,o,d)}static render(a){var p;const o=a.annotationStorage,d=a.linkService,l=a.xfaHtml,c=a.intent||"display",f=document.createElement(l.name);l.attributes&&this.setAttributes({html:f,element:l,intent:c,linkService:d});const u=[[l,-1,f]],h=a.div;if(h.append(f),a.viewport){const x=`matrix(${a.viewport.transform.join(",")})`;h.style.transform=x}c!=="richText"&&h.setAttribute("class","xfaLayer xfaFont");const g=[];for(;u.length>0;){const[x,E,S]=u.at(-1);if(E+1===x.children.length){u.pop();continue}const P=x.children[++u.at(-1)[1]];if(P===null)continue;const{name:F}=P;if(F==="#text"){const C=document.createTextNode(P.value);g.push(C),S.append(C);continue}const A=(p=P==null?void 0:P.attributes)!=null&&p.xmlns?document.createElementNS(P.attributes.xmlns,F):document.createElement(F);if(S.append(A),P.attributes&&this.setAttributes({html:A,element:P,storage:o,intent:c,linkService:d}),P.children&&P.children.length>0)u.push([P,-1,A]);else if(P.value){const C=document.createTextNode(P.value);s.XfaText.shouldBuildText(F)&&g.push(C),A.append(C)}}for(const x of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))x.setAttribute("readOnly",!0);return{textDivs:g}}static update(a){const o=`matrix(${a.viewport.transform.join(",")})`;a.div.style.transform=o,a.div.hidden=!1}}t.XfaLayer=i},(e,t,r)=>{var l,c,f,u,h,g,p,x,E,S,P,F,A,C,_,qr,$r,Yr,Jr,br,Zr,wr,Qr,es,ts,rs,ss,pt,Sr,Ut,Wt,Et,yr,Ht,U,ns,Ar,as,os,Tr,Gt,bt;Object.defineProperty(t,"__esModule",{value:!0}),t.InkEditor=void 0;var s=r(1),i=r(4),n=r(29),a=r(6),o=r(5);const ke=class ke extends i.AnnotationEditor{constructor(z){super({...z,name:"inkEditor"});_e(this,_);_e(this,l,0);_e(this,c,0);_e(this,f,this.canvasPointermove.bind(this));_e(this,u,this.canvasPointerleave.bind(this));_e(this,h,this.canvasPointerup.bind(this));_e(this,g,this.canvasPointerdown.bind(this));_e(this,p,new Path2D);_e(this,x,!1);_e(this,E,!1);_e(this,S,!1);_e(this,P,null);_e(this,F,0);_e(this,A,0);_e(this,C,null);this.color=z.color||null,this.thickness=z.thickness||null,this.opacity=z.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(z){i.AnnotationEditor.initialize(z,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(z,J){switch(z){case s.AnnotationEditorParamsType.INK_THICKNESS:ke._defaultThickness=J;break;case s.AnnotationEditorParamsType.INK_COLOR:ke._defaultColor=J;break;case s.AnnotationEditorParamsType.INK_OPACITY:ke._defaultOpacity=J/100;break}}updateParams(z,J){switch(z){case s.AnnotationEditorParamsType.INK_THICKNESS:ce(this,_,qr).call(this,J);break;case s.AnnotationEditorParamsType.INK_COLOR:ce(this,_,$r).call(this,J);break;case s.AnnotationEditorParamsType.INK_OPACITY:ce(this,_,Yr).call(this,J);break}}static get defaultPropertiesToUpdate(){return[[s.AnnotationEditorParamsType.INK_THICKNESS,ke._defaultThickness],[s.AnnotationEditorParamsType.INK_COLOR,ke._defaultColor||i.AnnotationEditor._defaultLineColor],[s.AnnotationEditorParamsType.INK_OPACITY,Math.round(ke._defaultOpacity*100)]]}get propertiesToUpdate(){return[[s.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||ke._defaultThickness],[s.AnnotationEditorParamsType.INK_COLOR,this.color||ke._defaultColor||i.AnnotationEditor._defaultLineColor],[s.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??ke._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(ce(this,_,Ut).call(this),ce(this,_,Wt).call(this)),this.isAttachedToDOM||(this.parent.add(this),ce(this,_,Et).call(this)),ce(this,_,bt).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,y(this,P).disconnect(),Ee(this,P,null),super.remove())}setParent(z){!this.parent&&z?this._uiManager.removeShouldRescale(this):this.parent&&z===null&&this._uiManager.addShouldRescale(this),super.setParent(z)}onScaleChanging(){const[z,J]=this.parentDimensions,de=this.width*z,fe=this.height*J;this.setDimensions(de,fe)}enableEditMode(){y(this,x)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",y(this,g)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",y(this,g)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){y(this,x)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Ee(this,x,!0),this.div.classList.add("disabled"),ce(this,_,bt).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(z){this._focusEventsAllowed&&(super.focusin(z),this.enableEditMode())}canvasPointerdown(z){z.button!==0||!this.isInEditMode()||y(this,x)||(this.setInForeground(),z.preventDefault(),z.type!=="mouse"&&this.div.focus(),ce(this,_,Zr).call(this,z.offsetX,z.offsetY))}canvasPointermove(z){z.preventDefault(),ce(this,_,wr).call(this,z.offsetX,z.offsetY)}canvasPointerup(z){z.preventDefault(),ce(this,_,Sr).call(this,z)}canvasPointerleave(z){ce(this,_,Sr).call(this,z)}get isResizable(){return!this.isEmpty()&&y(this,x)}render(){if(this.div)return this.div;let z,J;this.width&&(z=this.x,J=this.y),super.render(),i.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Pe=>{var he;return(he=this.div)==null?void 0:he.setAttribute("aria-label",Pe)});const[de,fe,Fe,De]=ce(this,_,Jr).call(this);if(this.setAt(de,fe,0,0),this.setDims(Fe,De),ce(this,_,Ut).call(this),this.width){const[Pe,he]=this.parentDimensions;this.setAspectRatio(this.width*Pe,this.height*he),this.setAt(z*Pe,J*he,this.width*Pe,this.height*he),Ee(this,S,!0),ce(this,_,Et).call(this),this.setDims(this.width*Pe,this.height*he),ce(this,_,pt).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return ce(this,_,Wt).call(this),this.div}setDimensions(z,J){const de=Math.round(z),fe=Math.round(J);if(y(this,F)===de&&y(this,A)===fe)return;Ee(this,F,de),Ee(this,A,fe),this.canvas.style.visibility="hidden";const[Fe,De]=this.parentDimensions;this.width=z/Fe,this.height=J/De,this.fixAndSetPosition(),y(this,x)&&ce(this,_,yr).call(this,z,J),ce(this,_,Et).call(this),ce(this,_,pt).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(z,J,de){var Je,nt,ot;if(z instanceof n.InkAnnotationElement)return null;const fe=super.deserialize(z,J,de);fe.thickness=z.thickness,fe.color=s.Util.makeHexColor(...z.color),fe.opacity=z.opacity;const[Fe,De]=fe.pageDimensions,Pe=fe.width*Fe,he=fe.height*De,ze=fe.parentScale,Le=z.thickness/2;Ee(fe,x,!0),Ee(fe,F,Math.round(Pe)),Ee(fe,A,Math.round(he));const{paths:tt,rect:et,rotation:it}=z;for(let{bezier:Me}of tt){Me=ce(Je=ke,U,as).call(Je,Me,et,it);const ge=[];fe.paths.push(ge);let be=ze*(Me[0]-Le),Ve=ze*(Me[1]-Le);for(let rt=2,ee=Me.length;rt<ee;rt+=6){const Ne=ze*(Me[rt]-Le),Be=ze*(Me[rt+1]-Le),qe=ze*(Me[rt+2]-Le),Ye=ze*(Me[rt+3]-Le),Ge=ze*(Me[rt+4]-Le),Y=ze*(Me[rt+5]-Le);ge.push([[be,Ve],[Ne,Be],[qe,Ye],[Ge,Y]]),be=Ge,Ve=Y}const st=ce(this,U,ns).call(this,ge);fe.bezierPath2D.push(st)}const Xe=ce(nt=fe,_,Tr).call(nt);return Ee(fe,c,Math.max(i.AnnotationEditor.MIN_SIZE,Xe[2]-Xe[0])),Ee(fe,l,Math.max(i.AnnotationEditor.MIN_SIZE,Xe[3]-Xe[1])),ce(ot=fe,_,yr).call(ot,Pe,he),fe}serialize(){if(this.isEmpty())return null;const z=this.getRect(0,0),J=i.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:s.AnnotationEditorType.INK,color:J,thickness:this.thickness,opacity:this.opacity,paths:ce(this,_,os).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,z),pageIndex:this.pageIndex,rect:z,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};l=new WeakMap,c=new WeakMap,f=new WeakMap,u=new WeakMap,h=new WeakMap,g=new WeakMap,p=new WeakMap,x=new WeakMap,E=new WeakMap,S=new WeakMap,P=new WeakMap,F=new WeakMap,A=new WeakMap,C=new WeakMap,_=new WeakSet,qr=function(z){const J=this.thickness;this.addCommands({cmd:()=>{this.thickness=z,ce(this,_,bt).call(this)},undo:()=>{this.thickness=J,ce(this,_,bt).call(this)},mustExec:!0,type:s.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},$r=function(z){const J=this.color;this.addCommands({cmd:()=>{this.color=z,ce(this,_,pt).call(this)},undo:()=>{this.color=J,ce(this,_,pt).call(this)},mustExec:!0,type:s.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Yr=function(z){z/=100;const J=this.opacity;this.addCommands({cmd:()=>{this.opacity=z,ce(this,_,pt).call(this)},undo:()=>{this.opacity=J,ce(this,_,pt).call(this)},mustExec:!0,type:s.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Jr=function(){const{parentRotation:z,parentDimensions:[J,de]}=this;switch(z){case 90:return[0,de,de,J];case 180:return[J,de,J,de];case 270:return[J,0,de,J];default:return[0,0,J,de]}},br=function(){const{ctx:z,color:J,opacity:de,thickness:fe,parentScale:Fe,scaleFactor:De}=this;z.lineWidth=fe*Fe/De,z.lineCap="round",z.lineJoin="round",z.miterLimit=10,z.strokeStyle=`${J}${(0,o.opacityToHex)(de)}`},Zr=function(z,J){this.canvas.addEventListener("contextmenu",a.noContextMenu),this.canvas.addEventListener("pointerleave",y(this,u)),this.canvas.addEventListener("pointermove",y(this,f)),this.canvas.addEventListener("pointerup",y(this,h)),this.canvas.removeEventListener("pointerdown",y(this,g)),this.isEditing=!0,y(this,S)||(Ee(this,S,!0),ce(this,_,Et).call(this),this.thickness||(this.thickness=ke._defaultThickness),this.color||(this.color=ke._defaultColor||i.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=ke._defaultOpacity)),this.currentPath.push([z,J]),Ee(this,E,!1),ce(this,_,br).call(this),Ee(this,C,()=>{ce(this,_,ts).call(this),y(this,C)&&window.requestAnimationFrame(y(this,C))}),window.requestAnimationFrame(y(this,C))},wr=function(z,J){const[de,fe]=this.currentPath.at(-1);if(this.currentPath.length>1&&z===de&&J===fe)return;const Fe=this.currentPath;let De=y(this,p);if(Fe.push([z,J]),Ee(this,E,!0),Fe.length<=2){De.moveTo(...Fe[0]),De.lineTo(z,J);return}Fe.length===3&&(Ee(this,p,De=new Path2D),De.moveTo(...Fe[0])),ce(this,_,rs).call(this,De,...Fe.at(-3),...Fe.at(-2),z,J)},Qr=function(){if(this.currentPath.length===0)return;const z=this.currentPath.at(-1);y(this,p).lineTo(...z)},es=function(z,J){Ee(this,C,null),z=Math.min(Math.max(z,0),this.canvas.width),J=Math.min(Math.max(J,0),this.canvas.height),ce(this,_,wr).call(this,z,J),ce(this,_,Qr).call(this);let de;if(this.currentPath.length!==1)de=ce(this,_,ss).call(this);else{const he=[z,J];de=[[he,he.slice(),he.slice(),he]]}const fe=y(this,p),Fe=this.currentPath;this.currentPath=[],Ee(this,p,new Path2D);const De=()=>{this.allRawPaths.push(Fe),this.paths.push(de),this.bezierPath2D.push(fe),this.rebuild()},Pe=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(ce(this,_,Ut).call(this),ce(this,_,Wt).call(this)),ce(this,_,bt).call(this))};this.addCommands({cmd:De,undo:Pe,mustExec:!0})},ts=function(){if(!y(this,E))return;Ee(this,E,!1);const z=Math.ceil(this.thickness*this.parentScale),J=this.currentPath.slice(-3),de=J.map(De=>De[0]),fe=J.map(De=>De[1]);Math.min(...de)-z,Math.max(...de)+z,Math.min(...fe)-z,Math.max(...fe)+z;const{ctx:Fe}=this;Fe.save(),Fe.clearRect(0,0,this.canvas.width,this.canvas.height);for(const De of this.bezierPath2D)Fe.stroke(De);Fe.stroke(y(this,p)),Fe.restore()},rs=function(z,J,de,fe,Fe,De,Pe){const he=(J+fe)/2,ze=(de+Fe)/2,Le=(fe+De)/2,tt=(Fe+Pe)/2;z.bezierCurveTo(he+2*(fe-he)/3,ze+2*(Fe-ze)/3,Le+2*(fe-Le)/3,tt+2*(Fe-tt)/3,Le,tt)},ss=function(){const z=this.currentPath;if(z.length<=2)return[[z[0],z[0],z.at(-1),z.at(-1)]];const J=[];let de,[fe,Fe]=z[0];for(de=1;de<z.length-2;de++){const[et,it]=z[de],[Xe,Je]=z[de+1],nt=(et+Xe)/2,ot=(it+Je)/2,Me=[fe+2*(et-fe)/3,Fe+2*(it-Fe)/3],ge=[nt+2*(et-nt)/3,ot+2*(it-ot)/3];J.push([[fe,Fe],Me,ge,[nt,ot]]),[fe,Fe]=[nt,ot]}const[De,Pe]=z[de],[he,ze]=z[de+1],Le=[fe+2*(De-fe)/3,Fe+2*(Pe-Fe)/3],tt=[he+2*(De-he)/3,ze+2*(Pe-ze)/3];return J.push([[fe,Fe],Le,tt,[he,ze]]),J},pt=function(){if(this.isEmpty()){ce(this,_,Ht).call(this);return}ce(this,_,br).call(this);const{canvas:z,ctx:J}=this;J.setTransform(1,0,0,1,0,0),J.clearRect(0,0,z.width,z.height),ce(this,_,Ht).call(this);for(const de of this.bezierPath2D)J.stroke(de)},Sr=function(z){this.canvas.removeEventListener("pointerleave",y(this,u)),this.canvas.removeEventListener("pointermove",y(this,f)),this.canvas.removeEventListener("pointerup",y(this,h)),this.canvas.addEventListener("pointerdown",y(this,g)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",a.noContextMenu)},10),ce(this,_,es).call(this,z.offsetX,z.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Ut=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",i.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(z=>{var J;return(J=this.canvas)==null?void 0:J.setAttribute("aria-label",z)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Wt=function(){Ee(this,P,new ResizeObserver(z=>{const J=z[0].contentRect;J.width&&J.height&&this.setDimensions(J.width,J.height)})),y(this,P).observe(this.div)},Et=function(){if(!y(this,S))return;const[z,J]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*z),this.canvas.height=Math.ceil(this.height*J),ce(this,_,Ht).call(this)},yr=function(z,J){const de=ce(this,_,Gt).call(this),fe=(z-de)/y(this,c),Fe=(J-de)/y(this,l);this.scaleFactor=Math.min(fe,Fe)},Ht=function(){const z=ce(this,_,Gt).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+z,this.translationY*this.scaleFactor+z)},U=new WeakSet,ns=function(z){const J=new Path2D;for(let de=0,fe=z.length;de<fe;de++){const[Fe,De,Pe,he]=z[de];de===0&&J.moveTo(...Fe),J.bezierCurveTo(De[0],De[1],Pe[0],Pe[1],he[0],he[1])}return J},Ar=function(z,J,de){const[fe,Fe,De,Pe]=J;switch(de){case 0:for(let he=0,ze=z.length;he<ze;he+=2)z[he]+=fe,z[he+1]=Pe-z[he+1];break;case 90:for(let he=0,ze=z.length;he<ze;he+=2){const Le=z[he];z[he]=z[he+1]+fe,z[he+1]=Le+Fe}break;case 180:for(let he=0,ze=z.length;he<ze;he+=2)z[he]=De-z[he],z[he+1]+=Fe;break;case 270:for(let he=0,ze=z.length;he<ze;he+=2){const Le=z[he];z[he]=De-z[he+1],z[he+1]=Pe-Le}break;default:throw new Error("Invalid rotation")}return z},as=function(z,J,de){const[fe,Fe,De,Pe]=J;switch(de){case 0:for(let he=0,ze=z.length;he<ze;he+=2)z[he]-=fe,z[he+1]=Pe-z[he+1];break;case 90:for(let he=0,ze=z.length;he<ze;he+=2){const Le=z[he];z[he]=z[he+1]-Fe,z[he+1]=Le-fe}break;case 180:for(let he=0,ze=z.length;he<ze;he+=2)z[he]=De-z[he],z[he+1]-=Fe;break;case 270:for(let he=0,ze=z.length;he<ze;he+=2){const Le=z[he];z[he]=Pe-z[he+1],z[he+1]=De-Le}break;default:throw new Error("Invalid rotation")}return z},os=function(z,J,de,fe){var ze,Le;const Fe=[],De=this.thickness/2,Pe=z*J+De,he=z*de+De;for(const tt of this.paths){const et=[],it=[];for(let Xe=0,Je=tt.length;Xe<Je;Xe++){const[nt,ot,Me,ge]=tt[Xe],be=z*nt[0]+Pe,Ve=z*nt[1]+he,st=z*ot[0]+Pe,rt=z*ot[1]+he,ee=z*Me[0]+Pe,Ne=z*Me[1]+he,Be=z*ge[0]+Pe,qe=z*ge[1]+he;Xe===0&&(et.push(be,Ve),it.push(be,Ve)),et.push(st,rt,ee,Ne,Be,qe),it.push(st,rt),Xe===Je-1&&it.push(Be,qe)}Fe.push({bezier:ce(ze=ke,U,Ar).call(ze,et,fe,this.rotation),points:ce(Le=ke,U,Ar).call(Le,it,fe,this.rotation)})}return Fe},Tr=function(){let z=1/0,J=-1/0,de=1/0,fe=-1/0;for(const Fe of this.paths)for(const[De,Pe,he,ze]of Fe){const Le=s.Util.bezierBoundingBox(...De,...Pe,...he,...ze);z=Math.min(z,Le[0]),de=Math.min(de,Le[1]),J=Math.max(J,Le[2]),fe=Math.max(fe,Le[3])}return[z,de,J,fe]},Gt=function(){return y(this,x)?Math.ceil(this.thickness*this.parentScale):0},bt=function(z=!1){if(this.isEmpty())return;if(!y(this,x)){ce(this,_,pt).call(this);return}const J=ce(this,_,Tr).call(this),de=ce(this,_,Gt).call(this);Ee(this,c,Math.max(i.AnnotationEditor.MIN_SIZE,J[2]-J[0])),Ee(this,l,Math.max(i.AnnotationEditor.MIN_SIZE,J[3]-J[1]));const fe=Math.ceil(de+y(this,c)*this.scaleFactor),Fe=Math.ceil(de+y(this,l)*this.scaleFactor),[De,Pe]=this.parentDimensions;this.width=fe/De,this.height=Fe/Pe,this.setAspectRatio(fe,Fe);const he=this.translationX,ze=this.translationY;this.translationX=-J[0],this.translationY=-J[1],ce(this,_,Et).call(this),ce(this,_,pt).call(this),Ee(this,F,fe),Ee(this,A,Fe),this.setDims(fe,Fe);const Le=z?de/this.scaleFactor/2:0;this.translate(he-this.translationX-Le,ze-this.translationY-Le)},_e(ke,U),lt(ke,"_defaultColor",null),lt(ke,"_defaultOpacity",1),lt(ke,"_defaultThickness",1),lt(ke,"_type","ink");let d=ke;t.InkEditor=d},(e,t,r)=>{var d,l,c,f,u,h,g,p,x,E,S,Nt,Pt,Vt,Rr,ls,cs,Cr,Xt,ds;Object.defineProperty(t,"__esModule",{value:!0}),t.StampEditor=void 0;var s=r(1),i=r(4),n=r(6),a=r(29);const k=class k extends i.AnnotationEditor{constructor(Q){super({...Q,name:"stampEditor"});_e(this,S);_e(this,d,null);_e(this,l,null);_e(this,c,null);_e(this,f,null);_e(this,u,null);_e(this,h,null);_e(this,g,null);_e(this,p,null);_e(this,x,!1);_e(this,E,!1);Ee(this,f,Q.bitmapUrl),Ee(this,u,Q.bitmapFile)}static initialize(Q){i.AnnotationEditor.initialize(Q)}static get supportedTypes(){const Q=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,s.shadow)(this,"supportedTypes",Q.map(oe=>`image/${oe}`))}static get supportedTypesStr(){return(0,s.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(Q){return this.supportedTypes.includes(Q)}static paste(Q,oe){oe.pasteEditor(s.AnnotationEditorType.STAMP,{bitmapFile:Q.getAsFile()})}remove(){var Q,oe;y(this,l)&&(Ee(this,d,null),this._uiManager.imageManager.deleteId(y(this,l)),(Q=y(this,h))==null||Q.remove(),Ee(this,h,null),(oe=y(this,g))==null||oe.disconnect(),Ee(this,g,null)),super.remove()}rebuild(){if(!this.parent){y(this,l)&&ce(this,S,Vt).call(this);return}super.rebuild(),this.div!==null&&(y(this,l)&&ce(this,S,Vt).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(y(this,c)||y(this,d)||y(this,f)||y(this,u))}get isResizable(){return!0}render(){if(this.div)return this.div;let Q,oe;if(this.width&&(Q=this.x,oe=this.y),super.render(),this.div.hidden=!0,y(this,d)?ce(this,S,Rr).call(this):ce(this,S,Vt).call(this),this.width){const[re,me]=this.parentDimensions;this.setAt(Q*re,oe*me,this.width*re,this.height*me)}return this.div}static deserialize(Q,oe,re){if(Q instanceof a.StampAnnotationElement)return null;const me=super.deserialize(Q,oe,re),{rect:H,bitmapUrl:ie,bitmapId:le,isSvg:N,accessibilityData:b}=Q;le&&re.imageManager.isValidId(le)?Ee(me,l,le):Ee(me,f,ie),Ee(me,x,N);const[v,j]=me.pageDimensions;return me.width=(H[2]-H[0])/v,me.height=(H[3]-H[1])/j,b&&(me.altTextData=b),me}serialize(Q=!1,oe=null){if(this.isEmpty())return null;const re={annotationType:s.AnnotationEditorType.STAMP,bitmapId:y(this,l),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:y(this,x),structTreeParentId:this._structTreeParentId};if(Q)return re.bitmapUrl=ce(this,S,Xt).call(this,!0),re.accessibilityData=this.altTextData,re;const{decorative:me,altText:H}=this.altTextData;if(!me&&H&&(re.accessibilityData={type:"Figure",alt:H}),oe===null)return re;oe.stamps||(oe.stamps=new Map);const ie=y(this,x)?(re.rect[2]-re.rect[0])*(re.rect[3]-re.rect[1]):null;if(!oe.stamps.has(y(this,l)))oe.stamps.set(y(this,l),{area:ie,serialized:re}),re.bitmap=ce(this,S,Xt).call(this,!1);else if(y(this,x)){const le=oe.stamps.get(y(this,l));ie>le.area&&(le.area=ie,le.serialized.bitmap.close(),le.serialized.bitmap=ce(this,S,Xt).call(this,!1))}return re}};d=new WeakMap,l=new WeakMap,c=new WeakMap,f=new WeakMap,u=new WeakMap,h=new WeakMap,g=new WeakMap,p=new WeakMap,x=new WeakMap,E=new WeakMap,S=new WeakSet,Nt=function(Q,oe=!1){if(!Q){this.remove();return}Ee(this,d,Q.bitmap),oe||(Ee(this,l,Q.id),Ee(this,x,Q.isSvg)),ce(this,S,Rr).call(this)},Pt=function(){Ee(this,c,null),this._uiManager.enableWaiting(!1),y(this,h)&&this.div.focus()},Vt=function(){if(y(this,l)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(y(this,l)).then(oe=>ce(this,S,Nt).call(this,oe,!0)).finally(()=>ce(this,S,Pt).call(this));return}if(y(this,f)){const oe=y(this,f);Ee(this,f,null),this._uiManager.enableWaiting(!0),Ee(this,c,this._uiManager.imageManager.getFromUrl(oe).then(re=>ce(this,S,Nt).call(this,re)).finally(()=>ce(this,S,Pt).call(this)));return}if(y(this,u)){const oe=y(this,u);Ee(this,u,null),this._uiManager.enableWaiting(!0),Ee(this,c,this._uiManager.imageManager.getFromFile(oe).then(re=>ce(this,S,Nt).call(this,re)).finally(()=>ce(this,S,Pt).call(this)));return}const Q=document.createElement("input");Q.type="file",Q.accept=k.supportedTypesStr,Ee(this,c,new Promise(oe=>{Q.addEventListener("change",async()=>{if(!Q.files||Q.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const re=await this._uiManager.imageManager.getFromFile(Q.files[0]);ce(this,S,Nt).call(this,re)}oe()}),Q.addEventListener("cancel",()=>{this.remove(),oe()})}).finally(()=>ce(this,S,Pt).call(this))),Q.click()},Rr=function(){const{div:Q}=this;let{width:oe,height:re}=y(this,d);const[me,H]=this.pageDimensions,ie=.75;if(this.width)oe=this.width*me,re=this.height*H;else if(oe>ie*me||re>ie*H){const v=Math.min(ie*me/oe,ie*H/re);oe*=v,re*=v}const[le,N]=this.parentDimensions;this.setDims(oe*le/me,re*N/H),this._uiManager.enableWaiting(!1);const b=Ee(this,h,document.createElement("canvas"));Q.append(b),Q.hidden=!1,ce(this,S,Cr).call(this,oe,re),ce(this,S,ds).call(this),y(this,E)||(this.parent.addUndoableEditor(this),Ee(this,E,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},ls=function(Q,oe){var ie;const[re,me]=this.parentDimensions;this.width=Q/re,this.height=oe/me,this.setDims(Q,oe),(ie=this._initialOptions)!=null&&ie.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,y(this,p)!==null&&clearTimeout(y(this,p)),Ee(this,p,setTimeout(()=>{Ee(this,p,null),ce(this,S,Cr).call(this,Q,oe)},200))},cs=function(Q,oe){const{width:re,height:me}=y(this,d);let H=re,ie=me,le=y(this,d);for(;H>2*Q||ie>2*oe;){const N=H,b=ie;H>2*Q&&(H=H>=16384?Math.floor(H/2)-1:Math.ceil(H/2)),ie>2*oe&&(ie=ie>=16384?Math.floor(ie/2)-1:Math.ceil(ie/2));const v=new OffscreenCanvas(H,ie);v.getContext("2d").drawImage(le,0,0,N,b,0,0,H,ie),le=v.transferToImageBitmap()}return le},Cr=function(Q,oe){Q=Math.ceil(Q),oe=Math.ceil(oe);const re=y(this,h);if(!re||re.width===Q&&re.height===oe)return;re.width=Q,re.height=oe;const me=y(this,x)?y(this,d):ce(this,S,cs).call(this,Q,oe),H=re.getContext("2d");H.filter=this._uiManager.hcmFilter,H.drawImage(me,0,0,me.width,me.height,0,0,Q,oe)},Xt=function(Q){if(Q){if(y(this,x)){const me=this._uiManager.imageManager.getSvgUrl(y(this,l));if(me)return me}const oe=document.createElement("canvas");return{width:oe.width,height:oe.height}=y(this,d),oe.getContext("2d").drawImage(y(this,d),0,0),oe.toDataURL()}if(y(this,x)){const[oe,re]=this.pageDimensions,me=Math.round(this.width*oe*n.PixelsPerInch.PDF_TO_CSS_UNITS),H=Math.round(this.height*re*n.PixelsPerInch.PDF_TO_CSS_UNITS),ie=new OffscreenCanvas(me,H);return ie.getContext("2d").drawImage(y(this,d),0,0,y(this,d).width,y(this,d).height,0,0,me,H),ie.transferToImageBitmap()}return structuredClone(y(this,d))},ds=function(){Ee(this,g,new ResizeObserver(Q=>{const oe=Q[0].contentRect;oe.width&&oe.height&&ce(this,S,ls).call(this,oe.width,oe.height)})),y(this,g).observe(this.div)},lt(k,"_type","stamp");let o=k;t.StampEditor=o}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var t=__webpack_module_cache__[e];if(t!==void 0)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__w_pdfjs_require__),r.exports}var __webpack_exports__={};return(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AbortException",{enumerable:!0,get:function(){return t.AbortException}}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return n.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return t.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return t.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return a.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return o.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return t.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return t.CMapCompressionType}}),Object.defineProperty(e,"DOMSVGFactory",{enumerable:!0,get:function(){return s.DOMSVGFactory}}),Object.defineProperty(e,"FeatureTest",{enumerable:!0,get:function(){return t.FeatureTest}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return d.GlobalWorkerOptions}}),Object.defineProperty(e,"ImageKind",{enumerable:!0,get:function(){return t.ImageKind}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return t.InvalidPDFException}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return t.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return t.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return r.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return s.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return r.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return t.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return t.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return s.PixelsPerInch}}),Object.defineProperty(e,"PromiseCapability",{enumerable:!0,get:function(){return t.PromiseCapability}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return s.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return r.SVGGraphics}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return t.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return t.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return t.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return l.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return r.build}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return t.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return r.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return s.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return s.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return s.getXfaPageViewport}}),Object.defineProperty(e,"isDataScheme",{enumerable:!0,get:function(){return s.isDataScheme}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return s.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return s.loadScript}}),Object.defineProperty(e,"noContextMenu",{enumerable:!0,get:function(){return s.noContextMenu}}),Object.defineProperty(e,"normalizeUnicode",{enumerable:!0,get:function(){return t.normalizeUnicode}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return i.renderTextLayer}}),Object.defineProperty(e,"setLayerDimensions",{enumerable:!0,get:function(){return s.setLayerDimensions}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return t.shadow}}),Object.defineProperty(e,"updateTextLayer",{enumerable:!0,get:function(){return i.updateTextLayer}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return r.version}});var t=__w_pdfjs_require__(1),r=__w_pdfjs_require__(2),s=__w_pdfjs_require__(6),i=__w_pdfjs_require__(26),n=__w_pdfjs_require__(27),a=__w_pdfjs_require__(5),o=__w_pdfjs_require__(29),d=__w_pdfjs_require__(14),l=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;pdfExports.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`;function detectPDFType(e,t){const r=e.toUpperCase(),s=t.toUpperCase();return s.includes("FQ")||s.includes("FISICO")||r.includes("ANÁLISE FÍSICO-QUÍMICA")||r.includes("CRUDE OIL ANALYSIS")||r.includes("DENSITY")&&r.includes("BSW")&&r.includes("API")?"FISICO_QUIMICO":s.includes("SEPARATOR")||s.includes("TS_")||s.includes("TEST_SEP")||s.includes("SEP_")||r.includes("TEST SEPARATOR")||r.includes("SEPARADOR DE TESTE")||r.includes("SEPARATOR")&&(r.includes("DAILY")||r.includes("MASS"))?"SEPARATOR":s.includes("B03")||r.includes("TOPSIDE")||r.includes("RISER P5")||r.includes("RISER P6")?"B03_TOPSIDE":s.includes("B05")||r.includes("SUBSEA")||r.includes("PE_4")||r.includes("PE_EO")?"B05_SUBSEA":s.includes("PVT")||s.includes("CALIBRATION")||r.includes("K-FACTORS")||r.includes("MOLAR COMPOSITION")?"PVT_CALIBRATION":"UNKNOWN"}function extractDate(e,t){const r=t.match(/(\d{8})/);if(r){const i=r[1];return`${i.slice(0,4)}-${i.slice(4,6)}-${i.slice(6,8)}`}const s=e.match(/(\d{4})[/-](\d{2})[/-](\d{2})/);return s?`${s[1]}-${s[2]}-${s[3]}`:new Date().toISOString().split("T")[0]}function extractNumber(e,t){const r=e.match(t);if(r){const s=r[1].replace(",",".");return parseFloat(s)||0}return 0}function parseB03Topside(e,t){const r=extractDate(e,t);let s="13FT0367";(e.includes("P6")||e.includes("13FT0417"))&&(s="13FT0417");let i=extractNumber(e,/(?:oil|óleo)[\s:]+(\d+\.?\d*)/i),n=extractNumber(e,/(?:gas|gás)[\s:]+(\d+\.?\d*)/i),a=extractNumber(e,/(?:water|água)[\s:]+(\d+\.?\d*)/i);if(i===0){const u=e.match(/Oil\s+(\d+\.?\d*)/i);u&&(i=parseFloat(u[1])||0)}if(n===0){const u=e.match(/Gas\s+(\d+\.?\d*)/i);u&&(n=parseFloat(u[1])||0)}if(a===0){const u=e.match(/Water\s+(\d+\.?\d*)/i);u&&(a=parseFloat(u[1])||0)}const o=/(\d{3,5}\.?\d*)\s*(?:t|ton)/gi,d=[];let l;for(;(l=o.exec(e))!==null;)d.push(parseFloat(l[1]));d.length>=3&&i===0&&(i=d[0],n=d[1],a=d[2]||0);const c=i+n,f=c+a;return{date:r,source:"TOPSIDE",meterTag:s,oil:i,gas:n,water:a,hc:c,total:f,fileName:t}}function parseB05Subsea(e,t){const r=extractDate(e,t);let s="18FT1506";e.includes("PE_EO4")||e.includes("18FT1806")?s="18FT1806":e.includes("PE_EO105")||e.includes("18FT1706")?s="18FT1706":(e.includes("PE_EO10")||e.includes("18FT1406"))&&(s="18FT1406");let i=extractNumber(e,/(?:oil|óleo)[\s:]+(\d+\.?\d*)/i),n=extractNumber(e,/(?:gas|gás)[\s:]+(\d+\.?\d*)/i),a=extractNumber(e,/(?:water|água)[\s:]+(\d+\.?\d*)/i);if(n===0){const u=e.match(/(?:hc|hydrocarbon)[\s:]+(\d+\.?\d*)/i);u&&(i=parseFloat(u[1])||0)}const o=/(\d{3,5}\.?\d*)\s*(?:t|ton)/gi,d=[];let l;for(;(l=o.exec(e))!==null;)d.push(parseFloat(l[1]));d.length>=2&&i===0&&(i=d[0],a=d[1]||0);const c=i+n,f=c+a;return{date:r,source:"SUBSEA",meterTag:s,oil:i,gas:n,water:a,hc:c,total:f,fileName:t}}function parseSeparator(e,t){const r=extractDate(e,t),s="TEST_SEPARATOR";let i=extractNumber(e,/(?:oil|óleo)[\s:]+(\d+\.?\d*)/i),n=extractNumber(e,/(?:gas|gás)[\s:]+(\d+\.?\d*)/i),a=extractNumber(e,/(?:water|água)[\s:]+(\d+\.?\d*)/i);if(i===0){const u=e.match(/(?:Mass|Massa).*?Oil\s+(\d+\.?\d*)/i)||e.match(/Oil.*?(?:Mass|Massa)\s+(\d+\.?\d*)/i);u&&(i=parseFloat(u[1])||0)}if(n===0){const u=e.match(/(?:Mass|Massa).*?Gas\s+(\d+\.?\d*)/i)||e.match(/Gas.*?(?:Mass|Massa)\s+(\d+\.?\d*)/i);u&&(n=parseFloat(u[1])||0)}if(a===0){const u=e.match(/(?:Mass|Massa).*?Water\s+(\d+\.?\d*)/i)||e.match(/Water.*?(?:Mass|Massa)\s+(\d+\.?\d*)/i);u&&(a=parseFloat(u[1])||0)}const o=/(\d{3,5}\.?\d*)\s*(?:t|ton|kg)/gi,d=[];let l;for(;(l=o.exec(e))!==null;)d.push(parseFloat(l[1]));d.length>=3&&i===0&&(i=d[0],n=d[1],a=d[2]||0);const c=i+n,f=c+a;return{date:r,source:"SEPARATOR",meterTag:s,oil:i,gas:n,water:a,hc:c,total:f,fileName:t}}function parsePhysicoChemical(e,t){const r=extractDate(e,t),s=e.match(/(?:sample|amostra)[\s:]+([A-Z0-9\-]+)/i)||e.match(/(?:ID|código)[\s:]+([A-Z0-9\-]+)/i),i=s?s[1]:t.replace(".pdf",""),n=extractNumber(e,/(?:density|densidade)[\s@:]+(?:\d+[°C℃]\s*)?(\d+\.?\d*)/i)||extractNumber(e,/(\d{3,4}\.?\d*)\s*kg\/m/i),a=extractNumber(e,/API[\s:]+(\d+\.?\d*)/i)||extractNumber(e,/(?:grau|°)\s*API[\s:]+(\d+\.?\d*)/i),o=extractNumber(e,/BS[\s]*[&W]*[\s:]+(\d+\.?\d*)/i)||extractNumber(e,/BSW[\s:]+(\d+\.?\d*)/i),d=extractNumber(e,/(?:viscosity|viscosidade)[\s@:]+(?:\d+[°C℃]\s*)?(\d+\.?\d*)/i),l=extractNumber(e,/(?:pour point|ponto de fluidez)[\s:]+(-?\d+\.?\d*)/i),c=extractNumber(e,/(?:sulphur|sulfur|enxofre)[\s:]+(\d+\.?\d*)/i),f=extractNumber(e,/(?:salt|sal)[\s:]+(\d+\.?\d*)/i),u=extractNumber(e,/(?:RVP|reid vapor|pressão de vapor)[\s:]+(\d+\.?\d*)/i),h=extractNumber(e,/H2S[\s:]+(\d+\.?\d*)/i)||extractNumber(e,/(?:sulfeto de hidrogênio)[\s:]+(\d+\.?\d*)/i),g=extractNumber(e,/CO2[\s:]+(\d+\.?\d*)/i)||extractNumber(e,/(?:dióxido de carbono)[\s:]+(\d+\.?\d*)/i),p=extractNumber(e,/(?:water content|teor de água)[\s:]+(\d+\.?\d*)/i);return{date:r,sampleId:i,density:n,api:a,bsw:o,viscosity:d,pourPoint:l,sulphur:c,saltContent:f,reidVaporPressure:u,h2s:h,co2:g,waterContent:p,fileName:t}}function parsePVTCalibration(e,t){const r=e.match(/(?:calibration|cal\.?)\s*(?:#|no\.?|number)?\s*(\d+)/i),s=r?parseInt(r[1]):0;let i="13FT0367",n="Riser P5";e.includes("13FT0417")&&(i="13FT0417",n="Riser P6");const a=extractDate(e,t),o=e.match(/end[:\s]+(\d{4}-\d{2}-\d{2})/i),d=o?o[1]:a,l=extractNumber(e,/mpfm.*?pressure[:\s]+(\d+\.?\d*)/i)||extractNumber(e,/pressure.*?mpfm[:\s]+(\d+\.?\d*)/i)||11505.73,c=extractNumber(e,/separator.*?pressure[:\s]+(\d+\.?\d*)/i)||extractNumber(e,/pressure.*?separator[:\s]+(\d+\.?\d*)/i)||8343.63,f=extractNumber(e,/mpfm.*?temp[:\s]+(\d+\.?\d*)/i)||extractNumber(e,/temp.*?mpfm[:\s]+(\d+\.?\d*)/i)||75.07,u=extractNumber(e,/separator.*?temp[:\s]+(\d+\.?\d*)/i)||extractNumber(e,/temp.*?separator[:\s]+(\d+\.?\d*)/i)||72.18,h=[{component:"N₂",molPercent:.575,molecularWeight:28.01},{component:"CO₂",molPercent:.02,molecularWeight:44.01},{component:"C₁",molPercent:62.183,molecularWeight:16.04},{component:"C₂",molPercent:8.069,molecularWeight:30.07},{component:"C₃",molPercent:5.047,molecularWeight:44.1},{component:"i-C₄",molPercent:1.069,molecularWeight:58.12},{component:"n-C₄",molPercent:1.858,molecularWeight:58.12},{component:"i-C₅",molPercent:.681,molecularWeight:72.15},{component:"n-C₅",molPercent:.788,molecularWeight:72.15},{component:"C₆",molPercent:1.112,molecularWeight:86.18},{component:"C₇",molPercent:1.138,molecularWeight:97.37},{component:"C₈",molPercent:1.657,molecularWeight:111.29},{component:"C₉",molPercent:1.472,molecularWeight:125.25},{component:"C₁₀+",molPercent:14.331,molecularWeight:289.64}],g=extractNumber(e,/k[_-]?oil.*?new[:\s]+(\d+\.?\d*)/i)||extractNumber(e,/new.*?k[_-]?oil[:\s]+(\d+\.?\d*)/i)||1.0908,p=extractNumber(e,/k[_-]?gas.*?new[:\s]+(\d+\.?\d*)/i)||extractNumber(e,/new.*?k[_-]?gas[:\s]+(\d+\.?\d*)/i)||1.09262,x=extractNumber(e,/k[_-]?water.*?new[:\s]+(\d+\.?\d*)/i)||1,E=extractNumber(e,/mpfm.*?oil.*?(\d{4,}\.?\d*)/i)||6365.07,S=extractNumber(e,/mpfm.*?gas.*?(\d{3,}\.?\d*)/i)||1476.18,P=extractNumber(e,/mpfm.*?water.*?(\d+\.?\d*)/i)||1.46,F=extractNumber(e,/separator.*?oil.*?(\d{4,}\.?\d*)/i)||6742.65,A=extractNumber(e,/separator.*?gas.*?(\d{3,}\.?\d*)/i)||1813.28,C=extractNumber(e,/separator.*?water.*?(\d+\.?\d*)/i)||24.93;return{calibrationNo:s,meterTag:i,meterName:n,startDate:a,endDate:d,pressure:{mpfm:l,separator:c},temperature:{mpfm:f,separator:u},composition:h,kFactors:{oil:{used:.94433,new:g},gas:{used:.96191,new:p},water:{used:1,new:x}},accumulatedMass:{mpfm:{oil:E,gas:S,water:P,hc:E+S},separator:{oil:F,gas:A,water:C,hc:F+A}},fileName:t}}async function extractTextFromPDF(e){const t=await e.arrayBuffer(),r=await pdfExports.getDocument({data:t}).promise;let s="";for(let i=1;i<=r.numPages;i++){const o=(await(await r.getPage(i)).getTextContent()).items.filter(d=>"str"in d).map(d=>d.str).join(" ");s+=o+`
`}return s}async function parsePDFFile(e){try{const t=await extractTextFromPDF(e),r=detectPDFType(t,e.name);switch(r){case"B03_TOPSIDE":return{success:!0,type:r,dailyData:parseB03Topside(t,e.name),fileName:e.name};case"B05_SUBSEA":return{success:!0,type:r,dailyData:parseB05Subsea(t,e.name),fileName:e.name};case"SEPARATOR":return{success:!0,type:r,dailyData:parseSeparator(t,e.name),fileName:e.name};case"PVT_CALIBRATION":return{success:!0,type:r,calibrationData:parsePVTCalibration(t,e.name),fileName:e.name};case"FISICO_QUIMICO":return{success:!0,type:r,physicoChemicalData:parsePhysicoChemical(t,e.name),fileName:e.name};default:return{success:!1,type:"UNKNOWN",error:"Tipo de PDF não reconhecido. Use arquivos B03 (Topside), B05 (Subsea), Separator, PVT Calibration ou Análise Físico-Química.",fileName:e.name}}}catch(t){return{success:!1,type:"UNKNOWN",error:t instanceof Error?t.message:"Erro ao processar PDF",fileName:e.name}}}async function parsePDFBatch(e){const t=[];for(const r of e){const s=await parsePDFFile(r);t.push(s)}return t}const ImportDataModal=({isOpen:e,onClose:t})=>{const{importMonitoringData:r,addAlert:s,updateMeter:i,meters:n}=useAppStore(),[a,o]=reactExports.useState([]),[d,l]=reactExports.useState([]),[c,f]=reactExports.useState(!1),[u,h]=reactExports.useState(!1),g=reactExports.useRef(null),p=reactExports.useCallback(T=>{T.preventDefault(),h(!0)},[]),x=reactExports.useCallback(T=>{T.preventDefault(),h(!1)},[]),E=reactExports.useCallback(T=>{T.preventDefault(),h(!1);const M=Array.from(T.dataTransfer.files).filter(R=>R.type==="application/pdf"||R.name.endsWith(".pdf"));M.length>0&&o(R=>[...R,...M])},[]),S=T=>{const M=Array.from(T.target.files||[]).filter(R=>R.type==="application/pdf"||R.name.endsWith(".pdf"));M.length>0&&o(R=>[...R,...M]),g.current&&(g.current.value="")},P=T=>{o(M=>M.filter((R,k)=>k!==T)),l(M=>M.filter((R,k)=>k!==T))},F=async()=>{if(a.length!==0){f(!0),l([]);try{const T=await parsePDFBatch(a);l(T)}catch{s({type:"error",severity:"critical",message:"Erro ao processar arquivos PDF"})}finally{f(!1)}}},A=()=>{const T=d.filter(k=>k.success);if(T.length===0){s({type:"error",severity:"warning",message:"Nenhum dado válido para importar"});return}const M=new Map;T.forEach(k=>{if(k.dailyData){const L=k.dailyData.date,ae=M.get(L)||{};k.dailyData.source==="TOPSIDE"?ae.topside=k.dailyData:ae.subsea=k.dailyData,M.set(L,ae)}if(k.calibrationData){const L=n.find(ae=>ae.tag===k.calibrationData.meterTag);L&&(i(L.id,{kOil:k.calibrationData.kFactors.oil.new,kGas:k.calibrationData.kFactors.gas.new,kWater:k.calibrationData.kFactors.water.new,lastCalibration:k.calibrationData.endDate}),s({type:"success",severity:"info",message:`K-factors do medidor ${L.tag} atualizados pela calibração`,meterId:L.id,meterTag:L.tag}))}});const R=[];M.forEach((k,L)=>{const ae=k.subsea,Q=k.topside,oe=(ae==null?void 0:ae.oil)||0,re=(ae==null?void 0:ae.gas)||0,me=(ae==null?void 0:ae.water)||0,H=oe+re,ie=(Q==null?void 0:Q.oil)||0,le=(Q==null?void 0:Q.gas)||0,N=(Q==null?void 0:Q.water)||0,b=ie+le,v=ie*.98,j=le*.99,D=N,U=v+j,W=H>0?(b-H)/H*100:0,Z=H+me,te=b+N,ve=Z>0?(te-Z)/Z*100:0,xe=Math.abs(W)>10?"FAIL":Math.abs(W)>7?"ALERT":"OK",Re=Math.abs(ve)>7?"FAIL":Math.abs(ve)>5?"ALERT":"OK";R.push({id:`mon-${L}-${Date.now()}`,date:L,subOil:oe,subGas:re,subWater:me,subHC:H,topOil:ie,topGas:le,topWater:N,topHC:b,sepOil:v,sepGas:j,sepWater:D,sepHC:U,hcBalTS:parseFloat(W.toFixed(2)),totalBalTS:parseFloat(ve.toFixed(2)),hcBalancePercent:parseFloat(W.toFixed(2)),totalBalancePercent:parseFloat(ve.toFixed(2)),hcStatus:xe,totalStatus:Re,action:xe==="FAIL"||Re==="FAIL"?"INVESTIGAR":"MONITORAR",subVsTS:parseFloat(W.toFixed(2)),topVsTS:0,topVsSub:parseFloat(((b-H)/(H||1)*100).toFixed(2))})}),R.length>0&&(r(R),s({type:"success",severity:"info",message:`${R.length} registro(s) de produção importado(s) com sucesso`})),C()},C=()=>{o([]),l([]),f(!1),t()},_=d.filter(T=>T.success).length,w=d.filter(T=>!T.success).length;return jsxRuntimeExports.jsx(Modal,{isOpen:e,onClose:C,title:"Importar Relatórios PDF",size:"lg",children:jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-blue-300",children:"Arraste e solte arquivos PDF ou clique para selecionar. São aceitos:"}),jsxRuntimeExports.jsxs("ul",{className:"text-xs text-blue-300/80 mt-2 space-y-1 ml-4",children:[jsxRuntimeExports.jsxs("li",{children:["• ",jsxRuntimeExports.jsx("strong",{children:"B03_MPFM_Daily"})," - Relatórios Topside (Riser P5/P6)"]}),jsxRuntimeExports.jsxs("li",{children:["• ",jsxRuntimeExports.jsx("strong",{children:"B05_MPFM_Daily"})," - Relatórios Subsea (PE_4, PE_EO)"]}),jsxRuntimeExports.jsxs("li",{children:["• ",jsxRuntimeExports.jsx("strong",{children:"PVTCalibration"})," - Relatórios de Calibração PVT"]})]})]}),jsxRuntimeExports.jsxs("div",{onDragOver:p,onDragLeave:x,onDrop:E,onClick:()=>{var T;return(T=g.current)==null?void 0:T.click()},className:cn("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-all",u?"border-blue-500 bg-blue-500/10":"border-zinc-600 hover:border-zinc-500 hover:bg-zinc-800/50"),children:[jsxRuntimeExports.jsx("input",{ref:g,type:"file",accept:".pdf",multiple:!0,onChange:S,className:"hidden","aria-label":"Select PDF files"}),jsxRuntimeExports.jsx(FileUp,{size:48,className:cn("mx-auto mb-3",u?"text-blue-400":"text-zinc-500")}),jsxRuntimeExports.jsx("p",{className:"text-zinc-300 font-medium",children:u?"Solte os arquivos aqui":"Arraste PDFs ou clique para selecionar"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Suporta múltiplos arquivos (importação em lote)"})]}),a.length>0&&jsxRuntimeExports.jsxs(Card,{className:"p-3 bg-zinc-800/50 max-h-48 overflow-y-auto",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsxs("span",{className:"text-sm font-medium text-zinc-300",children:[a.length," arquivo(s) selecionado(s)"]}),d.length>0&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[_>0&&jsxRuntimeExports.jsxs(Badge,{variant:"success",children:[_," OK"]}),w>0&&jsxRuntimeExports.jsxs(Badge,{variant:"error",children:[w," Erro"]})]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:a.map((T,M)=>{const R=d[M];return jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-2 bg-zinc-900/50 rounded",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[jsxRuntimeExports.jsx(FileText,{size:16,className:"text-zinc-400 flex-shrink-0"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-zinc-300 truncate",children:T.name})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[R&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:R.success?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(CheckCircle,{size:14,className:"text-emerald-400"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-emerald-400",children:R.type.replace("_"," ")})]}):jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(XCircle,{size:14,className:"text-red-400"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-red-400 max-w-32 truncate",children:R.error})]})}),jsxRuntimeExports.jsx("button",{type:"button",title:"Remover arquivo",onClick:k=>{k.stopPropagation(),P(M)},className:"p-1 text-zinc-500 hover:text-red-400 transition-colors",children:jsxRuntimeExports.jsx(Trash2,{size:14})})]})]},M)})})]}),d.length>0&&_>0&&jsxRuntimeExports.jsxs(Card,{className:"p-3 bg-emerald-500/10 border-emerald-500/30",children:[jsxRuntimeExports.jsxs("h4",{className:"text-sm font-medium text-emerald-400 mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Database,{size:16}),"Dados Prontos para Importação"]}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-emerald-300/80 space-y-1",children:[d.filter(T=>T.success&&T.dailyData).length>0&&jsxRuntimeExports.jsxs("p",{children:["• ",d.filter(T=>T.dailyData).length," registro(s) de produção diária"]}),d.filter(T=>T.success&&T.calibrationData).length>0&&jsxRuntimeExports.jsxs("p",{children:["• ",d.filter(T=>T.calibrationData).length," relatório(s) de calibração"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 pt-2 border-t border-zinc-800",children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",onClick:C,children:"Cancelar"}),d.length===0?jsxRuntimeExports.jsx(Button,{variant:"primary",onClick:F,disabled:a.length===0||c,children:c?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader2,{size:16,className:"animate-spin mr-2"}),"Processando..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Upload,{size:16,className:"mr-2"}),"Processar PDFs"]})}):jsxRuntimeExports.jsxs(Button,{variant:"primary",onClick:A,disabled:_===0,children:[jsxRuntimeExports.jsx(Database,{size:16,className:"mr-2"}),"Importar ",_," Registro(s)"]})]})]})})};function objectsToCSV(e,t){if(e.length===0)return"";const r=t||Object.keys(e[0]).map(n=>({key:n,header:String(n)})),s=r.map(n=>`"${n.header}"`).join(","),i=e.map(n=>r.map(a=>{const o=n[a.key];return o==null?"":typeof o=="string"?`"${o.replace(/"/g,'""')}"`:String(o)}).join(","));return[s,...i].join(`
`)}function downloadFile(e,t,r){const s=new Blob([e],{type:r}),i=URL.createObjectURL(s),n=document.createElement("a");n.href=i,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(i)}function exportMonitoringDataToCSV(e){const r=objectsToCSV(e,[{key:"date",header:"Data"},{key:"subOil",header:"Subsea Óleo (t)"},{key:"subGas",header:"Subsea Gás (t)"},{key:"subHC",header:"Subsea HC (t)"},{key:"topOil",header:"Topside Óleo (t)"},{key:"topGas",header:"Topside Gás (t)"},{key:"topHC",header:"Topside HC (t)"},{key:"sepOil",header:"Separador Óleo (t)"},{key:"sepGas",header:"Separador Gás (t)"},{key:"sepHC",header:"Separador HC (t)"},{key:"hcBalTS",header:"Balanço HC (%)"},{key:"totalBalTS",header:"Balanço Total (%)"},{key:"hcStatus",header:"Status HC"},{key:"action",header:"Ação"}]),s=new Date().toISOString().split("T")[0];downloadFile(r,`monitoramento_mpfm_${s}.csv`,"text/csv;charset=utf-8")}function exportMetersToCSV(e){const r=objectsToCSV(e,[{key:"tag",header:"TAG"},{key:"name",header:"Nome"},{key:"location",header:"Localização"},{key:"status",header:"Status"},{key:"manufacturer",header:"Fabricante"},{key:"model",header:"Modelo"},{key:"serialNumber",header:"Número de Série"},{key:"lastCalibration",header:"Última Calibração"},{key:"kOil",header:"K-Oil"},{key:"kGas",header:"K-Gas"},{key:"kWater",header:"K-Water"},{key:"daysToCalibration",header:"Dias para Calibração"}]),s=new Date().toISOString().split("T")[0];downloadFile(r,`medidores_mpfm_${s}.csv`,"text/csv;charset=utf-8")}function exportCalibrationEventsToCSV(e){const r=objectsToCSV(e,[{key:"id",header:"ID Evento"},{key:"meterTag",header:"TAG Medidor"},{key:"meterName",header:"Nome Medidor"},{key:"type",header:"Tipo"},{key:"status",header:"Status"},{key:"result",header:"Resultado"},{key:"startDate",header:"Data Início"},{key:"endDate",header:"Data Fim"},{key:"currentStep",header:"Etapa Atual"},{key:"progress",header:"Progresso (%)"},{key:"responsible",header:"Responsável"}]),s=new Date().toISOString().split("T")[0];downloadFile(r,`calibracoes_mpfm_${s}.csv`,"text/csv;charset=utf-8")}function exportAllDataToJSON(e,t){const r={version:"1.0.0",exportDate:new Date().toISOString(),...e},s=JSON.stringify(r,null,2),i=new Date().toISOString().split("T")[0];downloadFile(s,`${t||"mpfm_backup"}_${i}.json`,"application/json")}function generateCalibrationReport(e){const t=new Date().toLocaleString("pt-BR");return`
================================================================================
                    RELATÓRIO DE AVALIAÇÃO DE DESEMPENHO MPFM
                           CONFORME RANP 44/2015
================================================================================

ID do Evento: ${e.id}
Data de Emissão: ${t}

DADOS DO MEDIDOR
--------------------------------------------------------------------------------
TAG: ${e.meterTag}
Nome: ${e.meterName}
Tipo de Avaliação: ${e.type}

STATUS DA AVALIAÇÃO
--------------------------------------------------------------------------------
Status: ${e.status}
Resultado: ${e.result||"Pendente"}
Etapa Atual: ${e.currentStep}/7
Progresso: ${e.progress}%

PERÍODO
--------------------------------------------------------------------------------
Data de Início: ${e.startDate}
Data de Término: ${e.endDate||"Em andamento"}

RESPONSÁVEL
--------------------------------------------------------------------------------
${e.responsible}

================================================================================
                           FIM DO RELATÓRIO
================================================================================
`}function exportCalibrationReport(e){const t=generateCalibrationReport(e),r=new Date().toISOString().split("T")[0];downloadFile(t,`relatorio_${e.id}_${r}.txt`,"text/plain;charset=utf-8")}const ExportDataModal=({isOpen:e,onClose:t})=>{const{monitoringData:r,meters:s,calibrationEvents:i,selectedEvent:n}=useAppStore(),[a,o]=reactExports.useState("monitoring"),[d,l]=reactExports.useState("csv"),[c,f]=reactExports.useState(!1),u=async()=>{f(!0);try{switch(a){case"monitoring":d==="csv"?exportMonitoringDataToCSV(r):exportAllDataToJSON({monitoringData:r},"monitoring_data");break;case"meters":d==="csv"?exportMetersToCSV(s):exportAllDataToJSON({meters:s},"meters");break;case"calibration":d==="csv"?exportCalibrationEventsToCSV(i):exportAllDataToJSON({calibrationEvents:i},"calibration_events");break;case"all":exportAllDataToJSON({monitoringData:r,meters:s,calibrationEvents:i},"mpfm_monitor_backup");break;case"report":n&&exportCalibrationReport(n);break}t()}catch(h){console.error("Erro ao exportar:",h)}finally{f(!1)}};return jsxRuntimeExports.jsx(Modal,{isOpen:e,onClose:t,title:"Exportar Dados",size:"lg",children:jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"O que deseja exportar?"}),jsxRuntimeExports.jsx(Select,{value:a,onChange:h=>o(h.target.value),options:[{value:"monitoring",label:"Dados de Monitoramento"},{value:"meters",label:"Cadastro de Medidores"},{value:"calibration",label:"Eventos de Calibração"},{value:"all",label:"Backup Completo"},...n?[{value:"report",label:"Relatório de Calibração (Evento Selecionado)"}]:[]]})]}),a!=="all"&&a!=="report"&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Formato"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsxs("label",{className:"flex items-center",children:[jsxRuntimeExports.jsx("input",{type:"radio",name:"format",value:"csv",checked:d==="csv",onChange:h=>l(h.target.value),className:"mr-2"}),"CSV (Excel)"]}),jsxRuntimeExports.jsxs("label",{className:"flex items-center",children:[jsxRuntimeExports.jsx("input",{type:"radio",name:"format",value:"json",checked:d==="json",onChange:h=>l(h.target.value),className:"mr-2"}),"JSON"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Resumo"}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[a==="monitoring"&&jsxRuntimeExports.jsxs("p",{children:["📊 ",r.length," registros de monitoramento"]}),a==="meters"&&jsxRuntimeExports.jsxs("p",{children:["📍 ",s.length," medidores cadastrados"]}),a==="calibration"&&jsxRuntimeExports.jsxs("p",{children:["🔧 ",i.length," eventos de calibração"]}),a==="all"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("p",{children:["📊 ",r.length," registros de monitoramento"]}),jsxRuntimeExports.jsxs("p",{children:["📍 ",s.length," medidores"]}),jsxRuntimeExports.jsxs("p",{children:["🔧 ",i.length," eventos de calibração"]})]}),a==="report"&&n&&jsxRuntimeExports.jsxs("p",{children:["📄 Relatório para evento: ",n.id]})]})]}),a==="all"&&jsxRuntimeExports.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-yellow-700",children:"⚠️ O backup completo será exportado em formato JSON. Guarde este arquivo em local seguro para restauração futura."})}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",onClick:t,children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{type:"button",variant:"primary",onClick:u,disabled:c||a==="report"&&!n,children:c?"Exportando...":"Exportar"})]})]})})},NewCalibrationModal=({isOpen:e,onClose:t})=>{const{meters:r,addCalibrationEvent:s,setSelectedEvent:i}=useAppStore(),[n,a]=reactExports.useState(""),[o,d]=reactExports.useState("Periódica"),[l,c]=reactExports.useState(""),[f,u]=reactExports.useState({}),h=r.filter(E=>E.status==="active"),g=()=>{const E={};return n||(E.meterId="Selecione um medidor"),o||(E.type="Selecione o tipo de avaliação"),u(E),Object.keys(E).length===0},p=E=>{if(E.preventDefault(),!g())return;const S=r.find(F=>F.id===n);if(!S)return;const P=s(S,o);i(P),a(""),d("Periódica"),c(""),u({}),t()},x=()=>{a(""),d("Periódica"),c(""),u({}),t()};return jsxRuntimeExports.jsx(Modal,{isOpen:e,onClose:x,title:"Nova Avaliação de Calibração",size:"md",children:jsxRuntimeExports.jsxs("form",{onSubmit:p,className:"space-y-6",children:[h.length===0&&jsxRuntimeExports.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-yellow-700",children:"⚠️ Nenhum medidor ativo cadastrado. Adicione um medidor antes de criar uma avaliação de calibração."})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Select,{label:"Medidor MPFM *",value:n,onChange:E=>{a(E.target.value),u(S=>({...S,meterId:""}))},options:[{value:"",label:"Selecione um medidor..."},...h.map(E=>({value:E.id,label:`${E.tag} - ${E.name} (${E.location})`}))],error:f.meterId})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Select,{label:"Tipo de Avaliação *",value:o,onChange:E=>{d(E.target.value),u(S=>({...S,type:""}))},options:[{value:"Comissionamento",label:"Comissionamento - Primeira calibração do medidor"},{value:"Periódica",label:"Periódica - Calibração regular (anual)"},{value:"Especial",label:"Especial - Após manutenção ou alteração"},{value:"Investigação",label:"Investigação - Desvio detectado no monitoramento"}],error:f.type})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Input,{label:"Ordem de Serviço (Opcional)",placeholder:"Ex: OS-2024-001",value:l,onChange:E=>c(E.target.value)})}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Etapas da Avaliação"}),jsxRuntimeExports.jsxs("ol",{className:"text-xs text-blue-700 list-decimal list-inside space-y-1",children:[jsxRuntimeExports.jsx("li",{children:"Registro e Identificação"}),jsxRuntimeExports.jsx("li",{children:"Configuração PVT"}),jsxRuntimeExports.jsx("li",{children:"Totalizadores"}),jsxRuntimeExports.jsx("li",{children:"Cálculo K-Factors"}),jsxRuntimeExports.jsx("li",{children:"Balanço de Massas"}),jsxRuntimeExports.jsx("li",{children:"Monitoramento Pós"}),jsxRuntimeExports.jsx("li",{children:"Registro de Alarmes"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",onClick:x,children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{type:"submit",variant:"primary",disabled:h.length===0,children:"Iniciar Avaliação"})]})]})})};function useInitializeRealData(){const e=useAppStore(r=>r.meters),t=reactExports.useRef(!1);reactExports.useEffect(()=>{t.current||(t.current=!0,e.length===0&&(console.log("[MPFM] Inicializando medidores do FPSO Bacalhau..."),realMeters.forEach(r=>{useAppStore.setState(s=>({meters:[...s.meters,{...r,id:`meter-${r.tag}`}]}))})),console.log("[MPFM] Inicialização concluída! Importe PDFs para popular dados de produção."))},[e.length])}function App(){useInitializeRealData();const{showMeterModal:e,setShowMeterModal:t,showImportModal:r,setShowImportModal:s,showExportModal:i,setShowExportModal:n,showNewEventModal:a,setShowNewEventModal:o,editingMeter:d,setEditingMeter:l}=useAppStore(),c=()=>{t(!1),l(null)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Layout,{children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(Navigate,{to:"/monitoring",replace:!0})}),jsxRuntimeExports.jsx(Route,{path:"/monitoring",element:jsxRuntimeExports.jsx(MonitoringPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/calibration",element:jsxRuntimeExports.jsx(CalibrationPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/compliance",element:jsxRuntimeExports.jsx(CompliancePage,{})}),jsxRuntimeExports.jsx(Route,{path:"/desenquadramento",element:jsxRuntimeExports.jsx(Desenquadramento,{})}),jsxRuntimeExports.jsx(Route,{path:"/registro-diario",element:jsxRuntimeExports.jsx(RegistroDiario,{})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(Navigate,{to:"/monitoring",replace:!0})})]})}),jsxRuntimeExports.jsx(NewMeterModal,{isOpen:e,onClose:c,editingMeter:d}),jsxRuntimeExports.jsx(ImportDataModal,{isOpen:r,onClose:()=>s(!1)}),jsxRuntimeExports.jsx(ExportDataModal,{isOpen:i,onClose:()=>n(!1)}),jsxRuntimeExports.jsx(NewCalibrationModal,{isOpen:a,onClose:()=>o(!1)})]})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React$2.StrictMode,{children:jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsx(ToastProvider,{children:jsxRuntimeExports.jsx(App,{})})})}));
//# sourceMappingURL=index-CD9rdfuP.js.map
