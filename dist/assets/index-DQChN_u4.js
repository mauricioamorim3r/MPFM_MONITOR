var Zs=Object.defineProperty;var gs=n=>{throw TypeError(n)};var Qs=(n,t,i)=>t in n?Zs(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i;var Ze=(n,t,i)=>Qs(n,typeof t!="symbol"?t+"":t,i),Ft=(n,t,i)=>t.has(n)||gs("Cannot "+i);var r=(n,t,i)=>(Ft(n,t,"read from private field"),i?i.call(n):t.get(n)),re=(n,t,i)=>t.has(n)?gs("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,i),le=(n,t,i,e)=>(Ft(n,t,"write to private field"),e?e.call(n,i):t.set(n,i),i),J=(n,t,i)=>(Ft(n,t,"access private method"),i);var ht=(n,t,i,e)=>({set _(s){le(n,t,s,i)},get _(){return r(n,t,e)}});import{j as jsxRuntimeExports}from"./ui-DdXoV9Hu.js";import{a as reactDomExports,r as reactExports,g as getDefaultExportFromCjs,R as React$2,u as useLocation,b as useNavigate,d as getAugmentedNamespace,e as Routes,f as Route,N as Navigate,B as BrowserRouter}from"./vendor-D9FlTlAl.js";import{c as clsx,R as ResponsiveContainer,A as AreaChart,C as CartesianGrid,X as XAxis,Y as YAxis,T as Tooltip,a as ReferenceLine,b as Area,L as Legend,B as BarChart,d as Bar}from"./charts-D8KGVdYi.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&e(o)}).observe(document,{childList:!0,subtree:!0});function i(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(s){if(s.ep)return;s.ep=!0;const a=i(s);fetch(s.href,a)}})();var client={},m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),createLucideIcon=(n,t)=>{const i=reactExports.forwardRef(({color:e="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:D="",children:S,...E},c)=>reactExports.createElement("svg",{ref:c,...defaultAttributes,width:s,height:s,stroke:e,strokeWidth:o?Number(a)*24/Number(s):a,className:["lucide",`lucide-${toKebabCase(n)}`,D].join(" "),...E},[...t.map(([v,x])=>reactExports.createElement(v,x)),...Array.isArray(S)?S:[S]]));return i.displayName=`${n}`,i};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Activity=createLucideIcon("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AlertCircle=createLucideIcon("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AlertTriangle=createLucideIcon("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ArrowDownRight=createLucideIcon("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ArrowUpRight=createLucideIcon("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BarChart3=createLucideIcon("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Beaker=createLucideIcon("Beaker",[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bell=createLucideIcon("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Calculator=createLucideIcon("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Calendar=createLucideIcon("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CheckCircle2=createLucideIcon("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CheckCircle=createLucideIcon("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Check=createLucideIcon("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronLeft=createLucideIcon("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronRight=createLucideIcon("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Clipboard=createLucideIcon("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Clock=createLucideIcon("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Database=createLucideIcon("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Download=createLucideIcon("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Droplets=createLucideIcon("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eye=createLucideIcon("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileCheck=createLucideIcon("FileCheck",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileText=createLucideIcon("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileUp=createLucideIcon("FileUp",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Flame=createLucideIcon("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FlaskConical=createLucideIcon("FlaskConical",[["path",{d:"M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2",key:"pzvekw"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M7 16h10",key:"wp8him"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gauge=createLucideIcon("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Info=createLucideIcon("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Layers=createLucideIcon("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Loader2=createLucideIcon("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Menu=createLucideIcon("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PenLine=createLucideIcon("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PenSquare=createLucideIcon("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Play=createLucideIcon("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Plus=createLucideIcon("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Save=createLucideIcon("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Settings=createLucideIcon("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sparkles=createLucideIcon("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Target=createLucideIcon("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Trash2=createLucideIcon("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Upload=createLucideIcon("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Waves=createLucideIcon("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XCircle=createLucideIcon("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=createLucideIcon("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),CLASS_PART_SEPARATOR="-",createClassGroupUtils=n=>{const t=createClassMap(n),{conflictingClassGroups:i,conflictingClassGroupModifiers:e}=n;return{getClassGroupId:o=>{const D=o.split(CLASS_PART_SEPARATOR);return D[0]===""&&D.length!==1&&D.shift(),getGroupRecursive(D,t)||getGroupIdForArbitraryProperty(o)},getConflictingClassGroupIds:(o,D)=>{const S=i[o]||[];return D&&e[o]?[...S,...e[o]]:S}}},getGroupRecursive=(n,t)=>{var o;if(n.length===0)return t.classGroupId;const i=n[0],e=t.nextPart.get(i),s=e?getGroupRecursive(n.slice(1),e):void 0;if(s)return s;if(t.validators.length===0)return;const a=n.join(CLASS_PART_SEPARATOR);return(o=t.validators.find(({validator:D})=>D(a)))==null?void 0:o.classGroupId},arbitraryPropertyRegex=/^\[(.+)\]$/,getGroupIdForArbitraryProperty=n=>{if(arbitraryPropertyRegex.test(n)){const t=arbitraryPropertyRegex.exec(n)[1],i=t==null?void 0:t.substring(0,t.indexOf(":"));if(i)return"arbitrary.."+i}},createClassMap=n=>{const{theme:t,prefix:i}=n,e={nextPart:new Map,validators:[]};return getPrefixedClassGroupEntries(Object.entries(n.classGroups),i).forEach(([a,o])=>{processClassesRecursively(o,e,a,t)}),e},processClassesRecursively=(n,t,i,e)=>{n.forEach(s=>{if(typeof s=="string"){const a=s===""?t:getPart(t,s);a.classGroupId=i;return}if(typeof s=="function"){if(isThemeGetter(s)){processClassesRecursively(s(e),t,i,e);return}t.validators.push({validator:s,classGroupId:i});return}Object.entries(s).forEach(([a,o])=>{processClassesRecursively(o,getPart(t,a),i,e)})})},getPart=(n,t)=>{let i=n;return t.split(CLASS_PART_SEPARATOR).forEach(e=>{i.nextPart.has(e)||i.nextPart.set(e,{nextPart:new Map,validators:[]}),i=i.nextPart.get(e)}),i},isThemeGetter=n=>n.isThemeGetter,getPrefixedClassGroupEntries=(n,t)=>t?n.map(([i,e])=>{const s=e.map(a=>typeof a=="string"?t+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([o,D])=>[t+o,D])):a);return[i,s]}):n,createLruCache=n=>{if(n<1)return{get:()=>{},set:()=>{}};let t=0,i=new Map,e=new Map;const s=(a,o)=>{i.set(a,o),t++,t>n&&(t=0,e=i,i=new Map)};return{get(a){let o=i.get(a);if(o!==void 0)return o;if((o=e.get(a))!==void 0)return s(a,o),o},set(a,o){i.has(a)?i.set(a,o):s(a,o)}}},IMPORTANT_MODIFIER="!",createParseClassName=n=>{const{separator:t,experimentalParseClassName:i}=n,e=t.length===1,s=t[0],a=t.length,o=D=>{const S=[];let E=0,c=0,v;for(let f=0;f<D.length;f++){let u=D[f];if(E===0){if(u===s&&(e||D.slice(f,f+a)===t)){S.push(D.slice(c,f)),c=f+a;continue}if(u==="/"){v=f;continue}}u==="["?E++:u==="]"&&E--}const x=S.length===0?D:D.substring(c),p=x.startsWith(IMPORTANT_MODIFIER),_=p?x.substring(1):x,A=v&&v>c?v-c:void 0;return{modifiers:S,hasImportantModifier:p,baseClassName:_,maybePostfixModifierPosition:A}};return i?D=>i({className:D,parseClassName:o}):o},sortModifiers=n=>{if(n.length<=1)return n;const t=[];let i=[];return n.forEach(e=>{e[0]==="["?(t.push(...i.sort(),e),i=[]):i.push(e)}),t.push(...i.sort()),t},createConfigUtils=n=>({cache:createLruCache(n.cacheSize),parseClassName:createParseClassName(n),...createClassGroupUtils(n)}),SPLIT_CLASSES_REGEX=/\s+/,mergeClassList=(n,t)=>{const{parseClassName:i,getClassGroupId:e,getConflictingClassGroupIds:s}=t,a=[],o=n.trim().split(SPLIT_CLASSES_REGEX);let D="";for(let S=o.length-1;S>=0;S-=1){const E=o[S],{modifiers:c,hasImportantModifier:v,baseClassName:x,maybePostfixModifierPosition:p}=i(E);let _=!!p,A=e(_?x.substring(0,p):x);if(!A){if(!_){D=E+(D.length>0?" "+D:D);continue}if(A=e(x),!A){D=E+(D.length>0?" "+D:D);continue}_=!1}const f=sortModifiers(c).join(":"),u=v?f+IMPORTANT_MODIFIER:f,C=u+A;if(a.includes(C))continue;a.push(C);const F=s(A,_);for(let w=0;w<F.length;++w){const h=F[w];a.push(u+h)}D=E+(D.length>0?" "+D:D)}return D};function twJoin(){let n=0,t,i,e="";for(;n<arguments.length;)(t=arguments[n++])&&(i=toValue(t))&&(e&&(e+=" "),e+=i);return e}const toValue=n=>{if(typeof n=="string")return n;let t,i="";for(let e=0;e<n.length;e++)n[e]&&(t=toValue(n[e]))&&(i&&(i+=" "),i+=t);return i};function createTailwindMerge(n,...t){let i,e,s,a=o;function o(S){const E=t.reduce((c,v)=>v(c),n());return i=createConfigUtils(E),e=i.cache.get,s=i.cache.set,a=D,D(S)}function D(S){const E=e(S);if(E)return E;const c=mergeClassList(S,i);return s(S,c),c}return function(){return a(twJoin.apply(null,arguments))}}const fromTheme=n=>{const t=i=>i[n]||[];return t.isThemeGetter=!0,t},arbitraryValueRegex=/^\[(?:([a-z-]+):)?(.+)\]$/i,fractionRegex=/^\d+\/\d+$/,stringLengths=new Set(["px","full","screen"]),tshirtUnitRegex=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,lengthUnitRegex=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,colorFunctionRegex=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,shadowRegex=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,imageRegex=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,isLength=n=>isNumber(n)||stringLengths.has(n)||fractionRegex.test(n),isArbitraryLength=n=>getIsArbitraryValue(n,"length",isLengthOnly),isNumber=n=>!!n&&!Number.isNaN(Number(n)),isArbitraryNumber=n=>getIsArbitraryValue(n,"number",isNumber),isInteger=n=>!!n&&Number.isInteger(Number(n)),isPercent=n=>n.endsWith("%")&&isNumber(n.slice(0,-1)),isArbitraryValue=n=>arbitraryValueRegex.test(n),isTshirtSize=n=>tshirtUnitRegex.test(n),sizeLabels=new Set(["length","size","percentage"]),isArbitrarySize=n=>getIsArbitraryValue(n,sizeLabels,isNever),isArbitraryPosition=n=>getIsArbitraryValue(n,"position",isNever),imageLabels=new Set(["image","url"]),isArbitraryImage=n=>getIsArbitraryValue(n,imageLabels,isImage),isArbitraryShadow=n=>getIsArbitraryValue(n,"",isShadow),isAny=()=>!0,getIsArbitraryValue=(n,t,i)=>{const e=arbitraryValueRegex.exec(n);return e?e[1]?typeof t=="string"?e[1]===t:t.has(e[1]):i(e[2]):!1},isLengthOnly=n=>lengthUnitRegex.test(n)&&!colorFunctionRegex.test(n),isNever=()=>!1,isShadow=n=>shadowRegex.test(n),isImage=n=>imageRegex.test(n),getDefaultConfig=()=>{const n=fromTheme("colors"),t=fromTheme("spacing"),i=fromTheme("blur"),e=fromTheme("brightness"),s=fromTheme("borderColor"),a=fromTheme("borderRadius"),o=fromTheme("borderSpacing"),D=fromTheme("borderWidth"),S=fromTheme("contrast"),E=fromTheme("grayscale"),c=fromTheme("hueRotate"),v=fromTheme("invert"),x=fromTheme("gap"),p=fromTheme("gradientColorStops"),_=fromTheme("gradientColorStopPositions"),A=fromTheme("inset"),f=fromTheme("margin"),u=fromTheme("opacity"),C=fromTheme("padding"),F=fromTheme("saturate"),w=fromTheme("scale"),h=fromTheme("sepia"),R=fromTheme("skew"),b=fromTheme("space"),j=fromTheme("translate"),y=()=>["auto","contain","none"],L=()=>["auto","hidden","clip","visible","scroll"],g=()=>["auto",isArbitraryValue,t],T=()=>[isArbitraryValue,t],z=()=>["",isLength,isArbitraryLength],se=()=>["auto",isNumber,isArbitraryValue],V=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Q=()=>["solid","dashed","dotted","double","none"],K=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ue=()=>["start","end","center","between","around","evenly","stretch"],I=()=>["","0",isArbitraryValue],q=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ee=()=>[isNumber,isArbitraryValue];return{cacheSize:500,separator:":",theme:{colors:[isAny],spacing:[isLength,isArbitraryLength],blur:["none","",isTshirtSize,isArbitraryValue],brightness:ee(),borderColor:[n],borderRadius:["none","","full",isTshirtSize,isArbitraryValue],borderSpacing:T(),borderWidth:z(),contrast:ee(),grayscale:I(),hueRotate:ee(),invert:I(),gap:T(),gradientColorStops:[n],gradientColorStopPositions:[isPercent,isArbitraryLength],inset:g(),margin:g(),opacity:ee(),padding:T(),saturate:ee(),scale:ee(),sepia:I(),skew:ee(),space:T(),translate:T()},classGroups:{aspect:[{aspect:["auto","square","video",isArbitraryValue]}],container:["container"],columns:[{columns:[isTshirtSize]}],"break-after":[{"break-after":q()}],"break-before":[{"break-before":q()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...V(),isArbitraryValue]}],overflow:[{overflow:L()}],"overflow-x":[{"overflow-x":L()}],"overflow-y":[{"overflow-y":L()}],overscroll:[{overscroll:y()}],"overscroll-x":[{"overscroll-x":y()}],"overscroll-y":[{"overscroll-y":y()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[A]}],"inset-x":[{"inset-x":[A]}],"inset-y":[{"inset-y":[A]}],start:[{start:[A]}],end:[{end:[A]}],top:[{top:[A]}],right:[{right:[A]}],bottom:[{bottom:[A]}],left:[{left:[A]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",isInteger,isArbitraryValue]}],basis:[{basis:g()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",isArbitraryValue]}],grow:[{grow:I()}],shrink:[{shrink:I()}],order:[{order:["first","last","none",isInteger,isArbitraryValue]}],"grid-cols":[{"grid-cols":[isAny]}],"col-start-end":[{col:["auto",{span:["full",isInteger,isArbitraryValue]},isArbitraryValue]}],"col-start":[{"col-start":se()}],"col-end":[{"col-end":se()}],"grid-rows":[{"grid-rows":[isAny]}],"row-start-end":[{row:["auto",{span:[isInteger,isArbitraryValue]},isArbitraryValue]}],"row-start":[{"row-start":se()}],"row-end":[{"row-end":se()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",isArbitraryValue]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",isArbitraryValue]}],gap:[{gap:[x]}],"gap-x":[{"gap-x":[x]}],"gap-y":[{"gap-y":[x]}],"justify-content":[{justify:["normal",...ue()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...ue(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...ue(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[C]}],px:[{px:[C]}],py:[{py:[C]}],ps:[{ps:[C]}],pe:[{pe:[C]}],pt:[{pt:[C]}],pr:[{pr:[C]}],pb:[{pb:[C]}],pl:[{pl:[C]}],m:[{m:[f]}],mx:[{mx:[f]}],my:[{my:[f]}],ms:[{ms:[f]}],me:[{me:[f]}],mt:[{mt:[f]}],mr:[{mr:[f]}],mb:[{mb:[f]}],ml:[{ml:[f]}],"space-x":[{"space-x":[b]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[b]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",isArbitraryValue,t]}],"min-w":[{"min-w":[isArbitraryValue,t,"min","max","fit"]}],"max-w":[{"max-w":[isArbitraryValue,t,"none","full","min","max","fit","prose",{screen:[isTshirtSize]},isTshirtSize]}],h:[{h:[isArbitraryValue,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[isArbitraryValue,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[isArbitraryValue,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[isArbitraryValue,t,"auto","min","max","fit"]}],"font-size":[{text:["base",isTshirtSize,isArbitraryLength]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",isArbitraryNumber]}],"font-family":[{font:[isAny]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",isArbitraryValue]}],"line-clamp":[{"line-clamp":["none",isNumber,isArbitraryNumber]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",isLength,isArbitraryValue]}],"list-image":[{"list-image":["none",isArbitraryValue]}],"list-style-type":[{list:["none","disc","decimal",isArbitraryValue]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[u]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[u]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Q(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",isLength,isArbitraryLength]}],"underline-offset":[{"underline-offset":["auto",isLength,isArbitraryValue]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",isArbitraryValue]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",isArbitraryValue]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[u]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...V(),isArbitraryPosition]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",isArbitrarySize]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},isArbitraryImage]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[_]}],"gradient-via-pos":[{via:[_]}],"gradient-to-pos":[{to:[_]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[D]}],"border-w-x":[{"border-x":[D]}],"border-w-y":[{"border-y":[D]}],"border-w-s":[{"border-s":[D]}],"border-w-e":[{"border-e":[D]}],"border-w-t":[{"border-t":[D]}],"border-w-r":[{"border-r":[D]}],"border-w-b":[{"border-b":[D]}],"border-w-l":[{"border-l":[D]}],"border-opacity":[{"border-opacity":[u]}],"border-style":[{border:[...Q(),"hidden"]}],"divide-x":[{"divide-x":[D]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[D]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[u]}],"divide-style":[{divide:Q()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...Q()]}],"outline-offset":[{"outline-offset":[isLength,isArbitraryValue]}],"outline-w":[{outline:[isLength,isArbitraryLength]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[u]}],"ring-offset-w":[{"ring-offset":[isLength,isArbitraryLength]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",isTshirtSize,isArbitraryShadow]}],"shadow-color":[{shadow:[isAny]}],opacity:[{opacity:[u]}],"mix-blend":[{"mix-blend":[...K(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":K()}],filter:[{filter:["","none"]}],blur:[{blur:[i]}],brightness:[{brightness:[e]}],contrast:[{contrast:[S]}],"drop-shadow":[{"drop-shadow":["","none",isTshirtSize,isArbitraryValue]}],grayscale:[{grayscale:[E]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[v]}],saturate:[{saturate:[F]}],sepia:[{sepia:[h]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[i]}],"backdrop-brightness":[{"backdrop-brightness":[e]}],"backdrop-contrast":[{"backdrop-contrast":[S]}],"backdrop-grayscale":[{"backdrop-grayscale":[E]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[v]}],"backdrop-opacity":[{"backdrop-opacity":[u]}],"backdrop-saturate":[{"backdrop-saturate":[F]}],"backdrop-sepia":[{"backdrop-sepia":[h]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",isArbitraryValue]}],duration:[{duration:ee()}],ease:[{ease:["linear","in","out","in-out",isArbitraryValue]}],delay:[{delay:ee()}],animate:[{animate:["none","spin","ping","pulse","bounce",isArbitraryValue]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[isInteger,isArbitraryValue]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[R]}],"skew-y":[{"skew-y":[R]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",isArbitraryValue]}],accent:[{accent:["auto",n]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",isArbitraryValue]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",isArbitraryValue]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[isLength,isArbitraryLength,isArbitraryNumber]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},twMerge=createTailwindMerge(getDefaultConfig);function cn(...n){return twMerge(clsx(n))}function formatNumber(n,t=2){return n.toLocaleString("pt-BR",{minimumFractionDigits:t,maximumFractionDigits:t})}function formatDate(n,t="short"){const i=typeof n=="string"?new Date(n):n;return t==="long"?i.toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"}):i.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})}function formatDateTime(n){const t=typeof n=="string"?new Date(n):n;return`${formatDate(t)} ${t.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`}const modules=[{id:"monitoring",label:"Monitoramento SGM-FM",icon:Activity,description:"Variáveis críticas"},{id:"calibration",label:"Avaliação de Desempenho",icon:Gauge,description:"Calibração MPFM"},{id:"compliance",label:"Conformidade ANP",icon:FileCheck,description:"RANP 44/2015"}];function Sidebar({activeModule:n,onModuleChange:t,collapsed:i}){return jsxRuntimeExports.jsxs("aside",{className:cn("bg-zinc-900 border-r border-zinc-800 flex flex-col transition-all duration-200 flex-shrink-0",i?"w-16":"w-56"),children:[jsxRuntimeExports.jsx("div",{className:"p-3 border-b border-zinc-800",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-700 rounded-lg flex items-center justify-center flex-shrink-0",children:jsxRuntimeExports.jsx(Droplets,{className:"w-6 h-6 text-white"})}),!i&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-bold text-sm",children:"MPFM Monitor"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-zinc-500",children:"FPSO Bacalhau"})]})]})}),jsxRuntimeExports.jsx("nav",{className:"flex-1 p-2 space-y-1",children:modules.map(e=>{const s=e.icon,a=n===e.id;return jsxRuntimeExports.jsxs("button",{onClick:()=>t(e.id),className:cn("w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition text-sm",a?"bg-blue-600 text-white":"hover:bg-zinc-800 text-zinc-400"),children:[jsxRuntimeExports.jsx(s,{className:"w-5 h-5 flex-shrink-0"}),!i&&jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsx("div",{className:"text-xs font-medium",children:e.label}),jsxRuntimeExports.jsx("div",{className:"text-[10px] opacity-60",children:e.description})]})]},e.id)})}),jsxRuntimeExports.jsx("div",{className:"p-3 border-t border-zinc-800",children:!i&&jsxRuntimeExports.jsxs("div",{className:"text-xs text-zinc-500",children:[jsxRuntimeExports.jsx("div",{children:"RANP 44/2015 ANP"}),jsxRuntimeExports.jsx("div",{className:"text-zinc-600",children:"v2.1.0"})]})})]})}const variantStyles$1={default:"bg-zinc-700 text-zinc-300",success:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",warning:"bg-amber-500/20 text-amber-400 border border-amber-500/30",error:"bg-red-500/20 text-red-400 border border-red-500/30",info:"bg-blue-500/20 text-blue-400 border border-blue-500/30",purple:"bg-purple-500/20 text-purple-400 border border-purple-500/30",secondary:"bg-zinc-600/20 text-zinc-300 border border-zinc-500/30",OK:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",ALERT:"bg-amber-500/20 text-amber-400 border border-amber-500/30",FAIL:"bg-red-500/20 text-red-400 border border-red-500/30",ERROR:"bg-red-500/20 text-red-400 border border-red-500/30",Dentro:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",Fora:"bg-red-500/20 text-red-400 border border-red-500/30",active:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",inactive:"bg-zinc-600/20 text-zinc-400 border border-zinc-500/30",TOPSIDE:"bg-purple-500/20 text-purple-400 border border-purple-500/30",SUBSEA:"bg-blue-500/20 text-blue-400 border border-blue-500/30",MONITORAR:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",INVESTIGAR:"bg-red-500/20 text-red-400 border border-red-500/30",Pendente:"bg-amber-500/20 text-amber-400 border border-amber-500/30",Parcial:"bg-blue-500/20 text-blue-400 border border-blue-500/30",Crítico:"bg-red-500/20 text-red-400 border border-red-500/30",Alerta:"bg-amber-500/20 text-amber-400 border border-amber-500/30"},sizeStyles$2={sm:"px-1.5 py-0.5 text-[10px]",default:"px-2 py-0.5 text-xs"};function Badge({variant:n="default",size:t="default",children:i,className:e}){return jsxRuntimeExports.jsx("span",{className:cn("rounded-full font-medium inline-flex items-center",variantStyles$1[n],sizeStyles$2[t],e),children:i})}const variantStyles={primary:"bg-blue-600 hover:bg-blue-700 text-white",secondary:"bg-zinc-800 hover:bg-zinc-700 text-white border border-zinc-700",success:"bg-emerald-600 hover:bg-emerald-700 text-white",danger:"bg-red-600 hover:bg-red-700 text-white",ghost:"hover:bg-zinc-800 text-zinc-400",outline:"border border-zinc-600 hover:bg-zinc-800 text-zinc-300"},sizeStyles$1={xs:"px-2 py-1 text-xs",sm:"px-2 py-1.5 text-xs",default:"px-3 py-1.5 text-sm",lg:"px-4 py-2 text-sm"},iconSizes={xs:"w-3 h-3",sm:"w-3.5 h-3.5",default:"w-4 h-4",lg:"w-4 h-4"},Button=reactExports.forwardRef(({variant:n="primary",size:t="default",icon:i,loading:e=!1,disabled:s,className:a,children:o,...D},S)=>jsxRuntimeExports.jsxs("button",{ref:S,disabled:s||e,className:cn("flex items-center justify-center gap-1.5 rounded-lg font-medium transition",variantStyles[n],sizeStyles$1[t],(s||e)&&"opacity-50 cursor-not-allowed",a),...D,children:[e?jsxRuntimeExports.jsxs("svg",{className:cn("animate-spin",iconSizes[t]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):i?jsxRuntimeExports.jsx(i,{className:iconSizes[t]}):null,o]}));Button.displayName="Button";function Card({children:n,className:t,title:i,subtitle:e,headerRight:s,noPadding:a=!1}){return jsxRuntimeExports.jsxs("div",{className:cn("bg-zinc-900/80 border border-zinc-800 rounded-xl",t),children:[i&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-zinc-800",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-white",children:i}),e&&jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:e})]}),s]}),jsxRuntimeExports.jsx("div",{className:a?"":"p-4",children:n})]})}const Input=reactExports.forwardRef(({label:n,unit:t,error:i,inputSize:e="default",disabled:s,readOnly:a,className:o,...D},S)=>jsxRuntimeExports.jsxs("div",{className:cn("space-y-1",o),children:[n&&jsxRuntimeExports.jsx("label",{className:"text-xs text-zinc-400",children:n}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("input",{ref:S,disabled:s,readOnly:a,className:cn("w-full bg-zinc-800 border rounded text-white placeholder-zinc-500 focus:outline-none focus:border-blue-500",i?"border-red-500":"border-zinc-700",(s||a)&&"opacity-60 cursor-not-allowed",e==="sm"?"px-2 py-1 text-xs":"px-3 py-2 text-sm",t&&"pr-12"),...D}),t&&jsxRuntimeExports.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-zinc-500",children:t})]}),i&&jsxRuntimeExports.jsx("p",{className:"text-xs text-red-400",children:i})]}));Input.displayName="Input";const Select=reactExports.forwardRef(({label:n,options:t,selectSize:i="default",error:e,disabled:s,className:a,...o},D)=>jsxRuntimeExports.jsxs("div",{className:cn("space-y-1",a),children:[n&&jsxRuntimeExports.jsx("label",{className:"text-xs text-zinc-400",children:n}),jsxRuntimeExports.jsx("select",{ref:D,disabled:s,className:cn("w-full bg-zinc-800 border border-zinc-700 rounded text-white focus:outline-none focus:border-blue-500",s&&"opacity-60 cursor-not-allowed",e&&"border-red-500",i==="sm"?"px-2 py-1 text-xs":"px-3 py-2 text-sm"),...o,children:t.map(S=>jsxRuntimeExports.jsx("option",{value:S.value,children:S.label},S.value))}),e&&jsxRuntimeExports.jsx("p",{className:"text-xs text-red-400",children:e})]}));Select.displayName="Select";const sizeStyles={sm:"max-w-sm",md:"max-w-md",default:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};function Modal({isOpen:n,onClose:t,title:i,children:e,size:s="default"}){return reactExports.useEffect(()=>{const a=o=>{o.key==="Escape"&&t()};return n&&(document.addEventListener("keydown",a),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",a),document.body.style.overflow="unset"}},[n,t]),n?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:cn("bg-zinc-900 border border-zinc-800 rounded-xl w-full max-h-[90vh] flex flex-col",sizeStyles[s]),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-zinc-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-white",children:i}),jsxRuntimeExports.jsx("button",{onClick:t,title:"Fechar",className:"p-1 hover:bg-zinc-800 rounded-lg transition",children:jsxRuntimeExports.jsx(X,{className:"w-4 h-4 text-zinc-400"})})]}),jsxRuntimeExports.jsx("div",{className:"p-4 overflow-y-auto flex-1",children:e})]})}):null}function Tabs({tabs:n,activeTab:t,onChange:i,className:e}){return jsxRuntimeExports.jsx("div",{className:cn("flex gap-1 p-1 bg-zinc-800/50 rounded-lg",e),children:n.map(s=>jsxRuntimeExports.jsxs("button",{onClick:()=>i(s.id),className:cn("px-3 py-1.5 text-xs font-medium rounded-md transition flex items-center gap-1.5",t===s.id?"bg-blue-600 text-white":"text-zinc-400 hover:text-white hover:bg-zinc-700"),children:[s.icon&&jsxRuntimeExports.jsx(s.icon,{className:"w-3.5 h-3.5"}),s.label,s.count!==void 0&&jsxRuntimeExports.jsx("span",{className:cn("px-1.5 py-0.5 rounded-full text-[10px]",t===s.id?"bg-white/20":"bg-zinc-700"),children:s.count})]},s.id))})}const colorStyles$2={blue:"from-blue-500/20 to-blue-600/5 border-blue-500/30",emerald:"from-emerald-500/20 to-emerald-600/5 border-emerald-500/30",amber:"from-amber-500/20 to-amber-600/5 border-amber-500/30",red:"from-red-500/20 to-red-600/5 border-red-500/30",purple:"from-purple-500/20 to-purple-600/5 border-purple-500/30"},iconColors={blue:"text-blue-400",emerald:"text-emerald-400",amber:"text-amber-400",red:"text-red-400",purple:"text-purple-400"};function KPICard({title:n,value:t,unit:i,subtitle:e,icon:s,color:a,trend:o,onClick:D,className:S}){return jsxRuntimeExports.jsx("div",{className:cn("bg-gradient-to-br border rounded-xl p-3",colorStyles$2[a],D&&"cursor-pointer hover:brightness-110 transition",S),onClick:D,children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-400",children:n}),jsxRuntimeExports.jsxs("div",{className:"flex items-baseline gap-1 mt-1",children:[jsxRuntimeExports.jsx("span",{className:"text-xl font-bold text-white",children:t}),i&&jsxRuntimeExports.jsx("span",{className:"text-xs text-zinc-400",children:i})]}),e&&jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:e}),o!==void 0&&o!==0&&jsxRuntimeExports.jsxs("div",{className:cn("flex items-center gap-1 mt-1 text-xs",o>0?"text-emerald-400":"text-red-400"),children:[o>0?jsxRuntimeExports.jsx(ArrowUpRight,{className:"w-3 h-3"}):jsxRuntimeExports.jsx(ArrowDownRight,{className:"w-3 h-3"}),jsxRuntimeExports.jsxs("span",{children:[Math.abs(o),"%"]})]})]}),jsxRuntimeExports.jsx("div",{className:cn("p-2 rounded-lg bg-zinc-800/50",iconColors[a]),children:jsxRuntimeExports.jsx(s,{className:"w-4 h-4"})})]})})}const colorStyles$1={blue:"bg-blue-500",emerald:"bg-emerald-500",amber:"bg-amber-500",red:"bg-red-500",purple:"bg-purple-500"};function ProgressBar({value:n,max:t=100,color:i="blue",showLabel:e=!0,size:s="default",className:a}){const o=Math.min(n/t*100,100),S=i==="auto"?o>=100?"bg-red-500":o>=70?"bg-amber-500":"bg-emerald-500":colorStyles$1[i];return jsxRuntimeExports.jsxs("div",{className:cn("space-y-1",a),children:[jsxRuntimeExports.jsx("div",{className:cn("bg-zinc-800 rounded-full overflow-hidden",s==="sm"?"h-1.5":"h-2"),children:jsxRuntimeExports.jsx("div",{className:cn("h-full rounded-full transition-all",S),style:{width:`${o}%`}})}),e&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs text-zinc-500",children:[jsxRuntimeExports.jsx("span",{children:n}),jsxRuntimeExports.jsx("span",{children:t})]})]})}function StepIndicator({steps:n,currentStep:t,onStepClick:i,className:e}){return jsxRuntimeExports.jsx("div",{className:cn("flex items-center gap-1 overflow-x-auto pb-1",e),children:n.map((s,a)=>{const o=a+1,D=o<t,S=o===t,E=o>t;return jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>i==null?void 0:i(o),className:cn("flex items-center gap-1.5 px-2 py-1 rounded-lg transition flex-shrink-0",S&&"bg-blue-600 text-white",D&&"bg-emerald-500/20 text-emerald-400 hover:bg-emerald-500/30",E&&"bg-zinc-800 text-zinc-500 hover:bg-zinc-700"),children:[jsxRuntimeExports.jsx("div",{className:cn("w-5 h-5 rounded-full flex items-center justify-center text-xs font-medium",D&&"bg-emerald-500 text-white",S&&"bg-white text-blue-600",E&&"bg-zinc-700 text-zinc-400"),children:D?jsxRuntimeExports.jsx(Check,{className:"w-3 h-3"}):o}),jsxRuntimeExports.jsx("span",{className:"text-xs hidden lg:inline whitespace-nowrap",children:s})]}),a<n.length-1&&jsxRuntimeExports.jsx("div",{className:cn("w-4 h-px flex-shrink-0 mx-1",D?"bg-emerald-500":"bg-zinc-700")})]},a)})})}const colorStyles={blue:"text-blue-400 bg-blue-500/10",purple:"text-purple-400 bg-purple-500/10",amber:"text-amber-400 bg-amber-500/10",emerald:"text-emerald-400 bg-emerald-500/10",red:"text-red-400 bg-red-500/10"};function SectionHeader({icon:n,title:t,color:i="blue",action:e,className:s}){return jsxRuntimeExports.jsxs("div",{className:cn("flex items-center justify-between px-3 py-2 rounded-lg mb-3",colorStyles[i],s),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(n,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",children:t})]}),e]})}function Header({title:n,subtitle:t,onToggleSidebar:i,onImport:e,onExport:s,alertCount:a=0}){return jsxRuntimeExports.jsxs("header",{className:"h-14 bg-zinc-900 border-b border-zinc-800 flex items-center justify-between px-4 flex-shrink-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:i,title:"Menu",className:"p-2 hover:bg-zinc-800 rounded-lg transition",children:jsxRuntimeExports.jsx(Menu,{className:"w-5 h-5 text-zinc-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-sm font-semibold",children:n}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:t||`Última atualização: ${formatDateTime(new Date)}`})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[e&&jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:Upload,onClick:e,children:"Importar"}),s&&jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:Download,onClick:s,children:"Exportar"}),jsxRuntimeExports.jsxs("button",{title:"Notificações",className:"relative p-2 hover:bg-zinc-800 rounded-lg transition",children:[jsxRuntimeExports.jsx(Bell,{className:"w-5 h-5 text-zinc-400"}),a>0&&jsxRuntimeExports.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),jsxRuntimeExports.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-xs font-medium",children:"MA"})]})]})}const __vite_import_meta_env__$2={},createStoreImpl=n=>{let t;const i=new Set,e=(c,v)=>{const x=typeof c=="function"?c(t):c;if(!Object.is(x,t)){const p=t;t=v??(typeof x!="object"||x===null)?x:Object.assign({},t,x),i.forEach(_=>_(t,p))}},s=()=>t,S={setState:e,getState:s,getInitialState:()=>E,subscribe:c=>(i.add(c),()=>i.delete(c)),destroy:()=>{(__vite_import_meta_env__$2?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),i.clear()}},E=t=n(e,s,S);return S},createStore=n=>n?createStoreImpl(n):createStoreImpl;var withSelector={exports:{}},withSelector_production={},shim$2={exports:{}},useSyncExternalStoreShim_production={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React$1=reactExports;function is$1(n,t){return n===t&&(n!==0||1/n===1/t)||n!==n&&t!==t}var objectIs$1=typeof Object.is=="function"?Object.is:is$1,useState=React$1.useState,useEffect$1=React$1.useEffect,useLayoutEffect=React$1.useLayoutEffect,useDebugValue$2=React$1.useDebugValue;function useSyncExternalStore$2(n,t){var i=t(),e=useState({inst:{value:i,getSnapshot:t}}),s=e[0].inst,a=e[1];return useLayoutEffect(function(){s.value=i,s.getSnapshot=t,checkIfSnapshotChanged(s)&&a({inst:s})},[n,i,t]),useEffect$1(function(){return checkIfSnapshotChanged(s)&&a({inst:s}),n(function(){checkIfSnapshotChanged(s)&&a({inst:s})})},[n]),useDebugValue$2(i),i}function checkIfSnapshotChanged(n){var t=n.getSnapshot;n=n.value;try{var i=t();return!objectIs$1(n,i)}catch{return!0}}function useSyncExternalStore$1(n,t){return t()}var shim$1=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?useSyncExternalStore$1:useSyncExternalStore$2;useSyncExternalStoreShim_production.useSyncExternalStore=React$1.useSyncExternalStore!==void 0?React$1.useSyncExternalStore:shim$1;shim$2.exports=useSyncExternalStoreShim_production;var shimExports=shim$2.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React=reactExports,shim=shimExports;function is(n,t){return n===t&&(n!==0||1/n===1/t)||n!==n&&t!==t}var objectIs=typeof Object.is=="function"?Object.is:is,useSyncExternalStore=shim.useSyncExternalStore,useRef=React.useRef,useEffect=React.useEffect,useMemo=React.useMemo,useDebugValue$1=React.useDebugValue;withSelector_production.useSyncExternalStoreWithSelector=function(n,t,i,e,s){var a=useRef(null);if(a.current===null){var o={hasValue:!1,value:null};a.current=o}else o=a.current;a=useMemo(function(){function S(p){if(!E){if(E=!0,c=p,p=e(p),s!==void 0&&o.hasValue){var _=o.value;if(s(_,p))return v=_}return v=p}if(_=v,objectIs(c,p))return _;var A=e(p);return s!==void 0&&s(_,A)?(c=p,_):(c=p,v=A)}var E=!1,c,v,x=i===void 0?null:i;return[function(){return S(t())},x===null?void 0:function(){return S(x())}]},[t,i,e,s]);var D=useSyncExternalStore(n,a[0],a[1]);return useEffect(function(){o.hasValue=!0,o.value=D},[D]),useDebugValue$1(D),D};withSelector.exports=withSelector_production;var withSelectorExports=withSelector.exports;const useSyncExternalStoreExports=getDefaultExportFromCjs(withSelectorExports),__vite_import_meta_env__$1={},{useDebugValue}=React$2,{useSyncExternalStoreWithSelector}=useSyncExternalStoreExports;let didWarnAboutEqualityFn=!1;const identity=n=>n;function useStore(n,t=identity,i){(__vite_import_meta_env__$1?"production":void 0)!=="production"&&i&&!didWarnAboutEqualityFn&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),didWarnAboutEqualityFn=!0);const e=useSyncExternalStoreWithSelector(n.subscribe,n.getState,n.getServerState||n.getInitialState,t,i);return useDebugValue(e),e}const createImpl=n=>{(__vite_import_meta_env__$1?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof n=="function"?createStore(n):n,i=(e,s)=>useStore(t,e,s);return Object.assign(i,t),i},create=n=>createImpl,__vite_import_meta_env__={};function createJSONStorage(n,t){let i;try{i=n()}catch{return}return{getItem:s=>{var a;const o=S=>S===null?null:JSON.parse(S,void 0),D=(a=i.getItem(s))!=null?a:null;return D instanceof Promise?D.then(o):o(D)},setItem:(s,a)=>i.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>i.removeItem(s)}}const toThenable=n=>t=>{try{const i=n(t);return i instanceof Promise?i:{then(e){return toThenable(e)(i)},catch(e){return this}}}catch(i){return{then(e){return this},catch(e){return toThenable(e)(i)}}}},oldImpl=(n,t)=>(i,e,s)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:f=>f,version:0,merge:(f,u)=>({...u,...f}),...t},o=!1;const D=new Set,S=new Set;let E;try{E=a.getStorage()}catch{}if(!E)return n((...f)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),i(...f)},e,s);const c=toThenable(a.serialize),v=()=>{const f=a.partialize({...e()});let u;const C=c({state:f,version:a.version}).then(F=>E.setItem(a.name,F)).catch(F=>{u=F});if(u)throw u;return C},x=s.setState;s.setState=(f,u)=>{x(f,u),v()};const p=n((...f)=>{i(...f),v()},e,s);let _;const A=()=>{var f;if(!E)return;o=!1,D.forEach(C=>C(e()));const u=((f=a.onRehydrateStorage)==null?void 0:f.call(a,e()))||void 0;return toThenable(E.getItem.bind(E))(a.name).then(C=>{if(C)return a.deserialize(C)}).then(C=>{if(C)if(typeof C.version=="number"&&C.version!==a.version){if(a.migrate)return a.migrate(C.state,C.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return C.state}).then(C=>{var F;return _=a.merge(C,(F=e())!=null?F:p),i(_,!0),v()}).then(()=>{u==null||u(_,void 0),o=!0,S.forEach(C=>C(_))}).catch(C=>{u==null||u(void 0,C)})};return s.persist={setOptions:f=>{a={...a,...f},f.getStorage&&(E=f.getStorage())},clearStorage:()=>{E==null||E.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>A(),hasHydrated:()=>o,onHydrate:f=>(D.add(f),()=>{D.delete(f)}),onFinishHydration:f=>(S.add(f),()=>{S.delete(f)})},A(),_||p},newImpl=(n,t)=>(i,e,s)=>{let a={storage:createJSONStorage(()=>localStorage),partialize:A=>A,version:0,merge:(A,f)=>({...f,...A}),...t},o=!1;const D=new Set,S=new Set;let E=a.storage;if(!E)return n((...A)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),i(...A)},e,s);const c=()=>{const A=a.partialize({...e()});return E.setItem(a.name,{state:A,version:a.version})},v=s.setState;s.setState=(A,f)=>{v(A,f),c()};const x=n((...A)=>{i(...A),c()},e,s);s.getInitialState=()=>x;let p;const _=()=>{var A,f;if(!E)return;o=!1,D.forEach(C=>{var F;return C((F=e())!=null?F:x)});const u=((f=a.onRehydrateStorage)==null?void 0:f.call(a,(A=e())!=null?A:x))||void 0;return toThenable(E.getItem.bind(E))(a.name).then(C=>{if(C)if(typeof C.version=="number"&&C.version!==a.version){if(a.migrate)return[!0,a.migrate(C.state,C.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,C.state];return[!1,void 0]}).then(C=>{var F;const[w,h]=C;if(p=a.merge(h,(F=e())!=null?F:x),i(p,!0),w)return c()}).then(()=>{u==null||u(p,void 0),p=e(),o=!0,S.forEach(C=>C(p))}).catch(C=>{u==null||u(void 0,C)})};return s.persist={setOptions:A=>{a={...a,...A},A.storage&&(E=A.storage)},clearStorage:()=>{E==null||E.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:A=>(D.add(A),()=>{D.delete(A)}),onFinishHydration:A=>(S.add(A),()=>{S.delete(A)})},a.skipHydration||_(),p||x},persistImpl=(n,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((__vite_import_meta_env__?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),oldImpl(n,t)):newImpl(n,t),persist=persistImpl,ANP_LIMITS={HC_BALANCE_WARNING:7,HC_BALANCE_ERROR:10,TOTAL_BALANCE_WARNING:5,TOTAL_BALANCE_ERROR:7,K_FACTOR_MIN:.8,K_FACTOR_MAX:1.2};function calculateDeviation(n,t){return t===0?n===0?0:100:(n-t)/t*100}function getDeviationStatus(n,t,i){const e=Math.abs(n);return e>=i?"FAIL":e>=t?"ALERT":"OK"}function calculateMassBalance(n,t){const i=n.oil+n.gas,e=t.oil+t.gas,s=i+n.water,a=e+t.water,o=calculateDeviation(i,e),D=calculateDeviation(s,a),S=getDeviationStatus(o,ANP_LIMITS.HC_BALANCE_WARNING,ANP_LIMITS.HC_BALANCE_ERROR),E=getDeviationStatus(D,ANP_LIMITS.TOTAL_BALANCE_WARNING,ANP_LIMITS.TOTAL_BALANCE_ERROR);return{hcBalance:o,totalBalance:D,hcStatus:S,totalStatus:E,action:S==="FAIL"||E==="FAIL"?"INVESTIGAR":"MONITORAR"}}function calculateKFactor(n,t){return n===0?t===0?1:0:t/n}function generateCalibrationEventId(n,t,i=new Date){const e=n.startsWith("13")?"TOP":"SUB",s=t.substring(0,3).toUpperCase(),a=String(i.getMonth()+1).padStart(2,"0"),o=String(i.getFullYear()).slice(-2);return`CAL-MPFM_${e}-${s}-${a}-${o}`}function generateUniqueId(n=""){const t=Date.now().toString(36),i=Math.random().toString(36).substring(2,8);return n?`${n}-${t}-${i}`:`${t}-${i}`}const getInitialState=()=>({user:{id:"user-1",name:"Mauricio Amorim",email:"mauricio.amorim@equinor.com",role:"Admin"},activeModule:"monitoring",sidebarCollapsed:!1,showNewEventModal:!1,showImportModal:!1,showExportModal:!1,showMeterModal:!1,showAlertModal:!1,editingMeter:null,meters:[],selectedMeter:null,monitoringData:[],calibrationEvents:[],selectedEvent:null,calibrationFormData:null,alerts:[],monitoringFilters:{startDate:"",endDate:"",meterId:"",status:""},calibrationFilters:{status:"",type:"",meterId:"",responsible:""}}),useAppStore=create()(persist((n,t)=>({...getInitialState(),setActiveModule:i=>n({activeModule:i,selectedEvent:null}),toggleSidebar:()=>n(i=>({sidebarCollapsed:!i.sidebarCollapsed})),setShowNewEventModal:i=>n({showNewEventModal:i}),setShowImportModal:i=>n({showImportModal:i}),setShowExportModal:i=>n({showExportModal:i}),setShowMeterModal:i=>n({showMeterModal:i}),setShowAlertModal:i=>n({showAlertModal:i}),setEditingMeter:i=>n({editingMeter:i,showMeterModal:!!i}),setSelectedMeter:i=>n({selectedMeter:i}),addMeter:i=>{const e={...i,id:generateUniqueId("meter")};n(s=>({meters:[...s.meters,e]})),t().addAlert({type:"success",severity:"info",message:`Medidor ${e.tag} adicionado com sucesso`,meterId:e.id,meterTag:e.tag})},updateMeter:(i,e)=>{n(s=>({meters:s.meters.map(a=>a.id===i?{...a,...e}:a)}))},deleteMeter:i=>{const e=t().meters.find(s=>s.id===i);n(s=>{var a;return{meters:s.meters.filter(o=>o.id!==i),selectedMeter:((a=s.selectedMeter)==null?void 0:a.id)===i?null:s.selectedMeter}}),e&&t().addAlert({type:"warning",severity:"warning",message:`Medidor ${e.tag} removido`})},addMonitoringData:i=>{const e={...i,id:generateUniqueId("mon")};n(s=>({monitoringData:[...s.monitoringData,e]}))},updateMonitoringData:(i,e)=>{n(s=>({monitoringData:s.monitoringData.map(a=>a.id===i?{...a,...e}:a)}))},deleteMonitoringData:i=>{n(e=>({monitoringData:e.monitoringData.filter(s=>s.id!==i)}))},importMonitoringData:i=>{const e=i.map(s=>({...s,id:s.id||generateUniqueId("mon")}));n(s=>({monitoringData:[...s.monitoringData,...e]})),t().addAlert({type:"success",severity:"info",message:`${i.length} registros de monitoramento importados`})},recalculateBalances:()=>{n(i=>({monitoringData:i.monitoringData.map(e=>{const s=calculateMassBalance({oil:e.topOil,gas:e.topGas,water:e.topWater||0},{oil:e.sepOil,gas:e.sepGas,water:e.sepWater||0});return{...e,hcBalancePercent:s.hcBalance,totalBalancePercent:s.totalBalance,hcStatus:s.hcStatus,totalStatus:s.totalStatus,action:s.action}})}))},setSelectedEvent:i=>n({selectedEvent:i}),addCalibrationEvent:(i,e)=>{const s=new Date,a=generateCalibrationEventId(i.tag,e,s),o={id:a,meterId:i.id,meterTag:i.tag,meterName:i.name,type:e,status:"Em Andamento",startDate:s.toISOString().split("T")[0],currentStep:1,progress:0,responsible:t().user.name,createdAt:s.toISOString(),updatedAt:s.toISOString()};return n(D=>({calibrationEvents:[...D.calibrationEvents,o],showNewEventModal:!1})),t().addAlert({type:"info",severity:"info",message:`Avaliação ${a} iniciada para ${i.tag}`,meterId:i.id,meterTag:i.tag}),o},updateCalibrationEvent:(i,e)=>{n(s=>{var a;return{calibrationEvents:s.calibrationEvents.map(o=>o.id===i?{...o,...e,updatedAt:new Date().toISOString()}:o),selectedEvent:((a=s.selectedEvent)==null?void 0:a.id)===i?{...s.selectedEvent,...e,updatedAt:new Date().toISOString()}:s.selectedEvent}})},deleteCalibrationEvent:i=>{n(e=>{var s;return{calibrationEvents:e.calibrationEvents.filter(a=>a.id!==i),selectedEvent:((s=e.selectedEvent)==null?void 0:s.id)===i?null:e.selectedEvent}})},setCalibrationFormData:i=>n({calibrationFormData:i}),updateCalibrationFormData:i=>{n(e=>({calibrationFormData:e.calibrationFormData?{...e.calibrationFormData,...i}:null}))},completeCalibrationStep:(i,e)=>{const s=Math.round(e/7*100);t().updateCalibrationEvent(i,{currentStep:Math.min(e+1,7),progress:s,status:e>=7?"Concluída":"Em Andamento"})},finalizeCalibration:(i,e)=>{var o;const s=new Date;t().updateCalibrationEvent(i,{status:"Concluída",result:e,progress:100,currentStep:7,endDate:s.toISOString().split("T")[0]});const a=t().calibrationEvents.find(D=>D.id===i);if(a){if(e==="Aprovado"&&((o=t().calibrationFormData)!=null&&o.kFactors)){const{kFactors:D}=t().calibrationFormData;t().updateMeter(a.meterId,{kOil:D.kOil,kGas:D.kGas,kWater:D.kWater,lastCalibration:s.toISOString().split("T")[0],daysToCalibration:365})}t().addAlert({type:e==="Aprovado"?"success":"error",severity:e==="Aprovado"?"info":"critical",message:`Calibração ${i} finalizada: ${e}`,meterId:a.meterId,meterTag:a.meterTag})}},addAlert:i=>{const e={...i,id:generateUniqueId("alert"),timestamp:new Date().toISOString(),read:!1};n(s=>({alerts:[e,...s.alerts]}))},markAlertAsRead:i=>{n(e=>({alerts:e.alerts.map(s=>s.id===i?{...s,read:!0}:s)}))},markAllAlertsAsRead:()=>{n(i=>({alerts:i.alerts.map(e=>({...e,read:!0}))}))},deleteAlert:i=>{n(e=>({alerts:e.alerts.filter(s=>s.id!==i)}))},clearAllAlerts:()=>n({alerts:[]}),setMonitoringFilters:i=>{n(e=>({monitoringFilters:{...e.monitoringFilters,...i}}))},setCalibrationFilters:i=>{n(e=>({calibrationFilters:{...e.calibrationFilters,...i}}))},resetToDefaults:()=>{n(getInitialState())},clearAllData:()=>{n({meters:[],monitoringData:[],calibrationEvents:[],alerts:[],selectedMeter:null,selectedEvent:null,calibrationFormData:null})},getUnreadAlertsCount:()=>t().alerts.filter(i=>!i.read).length,getActiveMetersCount:()=>t().meters.filter(i=>i.status==="active").length,getFilteredMonitoringData:()=>{const{monitoringData:i,monitoringFilters:e}=t();return i.filter(s=>!(e.startDate&&s.date<e.startDate||e.endDate&&s.date>e.endDate||e.status&&s.hcStatus!==e.status))},getFilteredCalibrationEvents:()=>{const{calibrationEvents:i,calibrationFilters:e}=t();return i.filter(s=>!(e.status&&s.status!==e.status||e.type&&s.type!==e.type||e.meterId&&s.meterId!==e.meterId||e.responsible&&!s.responsible.toLowerCase().includes(e.responsible.toLowerCase())))}}),{name:"mpfm-monitor-storage",storage:createJSONStorage(()=>localStorage),partialize:n=>({meters:n.meters,monitoringData:n.monitoringData,calibrationEvents:n.calibrationEvents,alerts:n.alerts,user:n.user,sidebarCollapsed:n.sidebarCollapsed})})),MODULE_TITLES={monitoring:"Monitoramento SGM-FM",calibration:"Avaliação de Desempenho",compliance:"Conformidade ANP"};function Layout({children:n}){const[t,i]=reactExports.useState(!1),e=useLocation(),s=useNavigate(),{alerts:a,setShowImportModal:o,setShowExportModal:D}=useAppStore(),S=a.filter(x=>!x.read).length,c=(x=>x.includes("calibration")?"calibration":x.includes("compliance")?"compliance":"monitoring")(e.pathname),v=x=>{s(`/${x}`)};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white flex",children:[jsxRuntimeExports.jsx(Sidebar,{activeModule:c,onModuleChange:v,collapsed:t}),jsxRuntimeExports.jsxs("main",{className:"flex-1 flex flex-col min-w-0",children:[jsxRuntimeExports.jsx(Header,{title:MODULE_TITLES[c]||"MPFM Monitor",onToggleSidebar:()=>i(!t),onImport:()=>o(!0),onExport:()=>D(!0),alertCount:S}),jsxRuntimeExports.jsx("div",{className:"flex-1 p-4 overflow-auto",children:n})]})]})}function BalanceChart({data:n}){return jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:220,children:jsxRuntimeExports.jsxs(AreaChart,{data:n,children:[jsxRuntimeExports.jsxs("defs",{children:[jsxRuntimeExports.jsxs("linearGradient",{id:"hcGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[jsxRuntimeExports.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),jsxRuntimeExports.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]}),jsxRuntimeExports.jsxs("linearGradient",{id:"totalGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[jsxRuntimeExports.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.3}),jsxRuntimeExports.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})]}),jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3",stroke:"#27272a"}),jsxRuntimeExports.jsx(XAxis,{dataKey:"date",stroke:"#71717a",fontSize:10,tickFormatter:t=>t.slice(5)}),jsxRuntimeExports.jsx(YAxis,{stroke:"#71717a",fontSize:10,domain:[-15,40]}),jsxRuntimeExports.jsx(Tooltip,{contentStyle:{backgroundColor:"#18181b",border:"1px solid #27272a",borderRadius:"8px",fontSize:"11px"}}),jsxRuntimeExports.jsx(ReferenceLine,{y:10,stroke:"#ef4444",strokeDasharray:"5 5"}),jsxRuntimeExports.jsx(ReferenceLine,{y:-10,stroke:"#ef4444",strokeDasharray:"5 5"}),jsxRuntimeExports.jsx(ReferenceLine,{y:7,stroke:"#f59e0b",strokeDasharray:"3 3"}),jsxRuntimeExports.jsx(ReferenceLine,{y:-7,stroke:"#f59e0b",strokeDasharray:"3 3"}),jsxRuntimeExports.jsx(ReferenceLine,{y:0,stroke:"#52525b"}),jsxRuntimeExports.jsx(Area,{type:"monotone",dataKey:"hcBalTS",stroke:"#3b82f6",fill:"url(#hcGrad)",name:"HC %",strokeWidth:2}),jsxRuntimeExports.jsx(Area,{type:"monotone",dataKey:"totalBalTS",stroke:"#10b981",fill:"url(#totalGrad)",name:"Total %",strokeWidth:2}),jsxRuntimeExports.jsx(Legend,{wrapperStyle:{fontSize:"11px"}})]})})}function ProductionChart({data:n}){return jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:220,children:jsxRuntimeExports.jsxs(BarChart,{data:n,children:[jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3",stroke:"#27272a"}),jsxRuntimeExports.jsx(XAxis,{dataKey:"date",stroke:"#71717a",fontSize:10,tickFormatter:t=>t.slice(5)}),jsxRuntimeExports.jsx(YAxis,{stroke:"#71717a",fontSize:10}),jsxRuntimeExports.jsx(Tooltip,{contentStyle:{backgroundColor:"#18181b",border:"1px solid #27272a",borderRadius:"8px",fontSize:"11px"}}),jsxRuntimeExports.jsx(Bar,{dataKey:"subHC",fill:"#3b82f6",name:"Subsea",radius:[4,4,0,0]}),jsxRuntimeExports.jsx(Bar,{dataKey:"topHC",fill:"#8b5cf6",name:"Topside",radius:[4,4,0,0]}),jsxRuntimeExports.jsx(Bar,{dataKey:"sepHC",fill:"#10b981",name:"Test Sep",radius:[4,4,0,0]}),jsxRuntimeExports.jsx(Legend,{wrapperStyle:{fontSize:"11px"}})]})})}function DayCell({dayStatus:n,isToday:t,onClick:i}){if(!n)return jsxRuntimeExports.jsx("div",{className:"h-16 bg-zinc-900/30 rounded"});const e=parseInt(n.date.split("-")[2],10),s={OK:"bg-emerald-500/10 border-emerald-500/30 hover:bg-emerald-500/20",ALERT:"bg-amber-500/10 border-amber-500/30 hover:bg-amber-500/20",FAIL:"bg-red-500/10 border-red-500/30 hover:bg-red-500/20",NO_DATA:"bg-zinc-800/50 border-zinc-700/30 hover:bg-zinc-700/50"},a={OK:"bg-emerald-500",ALERT:"bg-amber-500",FAIL:"bg-red-500",NO_DATA:"bg-zinc-600"},o={OK:"text-emerald-400",ALERT:"text-amber-400",FAIL:"text-red-400",NO_DATA:"text-zinc-500"};return jsxRuntimeExports.jsxs("button",{onClick:i,disabled:!n.hasData,className:cn("h-16 rounded border transition-all duration-200 flex flex-col items-center justify-center gap-1","focus:outline-none focus:ring-2 focus:ring-blue-500/50",s[n.status],t&&"ring-2 ring-blue-500",n.hasData?"cursor-pointer":"cursor-default"),children:[jsxRuntimeExports.jsx("span",{className:cn("text-sm font-medium",n.hasData?"text-white":"text-zinc-600",t&&"text-blue-400"),children:e}),n.hasData&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:cn("w-2 h-2 rounded-full",a[n.status])}),jsxRuntimeExports.jsx("span",{className:cn("text-[10px] font-medium",o[n.status]),children:n.status})]}),n.hasData&&n.hcBalance!==void 0&&jsxRuntimeExports.jsxs("span",{className:cn("text-[9px]",o[n.status]),children:["HC: ",n.hcBalance>0?"+":"",n.hcBalance.toFixed(1),"%"]})]})}function DayDetailModal({isOpen:n,onClose:t,date:i}){const e=useAppStore(w=>w.monitoringData),s=useAppStore(w=>w.updateMonitoringData),a=useAppStore(w=>w.addAlert),[o,D]=reactExports.useState(!1),[S,E]=reactExports.useState(""),[c,v]=reactExports.useState({});if(!i)return null;const x=e.find(w=>w.date===i);if(!x)return jsxRuntimeExports.jsx(Modal,{isOpen:n,onClose:t,title:"Detalhes do Dia",size:"md",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-zinc-500",children:[jsxRuntimeExports.jsx(Calendar,{size:48,className:"mb-4 opacity-50"}),jsxRuntimeExports.jsxs("p",{children:["Sem dados de medição para ",i]})]})});const p=w=>{const[h,R,b]=w.split("-");return`${b}/${R}/${h}`},_={OK:{icon:CheckCircle,color:"text-emerald-400",bg:"bg-emerald-500/10"},ALERT:{icon:AlertTriangle,color:"text-amber-400",bg:"bg-amber-500/10"},FAIL:{icon:XCircle,color:"text-red-400",bg:"bg-red-500/10"}},A=_[x.hcStatus]||_.OK,f=A.icon,u=()=>{D(!0),v({subOil:x.subOil,subGas:x.subGas,subWater:x.subWater||0,topOil:x.topOil,topGas:x.topGas,topWater:x.topWater||0})},C=()=>{D(!1),E(""),v({})},F=()=>{if(!S.trim()){a({type:"error",severity:"warning",message:"É necessário informar o motivo da alteração"});return}const w=c.subOil+c.subGas,h=c.topOil+c.topGas,R=w>0?(h-w)/w*100:0,b=w+(c.subWater||0),j=h+(c.topWater||0),y=b>0?(j-b)/b*100:0,L=Math.abs(R)>10?"FAIL":Math.abs(R)>7?"ALERT":"OK",g=Math.abs(y)>7?"FAIL":Math.abs(y)>5?"ALERT":"OK";s(x.id,{subOil:c.subOil,subGas:c.subGas,subWater:c.subWater,subHC:w,topOil:c.topOil,topGas:c.topGas,topWater:c.topWater,topHC:h,hcBalTS:parseFloat(R.toFixed(2)),totalBalTS:parseFloat(y.toFixed(2)),hcBalancePercent:parseFloat(R.toFixed(2)),totalBalancePercent:parseFloat(y.toFixed(2)),hcStatus:L,totalStatus:g,action:L==="FAIL"||g==="FAIL"?"INVESTIGAR":"MONITORAR"}),a({type:"info",severity:"info",message:`Dados de ${p(i)} editados. Motivo: ${S}`}),D(!1),E(""),v({})};return jsxRuntimeExports.jsx(Modal,{isOpen:n,onClose:t,title:"",size:"lg",children:jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:cn("p-2 rounded-lg",A.bg),children:jsxRuntimeExports.jsx(f,{className:A.color,size:24})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-white",children:p(i)}),jsxRuntimeExports.jsx("p",{className:"text-sm text-zinc-400",children:"Dados de medição diária"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Badge,{variant:x.hcStatus==="OK"?"success":x.hcStatus==="ALERT"?"warning":"error",children:x.hcStatus}),!o&&jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",onClick:u,children:[jsxRuntimeExports.jsx(PenLine,{size:14,className:"mr-1"}),"Editar"]})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4 bg-zinc-800/50",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-zinc-400 mb-3 flex items-center gap-2",children:[jsxRuntimeExports.jsx(BarChart3,{size:16}),"Balanço de Massa"]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"text-center p-3 rounded-lg bg-zinc-900/50",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mb-1",children:"Balanço HC"}),jsxRuntimeExports.jsxs("p",{className:cn("text-2xl font-bold",Math.abs(x.hcBalTS)>10?"text-red-400":Math.abs(x.hcBalTS)>7?"text-amber-400":"text-emerald-400"),children:[x.hcBalTS>0?"+":"",x.hcBalTS.toFixed(2),"%"]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Limite: ±10%"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center p-3 rounded-lg bg-zinc-900/50",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mb-1",children:"Balanço Total"}),jsxRuntimeExports.jsxs("p",{className:cn("text-2xl font-bold",Math.abs(x.totalBalTS)>7?"text-red-400":Math.abs(x.totalBalTS)>5?"text-amber-400":"text-emerald-400"),children:[x.totalBalTS>0?"+":"",x.totalBalTS.toFixed(2),"%"]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Limite: ±7%"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4 bg-zinc-800/50",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-blue-400 mb-3 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Waves,{size:16}),"SUBSEA (MPFM)"]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:o?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Input,{label:"Óleo (t)",type:"number",value:c.subOil,onChange:w=>v({...c,subOil:parseFloat(w.target.value)||0})}),jsxRuntimeExports.jsx(Input,{label:"Gás (t)",type:"number",value:c.subGas,onChange:w=>v({...c,subGas:parseFloat(w.target.value)||0})}),jsxRuntimeExports.jsx(Input,{label:"Água (t)",type:"number",value:c.subWater,onChange:w=>v({...c,subWater:parseFloat(w.target.value)||0})})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Droplets,{size:12})," Óleo"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[x.subOil.toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Flame,{size:12})," Gás"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[x.subGas.toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Waves,{size:12})," Água"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[(x.subWater||0).toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm pt-2 border-t border-zinc-700",children:[jsxRuntimeExports.jsx("span",{className:"text-zinc-300 font-medium",children:"HC Total"}),jsxRuntimeExports.jsxs("span",{className:"text-blue-400 font-mono font-medium",children:[x.subHC.toFixed(2)," t"]})]})]})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4 bg-zinc-800/50",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-purple-400 mb-3 flex items-center gap-2",children:[jsxRuntimeExports.jsx(BarChart3,{size:16}),"TOPSIDE (MPFM)"]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:o?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Input,{label:"Óleo (t)",type:"number",value:c.topOil,onChange:w=>v({...c,topOil:parseFloat(w.target.value)||0})}),jsxRuntimeExports.jsx(Input,{label:"Gás (t)",type:"number",value:c.topGas,onChange:w=>v({...c,topGas:parseFloat(w.target.value)||0})}),jsxRuntimeExports.jsx(Input,{label:"Água (t)",type:"number",value:c.topWater,onChange:w=>v({...c,topWater:parseFloat(w.target.value)||0})})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Droplets,{size:12})," Óleo"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[x.topOil.toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Flame,{size:12})," Gás"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[x.topGas.toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Waves,{size:12})," Água"]}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:[(x.topWater||0).toFixed(2)," t"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm pt-2 border-t border-zinc-700",children:[jsxRuntimeExports.jsx("span",{className:"text-zinc-300 font-medium",children:"HC Total"}),jsxRuntimeExports.jsxs("span",{className:"text-purple-400 font-mono font-medium",children:[x.topHC.toFixed(2)," t"]})]})]})})]})]}),o&&jsxRuntimeExports.jsxs(Card,{className:"p-4 bg-amber-500/10 border-amber-500/30",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-amber-400 mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx(FileText,{size:16}),"Justificativa da Alteração (obrigatório)"]}),jsxRuntimeExports.jsx("textarea",{value:S,onChange:w=>E(w.target.value),placeholder:"Descreva o motivo da alteração para registro de auditoria...",className:"w-full h-20 bg-zinc-900/50 border border-zinc-700 rounded-lg p-2 text-sm text-white resize-none focus:outline-none focus:ring-2 focus:ring-amber-500/50"})]}),jsxRuntimeExports.jsx("div",{className:"flex justify-end gap-2 pt-2 border-t border-zinc-800",children:o?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",onClick:C,children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{variant:"primary",onClick:F,children:"Salvar Alterações"})]}):jsxRuntimeExports.jsx(Button,{variant:"ghost",onClick:t,children:"Fechar"})})]})})}const WEEKDAYS=["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],MONTHS=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];function CalendarView(){const n=new Date,[t,i]=reactExports.useState(n.getMonth()),[e,s]=reactExports.useState(n.getFullYear()),[a,o]=reactExports.useState(null),[D,S]=reactExports.useState(!1),E=useAppStore(u=>u.monitoringData),c=reactExports.useMemo(()=>{const u=new Date(e,t,1),C=new Date(e,t+1,0),F=u.getDay(),w=C.getDate(),h=[];for(let R=0;R<F;R++)h.push(null);for(let R=1;R<=w;R++){const b=`${e}-${String(t+1).padStart(2,"0")}-${String(R).padStart(2,"0")}`,j=E.find(y=>y.date===b);j?h.push({date:b,hasData:!0,status:j.hcStatus,hcBalance:j.hcBalTS,totalBalance:j.totalBalTS}):h.push({date:b,hasData:!1,status:"NO_DATA"})}return h},[t,e,E]),v=()=>{t===0?(i(11),s(e-1)):i(t-1)},x=()=>{t===11?(i(0),s(e+1)):i(t+1)},p=()=>{i(n.getMonth()),s(n.getFullYear())},_=u=>{o(u.date),S(!0)},A=reactExports.useMemo(()=>{const u=c.filter(h=>h==null?void 0:h.hasData),C=u.filter(h=>(h==null?void 0:h.status)==="OK").length,F=u.filter(h=>(h==null?void 0:h.status)==="ALERT").length,w=u.filter(h=>(h==null?void 0:h.status)==="FAIL").length;return{total:u.length,ok:C,alert:F,fail:w}},[c]),f=Array.from({length:10},(u,C)=>({value:String(e-5+C),label:String(e-5+C)}));return jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(Calendar,{className:"text-blue-400",size:24}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-white",children:"Calendário de Medições"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400",children:[A.total," dias com dados:"]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded-full bg-emerald-500"}),jsxRuntimeExports.jsxs("span",{className:"text-emerald-400",children:[A.ok," OK"]})]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded-full bg-amber-500"}),jsxRuntimeExports.jsxs("span",{className:"text-amber-400",children:[A.alert," Alert"]})]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded-full bg-red-500"}),jsxRuntimeExports.jsxs("span",{className:"text-red-400",children:[A.fail," Fail"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4 bg-zinc-800/50 rounded-lg p-2",children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:v,className:"text-zinc-400 hover:text-white",children:jsxRuntimeExports.jsx(ChevronLeft,{size:20})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Select,{value:String(t),onChange:u=>i(Number(u.target.value)),options:MONTHS.map((u,C)=>({value:String(C),label:u})),className:"w-32"}),jsxRuntimeExports.jsx(Select,{value:String(e),onChange:u=>s(Number(u.target.value)),options:f,className:"w-24"}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:p,className:"ml-2",children:"Hoje"})]}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:x,className:"text-zinc-400 hover:text-white",children:jsxRuntimeExports.jsx(ChevronRight,{size:20})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[WEEKDAYS.map(u=>jsxRuntimeExports.jsx("div",{className:"text-center text-xs font-medium text-zinc-500 py-2",children:u},u)),c.map((u,C)=>jsxRuntimeExports.jsx(DayCell,{dayStatus:u,isToday:(u==null?void 0:u.date)===n.toISOString().split("T")[0],onClick:u?()=>_(u):void 0},C))]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4 pt-4 border-t border-zinc-800 text-xs text-zinc-500",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded bg-emerald-500/20 border border-emerald-500"}),"OK (HC ≤ 7%)"]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded bg-amber-500/20 border border-amber-500"}),"Alert (7% < HC ≤ 10%)"]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded bg-red-500/20 border border-red-500"}),"Fail (HC > 10%)"]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded bg-zinc-700 border border-zinc-600"}),"Sem dados"]})]}),jsxRuntimeExports.jsx(DayDetailModal,{isOpen:D,onClose:()=>S(!1),date:a})]})}function getTimeAgo(n){const t=new Date,i=new Date(n),e=t.getTime()-i.getTime(),s=Math.floor(e/6e4),a=Math.floor(e/36e5),o=Math.floor(e/864e5);return s<60?`${s}m atrás`:a<24?`${a}h atrás`:`${o}d atrás`}const realMeters=[{tag:"13FT0367",name:"Riser P5",location:"TOPSIDE",status:"active",serialNumber:"SLB-VX-2024-0367",manufacturer:"Schlumberger",model:"Vx Spectra",lastCalibration:"2026-01-18",kOil:1.0908,kGas:1.09262,kWater:1,daysToCalibration:365},{tag:"13FT0417",name:"Riser P6",location:"TOPSIDE",status:"inactive",serialNumber:"SLB-VX-2024-0417",manufacturer:"Schlumberger",model:"Vx Spectra",lastCalibration:"2025-06-15",kOil:1,kGas:1,kWater:1,daysToCalibration:180},{tag:"18FT1506",name:"PE_4",location:"SUBSEA",status:"active",serialNumber:"TFMC-MPM-2024-1506",manufacturer:"TechnipFMC",model:"MPM",lastCalibration:"2025-12-01",kOil:1,kGas:1,kWater:1,daysToCalibration:320},{tag:"18FT1806",name:"PE_EO4",location:"SUBSEA",status:"inactive",serialNumber:"TFMC-MPM-2024-1806",manufacturer:"TechnipFMC",model:"MPM",lastCalibration:"2025-08-20",kOil:1,kGas:1,kWater:1,daysToCalibration:0},{tag:"18FT1706",name:"PE_EO105",location:"SUBSEA",status:"inactive",serialNumber:"TFMC-MPM-2024-1706",manufacturer:"TechnipFMC",model:"MPM",lastCalibration:"2025-07-10",kOil:1,kGas:1,kWater:1,daysToCalibration:0},{tag:"18FT1406",name:"PE_EO10",location:"SUBSEA",status:"inactive",serialNumber:"TFMC-MPM-2024-1406",manufacturer:"TechnipFMC",model:"MPM",lastCalibration:"2025-09-05",kOil:1,kGas:1,kWater:1,daysToCalibration:0}],realCalibrationPVT={calibrationNo:211,meterName:"N1 - Riser P5",startDate:"2026-01-17",endDate:"2026-01-18",densities:{oil:{mpfm:754.033},gas:{mpfm:91.842},water:{mpfm:999.784}},composition:[{component:"N₂",molPercent:.575,molecularWeight:28.01},{component:"CO₂",molPercent:.02,molecularWeight:44.01},{component:"C₁",molPercent:62.183,molecularWeight:16.04},{component:"C₂",molPercent:8.069,molecularWeight:30.07},{component:"C₃",molPercent:5.047,molecularWeight:44.1},{component:"i-C₄",molPercent:1.069,molecularWeight:58.12},{component:"n-C₄",molPercent:1.858,molecularWeight:58.12},{component:"i-C₅",molPercent:.681,molecularWeight:72.15},{component:"n-C₅",molPercent:.788,molecularWeight:72.15},{component:"C₆",molPercent:1.112,molecularWeight:86.18},{component:"C₇",molPercent:1.138,molecularWeight:97.37},{component:"C₈",molPercent:1.657,molecularWeight:111.29},{component:"C₉",molPercent:1.472,molecularWeight:125.25},{component:"C₁₀+",molPercent:14.331,molecularWeight:289.64}],peneloux:{gas:1,oil:1}};function AlertsList({limit:n}){const t=useAppStore(a=>a.alerts),i=n?t.slice(0,n):t,e=a=>{switch(a){case"error":return AlertCircle;case"warning":return AlertTriangle;case"success":return CheckCircle;default:return Info}},s=a=>{switch(a){case"error":return"bg-red-500/20 text-red-400";case"warning":return"bg-amber-500/20 text-amber-400";case"success":return"bg-emerald-500/20 text-emerald-400";default:return"bg-blue-500/20 text-blue-400"}};return jsxRuntimeExports.jsx("div",{className:"divide-y divide-zinc-800",children:i.map(a=>{const o=e(a.type);return jsxRuntimeExports.jsx("div",{className:cn("p-3",!a.read&&"bg-zinc-800/30"),children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-2",children:[jsxRuntimeExports.jsx("div",{className:cn("mt-0.5 p-1 rounded",s(a.type)),children:jsxRuntimeExports.jsx(o,{className:"w-3 h-3"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-200 truncate",children:a.message}),jsxRuntimeExports.jsxs("p",{className:"text-[10px] text-zinc-500 mt-0.5",children:[a.meterTag," • ",getTimeAgo(a.timestamp)]})]})]})},a.id)})})}function DailyTable({data:n}){const t=[...n].reverse().slice(0,5);return jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700 bg-zinc-800/50",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-left text-zinc-400",children:"Data"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-blue-400",children:"Subsea HC"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-purple-400",children:"Topside HC"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-emerald-400",children:"Test Sep HC"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Bal HC%"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Status"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Ação"})]})}),jsxRuntimeExports.jsx("tbody",{children:t.map((i,e)=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50 hover:bg-zinc-800/30",children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-zinc-200",children:i.date}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-right text-blue-400",children:i.subHC.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-right text-purple-400",children:i.topHC.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-right text-emerald-400",children:i.sepHC.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsxs("td",{className:cn("py-2 px-3 text-center font-mono",Math.abs(i.hcBalTS)>10?"text-red-400":"text-zinc-300"),children:[i.hcBalTS>0?"+":"",i.hcBalTS.toFixed(2),"%"]}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:i.hcStatus,size:"sm",children:i.hcStatus})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:i.action,size:"sm",children:i.action})})]},e))})]})})}function MetersList(){const{meters:n,setShowMeterModal:t,setEditingMeter:i,deleteMeter:e}=useAppStore(),s=o=>{i(o)},a=o=>{confirm("Tem certeza que deseja remover este medidor?")&&e(o)};return jsxRuntimeExports.jsx(Card,{title:"Medidores MPFM",subtitle:"Status e próximas calibrações",headerRight:jsxRuntimeExports.jsx(Button,{variant:"primary",size:"sm",icon:Plus,onClick:()=>t(!0),children:"Adicionar"}),noPadding:!0,children:n.length===0?jsxRuntimeExports.jsxs("div",{className:"p-8 text-center text-zinc-500",children:[jsxRuntimeExports.jsx("p",{className:"mb-4",children:"Nenhum medidor cadastrado."}),jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:Plus,onClick:()=>t(!0),children:"Adicionar Primeiro Medidor"})]}):jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700 bg-zinc-800/50",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-left text-zinc-400",children:"TAG"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-left text-zinc-400",children:"Nome"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Localização"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Status"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Última Calib."}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-zinc-400",children:"K-Oil"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-zinc-400",children:"K-Gas"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Próx. Calib."}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Ações"})]})}),jsxRuntimeExports.jsx("tbody",{children:n.map(o=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50 hover:bg-zinc-800/30",children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-3 font-mono text-blue-400",children:o.tag}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-zinc-200",children:o.name}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:o.location,size:"sm",children:o.location})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:o.status,size:"sm",children:o.status==="active"?"Ativo":"Inativo"})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center text-zinc-400",children:o.lastCalibration}),jsxRuntimeExports.jsx("td",{className:cn("py-2 px-3 text-right font-mono",o.kOil<.8||o.kOil>1.2?"text-red-400":"text-emerald-400"),children:o.kOil.toFixed(4)}),jsxRuntimeExports.jsx("td",{className:cn("py-2 px-3 text-right font-mono",o.kGas<.8||o.kGas>1.2?"text-red-400":"text-emerald-400"),children:o.kGas.toFixed(4)}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsxs(Badge,{variant:o.daysToCalibration<30?"error":o.daysToCalibration<60?"warning":"success",size:"sm",children:[o.daysToCalibration,"d"]})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-1",children:[jsxRuntimeExports.jsx("button",{onClick:()=>s(o),className:"p-1 hover:bg-zinc-700 rounded transition-colors",title:"Editar",children:jsxRuntimeExports.jsx(PenSquare,{className:"w-3.5 h-3.5 text-zinc-400 hover:text-blue-400"})}),jsxRuntimeExports.jsx("button",{onClick:()=>a(o.id),className:"p-1 hover:bg-zinc-700 rounded transition-colors",title:"Remover",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3.5 h-3.5 text-zinc-400 hover:text-red-400"})})]})})]},o.id))})]})})})}function MonitoringDashboard(){var x,p;const{monitoringData:n,meters:t,getUnreadAlertsCount:i,getActiveMetersCount:e,setShowMeterModal:s,setShowImportModal:a}=useAppStore(),o=n.length>0,D=t.length>0,S=o?n[n.length-1]:null,E=o?Math.max(...n.map(_=>Math.max(_.subVsTS||0,_.topVsTS||0,_.topVsSub||0))):0,c=i(),v=e();return!o&&!D?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-[60vh] space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx(Database,{className:"w-16 h-16 text-zinc-600 mx-auto mb-4"}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Bem-vindo ao MPFM Monitor"}),jsxRuntimeExports.jsx("p",{className:"text-zinc-400 max-w-md",children:"Comece adicionando medidores MPFM e importando dados de monitoramento para visualizar os balanços de massa."})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsx(Button,{variant:"primary",icon:Plus,onClick:()=>s(!0),children:"Adicionar Medidor"}),jsxRuntimeExports.jsx(Button,{variant:"secondary",icon:Database,onClick:()=>a(!0),children:"Importar Dados"})]})]}):jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-3",children:[jsxRuntimeExports.jsx(KPICard,{title:"Balanço HC Atual",value:S?((x=S.hcBalTS)==null?void 0:x.toFixed(2))||"0.00":"--",unit:"%",subtitle:S&&Math.abs(S.hcBalTS||0)>10?"FORA DO LIMITE":"Dentro do limite",icon:Target,color:S&&Math.abs(S.hcBalTS||0)>10?"red":"emerald"}),jsxRuntimeExports.jsx(KPICard,{title:"Balanço Total",value:S?((p=S.totalBalTS)==null?void 0:p.toFixed(2))||"0.00":"--",unit:"%",subtitle:"Limite: ±7%",icon:Activity,color:S&&Math.abs(S.totalBalTS||0)>7?"red":"emerald"}),jsxRuntimeExports.jsx(KPICard,{title:"Dias Consecutivos",value:E,unit:"/10",subtitle:"Gatilho calibração",icon:Calendar,color:E>=10?"red":E>=7?"amber":"emerald"}),jsxRuntimeExports.jsx(KPICard,{title:"Medidores Ativos",value:v,unit:`/${t.length}`,icon:Gauge,color:"purple"}),jsxRuntimeExports.jsx(KPICard,{title:"Alertas Pendentes",value:c,icon:Bell,color:c>0?"amber":"emerald"})]}),o&&jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(Card,{title:"Histórico de Balanço de Massa",subtitle:"Últimos 7 dias - Limites ANP: HC ±10%, Total ±7%",children:jsxRuntimeExports.jsx(BalanceChart,{data:n})}),jsxRuntimeExports.jsx(Card,{title:"Produção HC por Sistema",subtitle:"Últimos 7 dias (t)",children:jsxRuntimeExports.jsx(ProductionChart,{data:n})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[jsxRuntimeExports.jsx(Card,{title:"Monitoramento Diário",subtitle:o?"Últimos registros":"Nenhum dado importado",className:"lg:col-span-2",noPadding:!0,children:o?jsxRuntimeExports.jsx(DailyTable,{data:n}):jsxRuntimeExports.jsxs("div",{className:"p-8 text-center text-zinc-500",children:[jsxRuntimeExports.jsx("p",{children:"Importe dados de monitoramento para visualizar a tabela."}),jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",className:"mt-4",onClick:()=>a(!0),children:"Importar Dados"})]})}),jsxRuntimeExports.jsx(Card,{title:"Alertas Recentes",headerRight:jsxRuntimeExports.jsxs(Badge,{variant:c>0?"warning":"success",children:[c," novos"]}),noPadding:!0,children:jsxRuntimeExports.jsx(AlertsList,{limit:4})})]}),jsxRuntimeExports.jsx(MetersList,{}),jsxRuntimeExports.jsx(CalendarView,{})]})}function MonitoringPage(){return jsxRuntimeExports.jsx(MonitoringDashboard,{})}function CalibrationEventsList({onSelectEvent:n}){const{calibrationEvents:t,setShowNewEventModal:i,deleteCalibrationEvent:e}=useAppStore(),[s,a]=reactExports.useState("all"),o=t.filter(v=>s==="all"?!0:s==="active"?v.status==="Em Andamento":s==="pending"?v.status==="Pendente":s==="completed"?v.status==="Concluída":!0),D=(v,x)=>{v.stopPropagation(),confirm("Tem certeza que deseja remover este evento de calibração?")&&e(x)},S=v=>{switch(v){case"Concluída":return CheckCircle;case"Em Andamento":return Play;default:return Clock}},E=v=>{switch(v){case"Concluída":return"bg-emerald-500/20";case"Em Andamento":return"bg-blue-500/20";default:return"bg-zinc-700"}},c=v=>{switch(v){case"Concluída":return"text-emerald-400";case"Em Andamento":return"text-blue-400";default:return"text-zinc-400"}};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-white",children:"Eventos de Calibração"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Avaliações de desempenho MPFM - Comissionamento, Periódica, Investigação"})]}),jsxRuntimeExports.jsx(Button,{onClick:()=>i(!0),icon:Plus,children:"Nova Avaliação"})]}),jsxRuntimeExports.jsx(Tabs,{tabs:[{id:"all",label:"Todos",count:t.length},{id:"active",label:"Em Andamento",count:t.filter(v=>v.status==="Em Andamento").length},{id:"pending",label:"Pendentes",count:t.filter(v=>v.status==="Pendente").length},{id:"completed",label:"Concluídas",count:t.filter(v=>v.status==="Concluída").length}],activeTab:s,onChange:a}),o.length===0?jsxRuntimeExports.jsxs(Card,{className:"p-8 text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-zinc-500 mb-4",children:s==="all"?"Nenhum evento de calibração cadastrado.":`Nenhum evento com status "${s==="active"?"Em Andamento":s==="pending"?"Pendente":"Concluída"}".`}),s==="all"&&jsxRuntimeExports.jsx(Button,{variant:"primary",size:"sm",icon:Plus,onClick:()=>i(!0),children:"Criar Primeira Avaliação"})]}):jsxRuntimeExports.jsx("div",{className:"grid gap-3",children:o.map(v=>{const x=S(v.status);return jsxRuntimeExports.jsx(Card,{className:"hover:ring-1 hover:ring-blue-500/50 cursor-pointer transition",noPadding:!0,children:jsxRuntimeExports.jsx("div",{className:"p-4",onClick:()=>n(v),children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4",children:[jsxRuntimeExports.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${E(v.status)}`,children:jsxRuntimeExports.jsx(x,{className:`w-6 h-6 ${c(v.status)}`})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-white",children:v.id}),jsxRuntimeExports.jsx(Badge,{variant:v.status==="Concluída"?"success":v.status==="Em Andamento"?"info":"warning",children:v.status}),jsxRuntimeExports.jsx(Badge,{variant:"purple",children:v.type}),v.result&&jsxRuntimeExports.jsx(Badge,{variant:v.result==="Aprovado"?"success":"error",children:v.result})]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-zinc-400 mt-1",children:[jsxRuntimeExports.jsx("span",{className:"text-blue-400",children:v.meterTag})," -"," ",v.meterName," | Início: ",v.startDate," | Resp:"," ",v.responsible]}),jsxRuntimeExports.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 max-w-xs",children:jsxRuntimeExports.jsx(ProgressBar,{value:v.progress,color:v.status==="Concluída"?"emerald":"blue",showLabel:!1,size:"sm"})}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-zinc-400",children:["Etapa ",v.currentStep,"/7"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:p=>D(p,v.id),className:"p-2 hover:bg-zinc-700 rounded-lg transition-colors",title:"Remover evento",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4 text-zinc-400 hover:text-red-400"})}),jsxRuntimeExports.jsx(ChevronRight,{className:"w-5 h-5 text-zinc-500"})]})]})})},v.id)})})]})}function Step01Registro({event:n}){const{calibrationFormData:t,updateCalibrationFormData:i,user:e}=useAppStore(),s=(o,D)=>{i({[o]:D})},a=t||{eventId:n.id,status:n.status,resultado:"",operador:"Equinor Brasil Energia Ltda.",serviceOrder:"-",responsavelCalibracao:n.responsible||e.name,preenchidoPor:e.name,dataEmissao:new Date().toISOString().split("T")[0],unidade:"FPSO Bacalhau",baciaCampo:"Santos / Bacalhau",localizacao:`MEDIDOR SUBSEA - Poço ${n.meterName}`,referenciaMet:"Separador de Teste - TAG: 20VA121",tagMPFM:n.meterTag,serialNumber:"",fabricante:"TechnipFMC",modelo:"MPM High-Performance Flowmeter",tamanho:'5"',razaoBeta:"B = 0.7 MPM",modoMedicao:"Dual Mode",sistema:n.meterName,versaoSoftwareMedidor:"",versaoFPM207:"",versaoFCS320:"",versaoPVTsim:"",naturezaAtividade:`${n.type} - ${n.meterName} - ${n.meterTag}`,idEventoDesvio:"-",inicioEstabilizacao:"",inicioTotalizacao:"",fimTotalizacao:"",duracaoEfetiva:24,observacoesIniciais:"",comentariosGerais:""};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Clipboard,title:"Identificação do Responsável e Autoridade",color:"blue"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"ID do Evento/Relatório",value:a.eventId,readOnly:!0}),jsxRuntimeExports.jsx(Select,{label:"Status",value:a.status,onChange:o=>s("status",o.target.value),options:[{value:"Em Andamento",label:"Em Andamento"},{value:"Aguardando PVT",label:"Aguardando PVT"},{value:"Em Totalização",label:"Em Totalização"},{value:"Concluída",label:"Concluída"}]}),jsxRuntimeExports.jsx(Input,{label:"Operador",value:a.operador,onChange:o=>s("operador",o.target.value)}),jsxRuntimeExports.jsx(Select,{label:"Resultado",value:a.resultado,onChange:o=>s("resultado",o.target.value),options:[{value:"",label:"Pendente"},{value:"Aprovado",label:"Aprovado"},{value:"Reprovado",label:"Reprovado"}]}),jsxRuntimeExports.jsx(Input,{label:"Ordem de Serviço (S.O.)",value:a.serviceOrder,onChange:o=>s("serviceOrder",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Responsável Calibração",value:a.responsavelCalibracao,onChange:o=>s("responsavelCalibracao",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Preenchido por",value:a.preenchidoPor,onChange:o=>s("preenchidoPor",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Data de Emissão",type:"date",value:a.dataEmissao,onChange:o=>s("dataEmissao",o.target.value)})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Database,title:"Dados da Instalação",color:"purple"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"Unidade / FPSO",value:a.unidade,onChange:o=>s("unidade",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Bacia / Campo",value:a.baciaCampo,onChange:o=>s("baciaCampo",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Localização na Planta",value:a.localizacao,onChange:o=>s("localizacao",o.target.value),className:"col-span-2"}),jsxRuntimeExports.jsx(Input,{label:"Referência Metrológica (Autorizada)",value:a.referenciaMet,onChange:o=>s("referenciaMet",o.target.value),className:"col-span-2"})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Gauge,title:"Identificação do Instrumento (MPFM)",color:"amber"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"TAG do MPFM",value:a.tagMPFM,readOnly:!0}),jsxRuntimeExports.jsx(Input,{label:"Número de Série (S/N)",value:a.serialNumber,onChange:o=>s("serialNumber",o.target.value),placeholder:"Ex: 14-100269"}),jsxRuntimeExports.jsx(Input,{label:"Fabricante",value:a.fabricante,onChange:o=>s("fabricante",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Modelo",value:a.modelo,onChange:o=>s("modelo",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Tamanho",value:a.tamanho,onChange:o=>s("tamanho",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Razão Beta",value:a.razaoBeta,onChange:o=>s("razaoBeta",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Modo de Medição Ativo",value:a.modoMedicao,onChange:o=>s("modoMedicao",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Sistema",value:a.sistema,readOnly:!0})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Settings,title:"Configuração de Software e Integridade",color:"emerald"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"Versão de Software (Medidor)",value:a.versaoSoftwareMedidor,onChange:o=>s("versaoSoftwareMedidor",o.target.value),placeholder:"Ex: FW-MPM-BAC-v1.12.3"}),jsxRuntimeExports.jsx(Input,{label:"Versão do Computador de Vazão FPM207",value:a.versaoFPM207,onChange:o=>s("versaoFPM207",o.target.value),placeholder:"Ex: v2.8.5"}),jsxRuntimeExports.jsx(Input,{label:"Versão do Software FCS320",value:a.versaoFCS320,onChange:o=>s("versaoFCS320",o.target.value),placeholder:"Ex: v8.4.1 Build 710"}),jsxRuntimeExports.jsx(Input,{label:"Software de Simulação (Calsep PVTsim)",value:a.versaoPVTsim,onChange:o=>s("versaoPVTsim",o.target.value),placeholder:"Ex: v23.1.0"})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Calendar,title:"Escopo e Período do Teste de Calibração",color:"red"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"Natureza da Atividade",value:a.naturezaAtividade,className:"col-span-2",readOnly:!0}),jsxRuntimeExports.jsx(Input,{label:"ID do Evento de Desvio (se aplicável)",value:a.idEventoDesvio,onChange:o=>s("idEventoDesvio",o.target.value)}),jsxRuntimeExports.jsx("div",{}),jsxRuntimeExports.jsx(Input,{label:"Início da Estabilização",type:"datetime-local",value:a.inicioEstabilizacao,onChange:o=>s("inicioEstabilizacao",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Início da Totalização (24h)",type:"datetime-local",value:a.inicioTotalizacao,onChange:o=>s("inicioTotalizacao",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Fim da Totalização",type:"datetime-local",value:a.fimTotalizacao,onChange:o=>s("fimTotalizacao",o.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Duração Total Efetiva (h)",value:String(a.duracaoEfetiva),unit:"h",readOnly:!0}),jsxRuntimeExports.jsx(Input,{label:"Observações Iniciais",className:"col-span-2",value:a.observacoesIniciais,onChange:o=>s("observacoesIniciais",o.target.value),placeholder:"Observações..."})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:FileText,title:"Comentários Gerais"}),jsxRuntimeExports.jsx("textarea",{className:"w-full h-24 px-3 py-2 bg-zinc-800 border border-zinc-700 rounded-lg text-sm text-white placeholder-zinc-500 focus:outline-none focus:border-blue-500",placeholder:"Observações adicionais sobre o evento de calibração...",value:a.comentariosGerais,onChange:o=>s("comentariosGerais",o.target.value)})]})]})}const defaultComposition=[{component:"N₂",molecularWeight:28.01,molPercent:0,normalizedMolPercent:0},{component:"CO₂",molecularWeight:44.01,molPercent:0,normalizedMolPercent:0},{component:"H₂S",molecularWeight:34.08,molPercent:0,normalizedMolPercent:0},{component:"C₁",molecularWeight:16.04,molPercent:0,normalizedMolPercent:0},{component:"C₂",molecularWeight:30.07,molPercent:0,normalizedMolPercent:0},{component:"C₃",molecularWeight:44.1,molPercent:0,normalizedMolPercent:0},{component:"i-C₄",molecularWeight:58.12,molPercent:0,normalizedMolPercent:0},{component:"n-C₄",molecularWeight:58.12,molPercent:0,normalizedMolPercent:0},{component:"i-C₅",molecularWeight:72.15,molPercent:0,normalizedMolPercent:0},{component:"n-C₅",molecularWeight:72.15,molPercent:0,normalizedMolPercent:0},{component:"C₆",molecularWeight:86.18,molPercent:0,normalizedMolPercent:0},{component:"C₇+",molecularWeight:97.37,molPercent:0,normalizedMolPercent:0}];function Step02PVT(){const{calibrationFormData:n,updateCalibrationFormData:t}=useAppStore(),[i,e]=reactExports.useState((n==null?void 0:n.composicao)||defaultComposition),s=n||{pvtReportId:"",dataAmostragem:"",pontoAmostragem:"Separador",softwareModelagem:"PVTsim",versaoModelo:"",statusAprovacao:"Pendente",dataAprovacao:"",comentariosPVT:"",densidadeOleo:0,densidadeGas:0,densidadeAgua:0,gor:0,bsw:0,fatorEncolhimento:0,penelouxGas:1,penelouxOil:1,pvtLoadedFCS320:!1,pvtLoadedFPM207:!1,gammaRestarted:!1,pressureVerified:!1,temperatureVerified:!1},a=(v,x)=>{t({[v]:x})},o=(v,x)=>{const p=[...i];p[v]={...p[v],molPercent:x},e(p)},D=()=>{t({pvtReportId:`Calibration #${realCalibrationPVT.calibrationNo}`,dataAmostragem:realCalibrationPVT.startDate,pontoAmostragem:"Separador de Teste",softwareModelagem:"PVTsim",versaoModelo:"v23.1.0",statusAprovacao:"Aprovado",dataAprovacao:realCalibrationPVT.endDate,comentariosPVT:`Dados reais do FPSO Bacalhau - ${realCalibrationPVT.meterName}`,densidadeOleo:realCalibrationPVT.densities.oil.mpfm,densidadeGas:realCalibrationPVT.densities.gas.mpfm,densidadeAgua:realCalibrationPVT.densities.water.mpfm,gor:350,bsw:.02,fatorEncolhimento:.85,penelouxGas:realCalibrationPVT.peneloux.gas,penelouxOil:realCalibrationPVT.peneloux.oil,pvtLoadedFCS320:!0,pvtLoadedFPM207:!0,gammaRestarted:!0,pressureVerified:!0,temperatureVerified:!0});const v=realCalibrationPVT.composition.map(x=>({component:x.component,molecularWeight:x.molecularWeight,molPercent:x.molPercent,normalizedMolPercent:x.molPercent}));e(v),t({composicao:v})};reactExports.useEffect(()=>{const v=setTimeout(()=>{t({composicao:i})},500);return()=>clearTimeout(v)},[i,t]);const S=i.reduce((v,x)=>v+x.molPercent,0),E=S>0?i.reduce((v,x)=>v+x.molPercent*x.molecularWeight,0)/S:0,c=[{key:"pvtLoadedFCS320",label:"PVT carregada no FCS320"},{key:"pvtLoadedFPM207",label:"PVT carregada no FPM207"},{key:"gammaRestarted",label:"Gamma reiniciado"},{key:"pressureVerified",label:"Pressão verificada"},{key:"temperatureVerified",label:"Temperatura verificada"}];return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:FlaskConical,title:"Identificação do Relatório PVT / Amostragem",color:"purple"}),jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",onClick:D,className:"flex items-center gap-2 text-purple-400 border-purple-500/30 hover:bg-purple-500/10",children:[jsxRuntimeExports.jsx(Sparkles,{size:14}),"Carregar Dados Reais (Cal. #211)"]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"ID do Relatório Laboratorial",value:s.pvtReportId,onChange:v=>a("pvtReportId",v.target.value),className:"col-span-2",placeholder:"Ex: SLB - P.1077663_2025BRRD-P004039"}),jsxRuntimeExports.jsx(Input,{label:"Data da Amostragem",type:"date",value:s.dataAmostragem,onChange:v=>a("dataAmostragem",v.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Ponto de Amostragem",value:s.pontoAmostragem,onChange:v=>a("pontoAmostragem",v.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Software de Modelagem",value:s.softwareModelagem,onChange:v=>a("softwareModelagem",v.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Versão/Arquivo do Modelo",value:s.versaoModelo,onChange:v=>a("versaoModelo",v.target.value),placeholder:"Ex: v23.1.0"}),jsxRuntimeExports.jsx(Select,{label:"Status de Aprovação (PVT GROUP)",value:s.statusAprovacao,onChange:v=>a("statusAprovacao",v.target.value),options:[{value:"Pendente",label:"Pendente"},{value:"Em Análise",label:"Em Análise"},{value:"Aprovado",label:"Aprovado"},{value:"Reprovado",label:"Reprovado"}]}),jsxRuntimeExports.jsx(Input,{label:"Data de Aprovação",type:"date",value:s.dataAprovacao,onChange:v=>a("dataAprovacao",v.target.value)})]}),jsxRuntimeExports.jsx("div",{className:"mt-3",children:jsxRuntimeExports.jsx(Input,{label:"Comentários",value:s.comentariosPVT,onChange:v=>a("comentariosPVT",v.target.value),placeholder:"Observações sobre o relatório PVT..."})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Beaker,title:"Propriedades de Referência (@std)",color:"blue"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"Densidade Óleo",type:"number",value:s.densidadeOleo||"",onChange:v=>a("densidadeOleo",parseFloat(v.target.value)||0),unit:"kg/m³",placeholder:"773.41"}),jsxRuntimeExports.jsx(Input,{label:"Densidade Gás",type:"number",value:s.densidadeGas||"",onChange:v=>a("densidadeGas",parseFloat(v.target.value)||0),unit:"kg/m³",placeholder:"0.87"}),jsxRuntimeExports.jsx(Input,{label:"Densidade Água",type:"number",value:s.densidadeAgua||"",onChange:v=>a("densidadeAgua",parseFloat(v.target.value)||0),unit:"kg/m³",placeholder:"1.25"}),jsxRuntimeExports.jsx(Input,{label:"GOR",type:"number",value:s.gor||"",onChange:v=>a("gor",parseFloat(v.target.value)||0),unit:"Sm³/Sm³",placeholder:"216.81"}),jsxRuntimeExports.jsx(Input,{label:"BSW",type:"number",value:s.bsw||"",onChange:v=>a("bsw",parseFloat(v.target.value)||0),unit:"%",placeholder:"5.5"})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Database,title:"Composição molar (mol%)",color:"amber"}),jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Componente"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"Massa Molar"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"mol% (entrada)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"mol% (normalizado)"})]})}),jsxRuntimeExports.jsx("tbody",{children:i.map((v,x)=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50",children:[jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-zinc-200",children:v.component}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-right text-zinc-400",children:v.molecularWeight.toFixed(2)}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-right",children:jsxRuntimeExports.jsx("input",{type:"number",step:"0.001",value:v.molPercent||"",onChange:p=>o(x,parseFloat(p.target.value)||0),className:"w-20 px-2 py-1 bg-zinc-800 border border-zinc-700 rounded text-xs text-blue-400 text-right",placeholder:"0.000",title:`mol% de ${v.component}`})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-right text-emerald-400",children:S>0?(v.molPercent/S*100).toFixed(3):"0.000"})]},v.component))}),jsxRuntimeExports.jsxs("tfoot",{className:"bg-zinc-800/50",children:[jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-zinc-200 font-medium",children:"Soma mol%"}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2"}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-right text-blue-400 font-medium",children:S.toFixed(3)}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-right text-emerald-400 font-medium",children:"100.000"})]}),jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-zinc-200 font-medium",children:"MW mistura"}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2"}),jsxRuntimeExports.jsxs("td",{className:"py-2 px-2 text-right text-amber-400 font-medium",colSpan:2,children:[E.toFixed(2)," kg/kmol"]})]})]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Layers,title:"Fatores Peneloux",color:"emerald"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[jsxRuntimeExports.jsx(Input,{label:"Peneloux Gas",type:"number",step:"0.001",value:s.penelouxGas||"",onChange:v=>a("penelouxGas",parseFloat(v.target.value)||1),inputSize:"sm"}),jsxRuntimeExports.jsx(Input,{label:"Peneloux Oil",type:"number",step:"0.001",value:s.penelouxOil||"",onChange:v=>a("penelouxOil",parseFloat(v.target.value)||1),inputSize:"sm"})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:CheckCircle,title:"Controle de Aplicação PVT",color:"emerald"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mb-3",children:"Clique para alternar"}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:c.map(v=>{const x=s[v.key];return jsxRuntimeExports.jsxs("button",{type:"button",onClick:()=>a(v.key,!x),className:"w-full flex items-center justify-between p-2 bg-zinc-800/50 rounded hover:bg-zinc-700/50 transition-colors",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-zinc-300",children:v.label}),jsxRuntimeExports.jsx(Badge,{variant:x?"OK":"Pendente",size:"sm",children:x?"OK":"Pendente"})]},v.key)})})]})]})]})}const generateRowId=()=>`tot-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;function Step03Totalizadores(){const{calibrationFormData:n,updateCalibrationFormData:t}=useAppStore(),[i,e]=reactExports.useState((n==null?void 0:n.totalizadores)||[]),s=(A,f)=>{if(!A||!f)return 0;const u=new Date(A),C=new Date(f);return Math.max(0,(C.getTime()-u.getTime())/(1e3*60*60))},a=(A,f)=>A+f,o=reactExports.useCallback(()=>{const A={id:generateRowId(),startTime:"",endTime:"",deltaHours:0,mpfmOil:0,mpfmGas:0,mpfmWater:0,mpfmHC:0,mpfmTotal:0,refOilVolume:0,refOilDensity:0,refOilMassCalc:0,refOilMassPI:0,refGas:0,refWater:0,refHC:0,status:"Pendente"},f=[...i,A];e(f),t({totalizadores:f})},[i,t]),D=reactExports.useCallback(A=>{const f=i.filter(u=>u.id!==A);e(f),t({totalizadores:f})},[i,t]),S=reactExports.useCallback((A,f,u)=>{const C=i.map(F=>{if(F.id!==A)return F;const w={...F,[f]:u};if((f==="startTime"||f==="endTime")&&(w.deltaHours=s(f==="startTime"?String(u):F.startTime,f==="endTime"?String(u):F.endTime)),f==="mpfmOil"||f==="mpfmGas"){const h=f==="mpfmOil"?Number(u):F.mpfmOil,R=f==="mpfmGas"?Number(u):F.mpfmGas;w.mpfmHC=a(h,R)}if(f==="refOilMassCalc"||f==="refGas"){const h=f==="refOilMassCalc"?Number(u):F.refOilMassCalc,R=f==="refGas"?Number(u):F.refGas;w.refHC=a(h,R)}return w.deltaHours>=24&&w.mpfmOil>0&&w.refOilMassCalc>0?w.status="OK":w.startTime&&w.endTime&&(w.status="Parcial"),w});e(C),t({totalizadores:C})},[i,t]),E=i.reduce((A,f)=>A+f.mpfmOil,0),c=i.reduce((A,f)=>A+f.mpfmGas,0),v=i.reduce((A,f)=>A+f.mpfmHC,0),x=i.reduce((A,f)=>A+f.refOilMassCalc,0),p=i.reduce((A,f)=>A+f.refGas,0),_=i.reduce((A,f)=>A+f.deltaHours,0);return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-blue-300",children:[jsxRuntimeExports.jsx(Info,{className:"w-3 h-3 inline mr-1"}),"Adicione períodos de totalização. As deltas e totais são calculados automaticamente. O período total deve ser de no mínimo 24 horas."]})}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Database,title:"Totalizadores / Horário (mínimo 24h)",color:"blue"}),jsxRuntimeExports.jsx(Button,{variant:"primary",size:"sm",icon:Plus,onClick:o,children:"Adicionar Período"})]}),i.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-8 text-zinc-500",children:[jsxRuntimeExports.jsx(Database,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),jsxRuntimeExports.jsx("p",{children:"Nenhum período de totalização adicionado."}),jsxRuntimeExports.jsx("p",{className:"text-xs mt-1",children:'Clique em "Adicionar Período" para começar.'})]}):jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-left text-zinc-400",children:"Início"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-left text-zinc-400",children:"Fim"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-center text-zinc-400",children:"Δt (h)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-right text-blue-400",children:"MPFM Óleo (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-right text-blue-400",children:"MPFM Gás (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-right text-blue-400",children:"HC (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-right text-emerald-400",children:"REF Óleo (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-right text-emerald-400",children:"REF Gás (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 text-center text-zinc-400",children:"Status"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-1 w-8"})]})}),jsxRuntimeExports.jsx("tbody",{children:i.map(A=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50",children:[jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"datetime-local",value:A.startTime,onChange:f=>S(A.id,"startTime",f.target.value),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",title:"Início do período"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"datetime-local",value:A.endTime,onChange:f=>S(A.id,"endTime",f.target.value),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",title:"Fim do período"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1 text-center text-zinc-400",children:A.deltaHours.toFixed(2)}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"number",value:A.mpfmOil||"",onChange:f=>S(A.id,"mpfmOil",parseFloat(f.target.value)||0),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-blue-400 text-right",placeholder:"0",title:"MPFM Óleo"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"number",value:A.mpfmGas||"",onChange:f=>S(A.id,"mpfmGas",parseFloat(f.target.value)||0),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-blue-400 text-right",placeholder:"0",title:"MPFM Gás"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1 text-right text-blue-400 font-medium",children:formatNumber(A.mpfmHC)}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"number",value:A.refOilMassCalc||"",onChange:f=>S(A.id,"refOilMassCalc",parseFloat(f.target.value)||0),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-emerald-400 text-right",placeholder:"0",title:"Referência Óleo"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("input",{type:"number",value:A.refGas||"",onChange:f=>S(A.id,"refGas",parseFloat(f.target.value)||0),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-emerald-400 text-right",placeholder:"0",title:"Referência Gás"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:A.status,size:"sm",children:A.status})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-1",children:jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>D(A.id),className:"p-1 text-red-400 hover:text-red-300 transition-colors",title:"Remover período",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3 h-3"})})})]},A.id))})]})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Calculator,title:"Total - Somatório",color:"amber"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-6 gap-3",children:[jsxRuntimeExports.jsxs("div",{className:`p-3 rounded-lg ${_>=24?"bg-emerald-500/10 border border-emerald-500/20":"bg-zinc-800/50"}`,children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Duração Total"}),jsxRuntimeExports.jsxs("p",{className:`text-lg font-bold ${_>=24?"text-emerald-400":"text-white"}`,children:[_.toFixed(1),"h"]}),_<24&&jsxRuntimeExports.jsx("p",{className:"text-xs text-amber-400",children:"Mínimo 24h"})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/20",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"MPFM Óleo"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-blue-400",children:formatNumber(E)})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/20",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"MPFM Gás"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-blue-400",children:formatNumber(c)})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/20",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"MPFM HC"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-blue-400",children:formatNumber(v)})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-emerald-500/10 rounded-lg border border-emerald-500/20",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"REF Óleo"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-emerald-400",children:formatNumber(x)})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-emerald-500/10 rounded-lg border border-emerald-500/20",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"REF Gás"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-emerald-400",children:formatNumber(p)})]})]})]})]})}function Step04KFactors(){var c,v;const{calibrationFormData:n,updateCalibrationFormData:t}=useAppStore(),i=n||{kMin:ANP_LIMITS.K_FACTOR_MIN,kMax:ANP_LIMITS.K_FACTOR_MAX,limiteHC:ANP_LIMITS.HC_BALANCE_ERROR,limiteTotal:ANP_LIMITS.TOTAL_BALANCE_ERROR,massas:{oleo:{mpfm:0,ref:0},gas:{mpfm:0,ref:0},agua:{mpfm:0,ref:0}},totalizadores:[]},e=reactExports.useMemo(()=>{const x=i.totalizadores||[];return{mpfmOil:x.reduce((p,_)=>p+_.mpfmOil,0),mpfmGas:x.reduce((p,_)=>p+_.mpfmGas,0),refOil:x.reduce((p,_)=>p+_.refOilMassCalc,0),refGas:x.reduce((p,_)=>p+_.refGas,0)}},[i.totalizadores]),s=(x,p,_)=>x>=p&&x<=_,a=reactExports.useMemo(()=>{var A,f;const x=calculateKFactor(e.refOil,e.mpfmOil),p=calculateKFactor(e.refGas,e.mpfmGas),_=((f=(A=i.massas)==null?void 0:A.agua)==null?void 0:f.mpfm)>0?calculateKFactor(i.massas.agua.ref,i.massas.agua.mpfm):1;return{kOil:x,kGas:p,kWater:_,kOilStatus:s(x,i.kMin,i.kMax)?"Dentro":"Fora",kGasStatus:s(p,i.kMin,i.kMax)?"Dentro":"Fora",kWaterStatus:s(_,i.kMin,i.kMax)?"Dentro":"Fora"}},[e,i.kMin,i.kMax,i.massas]),o=reactExports.useMemo(()=>{var A,f,u,C,F,w,h,R;const x=(b,j)=>j===0?0:(b-j)/j*100,p=e.mpfmOil+e.mpfmGas,_=e.refOil+e.refGas;return[{fase:"Óleo",mpfm:e.mpfmOil,ref:e.refOil,desvio:x(e.mpfmOil,e.refOil)},{fase:"Gás",mpfm:e.mpfmGas,ref:e.refGas,desvio:x(e.mpfmGas,e.refGas)},{fase:"Água",mpfm:((f=(A=i.massas)==null?void 0:A.agua)==null?void 0:f.mpfm)||0,ref:((C=(u=i.massas)==null?void 0:u.agua)==null?void 0:C.ref)||0,desvio:x(((w=(F=i.massas)==null?void 0:F.agua)==null?void 0:w.mpfm)||0,((R=(h=i.massas)==null?void 0:h.agua)==null?void 0:R.ref)||0)},{fase:"HC (Total)",mpfm:p,ref:_,desvio:x(p,_),isTotal:!0}]},[e,i.massas]);reactExports.useEffect(()=>{var x;t({kFactors:a,massas:{oleo:{mpfm:e.mpfmOil,ref:e.refOil},gas:{mpfm:e.mpfmGas,ref:e.refGas},agua:((x=i.massas)==null?void 0:x.agua)||{mpfm:0,ref:0}}})},[a,e,t,(c=i.massas)==null?void 0:c.agua]);const D=(x,p)=>{t({[x]:p})},S=a.kOilStatus==="Dentro"&&a.kGasStatus==="Dentro",E=((v=o.find(x=>x.fase==="HC (Total)"))==null?void 0:v.desvio)||0;return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[e.mpfmOil>0&&e.refOil>0&&jsxRuntimeExports.jsx("div",{className:cn("p-4 rounded-lg flex items-center gap-3",S&&Math.abs(E)<=i.limiteHC?"bg-emerald-500/10 border border-emerald-500/20":"bg-red-500/10 border border-red-500/20"),children:S&&Math.abs(E)<=i.limiteHC?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CheckCircle,{className:"w-5 h-5 text-emerald-400"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-emerald-400",children:"K-Factors dentro do limite"}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-zinc-400",children:["Todos os fatores estão entre ",i.kMin," e ",i.kMax]})]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-5 h-5 text-red-400"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-red-400",children:"K-Factors fora do limite"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-400",children:"Um ou mais fatores estão fora do intervalo permitido"})]})]})}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Settings,title:"Parâmetros de Aceitação (ANP 44/2015)",color:"amber"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Input,{label:"K mínimo",type:"number",step:"0.01",value:i.kMin,onChange:x=>D("kMin",parseFloat(x.target.value)||.8)}),jsxRuntimeExports.jsx(Input,{label:"K máximo",type:"number",step:"0.01",value:i.kMax,onChange:x=>D("kMax",parseFloat(x.target.value)||1.2)}),jsxRuntimeExports.jsx(Input,{label:"Limite desvio HC (±)",type:"number",step:"0.1",value:i.limiteHC,onChange:x=>D("limiteHC",parseFloat(x.target.value)||10),unit:"%"}),jsxRuntimeExports.jsx(Input,{label:"Limite desvio Total (±)",type:"number",step:"0.1",value:i.limiteTotal,onChange:x=>D("limiteTotal",parseFloat(x.target.value)||7),unit:"%"})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Database,title:"Massas Totalizadas (24h)",color:"blue"}),e.mpfmOil===0&&e.refOil===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-6 text-zinc-500",children:[jsxRuntimeExports.jsx(Database,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"Nenhum dado de totalização"}),jsxRuntimeExports.jsx("p",{className:"text-xs",children:"Preencha os totalizadores no passo anterior"})]}):jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Fase"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-blue-400",children:"MPFM (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-emerald-400",children:"Ref (kg)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"Desvio"})]})}),jsxRuntimeExports.jsx("tbody",{children:o.map(x=>jsxRuntimeExports.jsxs("tr",{className:cn("border-b border-zinc-800/50",x.isTotal&&"bg-zinc-800/30 font-medium"),children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-zinc-200",children:x.fase}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-right text-blue-400",children:x.mpfm.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-2 text-right text-emerald-400",children:x.ref.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsxs("td",{className:cn("py-2 px-2 text-right",x.isTotal?Math.abs(x.desvio)>i.limiteHC?"text-red-400":"text-emerald-400":Math.abs(x.desvio)>20?"text-red-400":"text-zinc-300"),children:[x.desvio.toFixed(1),"%"]})]},x.fase))})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Calculator,title:"K-Factors Calculados",color:"purple"}),e.mpfmOil===0&&e.refOil===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-6 text-zinc-500",children:[jsxRuntimeExports.jsx(Calculator,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"K-Factors serão calculados"}),jsxRuntimeExports.jsx("p",{className:"text-xs",children:"após preenchimento dos totalizadores"})]}):jsxRuntimeExports.jsx("div",{className:"space-y-3",children:[{fase:"K-Oil (Óleo)",k:a.kOil,status:a.kOilStatus},{fase:"K-Gas (Gás)",k:a.kGas,status:a.kGasStatus},{fase:"K-Water (Água)",k:a.kWater,status:a.kWaterStatus}].map(x=>jsxRuntimeExports.jsxs("div",{className:cn("p-3 rounded-lg flex items-center justify-between",x.status==="Fora"?"bg-red-500/10 border border-red-500/20":"bg-emerald-500/10 border border-emerald-500/20"),children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-zinc-400",children:x.fase}),jsxRuntimeExports.jsx("p",{className:cn("text-xl font-bold font-mono",x.status==="Fora"?"text-red-400":"text-emerald-400"),children:x.k.toFixed(4)})]}),jsxRuntimeExports.jsx(Badge,{variant:x.status==="Dentro"?"OK":"Fora",children:x.status==="Dentro"?`${i.kMin} - ${i.kMax}`:"Fora"})]},x.fase))}),jsxRuntimeExports.jsxs("div",{className:"mt-4 p-3 bg-zinc-800/50 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mb-2",children:"Fórmula ANP 44/2015:"}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-zinc-400 font-mono",children:["K = Massa",jsxRuntimeExports.jsx("sub",{children:"REF"})," / Massa",jsxRuntimeExports.jsx("sub",{children:"MPFM"})]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-zinc-500 mt-2",children:["Intervalo válido: ",i.kMin," ≤ K ≤ ",i.kMax]})]})]})]})]})}const defaultEnvelope=[{id:"gvf",item:"GVF (%)",value:0,limit:95,status:"Pendente"},{id:"pressure",item:"Pressão (bar)",value:0,limit:500,status:"Pendente"},{id:"temperature",item:"Temperatura (°C)",value:0,limit:150,status:"Pendente"},{id:"flow",item:"Vazão (m³/h)",value:0,limit:1e3,status:"Pendente"},{id:"bsw",item:"BSW (%)",value:0,limit:50,status:"Pendente"}];function Step05Balanco(){const{calibrationFormData:n,updateCalibrationFormData:t}=useAppStore(),i=n||{balancoTopOil:0,balancoTopGas:0,balancoGasLift:0,balancoDesvio:0},[e,s]=reactExports.useState(defaultEnvelope),a=reactExports.useMemo(()=>{const E=i.totalizadores||[],c=E.reduce((A,f)=>A+(f.mpfmOil||0),0),v=E.reduce((A,f)=>A+(f.mpfmGas||0),0),x=c+v,p=i.balancoTopOil+i.balancoTopGas-i.balancoGasLift,_=x>0?(p-x)/x*100:0;return{subseaTotal:x,topsideTotal:p,desvio:_,status:Math.abs(_)<=10?"Dentro":"Fora"}},[i]),o=(E,c)=>{t({[E]:c,balancoDesvio:a.desvio})},D=(E,c,v)=>{s(x=>x.map(p=>{if(p.id!==E)return p;const _={...p,[c]:v};return _.value>0&&_.limit>0&&(_.status=_.value<=_.limit?"OK":"Fora"),_}))},S=e.every(E=>E.status==="OK"||E.status==="Pendente");return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Target,title:"Balanço HC Subsea vs Topside (com desconto de Gás Lift)",color:"blue"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[jsxRuntimeExports.jsx(Input,{label:"MPFM Topside – Óleo (kg)",type:"number",value:i.balancoTopOil||"",onChange:E=>o("balancoTopOil",parseFloat(E.target.value)||0),placeholder:"0"}),jsxRuntimeExports.jsx(Input,{label:"MPFM Topside – Gás (kg)",type:"number",value:i.balancoTopGas||"",onChange:E=>o("balancoTopGas",parseFloat(E.target.value)||0),placeholder:"0"}),jsxRuntimeExports.jsx(Input,{label:"Gás Lift – Gás (kg)",type:"number",value:i.balancoGasLift||"",onChange:E=>o("balancoGasLift",parseFloat(E.target.value)||0),placeholder:"0"}),jsxRuntimeExports.jsx(Input,{label:"Desvio (%)",value:a.desvio.toFixed(2),readOnly:!0,className:cn(Math.abs(a.desvio)>10&&"text-red-400")})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"p-3 bg-blue-500/10 rounded-lg border border-blue-500/20 text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"MPFM Subsea (Total)"}),jsxRuntimeExports.jsxs("p",{className:"text-lg font-bold text-blue-400",children:[a.subseaTotal.toLocaleString("pt-BR",{maximumFractionDigits:0})," kg"]})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-emerald-500/10 rounded-lg border border-emerald-500/20 text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Topside (Corrigido)"}),jsxRuntimeExports.jsxs("p",{className:"text-lg font-bold text-emerald-400",children:[a.topsideTotal.toLocaleString("pt-BR",{maximumFractionDigits:0})," kg"]})]}),jsxRuntimeExports.jsxs("div",{className:cn("p-3 rounded-lg text-center",a.status==="Dentro"?"bg-emerald-500/10 border border-emerald-500/20":"bg-red-500/10 border border-red-500/20"),children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Desvio"}),jsxRuntimeExports.jsxs("p",{className:cn("text-lg font-bold",a.status==="Dentro"?"text-emerald-400":"text-red-400"),children:[a.desvio.toFixed(1),"%"]})]})]}),jsxRuntimeExports.jsx("div",{className:cn("p-3 rounded-lg flex items-center gap-2",a.status==="Dentro"?"bg-emerald-500/10 border border-emerald-500/20":"bg-red-500/10 border border-red-500/20"),children:a.status==="Dentro"?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CheckCircle,{className:"w-4 h-4 text-emerald-400"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-emerald-300",children:"Status (±10%): Dentro do limite"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-4 h-4 text-red-400"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-red-300",children:"Status (±10%): Fora do limite - verificar dados"})]})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:CheckCircle,title:"Checagens de Envelope / Integridade",color:"emerald"}),jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-left text-zinc-400",children:"Item"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-zinc-400",children:"Valor Medido"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-right text-zinc-400",children:"Limite Máx."}),jsxRuntimeExports.jsx("th",{className:"py-2 px-3 text-center text-zinc-400",children:"Status"})]})}),jsxRuntimeExports.jsx("tbody",{children:e.map(E=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50",children:[jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-zinc-200",children:E.item}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3",children:jsxRuntimeExports.jsx("input",{type:"number",value:E.value||"",onChange:c=>D(E.id,"value",parseFloat(c.target.value)||0),className:"w-full px-2 py-1 bg-zinc-800 border border-zinc-700 rounded text-xs text-white text-right",placeholder:"0",title:`Valor de ${E.item}`})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3",children:jsxRuntimeExports.jsx("input",{type:"number",value:E.limit||"",onChange:c=>D(E.id,"limit",parseFloat(c.target.value)||0),className:"w-full px-2 py-1 bg-zinc-800 border border-zinc-700 rounded text-xs text-white text-right",placeholder:"0",title:`Limite de ${E.item}`})}),jsxRuntimeExports.jsx("td",{className:"py-2 px-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:E.status,size:"sm",children:E.status})})]},E.id))})]})}),!S&&jsxRuntimeExports.jsx("div",{className:"mt-3 p-3 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-amber-300",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-3 h-3 inline mr-1"}),"Alguns itens estão fora do envelope operacional. Verifique os valores."]})})]})]})}const generateId$1=()=>`mon-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,migrateRows=n=>!n||!Array.isArray(n)?[]:n.map(t=>({id:t.id||generateId$1(),data:t.data||"",duracao:t.duracao||0,mpfmOil:t.mpfmOil||0,mpfmGas:t.mpfmGas||0,mpfmTotal:t.mpfmTotal||0,refTotal:t.refTotal||0,desvio:t.desvio||0,alarmes:t.alarmes||""}));function Step06Monitoramento(){const{calibrationFormData:n,updateCalibrationFormData:t}=useAppStore(),[i,e]=reactExports.useState(()=>migrateRows((n==null?void 0:n.monitoramentoPosData)||[])),s=reactExports.useCallback(()=>{const S={id:generateId$1(),data:new Date().toISOString().split("T")[0],duracao:24,mpfmOil:0,mpfmGas:0,mpfmTotal:0,refTotal:0,desvio:0,alarmes:""},E=[...i,S];e(E),t({monitoramentoPosData:E})},[i,t]),a=reactExports.useCallback(S=>{const E=i.filter(c=>c.id!==S);e(E),t({monitoramentoPosData:E})},[i,t]),o=reactExports.useCallback((S,E,c)=>{const v=i.map(x=>{if(x.id!==S)return x;const p={...x,[E]:c};if(E==="mpfmOil"||E==="mpfmGas"){const _=E==="mpfmOil"?Number(c):x.mpfmOil,A=E==="mpfmGas"?Number(c):x.mpfmGas;p.mpfmTotal=_+A,p.refTotal>0&&(p.desvio=(p.mpfmTotal-p.refTotal)/p.refTotal*100)}return E==="refTotal"&&p.mpfmTotal>0&&(p.desvio=(p.mpfmTotal-Number(c))/Number(c)*100),p});e(v),t({monitoramentoPosData:v})},[i,t]),D=S=>{const E=Math.abs(S);return E<=7?"OK":E<=10?"Alerta":"Crítico"};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-purple-500/10 border border-purple-500/20 rounded-lg",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-purple-300",children:[jsxRuntimeExports.jsx(Info,{className:"w-3 h-3 inline mr-1"}),"Registre por período as massas totalizadas e o efeito dos novos K-factors. Este monitoramento serve como evidência pós-calibração."]})}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Eye,title:"Monitoramento Pós-Aplicação de Novos Fatores",color:"purple"}),jsxRuntimeExports.jsx(Button,{variant:"primary",size:"sm",icon:Plus,onClick:s,children:"Adicionar Período"})]}),i.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-8 text-zinc-500",children:[jsxRuntimeExports.jsx(Eye,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),jsxRuntimeExports.jsx("p",{children:"Nenhum período de monitoramento registrado."}),jsxRuntimeExports.jsx("p",{className:"text-xs mt-1",children:"Adicione períodos para acompanhar o desempenho pós-calibração."})]}):jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Data"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-center text-zinc-400",children:"Duração (h)"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"MPFM Óleo"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-zinc-400",children:"MPFM Gás"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-blue-400",children:"MPFM Total"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-right text-emerald-400",children:"REF Total"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-center text-zinc-400",children:"Desvio"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Alarmes"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 w-8"})]})}),jsxRuntimeExports.jsx("tbody",{children:i.map(S=>{const E=D(S.desvio);return jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-800/50",children:[jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"date",value:S.data,onChange:c=>o(S.id,"data",c.target.value),className:"px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",title:"Data do período"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"number",value:S.duracao||"",onChange:c=>o(S.id,"duracao",parseFloat(c.target.value)||0),className:"w-14 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white text-center",placeholder:"24",title:"Duração em horas"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"number",value:S.mpfmOil||"",onChange:c=>o(S.id,"mpfmOil",parseFloat(c.target.value)||0),className:"w-20 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white text-right",placeholder:"0",title:"MPFM Óleo"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"number",value:S.mpfmGas||"",onChange:c=>o(S.id,"mpfmGas",parseFloat(c.target.value)||0),className:"w-20 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white text-right",placeholder:"0",title:"MPFM Gás"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-right text-blue-400 font-medium",children:S.mpfmTotal.toLocaleString("pt-BR",{maximumFractionDigits:0})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"number",value:S.refTotal||"",onChange:c=>o(S.id,"refTotal",parseFloat(c.target.value)||0),className:"w-20 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-emerald-400 text-right",placeholder:"0",title:"Referência Total"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-center",children:jsxRuntimeExports.jsxs(Badge,{variant:E==="OK"?"OK":E==="Alerta"?"Alerta":"Crítico",size:"sm",children:[S.desvio.toFixed(1),"%"]})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{value:S.alarmes,onChange:c=>o(S.id,"alarmes",c.target.value),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",placeholder:"Nenhum",title:"Alarmes observados"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>a(S.id),className:"p-1 text-red-400 hover:text-red-300 transition-colors",title:"Remover período",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3 h-3"})})})]},S.id)})})]})}),i.length>0&&jsxRuntimeExports.jsx("div",{className:"mt-4 p-3 bg-zinc-800/50 rounded-lg",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs",children:[jsxRuntimeExports.jsxs("span",{className:"text-zinc-400",children:["Total de períodos: ",i.length]}),jsxRuntimeExports.jsxs("span",{className:cn(i.filter(S=>D(S.desvio)==="OK").length===i.length?"text-emerald-400":"text-amber-400"),children:["Períodos OK: ",i.filter(S=>D(S.desvio)==="OK").length," / ",i.length]})]})})]})]})}const generateId=()=>`alm-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,migrateAlarmRows=n=>!n||!Array.isArray(n)?[]:n.map(t=>({id:t.id||generateId(),dataHora:t.dataHora||"",tag:t.tag||"",codigo:t.codigo||"",descricao:t.descricao||"",gravidade:t.gravidade||"Info",acaoTomada:t.acaoTomada||""}));function Step07Alarmes(){const{calibrationFormData:n,updateCalibrationFormData:t,selectedEvent:i}=useAppStore(),[e,s]=reactExports.useState(()=>migrateAlarmRows((n==null?void 0:n.alarmes)||[])),a=reactExports.useCallback(()=>{const v={id:generateId(),dataHora:new Date().toISOString().slice(0,16),tag:(i==null?void 0:i.meterTag)||"",codigo:"",descricao:"",gravidade:"Info",acaoTomada:""},x=[...e,v];s(x),t({alarmes:x})},[e,t,i]),o=reactExports.useCallback(v=>{const x=e.filter(p=>p.id!==v);s(x),t({alarmes:x})},[e,t]),D=reactExports.useCallback((v,x,p)=>{const _=e.map(A=>A.id===v?{...A,[x]:p}:A);s(_),t({alarmes:_})},[e,t]),S=v=>{switch(v){case"Critical":return"bg-red-500/10 border-red-500/20";case"Warning":return"bg-amber-500/10 border-amber-500/20";default:return"bg-blue-500/10 border-blue-500/20"}},E=e.filter(v=>v.gravidade==="Critical").length,c=e.filter(v=>v.gravidade==="Warning").length;return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-red-300",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-3 h-3 inline mr-1"}),"Use este log para rastreabilidade: alarmes críticos devem estar inativos no início do teste e investigados quando ocorrerem."]})}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[jsxRuntimeExports.jsxs("div",{className:cn("p-3 rounded-lg border text-center",e.length===0?"bg-emerald-500/10 border-emerald-500/20":"bg-zinc-800/50 border-zinc-700"),children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Total de Alarmes"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-white",children:e.length})]}),jsxRuntimeExports.jsxs("div",{className:cn("p-3 rounded-lg border text-center",E>0?"bg-red-500/10 border-red-500/20":"bg-emerald-500/10 border-emerald-500/20"),children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Críticos"}),jsxRuntimeExports.jsx("p",{className:cn("text-2xl font-bold",E>0?"text-red-400":"text-emerald-400"),children:E})]}),jsxRuntimeExports.jsxs("div",{className:cn("p-3 rounded-lg border text-center",c>0?"bg-amber-500/10 border-amber-500/20":"bg-emerald-500/10 border-emerald-500/20"),children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Warnings"}),jsxRuntimeExports.jsx("p",{className:cn("text-2xl font-bold",c>0?"text-amber-400":"text-emerald-400"),children:c})]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:Bell,title:"Registro de Alarmes / Eventos (HMI/MPM/FCS320)",color:"red"}),jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:Plus,onClick:a,children:"Adicionar Alarme"})]}),e.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-8 text-zinc-500",children:[jsxRuntimeExports.jsx(CheckCircle,{className:"w-12 h-12 mx-auto mb-3 text-emerald-500 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-emerald-400",children:"Nenhum alarme registrado durante o período."}),jsxRuntimeExports.jsx("p",{className:"text-xs mt-1",children:"Isso é um bom sinal para a calibração."})]}):jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-xs",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-zinc-700",children:[jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Data/Hora"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"TAG"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Código"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Descrição"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-center text-zinc-400",children:"Gravidade"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 text-left text-zinc-400",children:"Ação Tomada"}),jsxRuntimeExports.jsx("th",{className:"py-2 px-2 w-8"})]})}),jsxRuntimeExports.jsx("tbody",{children:e.map(v=>jsxRuntimeExports.jsxs("tr",{className:cn("border-b border-zinc-800/50",S(v.gravidade)),children:[jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{type:"datetime-local",value:v.dataHora,onChange:x=>D(v.id,"dataHora",x.target.value),className:"px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",title:"Data e hora do alarme"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{value:v.tag,onChange:x=>D(v.id,"tag",x.target.value),className:"w-24 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-blue-400",placeholder:"TAG",title:"TAG do equipamento"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{value:v.codigo,onChange:x=>D(v.id,"codigo",x.target.value),className:"w-20 px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",placeholder:"Código",title:"Código do alarme"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{value:v.descricao,onChange:x=>D(v.id,"descricao",x.target.value),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",placeholder:"Descrição do alarme",title:"Descrição detalhada"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2 text-center",children:jsxRuntimeExports.jsxs("select",{value:v.gravidade,onChange:x=>D(v.id,"gravidade",x.target.value),className:"px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",title:"Gravidade do alarme",children:[jsxRuntimeExports.jsx("option",{value:"Info",children:"Info"}),jsxRuntimeExports.jsx("option",{value:"Warning",children:"Warning"}),jsxRuntimeExports.jsx("option",{value:"Critical",children:"Critical"})]})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("input",{value:v.acaoTomada,onChange:x=>D(v.id,"acaoTomada",x.target.value),className:"w-full px-1 py-0.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white",placeholder:"Ação tomada",title:"Ação tomada para resolver"})}),jsxRuntimeExports.jsx("td",{className:"py-1.5 px-2",children:jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>o(v.id),className:"p-1 text-red-400 hover:text-red-300 transition-colors",title:"Remover alarme",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3 h-3"})})})]},v.id))})]})})]}),E>0&&jsxRuntimeExports.jsxs("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"w-4 h-4 text-red-400"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-red-400",children:"Atenção"})]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-red-300",children:["Há ",E," alarme(s) crítico(s) registrado(s). Certifique-se de que todos foram investigados e as ações corretivas foram tomadas antes de finalizar a calibração."]})]})]})}const STEPS=["Registro","PVT","Totalizadores","K-Fatores","Balanços","Pós-Monit.","Alarmes"];function CalibrationWorkflow({event:n,onBack:t}){const{setSelectedEvent:i,setCalibrationFormData:e,calibrationFormData:s,completeCalibrationStep:a,finalizeCalibration:o}=useAppStore(),[D,S]=reactExports.useState(n.currentStep),[E,c]=reactExports.useState(!1);reactExports.useEffect(()=>{i(n),(!s||s.eventId!==n.id)&&e({eventId:n.id,status:n.status,resultado:n.result||"",operador:"",serviceOrder:"",responsavelCalibracao:n.responsible,preenchidoPor:"",dataEmissao:new Date().toISOString().split("T")[0],unidade:"",baciaCampo:"",localizacao:"",referenciaMet:"",tagMPFM:n.meterTag,serialNumber:"",fabricante:"",modelo:"",tamanho:"",razaoBeta:"",modoMedicao:"",sistema:"",versaoSoftwareMedidor:"",versaoFPM207:"",versaoFCS320:"",versaoPVTsim:"",naturezaAtividade:n.type,idEventoDesvio:"",inicioEstabilizacao:n.startDate,inicioTotalizacao:"",fimTotalizacao:"",duracaoEfetiva:0,observacoesIniciais:"",comentariosGerais:"",pvtReportId:"",dataAmostragem:"",pontoAmostragem:"",softwareModelagem:"PVTsim",versaoModelo:"",statusAprovacao:"Pendente",dataAprovacao:"",comentariosPVT:"",densidadeOleo:0,densidadeGas:0,densidadeAgua:0,gor:0,bsw:0,fatorEncolhimento:0,composicao:[],penelouxGas:1,penelouxOil:1,pvtLoadedFCS320:!1,pvtLoadedFPM207:!1,gammaRestarted:!1,pressureVerified:!1,temperatureVerified:!1,totalizadores:[],kMin:.8,kMax:1.2,limiteHC:10,limiteTotal:7,massas:{oleo:{mpfm:0,ref:0},gas:{mpfm:0,ref:0},agua:{mpfm:0,ref:0}},kFactors:{kOil:1,kGas:1,kWater:1,kOilStatus:"Dentro",kGasStatus:"Dentro",kWaterStatus:"Dentro"},balancoTopOil:0,balancoTopGas:0,balancoGasLift:0,balancoDesvio:0,monitoramentoPosData:[],alarmes:[]})},[n,i,e,s]);const v=async()=>{c(!0),setTimeout(()=>{c(!1),alert("Dados salvos com sucesso!")},500)},x=()=>{a(n.id,D),S(Math.min(7,D+1))},p=()=>{const A=confirm(`Deseja aprovar ou reprovar a calibração?

OK = Aprovado
Cancelar = Reprovado`);o(n.id,A?"Aprovado":"Reprovado"),alert(`Calibração ${A?"aprovada":"reprovada"} com sucesso!`),t()},_=()=>{switch(D){case 1:return jsxRuntimeExports.jsx(Step01Registro,{event:n});case 2:return jsxRuntimeExports.jsx(Step02PVT,{});case 3:return jsxRuntimeExports.jsx(Step03Totalizadores,{});case 4:return jsxRuntimeExports.jsx(Step04KFactors,{});case 5:return jsxRuntimeExports.jsx(Step05Balanco,{});case 6:return jsxRuntimeExports.jsx(Step06Monitoramento,{});case 7:return jsxRuntimeExports.jsx(Step07Alarmes,{});default:return null}};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:t,icon:ChevronLeft,children:"Voltar"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-white",children:n.id}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-zinc-500",children:[n.meterTag," - ",n.meterName," | ",n.type]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Badge,{variant:"info",children:n.status}),jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:Save,onClick:v,disabled:E,children:E?"Salvando...":"Salvar"}),jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"sm",icon:FileText,children:"Relatório"})]})]}),jsxRuntimeExports.jsx(Card,{className:"p-3",children:jsxRuntimeExports.jsx(StepIndicator,{steps:STEPS,currentStep:D,onStepClick:S})}),_(),jsxRuntimeExports.jsxs("div",{className:"flex justify-between pt-4 border-t border-zinc-800",children:[jsxRuntimeExports.jsx(Button,{variant:"secondary",onClick:()=>S(Math.max(1,D-1)),disabled:D===1,icon:ChevronLeft,children:"Anterior"}),jsxRuntimeExports.jsx("div",{className:"flex gap-2",children:D<7?jsxRuntimeExports.jsxs(Button,{onClick:x,children:["Próximo",jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4 ml-1"})]}):jsxRuntimeExports.jsx(Button,{variant:"success",icon:Check,onClick:p,children:"Concluir Avaliação"})})]})]})}function CalibrationPage(){const[n,t]=reactExports.useState(null);return n?jsxRuntimeExports.jsx(CalibrationWorkflow,{event:n,onBack:()=>t(null)}):jsxRuntimeExports.jsx(CalibrationEventsList,{onSelectEvent:t})}const checklistData=[{id:"1",category:"RTMV",description:"Avaliação de desempenho no comissionamento",status:"compliant",dueDate:"2025-12-01",notes:"Concluído - CAL-2025-001"},{id:"2",category:"RTMV",description:"Avaliação periódica (intervalos 6-12 meses)",status:"in-progress",dueDate:"2026-06-01",notes:"Próxima avaliação agendada"},{id:"3",category:"RTMV",description:"Investigação por gatilho ANP (±10% HC ou ±7% total)",status:"pending",notes:"Aplicável quando limite excedido"},{id:"4",category:"RTMV",description:"Arquivo PVT atualizado e aprovado",status:"compliant",dueDate:"2026-01-10",notes:"PVTsim v23.1.0"},{id:"5",category:"RTMV",description:"Software do medidor atualizado",status:"compliant",notes:"FW-MPM-BAC-v1.12.3"},{id:"6",category:"RTMV",description:"Relatório de calibração arquivado",status:"compliant",notes:"3 relatórios gerados"},{id:"7",category:"RTMV",description:"K-factors dentro do range (0.8-1.2)",status:"overdue",notes:"K-Gas fora do limite - investigar"},{id:"8",category:"RTMV",description:"Monitoramento de balanço diário implementado",status:"compliant",notes:"Dashboard operacional"},{id:"9",category:"Manutenção",description:"Verificação de integridade mecânica",status:"pending",dueDate:"2026-03-15"},{id:"10",category:"Manutenção",description:"Calibração de sensores P/T",status:"in-progress",dueDate:"2026-02-01"}],categoryStats=[{name:"RTMV",total:8,compliant:5,pending:1,overdue:1,inProgress:1},{name:"Manutenção",total:2,compliant:0,pending:1,overdue:0,inProgress:1}];function ComplianceDashboard(){const n=checklistData.length,t=checklistData.filter(o=>o.status==="compliant").length,i=checklistData.filter(o=>o.status==="pending").length,e=checklistData.filter(o=>o.status==="overdue").length,s=o=>{switch(o){case"compliant":return jsxRuntimeExports.jsx(Badge,{variant:"success",children:"Conforme"});case"pending":return jsxRuntimeExports.jsx(Badge,{variant:"warning",children:"Pendente"});case"overdue":return jsxRuntimeExports.jsx(Badge,{variant:"error",children:"Atrasado"});case"in-progress":return jsxRuntimeExports.jsx(Badge,{variant:"info",children:"Em Andamento"})}},a=o=>{switch(o){case"compliant":return jsxRuntimeExports.jsx(CheckCircle2,{className:"w-4 h-4 text-emerald-400"});case"pending":return jsxRuntimeExports.jsx(Clock,{className:"w-4 h-4 text-amber-400"});case"overdue":return jsxRuntimeExports.jsx(AlertCircle,{className:"w-4 h-4 text-red-400"});case"in-progress":return jsxRuntimeExports.jsx(Clock,{className:"w-4 h-4 text-blue-400"})}};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[jsxRuntimeExports.jsx(Card,{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-zinc-700 flex items-center justify-center",children:jsxRuntimeExports.jsx(FileCheck,{className:"w-5 h-5 text-zinc-300"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Total Requisitos"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-white",children:n})]})]})}),jsxRuntimeExports.jsx(Card,{className:"p-4 bg-emerald-500/10 border-emerald-500/20",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-500/20 flex items-center justify-center",children:jsxRuntimeExports.jsx(CheckCircle2,{className:"w-5 h-5 text-emerald-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Conformes"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:t})]})]})}),jsxRuntimeExports.jsx(Card,{className:"p-4 bg-amber-500/10 border-amber-500/20",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-500/20 flex items-center justify-center",children:jsxRuntimeExports.jsx(Clock,{className:"w-5 h-5 text-amber-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Pendentes"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-amber-400",children:i})]})]})}),jsxRuntimeExports.jsx(Card,{className:"p-4 bg-red-500/10 border-red-500/20",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-500/20 flex items-center justify-center",children:jsxRuntimeExports.jsx(AlertCircle,{className:"w-5 h-5 text-red-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500",children:"Atrasados"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-red-400",children:e})]})]})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:FileCheck,title:"Conformidade por Categoria",color:"blue"}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:categoryStats.map(o=>jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-zinc-300",children:o.name}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-zinc-500",children:[o.compliant,"/",o.total," conformes"]})]}),jsxRuntimeExports.jsx(ProgressBar,{value:o.compliant/o.total*100,color:o.overdue>0?"red":o.compliant===o.total?"emerald":"amber"})]},o.name))})]}),jsxRuntimeExports.jsxs(Card,{className:"p-4",children:[jsxRuntimeExports.jsx(SectionHeader,{icon:CheckCircle2,title:"Checklist de Requisitos Regulatórios (RTMV)",color:"emerald"}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:checklistData.map(o=>jsxRuntimeExports.jsxs("div",{className:cn("flex items-center justify-between p-3 rounded-lg border transition cursor-pointer hover:bg-zinc-700/50",o.status==="overdue"?"bg-red-500/5 border-red-500/20":o.status==="compliant"?"bg-emerald-500/5 border-emerald-500/10":"bg-zinc-800/50 border-zinc-700"),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[a(o.status),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-zinc-200",children:o.description}),jsxRuntimeExports.jsx(Badge,{variant:"secondary",size:"sm",children:o.category})]}),o.notes&&jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mt-0.5",children:o.notes})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[o.dueDate&&jsxRuntimeExports.jsx("span",{className:"text-xs text-zinc-500",children:o.dueDate}),s(o.status),jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4 text-zinc-600"})]})]},o.id))})]})]})}function CompliancePage(){return jsxRuntimeExports.jsx(ComplianceDashboard,{})}const initialFormData={tag:"",name:"",location:"TOPSIDE",status:"active",serialNumber:"",manufacturer:"Pietro Fiorentini",model:"Flowtwin",lastCalibration:new Date().toISOString().split("T")[0],kOil:1,kGas:1,kWater:1,daysToCalibration:365},NewMeterModal=({isOpen:n,onClose:t,editingMeter:i})=>{const{addMeter:e,updateMeter:s}=useAppStore(),[a,o]=reactExports.useState(i?{tag:i.tag,name:i.name,location:i.location,status:i.status,serialNumber:i.serialNumber,manufacturer:i.manufacturer,model:i.model,lastCalibration:i.lastCalibration,kOil:i.kOil,kGas:i.kGas,kWater:i.kWater,daysToCalibration:i.daysToCalibration}:initialFormData),[D,S]=reactExports.useState({}),E=reactExports.useCallback((p,_)=>{o(A=>({...A,[p]:_})),S(A=>({...A,[p]:void 0}))},[]),c=()=>{const p={};return a.tag.trim()?/^[A-Z0-9_-]+$/i.test(a.tag)||(p.tag="Tag deve conter apenas letras, números, - ou _"):p.tag="Tag é obrigatório",a.name.trim()||(p.name="Nome é obrigatório"),a.serialNumber.trim()||(p.serialNumber="Número de série é obrigatório"),a.manufacturer.trim()||(p.manufacturer="Fabricante é obrigatório"),a.model.trim()||(p.model="Modelo é obrigatório"),(a.kOil<.8||a.kOil>1.2)&&(p.kOil="K-factor deve estar entre 0.8 e 1.2"),(a.kGas<.8||a.kGas>1.2)&&(p.kGas="K-factor deve estar entre 0.8 e 1.2"),(a.kWater<.8||a.kWater>1.2)&&(p.kWater="K-factor deve estar entre 0.8 e 1.2"),S(p),Object.keys(p).length===0},v=p=>{p.preventDefault(),c()&&(i?s(i.id,a):e(a),o(initialFormData),t())},x=()=>{o(initialFormData),S({}),t()};return jsxRuntimeExports.jsx(Modal,{isOpen:n,onClose:x,title:i?"Editar Medidor":"Novo Medidor MPFM",size:"lg",children:jsxRuntimeExports.jsxs("form",{onSubmit:v,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Identificação"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(Input,{label:"Tag do Medidor *",placeholder:"Ex: MPFM-P55-001",value:a.tag,onChange:p=>E("tag",p.target.value.toUpperCase()),error:D.tag}),jsxRuntimeExports.jsx(Input,{label:"Nome *",placeholder:"Nome descritivo",value:a.name,onChange:p=>E("name",p.target.value),error:D.name})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[jsxRuntimeExports.jsx(Select,{label:"Localização *",value:a.location,onChange:p=>E("location",p.target.value),options:[{value:"TOPSIDE",label:"Topside"},{value:"SUBSEA",label:"Subsea"}]}),jsxRuntimeExports.jsx(Select,{label:"Status *",value:a.status,onChange:p=>E("status",p.target.value),options:[{value:"active",label:"Ativo"},{value:"inactive",label:"Inativo"}]})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Informações Técnicas"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[jsxRuntimeExports.jsx(Input,{label:"Número de Série *",placeholder:"SN-XXXXXX",value:a.serialNumber,onChange:p=>E("serialNumber",p.target.value),error:D.serialNumber}),jsxRuntimeExports.jsx(Input,{label:"Fabricante *",placeholder:"Pietro Fiorentini",value:a.manufacturer,onChange:p=>E("manufacturer",p.target.value),error:D.manufacturer}),jsxRuntimeExports.jsx(Input,{label:"Modelo *",placeholder:"Flowtwin",value:a.model,onChange:p=>E("model",p.target.value),error:D.model})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Calibração"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(Input,{label:"Última Calibração",type:"date",value:a.lastCalibration,onChange:p=>E("lastCalibration",p.target.value)}),jsxRuntimeExports.jsx(Input,{label:"Dias até Próxima Calibração",type:"number",value:a.daysToCalibration,onChange:p=>E("daysToCalibration",parseInt(p.target.value)||0)})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"K-Factors (faixa válida: 0.8 - 1.2)"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[jsxRuntimeExports.jsx(Input,{label:"K-Factor Óleo",type:"number",step:"0.001",min:"0.8",max:"1.2",value:a.kOil,onChange:p=>E("kOil",parseFloat(p.target.value)||1),error:D.kOil}),jsxRuntimeExports.jsx(Input,{label:"K-Factor Gás",type:"number",step:"0.001",min:"0.8",max:"1.2",value:a.kGas,onChange:p=>E("kGas",parseFloat(p.target.value)||1),error:D.kGas}),jsxRuntimeExports.jsx(Input,{label:"K-Factor Água",type:"number",step:"0.001",min:"0.8",max:"1.2",value:a.kWater,onChange:p=>E("kWater",parseFloat(p.target.value)||1),error:D.kWater})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",onClick:x,children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{type:"submit",variant:"primary",children:i?"Salvar Alterações":"Adicionar Medidor"})]})]})})};function commonjsRequire(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports$1){(function(t,i){module.exports=t.pdfjsLib=i()})(globalThis,()=>(()=>{var __webpack_modules__=[,(n,t)=>{var $e;Object.defineProperty(t,"__esModule",{value:!0}),t.VerbosityLevel=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.RenderingIntentFlag=t.PromiseCapability=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.PageActionEventType=t.OPS=t.MissingPDFException=t.MAX_IMAGE_SIZE_TO_CACHE=t.LINE_FACTOR=t.LINE_DESCENT_FACTOR=t.InvalidPDFException=t.ImageKind=t.IDENTITY_MATRIX=t.FormatError=t.FeatureTest=t.FONT_IDENTITY_MATRIX=t.DocumentActionEventType=t.CMapCompressionType=t.BaseException=t.BASELINE_FACTOR=t.AnnotationType=t.AnnotationReplyType=t.AnnotationPrefix=t.AnnotationMode=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationEditorType=t.AnnotationEditorPrefix=t.AnnotationEditorParamsType=t.AnnotationBorderStyleType=t.AnnotationActionEventType=t.AbortException=void 0,t.assert=I,t.bytesToString=me,t.createValidAbsoluteUrl=ee,t.getModificationDate=Se,t.getUuid=ze,t.getVerbosityLevel=V,t.info=Q,t.isArrayBuffer=te,t.isArrayEqual=we,t.isNodeJS=void 0,t.normalizeUnicode=Me,t.objectFromMap=je,t.objectSize=Ee,t.setVerbosityLevel=se,t.shadow=M,t.string32=be,t.stringToBytes=fe,t.stringToPDFString=xe,t.stringToUTF8String=Re,t.unreachable=ue,t.utf8StringToString=Ae,t.warn=K;const i=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");t.isNodeJS=i;const e=[1,0,0,1,0,0];t.IDENTITY_MATRIX=e;const s=[.001,0,0,.001,0,0];t.FONT_IDENTITY_MATRIX=s;const a=1e7;t.MAX_IMAGE_SIZE_TO_CACHE=a;const o=1.35;t.LINE_FACTOR=o;const D=.35;t.LINE_DESCENT_FACTOR=D;const S=D/o;t.BASELINE_FACTOR=S;const E={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};t.RenderingIntentFlag=E;const c={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};t.AnnotationMode=c;const v="pdfjs_internal_editor_";t.AnnotationEditorPrefix=v;const x={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};t.AnnotationEditorType=x;const p={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};t.AnnotationEditorParamsType=p;const _={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};t.PermissionFlag=_;const A={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};t.TextRenderingMode=A;const f={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};t.ImageKind=f;const u={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};t.AnnotationType=u;const C={GROUP:"Group",REPLY:"R"};t.AnnotationReplyType=C;const F={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};t.AnnotationFlag=F;const w={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};t.AnnotationFieldFlag=w;const h={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};t.AnnotationBorderStyleType=h;const R={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};t.AnnotationActionEventType=R;const b={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};t.DocumentActionEventType=b;const j={O:"PageOpen",C:"PageClose"};t.PageActionEventType=j;const y={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=y;const L={NONE:0,BINARY:1};t.CMapCompressionType=L;const g={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};t.OPS=g;const T={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};t.PasswordResponses=T;let z=y.WARNINGS;function se(ye){Number.isInteger(ye)&&(z=ye)}function V(){return z}function Q(ye){z>=y.INFOS&&console.log(`Info: ${ye}`)}function K(ye){z>=y.WARNINGS&&console.log(`Warning: ${ye}`)}function ue(ye){throw new Error(ye)}function I(ye,oe){ye||ue(oe)}function q(ye){switch(ye==null?void 0:ye.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ee(ye,oe=null,de=null){if(!ye)return null;try{if(de&&typeof ye=="string"){if(de.addDefaultProtocol&&ye.startsWith("www.")){const qe=ye.match(/\./g);(qe==null?void 0:qe.length)>=2&&(ye=`http://${ye}`)}if(de.tryConvertEncoding)try{ye=Re(ye)}catch{}}const Pe=oe?new URL(ye,oe):new URL(ye);if(q(Pe))return Pe}catch{}return null}function M(ye,oe,de,Pe=!1){return Object.defineProperty(ye,oe,{value:de,enumerable:!Pe,configurable:!0,writable:!1}),de}const l=function(){function oe(de,Pe){this.constructor===oe&&ue("Cannot initialize BaseException."),this.message=de,this.name=Pe}return oe.prototype=new Error,oe.constructor=oe,oe}();t.BaseException=l;class d extends l{constructor(oe,de){super(oe,"PasswordException"),this.code=de}}t.PasswordException=d;class k extends l{constructor(oe,de){super(oe,"UnknownErrorException"),this.details=de}}t.UnknownErrorException=k;class B extends l{constructor(oe){super(oe,"InvalidPDFException")}}t.InvalidPDFException=B;class G extends l{constructor(oe){super(oe,"MissingPDFException")}}t.MissingPDFException=G;class W extends l{constructor(oe,de){super(oe,"UnexpectedResponseException"),this.status=de}}t.UnexpectedResponseException=W;class $ extends l{constructor(oe){super(oe,"FormatError")}}t.FormatError=$;class ce extends l{constructor(oe){super(oe,"AbortException")}}t.AbortException=ce;function me(ye){(typeof ye!="object"||(ye==null?void 0:ye.length)===void 0)&&ue("Invalid argument for bytesToString");const oe=ye.length,de=8192;if(oe<de)return String.fromCharCode.apply(null,ye);const Pe=[];for(let qe=0;qe<oe;qe+=de){const Ve=Math.min(qe+de,oe),U=ye.subarray(qe,Ve);Pe.push(String.fromCharCode.apply(null,U))}return Pe.join("")}function fe(ye){typeof ye!="string"&&ue("Invalid argument for stringToBytes");const oe=ye.length,de=new Uint8Array(oe);for(let Pe=0;Pe<oe;++Pe)de[Pe]=ye.charCodeAt(Pe)&255;return de}function be(ye){return String.fromCharCode(ye>>24&255,ye>>16&255,ye>>8&255,ye&255)}function Ee(ye){return Object.keys(ye).length}function je(ye){const oe=Object.create(null);for(const[de,Pe]of ye)oe[de]=Pe;return oe}function ie(){const ye=new Uint8Array(4);return ye[0]=1,new Uint32Array(ye.buffer,0,1)[0]===1}function ae(){try{return new Function(""),!0}catch{return!1}}class P{static get isLittleEndian(){return M(this,"isLittleEndian",ie())}static get isEvalSupported(){return M(this,"isEvalSupported",ae())}static get isOffscreenCanvasSupported(){return M(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?M(this,"platform",{isWin:!1,isMac:!1}):M(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var oe,de;return M(this,"isCSSRoundSupported",(de=(oe=globalThis.CSS)==null?void 0:oe.supports)==null?void 0:de.call(oe,"width: round(1.5px, 1px)"))}}t.FeatureTest=P;const H=[...Array(256).keys()].map(ye=>ye.toString(16).padStart(2,"0"));class Z{static makeHexColor(oe,de,Pe){return`#${H[oe]}${H[de]}${H[Pe]}`}static scaleMinMax(oe,de){let Pe;oe[0]?(oe[0]<0&&(Pe=de[0],de[0]=de[1],de[1]=Pe),de[0]*=oe[0],de[1]*=oe[0],oe[3]<0&&(Pe=de[2],de[2]=de[3],de[3]=Pe),de[2]*=oe[3],de[3]*=oe[3]):(Pe=de[0],de[0]=de[2],de[2]=Pe,Pe=de[1],de[1]=de[3],de[3]=Pe,oe[1]<0&&(Pe=de[2],de[2]=de[3],de[3]=Pe),de[2]*=oe[1],de[3]*=oe[1],oe[2]<0&&(Pe=de[0],de[0]=de[1],de[1]=Pe),de[0]*=oe[2],de[1]*=oe[2]),de[0]+=oe[4],de[1]+=oe[4],de[2]+=oe[5],de[3]+=oe[5]}static transform(oe,de){return[oe[0]*de[0]+oe[2]*de[1],oe[1]*de[0]+oe[3]*de[1],oe[0]*de[2]+oe[2]*de[3],oe[1]*de[2]+oe[3]*de[3],oe[0]*de[4]+oe[2]*de[5]+oe[4],oe[1]*de[4]+oe[3]*de[5]+oe[5]]}static applyTransform(oe,de){const Pe=oe[0]*de[0]+oe[1]*de[2]+de[4],qe=oe[0]*de[1]+oe[1]*de[3]+de[5];return[Pe,qe]}static applyInverseTransform(oe,de){const Pe=de[0]*de[3]-de[1]*de[2],qe=(oe[0]*de[3]-oe[1]*de[2]+de[2]*de[5]-de[4]*de[3])/Pe,Ve=(-oe[0]*de[1]+oe[1]*de[0]+de[4]*de[1]-de[5]*de[0])/Pe;return[qe,Ve]}static getAxialAlignedBoundingBox(oe,de){const Pe=this.applyTransform(oe,de),qe=this.applyTransform(oe.slice(2,4),de),Ve=this.applyTransform([oe[0],oe[3]],de),U=this.applyTransform([oe[2],oe[1]],de);return[Math.min(Pe[0],qe[0],Ve[0],U[0]),Math.min(Pe[1],qe[1],Ve[1],U[1]),Math.max(Pe[0],qe[0],Ve[0],U[0]),Math.max(Pe[1],qe[1],Ve[1],U[1])]}static inverseTransform(oe){const de=oe[0]*oe[3]-oe[1]*oe[2];return[oe[3]/de,-oe[1]/de,-oe[2]/de,oe[0]/de,(oe[2]*oe[5]-oe[4]*oe[3])/de,(oe[4]*oe[1]-oe[5]*oe[0])/de]}static singularValueDecompose2dScale(oe){const de=[oe[0],oe[2],oe[1],oe[3]],Pe=oe[0]*de[0]+oe[1]*de[2],qe=oe[0]*de[1]+oe[1]*de[3],Ve=oe[2]*de[0]+oe[3]*de[2],U=oe[2]*de[1]+oe[3]*de[3],ge=(Pe+U)/2,Ce=Math.sqrt((Pe+U)**2-4*(Pe*U-Ve*qe))/2,De=ge+Ce||1,Le=ge-Ce||1;return[Math.sqrt(De),Math.sqrt(Le)]}static normalizeRect(oe){const de=oe.slice(0);return oe[0]>oe[2]&&(de[0]=oe[2],de[2]=oe[0]),oe[1]>oe[3]&&(de[1]=oe[3],de[3]=oe[1]),de}static intersect(oe,de){const Pe=Math.max(Math.min(oe[0],oe[2]),Math.min(de[0],de[2])),qe=Math.min(Math.max(oe[0],oe[2]),Math.max(de[0],de[2]));if(Pe>qe)return null;const Ve=Math.max(Math.min(oe[1],oe[3]),Math.min(de[1],de[3])),U=Math.min(Math.max(oe[1],oe[3]),Math.max(de[1],de[3]));return Ve>U?null:[Pe,Ve,qe,U]}static bezierBoundingBox(oe,de,Pe,qe,Ve,U,ge,Ce){const De=[],Le=[[],[]];let ke,O,N,Y,he,pe,ve,_e;for(let He=0;He<2;++He){if(He===0?(O=6*oe-12*Pe+6*Ve,ke=-3*oe+9*Pe-9*Ve+3*ge,N=3*Pe-3*oe):(O=6*de-12*qe+6*U,ke=-3*de+9*qe-9*U+3*Ce,N=3*qe-3*de),Math.abs(ke)<1e-12){if(Math.abs(O)<1e-12)continue;Y=-N/O,0<Y&&Y<1&&De.push(Y);continue}ve=O*O-4*N*ke,_e=Math.sqrt(ve),!(ve<0)&&(he=(-O+_e)/(2*ke),0<he&&he<1&&De.push(he),pe=(-O-_e)/(2*ke),0<pe&&pe<1&&De.push(pe))}let Ie=De.length,Ne;const Te=Ie;for(;Ie--;)Y=De[Ie],Ne=1-Y,Le[0][Ie]=Ne*Ne*Ne*oe+3*Ne*Ne*Y*Pe+3*Ne*Y*Y*Ve+Y*Y*Y*ge,Le[1][Ie]=Ne*Ne*Ne*de+3*Ne*Ne*Y*qe+3*Ne*Y*Y*U+Y*Y*Y*Ce;return Le[0][Te]=oe,Le[1][Te]=de,Le[0][Te+1]=ge,Le[1][Te+1]=Ce,Le[0].length=Le[1].length=Te+2,[Math.min(...Le[0]),Math.min(...Le[1]),Math.max(...Le[0]),Math.max(...Le[1])]}}t.Util=Z;const ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function xe(ye){if(ye[0]>="ï"){let de;if(ye[0]==="þ"&&ye[1]==="ÿ"?de="utf-16be":ye[0]==="ÿ"&&ye[1]==="þ"?de="utf-16le":ye[0]==="ï"&&ye[1]==="»"&&ye[2]==="¿"&&(de="utf-8"),de)try{const Pe=new TextDecoder(de,{fatal:!0}),qe=fe(ye);return Pe.decode(qe)}catch(Pe){K(`stringToPDFString: "${Pe}".`)}}const oe=[];for(let de=0,Pe=ye.length;de<Pe;de++){const qe=ne[ye.charCodeAt(de)];oe.push(qe?String.fromCharCode(qe):ye.charAt(de))}return oe.join("")}function Re(ye){return decodeURIComponent(escape(ye))}function Ae(ye){return unescape(encodeURIComponent(ye))}function te(ye){return typeof ye=="object"&&(ye==null?void 0:ye.byteLength)!==void 0}function we(ye,oe){if(ye.length!==oe.length)return!1;for(let de=0,Pe=ye.length;de<Pe;de++)if(ye[de]!==oe[de])return!1;return!0}function Se(ye=new Date){return[ye.getUTCFullYear().toString(),(ye.getUTCMonth()+1).toString().padStart(2,"0"),ye.getUTCDate().toString().padStart(2,"0"),ye.getUTCHours().toString().padStart(2,"0"),ye.getUTCMinutes().toString().padStart(2,"0"),ye.getUTCSeconds().toString().padStart(2,"0")].join("")}class We{constructor(){re(this,$e,!1);this.promise=new Promise((oe,de)=>{this.resolve=Pe=>{le(this,$e,!0),oe(Pe)},this.reject=Pe=>{le(this,$e,!0),de(Pe)}})}get settled(){return r(this,$e)}}$e=new WeakMap,t.PromiseCapability=We;let Be=null,Xe=null;function Me(ye){return Be||(Be=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Xe=new Map([["ﬅ","ſt"]])),ye.replaceAll(Be,(oe,de,Pe)=>de?de.normalize("NFKC"):Xe.get(Pe))}function ze(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const ye=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(ye);else for(let oe=0;oe<32;oe++)ye[oe]=Math.floor(Math.random()*255);return me(ye)}const Ke="pdfjs_internal_id_";t.AnnotationPrefix=Ke},(__unused_webpack_module,exports$1,__w_pdfjs_require__)=>{var n,i,e,s,ot,yt,D,S,E,c,v,x,p,_,A,Et,u,C,Dt,w,h;Object.defineProperty(exports$1,"__esModule",{value:!0}),exports$1.RenderTask=exports$1.PDFWorkerUtil=exports$1.PDFWorker=exports$1.PDFPageProxy=exports$1.PDFDocumentProxy=exports$1.PDFDocumentLoadingTask=exports$1.PDFDataRangeTransport=exports$1.LoopbackPort=exports$1.DefaultStandardFontDataFactory=exports$1.DefaultFilterFactory=exports$1.DefaultCanvasFactory=exports$1.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports$1,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports$1.build=void 0,exports$1.getDocument=getDocument,exports$1.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports$1.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports$1.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports$1.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports$1.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(b){if(typeof b=="string"||b instanceof URL?b={url:b}:(0,_util.isArrayBuffer)(b)&&(b={data:b}),typeof b!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!b.url&&!b.data&&!b.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const j=new PDFDocumentLoadingTask,{docId:y}=j,L=b.url?getUrlProp(b.url):null,g=b.data?getDataProp(b.data):null,T=b.httpHeaders||null,z=b.withCredentials===!0,se=b.password??null,V=b.range instanceof PDFDataRangeTransport?b.range:null,Q=Number.isInteger(b.rangeChunkSize)&&b.rangeChunkSize>0?b.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let K=b.worker instanceof PDFWorker?b.worker:null;const ue=b.verbosity,I=typeof b.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(b.docBaseUrl)?b.docBaseUrl:null,q=typeof b.cMapUrl=="string"?b.cMapUrl:null,ee=b.cMapPacked!==!1,M=b.CMapReaderFactory||DefaultCMapReaderFactory,l=typeof b.standardFontDataUrl=="string"?b.standardFontDataUrl:null,d=b.StandardFontDataFactory||DefaultStandardFontDataFactory,k=b.stopAtErrors!==!0,B=Number.isInteger(b.maxImageSize)&&b.maxImageSize>-1?b.maxImageSize:-1,G=b.isEvalSupported!==!1,W=typeof b.isOffscreenCanvasSupported=="boolean"?b.isOffscreenCanvasSupported:!_util.isNodeJS,$=Number.isInteger(b.canvasMaxAreaInBytes)?b.canvasMaxAreaInBytes:-1,ce=typeof b.disableFontFace=="boolean"?b.disableFontFace:_util.isNodeJS,me=b.fontExtraProperties===!0,fe=b.enableXfa===!0,be=b.ownerDocument||globalThis.document,Ee=b.disableRange===!0,je=b.disableStream===!0,ie=b.disableAutoFetch===!0,ae=b.pdfBug===!0,P=V?V.length:b.length??NaN,H=typeof b.useSystemFonts=="boolean"?b.useSystemFonts:!_util.isNodeJS&&!ce,Z=typeof b.useWorkerFetch=="boolean"?b.useWorkerFetch:M===_display_utils.DOMCMapReaderFactory&&d===_display_utils.DOMStandardFontDataFactory&&q&&l&&(0,_display_utils.isValidFetchUrl)(q,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(l,document.baseURI),ne=b.canvasFactory||new DefaultCanvasFactory({ownerDocument:be}),xe=b.filterFactory||new DefaultFilterFactory({docId:y,ownerDocument:be}),Re=null;(0,_util.setVerbosityLevel)(ue);const Ae={canvasFactory:ne,filterFactory:xe};if(Z||(Ae.cMapReaderFactory=new M({baseUrl:q,isCompressed:ee}),Ae.standardFontDataFactory=new d({baseUrl:l})),!K){const Se={verbosity:ue,port:_worker_options.GlobalWorkerOptions.workerPort};K=Se.port?PDFWorker.fromPort(Se):new PDFWorker(Se),j._worker=K}const te={docId:y,apiVersion:"3.11.174",data:g,password:se,disableAutoFetch:ie,rangeChunkSize:Q,length:P,docBaseUrl:I,enableXfa:fe,evaluatorOptions:{maxImageSize:B,disableFontFace:ce,ignoreErrors:k,isEvalSupported:G,isOffscreenCanvasSupported:W,canvasMaxAreaInBytes:$,fontExtraProperties:me,useSystemFonts:H,cMapUrl:Z?q:null,standardFontDataUrl:Z?l:null}},we={ignoreErrors:k,isEvalSupported:G,disableFontFace:ce,fontExtraProperties:me,enableXfa:fe,ownerDocument:be,disableAutoFetch:ie,pdfBug:ae,styleElement:Re};return K.promise.then(function(){if(j.destroyed)throw new Error("Loading aborted");const Se=_fetchDocument(K,te),We=new Promise(function(Be){let Xe;V?Xe=new _transport_stream.PDFDataTransportStream({length:P,initialData:V.initialData,progressiveDone:V.progressiveDone,contentDispositionFilename:V.contentDispositionFilename,disableRange:Ee,disableStream:je},V):g||(Xe=(ze=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(ze):(0,_display_utils.isValidFetchUrl)(ze.url)?new _displayFetch_stream.PDFFetchStream(ze):new _displayNetwork.PDFNetworkStream(ze))({url:L,length:P,httpHeaders:T,withCredentials:z,rangeChunkSize:Q,disableRange:Ee,disableStream:je})),Be(Xe)});return Promise.all([Se,We]).then(function([Be,Xe]){if(j.destroyed)throw new Error("Loading aborted");const Me=new _message_handler.MessageHandler(y,Be,K.port),ze=new WorkerTransport(Me,j,Xe,we,Ae);j._transport=ze,Me.send("Ready",null)})}).catch(j._capability.reject),j}async function _fetchDocument(b,j){if(b.destroyed)throw new Error("Worker was destroyed");const y=await b.messageHandler.sendWithPromise("GetDocRequest",j,j.data?[j.data.buffer]:null);if(b.destroyed)throw new Error("Worker was destroyed");return y}function getUrlProp(b){if(b instanceof URL)return b.href;try{return new URL(b,window.location).href}catch{if(_util.isNodeJS&&typeof b=="string")return b}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(b){if(_util.isNodeJS&&typeof Buffer<"u"&&b instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(b instanceof Uint8Array&&b.byteLength===b.buffer.byteLength)return b;if(typeof b=="string")return(0,_util.stringToBytes)(b);if(typeof b=="object"&&!isNaN(b==null?void 0:b.length)||(0,_util.isArrayBuffer)(b))return new Uint8Array(b);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const t=class t{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${ht(t,n)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var j,y,L;this.destroyed=!0;try{(j=this._worker)!=null&&j.port&&(this._worker._pendingDestroy=!0),await((y=this._transport)==null?void 0:y.destroy())}catch(g){throw(L=this._worker)!=null&&L.port&&delete this._worker._pendingDestroy,g}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};n=new WeakMap,re(t,n,0);let PDFDocumentLoadingTask=t;exports$1.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(j,y,L=!1,g=null){this.length=j,this.initialData=y,this.progressiveDone=L,this.contentDispositionFilename=g,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(j){this._rangeListeners.push(j)}addProgressListener(j){this._progressListeners.push(j)}addProgressiveReadListener(j){this._progressiveReadListeners.push(j)}addProgressiveDoneListener(j){this._progressiveDoneListeners.push(j)}onDataRange(j,y){for(const L of this._rangeListeners)L(j,y)}onDataProgress(j,y){this._readyCapability.promise.then(()=>{for(const L of this._progressListeners)L(j,y)})}onDataProgressiveRead(j){this._readyCapability.promise.then(()=>{for(const y of this._progressiveReadListeners)y(j)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const j of this._progressiveDoneListeners)j()})}transportReady(){this._readyCapability.resolve()}requestDataRange(j,y){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports$1.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(j,y){this._pdfInfo=j,this._transport=y,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(L=>{if(!L)return L;const g=[];for(const T in L)g.push(...L[T]);return g}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(j){return this._transport.getPage(j)}getPageIndex(j){return this._transport.getPageIndex(j)}getDestinations(){return this._transport.getDestinations()}getDestination(j){return this._transport.getDestination(j)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(j=!1){return this._transport.startCleanup(j||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports$1.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(j,y,L,g=!1){re(this,s);re(this,i,null);re(this,e,!1);this._pageIndex=j,this._pageInfo=y,this._transport=L,this._stats=g?new _display_utils.StatTimer:null,this._pdfBug=g,this.commonObjs=L.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:j,rotation:y=this.rotate,offsetX:L=0,offsetY:g=0,dontFlip:T=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:j,rotation:y,offsetX:L,offsetY:g,dontFlip:T})}getAnnotations({intent:j="display"}={}){const y=this._transport.getRenderingIntent(j);return this._transport.getAnnotations(this._pageIndex,y.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var j;return((j=this._transport._htmlForXfa)==null?void 0:j.children[this._pageIndex])||null}render({canvasContext:j,viewport:y,intent:L="display",annotationMode:g=_util.AnnotationMode.ENABLE,transform:T=null,background:z=null,optionalContentConfigPromise:se=null,annotationCanvasMap:V=null,pageColors:Q=null,printAnnotationStorage:K=null}){var d,k;(d=this._stats)==null||d.time("Overall");const ue=this._transport.getRenderingIntent(L,g,K);le(this,e,!1),J(this,s,yt).call(this),se||(se=this._transport.getOptionalContentConfig());let I=this._intentStates.get(ue.cacheKey);I||(I=Object.create(null),this._intentStates.set(ue.cacheKey,I)),I.streamReaderCancelTimeout&&(clearTimeout(I.streamReaderCancelTimeout),I.streamReaderCancelTimeout=null);const q=!!(ue.renderingIntent&_util.RenderingIntentFlag.PRINT);I.displayReadyCapability||(I.displayReadyCapability=new _util.PromiseCapability,I.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(k=this._stats)==null||k.time("Page Request"),this._pumpOperatorList(ue));const ee=B=>{var G,W;I.renderTasks.delete(M),(this._maybeCleanupAfterRender||q)&&le(this,e,!0),J(this,s,ot).call(this,!q),B?(M.capability.reject(B),this._abortOperatorList({intentState:I,reason:B instanceof Error?B:new Error(B)})):M.capability.resolve(),(G=this._stats)==null||G.timeEnd("Rendering"),(W=this._stats)==null||W.timeEnd("Overall")},M=new InternalRenderTask({callback:ee,params:{canvasContext:j,viewport:y,transform:T,background:z},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:V,operatorList:I.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!q,pdfBug:this._pdfBug,pageColors:Q});(I.renderTasks||(I.renderTasks=new Set)).add(M);const l=M.task;return Promise.all([I.displayReadyCapability.promise,se]).then(([B,G])=>{var W;if(this.destroyed){ee();return}(W=this._stats)==null||W.time("Rendering"),M.initializeGraphics({transparency:B,optionalContentConfig:G}),M.operatorListChanged()}).catch(ee),l}getOperatorList({intent:j="display",annotationMode:y=_util.AnnotationMode.ENABLE,printAnnotationStorage:L=null}={}){var V;function g(){z.operatorList.lastChunk&&(z.opListReadCapability.resolve(z.operatorList),z.renderTasks.delete(se))}const T=this._transport.getRenderingIntent(j,y,L,!0);let z=this._intentStates.get(T.cacheKey);z||(z=Object.create(null),this._intentStates.set(T.cacheKey,z));let se;return z.opListReadCapability||(se=Object.create(null),se.operatorListChanged=g,z.opListReadCapability=new _util.PromiseCapability,(z.renderTasks||(z.renderTasks=new Set)).add(se),z.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(V=this._stats)==null||V.time("Page Request"),this._pumpOperatorList(T)),z.opListReadCapability.promise}streamTextContent({includeMarkedContent:j=!1,disableNormalization:y=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:j===!0,disableNormalization:y===!0},{highWaterMark:100,size(g){return g.items.length}})}getTextContent(j={}){if(this._transport._htmlForXfa)return this.getXfa().then(L=>_xfa_text.XfaText.textContent(L));const y=this.streamTextContent(j);return new Promise(function(L,g){function T(){z.read().then(function({value:V,done:Q}){if(Q){L(se);return}Object.assign(se.styles,V.styles),se.items.push(...V.items),T()},g)}const z=y.getReader(),se={items:[],styles:Object.create(null)};T()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const j=[];for(const y of this._intentStates.values())if(this._abortOperatorList({intentState:y,reason:new Error("Page was destroyed."),force:!0}),!y.opListReadCapability)for(const L of y.renderTasks)j.push(L.completed),L.cancel();return this.objs.clear(),le(this,e,!1),J(this,s,yt).call(this),Promise.all(j)}cleanup(j=!1){le(this,e,!0);const y=J(this,s,ot).call(this,!1);return j&&y&&this._stats&&(this._stats=new _display_utils.StatTimer),y}_startRenderPage(j,y){var g,T;const L=this._intentStates.get(y);L&&((g=this._stats)==null||g.timeEnd("Page Request"),(T=L.displayReadyCapability)==null||T.resolve(j))}_renderPageChunk(j,y){for(let L=0,g=j.length;L<g;L++)y.operatorList.fnArray.push(j.fnArray[L]),y.operatorList.argsArray.push(j.argsArray[L]);y.operatorList.lastChunk=j.lastChunk,y.operatorList.separateAnnots=j.separateAnnots;for(const L of y.renderTasks)L.operatorListChanged();j.lastChunk&&J(this,s,ot).call(this,!0)}_pumpOperatorList({renderingIntent:j,cacheKey:y,annotationStorageSerializable:L}){const{map:g,transfers:T}=L,se=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:j,cacheKey:y,annotationStorage:g},T).getReader(),V=this._intentStates.get(y);V.streamReader=se;const Q=()=>{se.read().then(({value:K,done:ue})=>{if(ue){V.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(K,V),Q())},K=>{if(V.streamReader=null,!this._transport.destroyed){if(V.operatorList){V.operatorList.lastChunk=!0;for(const ue of V.renderTasks)ue.operatorListChanged();J(this,s,ot).call(this,!0)}if(V.displayReadyCapability)V.displayReadyCapability.reject(K);else if(V.opListReadCapability)V.opListReadCapability.reject(K);else throw K}})};Q()}_abortOperatorList({intentState:j,reason:y,force:L=!1}){if(j.streamReader){if(j.streamReaderCancelTimeout&&(clearTimeout(j.streamReaderCancelTimeout),j.streamReaderCancelTimeout=null),!L){if(j.renderTasks.size>0)return;if(y instanceof _display_utils.RenderingCancelledException){let g=RENDERING_CANCELLED_TIMEOUT;y.extraDelay>0&&y.extraDelay<1e3&&(g+=y.extraDelay),j.streamReaderCancelTimeout=setTimeout(()=>{j.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:j,reason:y,force:!0})},g);return}}if(j.streamReader.cancel(new _util.AbortException(y.message)).catch(()=>{}),j.streamReader=null,!this._transport.destroyed){for(const[g,T]of this._intentStates)if(T===j){this._intentStates.delete(g);break}this.cleanup()}}}get stats(){return this._stats}}i=new WeakMap,e=new WeakMap,s=new WeakSet,ot=function(j=!1){if(J(this,s,yt).call(this),!r(this,e)||this.destroyed)return!1;if(j)return le(this,i,setTimeout(()=>{le(this,i,null),J(this,s,ot).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:y,operatorList:L}of this._intentStates.values())if(y.size>0||!L.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),le(this,e,!1),!0},yt=function(){r(this,i)&&(clearTimeout(r(this,i)),le(this,i,null))},exports$1.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){re(this,D,new Set);re(this,S,Promise.resolve())}postMessage(j,y){const L={data:structuredClone(j,y?{transfer:y}:null)};r(this,S).then(()=>{for(const g of r(this,D))g.call(this,L)})}addEventListener(j,y){r(this,D).add(y)}removeEventListener(j,y){r(this,D).delete(y)}terminate(){r(this,D).clear()}}D=new WeakMap,S=new WeakMap,exports$1.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports$1.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const b=(E=document==null?void 0:document.currentScript)==null?void 0:E.src;b&&(PDFWorkerUtil.fallbackWorkerSrc=b.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(b,j){let y;try{if(y=new URL(b),!y.origin||y.origin==="null")return!1}catch{return!1}const L=new URL(j,y);return y.origin===L.origin},PDFWorkerUtil.createCDNWrapper=function(b){const j=`importScripts("${b}");`;return URL.createObjectURL(new Blob([j]))}}const _PDFWorker=class _PDFWorker{constructor({name:b=null,port:j=null,verbosity:y=(0,_util.getVerbosityLevel)()}={}){var L;if(this.name=b,this.destroyed=!1,this.verbosity=y,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,j){if((L=r(_PDFWorker,c))!=null&&L.has(j))throw new Error("Cannot use more than one PDFWorker per port.");(r(_PDFWorker,c)||le(_PDFWorker,c,new WeakMap)).set(j,this),this._initializeFromPort(j);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(b){this._port=b,this._messageHandler=new _message_handler.MessageHandler("main","worker",b),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:b}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,b)||(b=PDFWorkerUtil.createCDNWrapper(new URL(b,window.location).href));const j=new Worker(b),y=new _message_handler.MessageHandler("main","worker",j),L=()=>{j.removeEventListener("error",g),y.destroy(),j.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},g=()=>{this._webWorker||L()};j.addEventListener("error",g),y.on("test",z=>{if(j.removeEventListener("error",g),this.destroyed){L();return}z?(this._messageHandler=y,this._port=j,this._webWorker=j,this._readyCapability.resolve(),y.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),y.destroy(),j.terminate())}),y.on("ready",z=>{if(j.removeEventListener("error",g),this.destroyed){L();return}try{T()}catch{this._setupFakeWorker()}});const T=()=>{const z=new Uint8Array;y.send("test",z,[z.buffer])};T();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(b=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const j=new LoopbackPort;this._port=j;const y=`fake${PDFWorkerUtil.fakeWorkerId++}`,L=new _message_handler.MessageHandler(y+"_worker",y,j);b.setup(L,j);const g=new _message_handler.MessageHandler(y,y+"_worker",j);this._messageHandler=g,this._readyCapability.resolve(),g.send("configure",{verbosity:this.verbosity})}).catch(b=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${b.message}".`))})}destroy(){var b;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(b=r(_PDFWorker,c))==null||b.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(b){var y;if(!(b!=null&&b.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const j=(y=r(this,c))==null?void 0:y.get(b.port);if(j){if(j._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return j}return new _PDFWorker(b)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var b;try{return((b=globalThis.pdfjsWorker)==null?void 0:b.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};c=new WeakMap,re(_PDFWorker,c);let PDFWorker=_PDFWorker;exports$1.PDFWorker=PDFWorker;class WorkerTransport{constructor(j,y,L,g,T){re(this,A);re(this,v,new Map);re(this,x,new Map);re(this,p,new Map);re(this,_,null);this.messageHandler=j,this.loadingTask=y,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:g.ownerDocument,styleElement:g.styleElement}),this._params=g,this.canvasFactory=T.canvasFactory,this.filterFactory=T.filterFactory,this.cMapReaderFactory=T.cMapReaderFactory,this.standardFontDataFactory=T.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=L,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(j,y=_util.AnnotationMode.ENABLE,L=null,g=!1){let T=_util.RenderingIntentFlag.DISPLAY,z=_annotation_storage.SerializableEmpty;switch(j){case"any":T=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":T=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${j}`)}switch(y){case _util.AnnotationMode.DISABLE:T+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:T+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:T+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,z=(T&_util.RenderingIntentFlag.PRINT&&L instanceof _annotation_storage.PrintAnnotationStorage?L:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${y}`)}return g&&(T+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:T,cacheKey:`${T}_${z.hash}`,annotationStorageSerializable:z}}destroy(){var L;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(L=r(this,_))==null||L.reject(new Error("Worker was destroyed during onPassword callback"));const j=[];for(const g of r(this,x).values())j.push(g._destroy());r(this,x).clear(),r(this,p).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const y=this.messageHandler.sendWithPromise("Terminate",null);return j.push(y),Promise.all(j).then(()=>{var g;this.commonObjs.clear(),this.fontLoader.clear(),r(this,v).clear(),this.filterFactory.destroy(),(g=this._networkStream)==null||g.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:j,loadingTask:y}=this;j.on("GetReader",(L,g)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=T=>{this._lastProgress={loaded:T.loaded,total:T.total}},g.onPull=()=>{this._fullReader.read().then(function({value:T,done:z}){if(z){g.close();return}(0,_util.assert)(T instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),g.enqueue(new Uint8Array(T),1,[T])}).catch(T=>{g.error(T)})},g.onCancel=T=>{this._fullReader.cancel(T),g.ready.catch(z=>{if(!this.destroyed)throw z})}}),j.on("ReaderHeadersReady",L=>{const g=new _util.PromiseCapability,T=this._fullReader;return T.headersReady.then(()=>{var z;(!T.isStreamingSupported||!T.isRangeSupported)&&(this._lastProgress&&((z=y.onProgress)==null||z.call(y,this._lastProgress)),T.onProgress=se=>{var V;(V=y.onProgress)==null||V.call(y,{loaded:se.loaded,total:se.total})}),g.resolve({isStreamingSupported:T.isStreamingSupported,isRangeSupported:T.isRangeSupported,contentLength:T.contentLength})},g.reject),g.promise}),j.on("GetRangeReader",(L,g)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const T=this._networkStream.getRangeReader(L.begin,L.end);if(!T){g.close();return}g.onPull=()=>{T.read().then(function({value:z,done:se}){if(se){g.close();return}(0,_util.assert)(z instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),g.enqueue(new Uint8Array(z),1,[z])}).catch(z=>{g.error(z)})},g.onCancel=z=>{T.cancel(z),g.ready.catch(se=>{if(!this.destroyed)throw se})}}),j.on("GetDoc",({pdfInfo:L})=>{this._numPages=L.numPages,this._htmlForXfa=L.htmlForXfa,delete L.htmlForXfa,y._capability.resolve(new PDFDocumentProxy(L,this))}),j.on("DocException",function(L){let g;switch(L.name){case"PasswordException":g=new _util.PasswordException(L.message,L.code);break;case"InvalidPDFException":g=new _util.InvalidPDFException(L.message);break;case"MissingPDFException":g=new _util.MissingPDFException(L.message);break;case"UnexpectedResponseException":g=new _util.UnexpectedResponseException(L.message,L.status);break;case"UnknownErrorException":g=new _util.UnknownErrorException(L.message,L.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}y._capability.reject(g)}),j.on("PasswordRequest",L=>{if(le(this,_,new _util.PromiseCapability),y.onPassword){const g=T=>{T instanceof Error?r(this,_).reject(T):r(this,_).resolve({password:T})};try{y.onPassword(g,L.code)}catch(T){r(this,_).reject(T)}}else r(this,_).reject(new _util.PasswordException(L.message,L.code));return r(this,_).promise}),j.on("DataLoaded",L=>{var g;(g=y.onProgress)==null||g.call(y,{loaded:L.length,total:L.length}),this.downloadInfoCapability.resolve(L)}),j.on("StartRenderPage",L=>{if(this.destroyed)return;r(this,x).get(L.pageIndex)._startRenderPage(L.transparency,L.cacheKey)}),j.on("commonobj",([L,g,T])=>{var z;if(!this.destroyed&&!this.commonObjs.has(L))switch(g){case"Font":const se=this._params;if("error"in T){const K=T.error;(0,_util.warn)(`Error during font loading: ${K}`),this.commonObjs.resolve(L,K);break}const V=se.pdfBug&&((z=globalThis.FontInspector)!=null&&z.enabled)?(K,ue)=>globalThis.FontInspector.fontAdded(K,ue):null,Q=new _font_loader.FontFaceObject(T,{isEvalSupported:se.isEvalSupported,disableFontFace:se.disableFontFace,ignoreErrors:se.ignoreErrors,inspectFont:V});this.fontLoader.bind(Q).catch(K=>j.sendWithPromise("FontFallback",{id:L})).finally(()=>{!se.fontExtraProperties&&Q.data&&(Q.data=null),this.commonObjs.resolve(L,Q)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(L,T);break;default:throw new Error(`Got unknown common object type ${g}`)}}),j.on("obj",([L,g,T,z])=>{var V;if(this.destroyed)return;const se=r(this,x).get(g);if(!se.objs.has(L))switch(T){case"Image":if(se.objs.resolve(L,z),z){let Q;if(z.bitmap){const{width:K,height:ue}=z;Q=K*ue*4}else Q=((V=z.data)==null?void 0:V.length)||0;Q>_util.MAX_IMAGE_SIZE_TO_CACHE&&(se._maybeCleanupAfterRender=!0)}break;case"Pattern":se.objs.resolve(L,z);break;default:throw new Error(`Got unknown object type ${T}`)}}),j.on("DocProgress",L=>{var g;this.destroyed||(g=y.onProgress)==null||g.call(y,{loaded:L.loaded,total:L.total})}),j.on("FetchBuiltInCMap",L=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(L):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),j.on("FetchStandardFontData",L=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(L):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var L;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:j,transfers:y}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:j,filename:((L=this._fullReader)==null?void 0:L.filename)??null},y).finally(()=>{this.annotationStorage.resetModified()})}getPage(j){if(!Number.isInteger(j)||j<=0||j>this._numPages)return Promise.reject(new Error("Invalid page request."));const y=j-1,L=r(this,p).get(y);if(L)return L;const g=this.messageHandler.sendWithPromise("GetPage",{pageIndex:y}).then(T=>{if(this.destroyed)throw new Error("Transport destroyed");const z=new PDFPageProxy(y,T,this,this._params.pdfBug);return r(this,x).set(y,z),z});return r(this,p).set(y,g),g}getPageIndex(j){return typeof j!="object"||j===null||!Number.isInteger(j.num)||j.num<0||!Number.isInteger(j.gen)||j.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:j.num,gen:j.gen})}getAnnotations(j,y){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:j,intent:y})}getFieldObjects(){return J(this,A,Et).call(this,"GetFieldObjects")}hasJSActions(){return J(this,A,Et).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(j){return typeof j!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:j})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return J(this,A,Et).call(this,"GetDocJSActions")}getPageJSActions(j){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:j})}getStructTree(j){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:j})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(j=>new _optional_content_config.OptionalContentConfig(j))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const j="GetMetadata",y=r(this,v).get(j);if(y)return y;const L=this.messageHandler.sendWithPromise(j,null).then(g=>{var T,z;return{info:g[0],metadata:g[1]?new _metadata.Metadata(g[1]):null,contentDispositionFilename:((T=this._fullReader)==null?void 0:T.filename)??null,contentLength:((z=this._fullReader)==null?void 0:z.contentLength)??null}});return r(this,v).set(j,L),L}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(j=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const y of r(this,x).values())if(!y.cleanup())throw new Error(`startCleanup: Page ${y.pageNumber} is currently rendering.`);this.commonObjs.clear(),j||this.fontLoader.clear(),r(this,v).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:j,enableXfa:y}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:j,enableXfa:y})}}v=new WeakMap,x=new WeakMap,p=new WeakMap,_=new WeakMap,A=new WeakSet,Et=function(j,y=null){const L=r(this,v).get(j);if(L)return L;const g=this.messageHandler.sendWithPromise(j,y);return r(this,v).set(j,g),g};class PDFObjects{constructor(){re(this,C);re(this,u,Object.create(null))}get(j,y=null){if(y){const g=J(this,C,Dt).call(this,j);return g.capability.promise.then(()=>y(g.data)),null}const L=r(this,u)[j];if(!(L!=null&&L.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${j}.`);return L.data}has(j){const y=r(this,u)[j];return(y==null?void 0:y.capability.settled)||!1}resolve(j,y=null){const L=J(this,C,Dt).call(this,j);L.data=y,L.capability.resolve()}clear(){var j;for(const y in r(this,u)){const{data:L}=r(this,u)[y];(j=L==null?void 0:L.bitmap)==null||j.close()}le(this,u,Object.create(null))}}u=new WeakMap,C=new WeakSet,Dt=function(j){var y;return(y=r(this,u))[j]||(y[j]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(j){re(this,w,null);le(this,w,j),this.onContinue=null}get promise(){return r(this,w).capability.promise}cancel(j=0){r(this,w).cancel(null,j)}get separateAnnots(){const{separateAnnots:j}=r(this,w).operatorList;if(!j)return!1;const{annotationCanvasMap:y}=r(this,w);return j.form||j.canvas&&(y==null?void 0:y.size)>0}}w=new WeakMap,exports$1.RenderTask=RenderTask;const R=class R{constructor({callback:j,params:y,objs:L,commonObjs:g,annotationCanvasMap:T,operatorList:z,pageIndex:se,canvasFactory:V,filterFactory:Q,useRequestAnimationFrame:K=!1,pdfBug:ue=!1,pageColors:I=null}){this.callback=j,this.params=y,this.objs=L,this.commonObjs=g,this.annotationCanvasMap=T,this.operatorListIdx=null,this.operatorList=z,this._pageIndex=se,this.canvasFactory=V,this.filterFactory=Q,this._pdfBug=ue,this.pageColors=I,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=K===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=y.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:j=!1,optionalContentConfig:y}){var se,V;if(this.cancelled)return;if(this._canvas){if(r(R,h).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");r(R,h).add(this._canvas)}this._pdfBug&&((se=globalThis.StepperManager)!=null&&se.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:L,viewport:g,transform:T,background:z}=this.params;this.gfx=new _canvas.CanvasGraphics(L,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:y},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:T,viewport:g,transparency:j,background:z}),this.operatorListIdx=0,this.graphicsReady=!0,(V=this.graphicsReadyCallback)==null||V.call(this)}cancel(j=null,y=0){var L;this.running=!1,this.cancelled=!0,(L=this.gfx)==null||L.endDrawing(),r(R,h).delete(this._canvas),this.callback(j||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,y))}operatorListChanged(){var j;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(j=this.stepper)==null||j.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),r(R,h).delete(this._canvas),this.callback())))}};h=new WeakMap,re(R,h,new WeakSet);let InternalRenderTask=R;const version="3.11.174";exports$1.version=version;const build="ce8716743";exports$1.build=build},(n,t,i)=>{var E,c,v,bs,p;Object.defineProperty(t,"__esModule",{value:!0}),t.SerializableEmpty=t.PrintAnnotationStorage=t.AnnotationStorage=void 0;var e=i(1),s=i(4),a=i(8);const o=Object.freeze({map:null,hash:"",transfers:void 0});t.SerializableEmpty=o;class D{constructor(){re(this,v);re(this,E,!1);re(this,c,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(A,f){const u=r(this,c).get(A);return u===void 0?f:Object.assign(f,u)}getRawValue(A){return r(this,c).get(A)}remove(A){if(r(this,c).delete(A),r(this,c).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const f of r(this,c).values())if(f instanceof s.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(A,f){const u=r(this,c).get(A);let C=!1;if(u!==void 0)for(const[F,w]of Object.entries(f))u[F]!==w&&(C=!0,u[F]=w);else C=!0,r(this,c).set(A,f);C&&J(this,v,bs).call(this),f instanceof s.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(f.constructor._type)}has(A){return r(this,c).has(A)}getAll(){return r(this,c).size>0?(0,e.objectFromMap)(r(this,c)):null}setAll(A){for(const[f,u]of Object.entries(A))this.setValue(f,u)}get size(){return r(this,c).size}resetModified(){r(this,E)&&(le(this,E,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new S(this)}get serializable(){if(r(this,c).size===0)return o;const A=new Map,f=new a.MurmurHash3_64,u=[],C=Object.create(null);let F=!1;for(const[w,h]of r(this,c)){const R=h instanceof s.AnnotationEditor?h.serialize(!1,C):h;R&&(A.set(w,R),f.update(`${w}:${JSON.stringify(R)}`),F||(F=!!R.bitmap))}if(F)for(const w of A.values())w.bitmap&&u.push(w.bitmap);return A.size>0?{map:A,hash:f.hexdigest(),transfers:u}:o}}E=new WeakMap,c=new WeakMap,v=new WeakSet,bs=function(){r(this,E)||(le(this,E,!0),typeof this.onSetModified=="function"&&this.onSetModified())},t.AnnotationStorage=D;class S extends D{constructor(f){super();re(this,p);const{map:u,hash:C,transfers:F}=f.serializable,w=structuredClone(u,F?{transfer:F}:null);le(this,p,{map:w,hash:C,transfers:F})}get print(){(0,e.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return r(this,p)}}p=new WeakMap,t.PrintAnnotationStorage=S},(n,t,i)=>{var S,E,c,v,x,p,_,A,f,u,C,F,w,h,R,It,Ot,y,Lt,zt,vs,ys,Es,Bt,As;Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditor=void 0;var e=i(5),s=i(1),a=i(6);const K=class K{constructor(I){re(this,R);re(this,S,"");re(this,E,!1);re(this,c,null);re(this,v,null);re(this,x,null);re(this,p,!1);re(this,_,null);re(this,A,this.focusin.bind(this));re(this,f,this.focusout.bind(this));re(this,u,!1);re(this,C,!1);re(this,F,!1);Ze(this,"_initialOptions",Object.create(null));Ze(this,"_uiManager",null);Ze(this,"_focusEventsAllowed",!0);Ze(this,"_l10nPromise",null);re(this,w,!1);re(this,h,K._zIndex++);this.constructor===K&&(0,s.unreachable)("Cannot initialize AnnotationEditor."),this.parent=I.parent,this.id=I.id,this.width=this.height=null,this.pageIndex=I.parent.pageIndex,this.name=I.name,this.div=null,this._uiManager=I.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=I.isCentered,this._structTreeParentId=null;const{rotation:q,rawDims:{pageWidth:ee,pageHeight:M,pageX:l,pageY:d}}=this.parent.viewport;this.rotation=q,this.pageRotation=(360+q-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[ee,M],this.pageTranslation=[l,d];const[k,B]=this.parentDimensions;this.x=I.x/k,this.y=I.y/B,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,s.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(I){const q=new D({id:I.parent.getNextId(),parent:I.parent,uiManager:I._uiManager});q.annotationElementId=I.annotationElementId,q.deleted=!0,q._uiManager.addToAnnotationStorage(q)}static initialize(I,q=null){if(K._l10nPromise||(K._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(M=>[M,I.get(M)]))),q!=null&&q.strings)for(const M of q.strings)K._l10nPromise.set(M,I.get(M));if(K._borderLineWidth!==-1)return;const ee=getComputedStyle(document.documentElement);K._borderLineWidth=parseFloat(ee.getPropertyValue("--outline-width"))||0}static updateDefaultParams(I,q){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(I){return!1}static paste(I,q){(0,s.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return r(this,w)}set _isDraggable(I){var q;le(this,w,I),(q=this.div)==null||q.classList.toggle("draggable",I)}center(){const[I,q]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*q/(I*2),this.y+=this.width*I/(q*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*q/(I*2),this.y-=this.width*I/(q*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(I){this._uiManager.addCommands(I)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=r(this,h)}setParent(I){I!==null&&(this.pageIndex=I.pageIndex,this.pageDimensions=I.pageDimensions),this.parent=I}focusin(I){this._focusEventsAllowed&&(r(this,u)?le(this,u,!1):this.parent.setSelected(this))}focusout(I){var ee;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const q=I.relatedTarget;q!=null&&q.closest(`#${this.id}`)||(I.preventDefault(),(ee=this.parent)!=null&&ee.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(I,q,ee,M){const[l,d]=this.parentDimensions;[ee,M]=this.screenToPageTranslation(ee,M),this.x=(I+ee)/l,this.y=(q+M)/d,this.fixAndSetPosition()}translate(I,q){J(this,R,It).call(this,this.parentDimensions,I,q)}translateInPage(I,q){J(this,R,It).call(this,this.pageDimensions,I,q),this.div.scrollIntoView({block:"nearest"})}drag(I,q){const[ee,M]=this.parentDimensions;if(this.x+=I/ee,this.y+=q/M,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:G,y:W}=this.div.getBoundingClientRect();this.parent.findNewParent(this,G,W)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:d}=this;const[k,B]=J(this,R,Ot).call(this);l+=k,d+=B,this.div.style.left=`${(100*l).toFixed(2)}%`,this.div.style.top=`${(100*d).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[I,q]=this.pageDimensions;let{x:ee,y:M,width:l,height:d}=this;switch(l*=I,d*=q,ee*=I,M*=q,this.rotation){case 0:ee=Math.max(0,Math.min(I-l,ee)),M=Math.max(0,Math.min(q-d,M));break;case 90:ee=Math.max(0,Math.min(I-d,ee)),M=Math.min(q,Math.max(l,M));break;case 180:ee=Math.min(I,Math.max(l,ee)),M=Math.min(q,Math.max(d,M));break;case 270:ee=Math.min(I,Math.max(d,ee)),M=Math.max(0,Math.min(q-l,M));break}this.x=ee/=I,this.y=M/=q;const[k,B]=J(this,R,Ot).call(this);ee+=k,M+=B;const{style:G}=this.div;G.left=`${(100*ee).toFixed(2)}%`,G.top=`${(100*M).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(I,q){var ee;return J(ee=K,y,Lt).call(ee,I,q,this.parentRotation)}pageTranslationToScreen(I,q){var ee;return J(ee=K,y,Lt).call(ee,I,q,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:I,pageDimensions:[q,ee]}=this,M=q*I,l=ee*I;return s.FeatureTest.isCSSRoundSupported?[Math.round(M),Math.round(l)]:[M,l]}setDims(I,q){var l;const[ee,M]=this.parentDimensions;this.div.style.width=`${(100*I/ee).toFixed(2)}%`,r(this,p)||(this.div.style.height=`${(100*q/M).toFixed(2)}%`),(l=r(this,c))==null||l.classList.toggle("small",I<K.SMALL_EDITOR_SIZE||q<K.SMALL_EDITOR_SIZE)}fixDims(){const{style:I}=this.div,{height:q,width:ee}=I,M=ee.endsWith("%"),l=!r(this,p)&&q.endsWith("%");if(M&&l)return;const[d,k]=this.parentDimensions;M||(I.width=`${(100*parseFloat(ee)/d).toFixed(2)}%`),!r(this,p)&&!l&&(I.height=`${(100*parseFloat(q)/k).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(r(this,c))return;const I=le(this,c,document.createElement("button"));I.className="altText";const q=await K._l10nPromise.get("editor_alt_text_button_label");I.textContent=q,I.setAttribute("aria-label",q),I.tabIndex="0",I.addEventListener("contextmenu",a.noContextMenu),I.addEventListener("pointerdown",ee=>ee.stopPropagation()),I.addEventListener("click",ee=>{ee.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),I.addEventListener("keydown",ee=>{ee.target===I&&ee.key==="Enter"&&(ee.preventDefault(),this._uiManager.editAltText(this))}),J(this,R,Bt).call(this),this.div.append(I),K.SMALL_EDITOR_SIZE||(K.SMALL_EDITOR_SIZE=Math.min(128,Math.round(I.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:r(this,S),decorative:r(this,E)}}set altTextData({altText:I,decorative:q}){r(this,S)===I&&r(this,E)===q||(le(this,S,I),le(this,E,q),J(this,R,Bt).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",r(this,A)),this.div.addEventListener("focusout",r(this,f));const[I,q]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*q/I).toFixed(2)}%`,this.div.style.maxHeight=`${(100*I/q).toFixed(2)}%`);const[ee,M]=this.getInitialTranslation();return this.translate(ee,M),(0,e.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(I){const{isMac:q}=s.FeatureTest.platform;if(I.button!==0||I.ctrlKey&&q){I.preventDefault();return}le(this,u,!0),J(this,R,As).call(this,I)}moveInDOM(){var I;(I=this.parent)==null||I.moveEditorInDOM(this)}_setParentAndPosition(I,q,ee){I.changeParent(this),this.x=q,this.y=ee,this.fixAndSetPosition()}getRect(I,q){const ee=this.parentScale,[M,l]=this.pageDimensions,[d,k]=this.pageTranslation,B=I/ee,G=q/ee,W=this.x*M,$=this.y*l,ce=this.width*M,me=this.height*l;switch(this.rotation){case 0:return[W+B+d,l-$-G-me+k,W+B+ce+d,l-$-G+k];case 90:return[W+G+d,l-$+B+k,W+G+me+d,l-$+B+ce+k];case 180:return[W-B-ce+d,l-$+G+k,W-B+d,l-$+G+me+k];case 270:return[W-G-me+d,l-$-B-ce+k,W-G+d,l-$-B+k];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(I,q){const[ee,M,l,d]=I,k=l-ee,B=d-M;switch(this.rotation){case 0:return[ee,q-d,k,B];case 90:return[ee,q-M,B,k];case 180:return[l,q-M,k,B];case 270:return[l,q-d,B,k];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){le(this,F,!0)}disableEditMode(){le(this,F,!1)}isInEditMode(){return r(this,F)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var I,q;(I=this.div)==null||I.addEventListener("focusin",r(this,A)),(q=this.div)==null||q.addEventListener("focusout",r(this,f))}serialize(I=!1,q=null){(0,s.unreachable)("An editor must be serializable")}static deserialize(I,q,ee){const M=new this.prototype.constructor({parent:q,id:q.getNextId(),uiManager:ee});M.rotation=I.rotation;const[l,d]=M.pageDimensions,[k,B,G,W]=M.getRectInCurrentCoords(I.rect,d);return M.x=k/l,M.y=B/d,M.width=G/l,M.height=W/d,M}remove(){var I;this.div.removeEventListener("focusin",r(this,A)),this.div.removeEventListener("focusout",r(this,f)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(I=r(this,c))==null||I.remove(),le(this,c,null),le(this,v,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(J(this,R,vs).call(this),r(this,_).classList.remove("hidden"))}select(){var I;this.makeResizable(),(I=this.div)==null||I.classList.add("selectedEditor")}unselect(){var I,q,ee;(I=r(this,_))==null||I.classList.add("hidden"),(q=this.div)==null||q.classList.remove("selectedEditor"),(ee=this.div)!=null&&ee.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(I,q){}disableEditing(){r(this,c)&&(r(this,c).hidden=!0)}enableEditing(){r(this,c)&&(r(this,c).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return r(this,C)}set isEditing(I){le(this,C,I),this.parent&&(I?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(I,q){le(this,p,!0);const ee=I/q,{style:M}=this.div;M.aspectRatio=ee,M.height="auto"}static get MIN_SIZE(){return 16}};S=new WeakMap,E=new WeakMap,c=new WeakMap,v=new WeakMap,x=new WeakMap,p=new WeakMap,_=new WeakMap,A=new WeakMap,f=new WeakMap,u=new WeakMap,C=new WeakMap,F=new WeakMap,w=new WeakMap,h=new WeakMap,R=new WeakSet,It=function([I,q],ee,M){[ee,M]=this.screenToPageTranslation(ee,M),this.x+=ee/I,this.y+=M/q,this.fixAndSetPosition()},Ot=function(){const[I,q]=this.parentDimensions,{_borderLineWidth:ee}=K,M=ee/I,l=ee/q;switch(this.rotation){case 90:return[-M,l];case 180:return[M,l];case 270:return[M,-l];default:return[-M,-l]}},y=new WeakSet,Lt=function(I,q,ee){switch(ee){case 90:return[q,-I];case 180:return[-I,-q];case 270:return[-q,I];default:return[I,q]}},zt=function(I){switch(I){case 90:{const[q,ee]=this.pageDimensions;return[0,-q/ee,ee/q,0]}case 180:return[-1,0,0,-1];case 270:{const[q,ee]=this.pageDimensions;return[0,q/ee,-ee/q,0]}default:return[1,0,0,1]}},vs=function(){if(r(this,_))return;le(this,_,document.createElement("div")),r(this,_).classList.add("resizers");const I=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||I.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const q of I){const ee=document.createElement("div");r(this,_).append(ee),ee.classList.add("resizer",q),ee.addEventListener("pointerdown",J(this,R,ys).bind(this,q)),ee.addEventListener("contextmenu",a.noContextMenu)}this.div.prepend(r(this,_))},ys=function(I,q){q.preventDefault();const{isMac:ee}=s.FeatureTest.platform;if(q.button!==0||q.ctrlKey&&ee)return;const M=J(this,R,Es).bind(this,I),l=this._isDraggable;this._isDraggable=!1;const d={passive:!0,capture:!0};window.addEventListener("pointermove",M,d);const k=this.x,B=this.y,G=this.width,W=this.height,$=this.parent.div.style.cursor,ce=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(q.target).cursor;const me=()=>{this._isDraggable=l,window.removeEventListener("pointerup",me),window.removeEventListener("blur",me),window.removeEventListener("pointermove",M,d),this.parent.div.style.cursor=$,this.div.style.cursor=ce;const fe=this.x,be=this.y,Ee=this.width,je=this.height;fe===k&&be===B&&Ee===G&&je===W||this.addCommands({cmd:()=>{this.width=Ee,this.height=je,this.x=fe,this.y=be;const[ie,ae]=this.parentDimensions;this.setDims(ie*Ee,ae*je),this.fixAndSetPosition()},undo:()=>{this.width=G,this.height=W,this.x=k,this.y=B;const[ie,ae]=this.parentDimensions;this.setDims(ie*G,ae*W),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",me),window.addEventListener("blur",me)},Es=function(I,q){const[ee,M]=this.parentDimensions,l=this.x,d=this.y,k=this.width,B=this.height,G=K.MIN_SIZE/ee,W=K.MIN_SIZE/M,$=Me=>Math.round(Me*1e4)/1e4,ce=J(this,R,zt).call(this,this.rotation),me=(Me,ze)=>[ce[0]*Me+ce[2]*ze,ce[1]*Me+ce[3]*ze],fe=J(this,R,zt).call(this,360-this.rotation),be=(Me,ze)=>[fe[0]*Me+fe[2]*ze,fe[1]*Me+fe[3]*ze];let Ee,je,ie=!1,ae=!1;switch(I){case"topLeft":ie=!0,Ee=(Me,ze)=>[0,0],je=(Me,ze)=>[Me,ze];break;case"topMiddle":Ee=(Me,ze)=>[Me/2,0],je=(Me,ze)=>[Me/2,ze];break;case"topRight":ie=!0,Ee=(Me,ze)=>[Me,0],je=(Me,ze)=>[0,ze];break;case"middleRight":ae=!0,Ee=(Me,ze)=>[Me,ze/2],je=(Me,ze)=>[0,ze/2];break;case"bottomRight":ie=!0,Ee=(Me,ze)=>[Me,ze],je=(Me,ze)=>[0,0];break;case"bottomMiddle":Ee=(Me,ze)=>[Me/2,ze],je=(Me,ze)=>[Me/2,0];break;case"bottomLeft":ie=!0,Ee=(Me,ze)=>[0,ze],je=(Me,ze)=>[Me,0];break;case"middleLeft":ae=!0,Ee=(Me,ze)=>[0,ze/2],je=(Me,ze)=>[Me,ze/2];break}const P=Ee(k,B),H=je(k,B);let Z=me(...H);const ne=$(l+Z[0]),xe=$(d+Z[1]);let Re=1,Ae=1,[te,we]=this.screenToPageTranslation(q.movementX,q.movementY);if([te,we]=be(te/ee,we/M),ie){const Me=Math.hypot(k,B);Re=Ae=Math.max(Math.min(Math.hypot(H[0]-P[0]-te,H[1]-P[1]-we)/Me,1/k,1/B),G/k,W/B)}else ae?Re=Math.max(G,Math.min(1,Math.abs(H[0]-P[0]-te)))/k:Ae=Math.max(W,Math.min(1,Math.abs(H[1]-P[1]-we)))/B;const Se=$(k*Re),We=$(B*Ae);Z=me(...je(Se,We));const Be=ne-Z[0],Xe=xe-Z[1];this.width=Se,this.height=We,this.x=Be,this.y=Xe,this.setDims(ee*Se,M*We),this.fixAndSetPosition()},Bt=async function(){var ee;const I=r(this,c);if(!I)return;if(!r(this,S)&&!r(this,E)){I.classList.remove("done"),(ee=r(this,v))==null||ee.remove();return}K._l10nPromise.get("editor_alt_text_edit_button_label").then(M=>{I.setAttribute("aria-label",M)});let q=r(this,v);if(!q){le(this,v,q=document.createElement("span")),q.className="tooltip",q.setAttribute("role","tooltip");const M=q.id=`alt-text-tooltip-${this.id}`;I.setAttribute("aria-describedby",M);const l=100;I.addEventListener("mouseenter",()=>{le(this,x,setTimeout(()=>{le(this,x,null),r(this,v).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},l))}),I.addEventListener("mouseleave",()=>{var d;clearTimeout(r(this,x)),le(this,x,null),(d=r(this,v))==null||d.classList.remove("show")})}I.classList.add("done"),q.innerText=r(this,E)?await K._l10nPromise.get("editor_alt_text_decorative_tooltip"):r(this,S),q.parentNode||I.append(q)},As=function(I){if(!this._isDraggable)return;const q=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let ee,M;q&&(ee={passive:!0,capture:!0},M=d=>{const[k,B]=this.screenToPageTranslation(d.movementX,d.movementY);this._uiManager.dragSelectedEditors(k,B)},window.addEventListener("pointermove",M,ee));const l=()=>{if(window.removeEventListener("pointerup",l),window.removeEventListener("blur",l),q&&window.removeEventListener("pointermove",M,ee),le(this,u,!1),!this._uiManager.endDragSession()){const{isMac:d}=s.FeatureTest.platform;I.ctrlKey&&!d||I.shiftKey||I.metaKey&&d?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",l),window.addEventListener("blur",l)},re(K,y),Ze(K,"_borderLineWidth",-1),Ze(K,"_colorManager",new e.ColorManager),Ze(K,"_zIndex",1),Ze(K,"SMALL_EDITOR_SIZE",0);let o=K;t.AnnotationEditor=o;class D extends o{constructor(I){super(I),this.annotationElementId=I.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(n,t,i)=>{var p,_,A,f,u,Gt,w,h,R,b,j,js,g,T,z,se,V,Q,K,ue,I,q,ee,M,l,d,k,B,G,W,$,ce,me,fe,be,Ee,je,ie,ae,P,H,Z,ne,xe,Re,Ae,te,Rs,Wt,Ht,At,Ut,Vt,tt,pt,_s,Ss,qt,mt,Xt;Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardManager=t.CommandManager=t.ColorManager=t.AnnotationEditorUIManager=void 0,t.bindEvents=a,t.opacityToHex=o;var e=i(1),s=i(6);function a(Ve,U,ge){for(const Ce of ge)U.addEventListener(Ce,Ve[Ce].bind(Ve))}function o(Ve){return Math.round(Math.min(255,Math.max(1,255*Ve))).toString(16).padStart(2,"0")}class D{constructor(){re(this,p,0)}getId(){return`${e.AnnotationEditorPrefix}${ht(this,p)._++}`}}p=new WeakMap;const F=class F{constructor(){re(this,u);re(this,_,(0,e.getUuid)());re(this,A,0);re(this,f,null)}static get _isSVGFittingCanvas(){const U='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Ce=new OffscreenCanvas(1,3).getContext("2d"),De=new Image;De.src=U;const Le=De.decode().then(()=>(Ce.drawImage(De,0,0,1,1,0,0,1,3),new Uint32Array(Ce.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,e.shadow)(this,"_isSVGFittingCanvas",Le)}async getFromFile(U){const{lastModified:ge,name:Ce,size:De,type:Le}=U;return J(this,u,Gt).call(this,`${ge}_${Ce}_${De}_${Le}`,U)}async getFromUrl(U){return J(this,u,Gt).call(this,U,U)}async getFromId(U){r(this,f)||le(this,f,new Map);const ge=r(this,f).get(U);return ge?ge.bitmap?(ge.refCounter+=1,ge):ge.file?this.getFromFile(ge.file):this.getFromUrl(ge.url):null}getSvgUrl(U){const ge=r(this,f).get(U);return ge!=null&&ge.isSvg?ge.svgUrl:null}deleteId(U){r(this,f)||le(this,f,new Map);const ge=r(this,f).get(U);ge&&(ge.refCounter-=1,ge.refCounter===0&&(ge.bitmap=null))}isValidId(U){return U.startsWith(`image_${r(this,_)}_`)}};_=new WeakMap,A=new WeakMap,f=new WeakMap,u=new WeakSet,Gt=async function(U,ge){r(this,f)||le(this,f,new Map);let Ce=r(this,f).get(U);if(Ce===null)return null;if(Ce!=null&&Ce.bitmap)return Ce.refCounter+=1,Ce;try{Ce||(Ce={bitmap:null,id:`image_${r(this,_)}_${ht(this,A)._++}`,refCounter:0,isSvg:!1});let De;if(typeof ge=="string"){Ce.url=ge;const Le=await fetch(ge);if(!Le.ok)throw new Error(Le.statusText);De=await Le.blob()}else De=Ce.file=ge;if(De.type==="image/svg+xml"){const Le=F._isSVGFittingCanvas,ke=new FileReader,O=new Image,N=new Promise((Y,he)=>{O.onload=()=>{Ce.bitmap=O,Ce.isSvg=!0,Y()},ke.onload=async()=>{const pe=Ce.svgUrl=ke.result;O.src=await Le?`${pe}#svgView(preserveAspectRatio(none))`:pe},O.onerror=ke.onerror=he});ke.readAsDataURL(De),await N}else Ce.bitmap=await createImageBitmap(De);Ce.refCounter=1}catch(De){console.error(De),Ce=null}return r(this,f).set(U,Ce),Ce&&r(this,f).set(Ce.id,Ce),Ce};let S=F;class E{constructor(U=128){re(this,w,[]);re(this,h,!1);re(this,R);re(this,b,-1);le(this,R,U)}add({cmd:U,undo:ge,mustExec:Ce,type:De=NaN,overwriteIfSameType:Le=!1,keepUndo:ke=!1}){if(Ce&&U(),r(this,h))return;const O={cmd:U,undo:ge,type:De};if(r(this,b)===-1){r(this,w).length>0&&(r(this,w).length=0),le(this,b,0),r(this,w).push(O);return}if(Le&&r(this,w)[r(this,b)].type===De){ke&&(O.undo=r(this,w)[r(this,b)].undo),r(this,w)[r(this,b)]=O;return}const N=r(this,b)+1;N===r(this,R)?r(this,w).splice(0,1):(le(this,b,N),N<r(this,w).length&&r(this,w).splice(N)),r(this,w).push(O)}undo(){r(this,b)!==-1&&(le(this,h,!0),r(this,w)[r(this,b)].undo(),le(this,h,!1),le(this,b,r(this,b)-1))}redo(){r(this,b)<r(this,w).length-1&&(le(this,b,r(this,b)+1),le(this,h,!0),r(this,w)[r(this,b)].cmd(),le(this,h,!1))}hasSomethingToUndo(){return r(this,b)!==-1}hasSomethingToRedo(){return r(this,b)<r(this,w).length-1}destroy(){le(this,w,null)}}w=new WeakMap,h=new WeakMap,R=new WeakMap,b=new WeakMap,t.CommandManager=E;class c{constructor(U){re(this,j);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:ge}=e.FeatureTest.platform;for(const[Ce,De,Le={}]of U)for(const ke of Ce){const O=ke.startsWith("mac+");ge&&O?(this.callbacks.set(ke.slice(4),{callback:De,options:Le}),this.allKeys.add(ke.split("+").at(-1))):!ge&&!O&&(this.callbacks.set(ke,{callback:De,options:Le}),this.allKeys.add(ke.split("+").at(-1)))}}exec(U,ge){if(!this.allKeys.has(ge.key))return;const Ce=this.callbacks.get(J(this,j,js).call(this,ge));if(!Ce)return;const{callback:De,options:{bubbles:Le=!1,args:ke=[],checker:O=null}}=Ce;O&&!O(U,ge)||(De.bind(U,...ke)(),Le||(ge.stopPropagation(),ge.preventDefault()))}}j=new WeakSet,js=function(U){U.altKey&&this.buffer.push("alt"),U.ctrlKey&&this.buffer.push("ctrl"),U.metaKey&&this.buffer.push("meta"),U.shiftKey&&this.buffer.push("shift"),this.buffer.push(U.key);const ge=this.buffer.join("+");return this.buffer.length=0,ge},t.KeyboardManager=c;const L=class L{get _colors(){const U=new Map([["CanvasText",null],["Canvas",null]]);return(0,s.getColorValues)(U),(0,e.shadow)(this,"_colors",U)}convert(U){const ge=(0,s.getRGB)(U);if(!window.matchMedia("(forced-colors: active)").matches)return ge;for(const[Ce,De]of this._colors)if(De.every((Le,ke)=>Le===ge[ke]))return L._colorsMapping.get(Ce);return ge}getHexCode(U){const ge=this._colors.get(U);return ge?e.Util.makeHexColor(...ge):U}};Ze(L,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let v=L;t.ColorManager=v;const qe=class qe{constructor(U,ge,Ce,De,Le,ke){re(this,te);re(this,g,null);re(this,T,new Map);re(this,z,new Map);re(this,se,null);re(this,V,null);re(this,Q,new E);re(this,K,0);re(this,ue,new Set);re(this,I,null);re(this,q,null);re(this,ee,new Set);re(this,M,null);re(this,l,new D);re(this,d,!1);re(this,k,!1);re(this,B,null);re(this,G,e.AnnotationEditorType.NONE);re(this,W,new Set);re(this,$,null);re(this,ce,this.blur.bind(this));re(this,me,this.focus.bind(this));re(this,fe,this.copy.bind(this));re(this,be,this.cut.bind(this));re(this,Ee,this.paste.bind(this));re(this,je,this.keydown.bind(this));re(this,ie,this.onEditingAction.bind(this));re(this,ae,this.onPageChanging.bind(this));re(this,P,this.onScaleChanging.bind(this));re(this,H,this.onRotationChanging.bind(this));re(this,Z,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});re(this,ne,[0,0]);re(this,xe,null);re(this,Re,null);re(this,Ae,null);le(this,Re,U),le(this,Ae,ge),le(this,se,Ce),this._eventBus=De,this._eventBus._on("editingaction",r(this,ie)),this._eventBus._on("pagechanging",r(this,ae)),this._eventBus._on("scalechanging",r(this,P)),this._eventBus._on("rotationchanging",r(this,H)),le(this,V,Le.annotationStorage),le(this,M,Le.filterFactory),le(this,$,ke),this.viewParameters={realScale:s.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const U=qe.prototype,ge=Le=>{const{activeElement:ke}=document;return ke&&r(Le,Re).contains(ke)&&Le.hasSomethingToControl()},Ce=this.TRANSLATE_SMALL,De=this.TRANSLATE_BIG;return(0,e.shadow)(this,"_keyboardManager",new c([[["ctrl+a","mac+meta+a"],U.selectAll],[["ctrl+z","mac+meta+z"],U.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],U.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],U.delete],[["Escape","mac+Escape"],U.unselectAll],[["ArrowLeft","mac+ArrowLeft"],U.translateSelectedEditors,{args:[-Ce,0],checker:ge}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],U.translateSelectedEditors,{args:[-De,0],checker:ge}],[["ArrowRight","mac+ArrowRight"],U.translateSelectedEditors,{args:[Ce,0],checker:ge}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],U.translateSelectedEditors,{args:[De,0],checker:ge}],[["ArrowUp","mac+ArrowUp"],U.translateSelectedEditors,{args:[0,-Ce],checker:ge}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],U.translateSelectedEditors,{args:[0,-De],checker:ge}],[["ArrowDown","mac+ArrowDown"],U.translateSelectedEditors,{args:[0,Ce],checker:ge}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],U.translateSelectedEditors,{args:[0,De],checker:ge}]]))}destroy(){J(this,te,At).call(this),J(this,te,Wt).call(this),this._eventBus._off("editingaction",r(this,ie)),this._eventBus._off("pagechanging",r(this,ae)),this._eventBus._off("scalechanging",r(this,P)),this._eventBus._off("rotationchanging",r(this,H));for(const U of r(this,z).values())U.destroy();r(this,z).clear(),r(this,T).clear(),r(this,ee).clear(),le(this,g,null),r(this,W).clear(),r(this,Q).destroy(),r(this,se).destroy()}get hcmFilter(){return(0,e.shadow)(this,"hcmFilter",r(this,$)?r(this,M).addHCMFilter(r(this,$).foreground,r(this,$).background):"none")}get direction(){return(0,e.shadow)(this,"direction",getComputedStyle(r(this,Re)).direction)}editAltText(U){var ge;(ge=r(this,se))==null||ge.editAltText(this,U)}onPageChanging({pageNumber:U}){le(this,K,U-1)}focusMainContainer(){r(this,Re).focus()}findParent(U,ge){for(const Ce of r(this,z).values()){const{x:De,y:Le,width:ke,height:O}=Ce.div.getBoundingClientRect();if(U>=De&&U<=De+ke&&ge>=Le&&ge<=Le+O)return Ce}return null}disableUserSelect(U=!1){r(this,Ae).classList.toggle("noUserSelect",U)}addShouldRescale(U){r(this,ee).add(U)}removeShouldRescale(U){r(this,ee).delete(U)}onScaleChanging({scale:U}){this.commitOrRemove(),this.viewParameters.realScale=U*s.PixelsPerInch.PDF_TO_CSS_UNITS;for(const ge of r(this,ee))ge.onScaleChanging()}onRotationChanging({pagesRotation:U}){this.commitOrRemove(),this.viewParameters.rotation=U}addToAnnotationStorage(U){!U.isEmpty()&&r(this,V)&&!r(this,V).has(U.id)&&r(this,V).setValue(U.id,U)}blur(){if(!this.hasSelection)return;const{activeElement:U}=document;for(const ge of r(this,W))if(ge.div.contains(U)){le(this,B,[ge,U]),ge._focusEventsAllowed=!1;break}}focus(){if(!r(this,B))return;const[U,ge]=r(this,B);le(this,B,null),ge.addEventListener("focusin",()=>{U._focusEventsAllowed=!0},{once:!0}),ge.focus()}addEditListeners(){J(this,te,Ht).call(this),J(this,te,Ut).call(this)}removeEditListeners(){J(this,te,At).call(this),J(this,te,Vt).call(this)}copy(U){var Ce;if(U.preventDefault(),(Ce=r(this,g))==null||Ce.commitOrRemove(),!this.hasSelection)return;const ge=[];for(const De of r(this,W)){const Le=De.serialize(!0);Le&&ge.push(Le)}ge.length!==0&&U.clipboardData.setData("application/pdfjs",JSON.stringify(ge))}cut(U){this.copy(U),this.delete()}paste(U){U.preventDefault();const{clipboardData:ge}=U;for(const Le of ge.items)for(const ke of r(this,q))if(ke.isHandlingMimeForPasting(Le.type)){ke.paste(Le,this.currentLayer);return}let Ce=ge.getData("application/pdfjs");if(!Ce)return;try{Ce=JSON.parse(Ce)}catch(Le){(0,e.warn)(`paste: "${Le.message}".`);return}if(!Array.isArray(Ce))return;this.unselectAll();const De=this.currentLayer;try{const Le=[];for(const N of Ce){const Y=De.deserialize(N);if(!Y)return;Le.push(Y)}const ke=()=>{for(const N of Le)J(this,te,qt).call(this,N);J(this,te,Xt).call(this,Le)},O=()=>{for(const N of Le)N.remove()};this.addCommands({cmd:ke,undo:O,mustExec:!0})}catch(Le){(0,e.warn)(`paste: "${Le.message}".`)}}keydown(U){var ge;(ge=this.getActive())!=null&&ge.shouldGetKeyboardEvents()||qe._keyboardManager.exec(this,U)}onEditingAction(U){["undo","redo","delete","selectAll"].includes(U.name)&&this[U.name]()}setEditingState(U){U?(J(this,te,Rs).call(this),J(this,te,Ht).call(this),J(this,te,Ut).call(this),J(this,te,tt).call(this,{isEditing:r(this,G)!==e.AnnotationEditorType.NONE,isEmpty:J(this,te,mt).call(this),hasSomethingToUndo:r(this,Q).hasSomethingToUndo(),hasSomethingToRedo:r(this,Q).hasSomethingToRedo(),hasSelectedEditor:!1})):(J(this,te,Wt).call(this),J(this,te,At).call(this),J(this,te,Vt).call(this),J(this,te,tt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(U){if(!r(this,q)){le(this,q,U);for(const ge of r(this,q))J(this,te,pt).call(this,ge.defaultPropertiesToUpdate)}}getId(){return r(this,l).getId()}get currentLayer(){return r(this,z).get(r(this,K))}getLayer(U){return r(this,z).get(U)}get currentPageIndex(){return r(this,K)}addLayer(U){r(this,z).set(U.pageIndex,U),r(this,d)?U.enable():U.disable()}removeLayer(U){r(this,z).delete(U.pageIndex)}updateMode(U,ge=null){if(r(this,G)!==U){if(le(this,G,U),U===e.AnnotationEditorType.NONE){this.setEditingState(!1),J(this,te,Ss).call(this);return}this.setEditingState(!0),J(this,te,_s).call(this),this.unselectAll();for(const Ce of r(this,z).values())Ce.updateMode(U);if(ge){for(const Ce of r(this,T).values())if(Ce.annotationElementId===ge){this.setSelected(Ce),Ce.enterInEditMode();break}}}}updateToolbar(U){U!==r(this,G)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:U})}updateParams(U,ge){if(r(this,q)){if(U===e.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(U);return}for(const Ce of r(this,W))Ce.updateParams(U,ge);for(const Ce of r(this,q))Ce.updateDefaultParams(U,ge)}}enableWaiting(U=!1){if(r(this,k)!==U){le(this,k,U);for(const ge of r(this,z).values())U?ge.disableClick():ge.enableClick(),ge.div.classList.toggle("waiting",U)}}getEditors(U){const ge=[];for(const Ce of r(this,T).values())Ce.pageIndex===U&&ge.push(Ce);return ge}getEditor(U){return r(this,T).get(U)}addEditor(U){r(this,T).set(U.id,U)}removeEditor(U){var ge;r(this,T).delete(U.id),this.unselect(U),(!U.annotationElementId||!r(this,ue).has(U.annotationElementId))&&((ge=r(this,V))==null||ge.remove(U.id))}addDeletedAnnotationElement(U){r(this,ue).add(U.annotationElementId),U.deleted=!0}isDeletedAnnotationElement(U){return r(this,ue).has(U)}removeDeletedAnnotationElement(U){r(this,ue).delete(U.annotationElementId),U.deleted=!1}setActiveEditor(U){r(this,g)!==U&&(le(this,g,U),U&&J(this,te,pt).call(this,U.propertiesToUpdate))}toggleSelected(U){if(r(this,W).has(U)){r(this,W).delete(U),U.unselect(),J(this,te,tt).call(this,{hasSelectedEditor:this.hasSelection});return}r(this,W).add(U),U.select(),J(this,te,pt).call(this,U.propertiesToUpdate),J(this,te,tt).call(this,{hasSelectedEditor:!0})}setSelected(U){for(const ge of r(this,W))ge!==U&&ge.unselect();r(this,W).clear(),r(this,W).add(U),U.select(),J(this,te,pt).call(this,U.propertiesToUpdate),J(this,te,tt).call(this,{hasSelectedEditor:!0})}isSelected(U){return r(this,W).has(U)}unselect(U){U.unselect(),r(this,W).delete(U),J(this,te,tt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return r(this,W).size!==0}undo(){r(this,Q).undo(),J(this,te,tt).call(this,{hasSomethingToUndo:r(this,Q).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:J(this,te,mt).call(this)})}redo(){r(this,Q).redo(),J(this,te,tt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:r(this,Q).hasSomethingToRedo(),isEmpty:J(this,te,mt).call(this)})}addCommands(U){r(this,Q).add(U),J(this,te,tt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:J(this,te,mt).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const U=[...r(this,W)],ge=()=>{for(const De of U)De.remove()},Ce=()=>{for(const De of U)J(this,te,qt).call(this,De)};this.addCommands({cmd:ge,undo:Ce,mustExec:!0})}commitOrRemove(){var U;(U=r(this,g))==null||U.commitOrRemove()}hasSomethingToControl(){return r(this,g)||this.hasSelection}selectAll(){for(const U of r(this,W))U.commit();J(this,te,Xt).call(this,r(this,T).values())}unselectAll(){if(r(this,g)){r(this,g).commitOrRemove();return}if(this.hasSelection){for(const U of r(this,W))U.unselect();r(this,W).clear(),J(this,te,tt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(U,ge,Ce=!1){if(Ce||this.commitOrRemove(),!this.hasSelection)return;r(this,ne)[0]+=U,r(this,ne)[1]+=ge;const[De,Le]=r(this,ne),ke=[...r(this,W)],O=1e3;r(this,xe)&&clearTimeout(r(this,xe)),le(this,xe,setTimeout(()=>{le(this,xe,null),r(this,ne)[0]=r(this,ne)[1]=0,this.addCommands({cmd:()=>{for(const N of ke)r(this,T).has(N.id)&&N.translateInPage(De,Le)},undo:()=>{for(const N of ke)r(this,T).has(N.id)&&N.translateInPage(-De,-Le)},mustExec:!1})},O));for(const N of ke)N.translateInPage(U,ge)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),le(this,I,new Map);for(const U of r(this,W))r(this,I).set(U,{savedX:U.x,savedY:U.y,savedPageIndex:U.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!r(this,I))return!1;this.disableUserSelect(!1);const U=r(this,I);le(this,I,null);let ge=!1;for(const[{x:De,y:Le,pageIndex:ke},O]of U)O.newX=De,O.newY=Le,O.newPageIndex=ke,ge||(ge=De!==O.savedX||Le!==O.savedY||ke!==O.savedPageIndex);if(!ge)return!1;const Ce=(De,Le,ke,O)=>{if(r(this,T).has(De.id)){const N=r(this,z).get(O);N?De._setParentAndPosition(N,Le,ke):(De.pageIndex=O,De.x=Le,De.y=ke)}};return this.addCommands({cmd:()=>{for(const[De,{newX:Le,newY:ke,newPageIndex:O}]of U)Ce(De,Le,ke,O)},undo:()=>{for(const[De,{savedX:Le,savedY:ke,savedPageIndex:O}]of U)Ce(De,Le,ke,O)},mustExec:!0}),!0}dragSelectedEditors(U,ge){if(r(this,I))for(const Ce of r(this,I).keys())Ce.drag(U,ge)}rebuild(U){if(U.parent===null){const ge=this.getLayer(U.pageIndex);ge?(ge.changeParent(U),ge.addOrRebuild(U)):(this.addEditor(U),this.addToAnnotationStorage(U),U.rebuild())}else U.parent.addOrRebuild(U)}isActive(U){return r(this,g)===U}getActive(){return r(this,g)}getMode(){return r(this,G)}get imageManager(){return(0,e.shadow)(this,"imageManager",new S)}};g=new WeakMap,T=new WeakMap,z=new WeakMap,se=new WeakMap,V=new WeakMap,Q=new WeakMap,K=new WeakMap,ue=new WeakMap,I=new WeakMap,q=new WeakMap,ee=new WeakMap,M=new WeakMap,l=new WeakMap,d=new WeakMap,k=new WeakMap,B=new WeakMap,G=new WeakMap,W=new WeakMap,$=new WeakMap,ce=new WeakMap,me=new WeakMap,fe=new WeakMap,be=new WeakMap,Ee=new WeakMap,je=new WeakMap,ie=new WeakMap,ae=new WeakMap,P=new WeakMap,H=new WeakMap,Z=new WeakMap,ne=new WeakMap,xe=new WeakMap,Re=new WeakMap,Ae=new WeakMap,te=new WeakSet,Rs=function(){window.addEventListener("focus",r(this,me)),window.addEventListener("blur",r(this,ce))},Wt=function(){window.removeEventListener("focus",r(this,me)),window.removeEventListener("blur",r(this,ce))},Ht=function(){window.addEventListener("keydown",r(this,je),{capture:!0})},At=function(){window.removeEventListener("keydown",r(this,je),{capture:!0})},Ut=function(){document.addEventListener("copy",r(this,fe)),document.addEventListener("cut",r(this,be)),document.addEventListener("paste",r(this,Ee))},Vt=function(){document.removeEventListener("copy",r(this,fe)),document.removeEventListener("cut",r(this,be)),document.removeEventListener("paste",r(this,Ee))},tt=function(U){Object.entries(U).some(([Ce,De])=>r(this,Z)[Ce]!==De)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(r(this,Z),U)})},pt=function(U){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:U})},_s=function(){if(!r(this,d)){le(this,d,!0);for(const U of r(this,z).values())U.enable()}},Ss=function(){if(this.unselectAll(),r(this,d)){le(this,d,!1);for(const U of r(this,z).values())U.disable()}},qt=function(U){const ge=r(this,z).get(U.pageIndex);ge?ge.addOrRebuild(U):this.addEditor(U)},mt=function(){if(r(this,T).size===0)return!0;if(r(this,T).size===1)for(const U of r(this,T).values())return U.isEmpty();return!1},Xt=function(U){r(this,W).clear();for(const ge of U)ge.isEmpty()||(r(this,W).add(ge),ge.select());J(this,te,tt).call(this,{hasSelectedEditor:!0})},Ze(qe,"TRANSLATE_SMALL",1),Ze(qe,"TRANSLATE_BIG",10);let x=qe;t.AnnotationEditorUIManager=x},(n,t,i)=>{var K,ue,I,q,ee,M,l,d,k,B,G,W,lt,ct,Kt,jt,Rt,ft,xt;Object.defineProperty(t,"__esModule",{value:!0}),t.StatTimer=t.RenderingCancelledException=t.PixelsPerInch=t.PageViewport=t.PDFDateString=t.DOMStandardFontDataFactory=t.DOMSVGFactory=t.DOMFilterFactory=t.DOMCanvasFactory=t.DOMCMapReaderFactory=void 0,t.deprecated=b,t.getColorValues=T,t.getCurrentTransform=z,t.getCurrentTransformInverse=se,t.getFilenameFromUrl=u,t.getPdfFilenameFromUrl=C,t.getRGB=g,t.getXfaPageViewport=L,t.isDataScheme=A,t.isPdfFile=f,t.isValidFetchUrl=w,t.loadScript=R,t.noContextMenu=h,t.setLayerDimensions=V;var e=i(7),s=i(1);const a="http://www.w3.org/2000/svg",Q=class Q{};Ze(Q,"CSS",96),Ze(Q,"PDF",72),Ze(Q,"PDF_TO_CSS_UNITS",Q.CSS/Q.PDF);let o=Q;t.PixelsPerInch=o;class D extends e.BaseFilterFactory{constructor({docId:P,ownerDocument:H=globalThis.document}={}){super();re(this,W);re(this,K);re(this,ue);re(this,I);re(this,q);re(this,ee);re(this,M);re(this,l);re(this,d);re(this,k);re(this,B);re(this,G,0);le(this,I,P),le(this,q,H)}addFilter(P){if(!P)return"none";let H=r(this,W,lt).get(P);if(H)return H;let Z,ne,xe,Re;if(P.length===1){const Se=P[0],We=new Array(256);for(let Be=0;Be<256;Be++)We[Be]=Se[Be]/255;Re=Z=ne=xe=We.join(",")}else{const[Se,We,Be]=P,Xe=new Array(256),Me=new Array(256),ze=new Array(256);for(let Ke=0;Ke<256;Ke++)Xe[Ke]=Se[Ke]/255,Me[Ke]=We[Ke]/255,ze[Ke]=Be[Ke]/255;Z=Xe.join(","),ne=Me.join(","),xe=ze.join(","),Re=`${Z}${ne}${xe}`}if(H=r(this,W,lt).get(Re),H)return r(this,W,lt).set(P,H),H;const Ae=`g_${r(this,I)}_transfer_map_${ht(this,G)._++}`,te=`url(#${Ae})`;r(this,W,lt).set(P,te),r(this,W,lt).set(Re,te);const we=J(this,W,jt).call(this,Ae);return J(this,W,ft).call(this,Z,ne,xe,we),te}addHCMFilter(P,H){var We;const Z=`${P}-${H}`;if(r(this,M)===Z)return r(this,l);if(le(this,M,Z),le(this,l,"none"),(We=r(this,ee))==null||We.remove(),!P||!H)return r(this,l);const ne=J(this,W,xt).call(this,P);P=s.Util.makeHexColor(...ne);const xe=J(this,W,xt).call(this,H);if(H=s.Util.makeHexColor(...xe),r(this,W,ct).style.color="",P==="#000000"&&H==="#ffffff"||P===H)return r(this,l);const Re=new Array(256);for(let Be=0;Be<=255;Be++){const Xe=Be/255;Re[Be]=Xe<=.03928?Xe/12.92:((Xe+.055)/1.055)**2.4}const Ae=Re.join(","),te=`g_${r(this,I)}_hcm_filter`,we=le(this,d,J(this,W,jt).call(this,te));J(this,W,ft).call(this,Ae,Ae,Ae,we),J(this,W,Kt).call(this,we);const Se=(Be,Xe)=>{const Me=ne[Be]/255,ze=xe[Be]/255,Ke=new Array(Xe+1);for(let $e=0;$e<=Xe;$e++)Ke[$e]=Me+$e/Xe*(ze-Me);return Ke.join(",")};return J(this,W,ft).call(this,Se(0,5),Se(1,5),Se(2,5),we),le(this,l,`url(#${te})`),r(this,l)}addHighlightHCMFilter(P,H,Z,ne){var ze;const xe=`${P}-${H}-${Z}-${ne}`;if(r(this,k)===xe)return r(this,B);if(le(this,k,xe),le(this,B,"none"),(ze=r(this,d))==null||ze.remove(),!P||!H)return r(this,B);const[Re,Ae]=[P,H].map(J(this,W,xt).bind(this));let te=Math.round(.2126*Re[0]+.7152*Re[1]+.0722*Re[2]),we=Math.round(.2126*Ae[0]+.7152*Ae[1]+.0722*Ae[2]),[Se,We]=[Z,ne].map(J(this,W,xt).bind(this));we<te&&([te,we,Se,We]=[we,te,We,Se]),r(this,W,ct).style.color="";const Be=(Ke,$e,ye)=>{const oe=new Array(256),de=(we-te)/ye,Pe=Ke/255,qe=($e-Ke)/(255*ye);let Ve=0;for(let U=0;U<=ye;U++){const ge=Math.round(te+U*de),Ce=Pe+U*qe;for(let De=Ve;De<=ge;De++)oe[De]=Ce;Ve=ge+1}for(let U=Ve;U<256;U++)oe[U]=oe[Ve-1];return oe.join(",")},Xe=`g_${r(this,I)}_hcm_highlight_filter`,Me=le(this,d,J(this,W,jt).call(this,Xe));return J(this,W,Kt).call(this,Me),J(this,W,ft).call(this,Be(Se[0],We[0],5),Be(Se[1],We[1],5),Be(Se[2],We[2],5),Me),le(this,B,`url(#${Xe})`),r(this,B)}destroy(P=!1){P&&(r(this,l)||r(this,B))||(r(this,ue)&&(r(this,ue).parentNode.parentNode.remove(),le(this,ue,null)),r(this,K)&&(r(this,K).clear(),le(this,K,null)),le(this,G,0))}}K=new WeakMap,ue=new WeakMap,I=new WeakMap,q=new WeakMap,ee=new WeakMap,M=new WeakMap,l=new WeakMap,d=new WeakMap,k=new WeakMap,B=new WeakMap,G=new WeakMap,W=new WeakSet,lt=function(){return r(this,K)||le(this,K,new Map)},ct=function(){if(!r(this,ue)){const P=r(this,q).createElement("div"),{style:H}=P;H.visibility="hidden",H.contain="strict",H.width=H.height=0,H.position="absolute",H.top=H.left=0,H.zIndex=-1;const Z=r(this,q).createElementNS(a,"svg");Z.setAttribute("width",0),Z.setAttribute("height",0),le(this,ue,r(this,q).createElementNS(a,"defs")),P.append(Z),Z.append(r(this,ue)),r(this,q).body.append(P)}return r(this,ue)},Kt=function(P){const H=r(this,q).createElementNS(a,"feColorMatrix");H.setAttribute("type","matrix"),H.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),P.append(H)},jt=function(P){const H=r(this,q).createElementNS(a,"filter");return H.setAttribute("color-interpolation-filters","sRGB"),H.setAttribute("id",P),r(this,W,ct).append(H),H},Rt=function(P,H,Z){const ne=r(this,q).createElementNS(a,H);ne.setAttribute("type","discrete"),ne.setAttribute("tableValues",Z),P.append(ne)},ft=function(P,H,Z,ne){const xe=r(this,q).createElementNS(a,"feComponentTransfer");ne.append(xe),J(this,W,Rt).call(this,xe,"feFuncR",P),J(this,W,Rt).call(this,xe,"feFuncG",H),J(this,W,Rt).call(this,xe,"feFuncB",Z)},xt=function(P){return r(this,W,ct).style.color=P,g(getComputedStyle(r(this,W,ct)).getPropertyValue("color"))},t.DOMFilterFactory=D;class S extends e.BaseCanvasFactory{constructor({ownerDocument:ae=globalThis.document}={}){super(),this._document=ae}_createCanvas(ae,P){const H=this._document.createElement("canvas");return H.width=ae,H.height=P,H}}t.DOMCanvasFactory=S;async function E(ie,ae=!1){if(w(ie,document.baseURI)){const P=await fetch(ie);if(!P.ok)throw new Error(P.statusText);return ae?new Uint8Array(await P.arrayBuffer()):(0,s.stringToBytes)(await P.text())}return new Promise((P,H)=>{const Z=new XMLHttpRequest;Z.open("GET",ie,!0),ae&&(Z.responseType="arraybuffer"),Z.onreadystatechange=()=>{if(Z.readyState===XMLHttpRequest.DONE){if(Z.status===200||Z.status===0){let ne;if(ae&&Z.response?ne=new Uint8Array(Z.response):!ae&&Z.responseText&&(ne=(0,s.stringToBytes)(Z.responseText)),ne){P(ne);return}}H(new Error(Z.statusText))}},Z.send(null)})}class c extends e.BaseCMapReaderFactory{_fetchData(ae,P){return E(ae,this.isCompressed).then(H=>({cMapData:H,compressionType:P}))}}t.DOMCMapReaderFactory=c;class v extends e.BaseStandardFontDataFactory{_fetchData(ae){return E(ae,!0)}}t.DOMStandardFontDataFactory=v;class x extends e.BaseSVGFactory{_createSVG(ae){return document.createElementNS(a,ae)}}t.DOMSVGFactory=x;class p{constructor({viewBox:ae,scale:P,rotation:H,offsetX:Z=0,offsetY:ne=0,dontFlip:xe=!1}){this.viewBox=ae,this.scale=P,this.rotation=H,this.offsetX=Z,this.offsetY=ne;const Re=(ae[2]+ae[0])/2,Ae=(ae[3]+ae[1])/2;let te,we,Se,We;switch(H%=360,H<0&&(H+=360),H){case 180:te=-1,we=0,Se=0,We=1;break;case 90:te=0,we=1,Se=1,We=0;break;case 270:te=0,we=-1,Se=-1,We=0;break;case 0:te=1,we=0,Se=0,We=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}xe&&(Se=-Se,We=-We);let Be,Xe,Me,ze;te===0?(Be=Math.abs(Ae-ae[1])*P+Z,Xe=Math.abs(Re-ae[0])*P+ne,Me=(ae[3]-ae[1])*P,ze=(ae[2]-ae[0])*P):(Be=Math.abs(Re-ae[0])*P+Z,Xe=Math.abs(Ae-ae[1])*P+ne,Me=(ae[2]-ae[0])*P,ze=(ae[3]-ae[1])*P),this.transform=[te*P,we*P,Se*P,We*P,Be-te*P*Re-Se*P*Ae,Xe-we*P*Re-We*P*Ae],this.width=Me,this.height=ze}get rawDims(){const{viewBox:ae}=this;return(0,s.shadow)(this,"rawDims",{pageWidth:ae[2]-ae[0],pageHeight:ae[3]-ae[1],pageX:ae[0],pageY:ae[1]})}clone({scale:ae=this.scale,rotation:P=this.rotation,offsetX:H=this.offsetX,offsetY:Z=this.offsetY,dontFlip:ne=!1}={}){return new p({viewBox:this.viewBox.slice(),scale:ae,rotation:P,offsetX:H,offsetY:Z,dontFlip:ne})}convertToViewportPoint(ae,P){return s.Util.applyTransform([ae,P],this.transform)}convertToViewportRectangle(ae){const P=s.Util.applyTransform([ae[0],ae[1]],this.transform),H=s.Util.applyTransform([ae[2],ae[3]],this.transform);return[P[0],P[1],H[0],H[1]]}convertToPdfPoint(ae,P){return s.Util.applyInverseTransform([ae,P],this.transform)}}t.PageViewport=p;class _ extends s.BaseException{constructor(ae,P=0){super(ae,"RenderingCancelledException"),this.extraDelay=P}}t.RenderingCancelledException=_;function A(ie){const ae=ie.length;let P=0;for(;P<ae&&ie[P].trim()==="";)P++;return ie.substring(P,P+5).toLowerCase()==="data:"}function f(ie){return typeof ie=="string"&&/\.pdf$/i.test(ie)}function u(ie,ae=!1){return ae||([ie]=ie.split(/[#?]/,1)),ie.substring(ie.lastIndexOf("/")+1)}function C(ie,ae="document.pdf"){if(typeof ie!="string")return ae;if(A(ie))return(0,s.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),ae;const P=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,H=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Z=P.exec(ie);let ne=H.exec(Z[1])||H.exec(Z[2])||H.exec(Z[3]);if(ne&&(ne=ne[0],ne.includes("%")))try{ne=H.exec(decodeURIComponent(ne))[0]}catch{}return ne||ae}class F{constructor(){Ze(this,"started",Object.create(null));Ze(this,"times",[])}time(ae){ae in this.started&&(0,s.warn)(`Timer is already running for ${ae}`),this.started[ae]=Date.now()}timeEnd(ae){ae in this.started||(0,s.warn)(`Timer has not been started for ${ae}`),this.times.push({name:ae,start:this.started[ae],end:Date.now()}),delete this.started[ae]}toString(){const ae=[];let P=0;for(const{name:H}of this.times)P=Math.max(H.length,P);for(const{name:H,start:Z,end:ne}of this.times)ae.push(`${H.padEnd(P)} ${ne-Z}ms
`);return ae.join("")}}t.StatTimer=F;function w(ie,ae){try{const{protocol:P}=ae?new URL(ie,ae):new URL(ie);return P==="http:"||P==="https:"}catch{return!1}}function h(ie){ie.preventDefault()}function R(ie,ae=!1){return new Promise((P,H)=>{const Z=document.createElement("script");Z.src=ie,Z.onload=function(ne){ae&&Z.remove(),P(ne)},Z.onerror=function(){H(new Error(`Cannot load script at: ${Z.src}`))},(document.head||document.documentElement).append(Z)})}function b(ie){console.log("Deprecated API usage: "+ie)}let j;class y{static toDateObject(ae){if(!ae||typeof ae!="string")return null;j||(j=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const P=j.exec(ae);if(!P)return null;const H=parseInt(P[1],10);let Z=parseInt(P[2],10);Z=Z>=1&&Z<=12?Z-1:0;let ne=parseInt(P[3],10);ne=ne>=1&&ne<=31?ne:1;let xe=parseInt(P[4],10);xe=xe>=0&&xe<=23?xe:0;let Re=parseInt(P[5],10);Re=Re>=0&&Re<=59?Re:0;let Ae=parseInt(P[6],10);Ae=Ae>=0&&Ae<=59?Ae:0;const te=P[7]||"Z";let we=parseInt(P[8],10);we=we>=0&&we<=23?we:0;let Se=parseInt(P[9],10)||0;return Se=Se>=0&&Se<=59?Se:0,te==="-"?(xe+=we,Re+=Se):te==="+"&&(xe-=we,Re-=Se),new Date(Date.UTC(H,Z,ne,xe,Re,Ae))}}t.PDFDateString=y;function L(ie,{scale:ae=1,rotation:P=0}){const{width:H,height:Z}=ie.attributes.style,ne=[0,0,parseInt(H),parseInt(Z)];return new p({viewBox:ne,scale:ae,rotation:P})}function g(ie){if(ie.startsWith("#")){const ae=parseInt(ie.slice(1),16);return[(ae&16711680)>>16,(ae&65280)>>8,ae&255]}return ie.startsWith("rgb(")?ie.slice(4,-1).split(",").map(ae=>parseInt(ae)):ie.startsWith("rgba(")?ie.slice(5,-1).split(",").map(ae=>parseInt(ae)).slice(0,3):((0,s.warn)(`Not a valid color format: "${ie}"`),[0,0,0])}function T(ie){const ae=document.createElement("span");ae.style.visibility="hidden",document.body.append(ae);for(const P of ie.keys()){ae.style.color=P;const H=window.getComputedStyle(ae).color;ie.set(P,g(H))}ae.remove()}function z(ie){const{a:ae,b:P,c:H,d:Z,e:ne,f:xe}=ie.getTransform();return[ae,P,H,Z,ne,xe]}function se(ie){const{a:ae,b:P,c:H,d:Z,e:ne,f:xe}=ie.getTransform().invertSelf();return[ae,P,H,Z,ne,xe]}function V(ie,ae,P=!1,H=!0){if(ae instanceof p){const{pageWidth:Z,pageHeight:ne}=ae.rawDims,{style:xe}=ie,Re=s.FeatureTest.isCSSRoundSupported,Ae=`var(--scale-factor) * ${Z}px`,te=`var(--scale-factor) * ${ne}px`,we=Re?`round(${Ae}, 1px)`:`calc(${Ae})`,Se=Re?`round(${te}, 1px)`:`calc(${te})`;!P||ae.rotation%180===0?(xe.width=we,xe.height=Se):(xe.width=Se,xe.height=we)}H&&ie.setAttribute("data-main-rotation",ae.rotation)}},(n,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStandardFontDataFactory=t.BaseSVGFactory=t.BaseFilterFactory=t.BaseCanvasFactory=t.BaseCMapReaderFactory=void 0;var e=i(1);class s{constructor(){this.constructor===s&&(0,e.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(c){return"none"}addHCMFilter(c,v){return"none"}addHighlightHCMFilter(c,v,x,p){return"none"}destroy(c=!1){}}t.BaseFilterFactory=s;class a{constructor(){this.constructor===a&&(0,e.unreachable)("Cannot initialize BaseCanvasFactory.")}create(c,v){if(c<=0||v<=0)throw new Error("Invalid canvas size");const x=this._createCanvas(c,v);return{canvas:x,context:x.getContext("2d")}}reset(c,v,x){if(!c.canvas)throw new Error("Canvas is not specified");if(v<=0||x<=0)throw new Error("Invalid canvas size");c.canvas.width=v,c.canvas.height=x}destroy(c){if(!c.canvas)throw new Error("Canvas is not specified");c.canvas.width=0,c.canvas.height=0,c.canvas=null,c.context=null}_createCanvas(c,v){(0,e.unreachable)("Abstract method `_createCanvas` called.")}}t.BaseCanvasFactory=a;class o{constructor({baseUrl:c=null,isCompressed:v=!0}){this.constructor===o&&(0,e.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=c,this.isCompressed=v}async fetch({name:c}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!c)throw new Error("CMap name must be specified.");const v=this.baseUrl+c+(this.isCompressed?".bcmap":""),x=this.isCompressed?e.CMapCompressionType.BINARY:e.CMapCompressionType.NONE;return this._fetchData(v,x).catch(p=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${v}`)})}_fetchData(c,v){(0,e.unreachable)("Abstract method `_fetchData` called.")}}t.BaseCMapReaderFactory=o;class D{constructor({baseUrl:c=null}){this.constructor===D&&(0,e.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=c}async fetch({filename:c}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!c)throw new Error("Font filename must be specified.");const v=`${this.baseUrl}${c}`;return this._fetchData(v).catch(x=>{throw new Error(`Unable to load font data at: ${v}`)})}_fetchData(c){(0,e.unreachable)("Abstract method `_fetchData` called.")}}t.BaseStandardFontDataFactory=D;class S{constructor(){this.constructor===S&&(0,e.unreachable)("Cannot initialize BaseSVGFactory.")}create(c,v,x=!1){if(c<=0||v<=0)throw new Error("Invalid SVG dimensions");const p=this._createSVG("svg:svg");return p.setAttribute("version","1.1"),x||(p.setAttribute("width",`${c}px`),p.setAttribute("height",`${v}px`)),p.setAttribute("preserveAspectRatio","none"),p.setAttribute("viewBox",`0 0 ${c} ${v}`),p}createElement(c){if(typeof c!="string")throw new Error("Invalid SVG element type");return this._createSVG(c)}_createSVG(c){(0,e.unreachable)("Abstract method `_createSVG` called.")}}t.BaseSVGFactory=S},(n,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MurmurHash3_64=void 0;var e=i(1);const s=3285377520,a=4294901760,o=65535;class D{constructor(E){this.h1=E?E&4294967295:s,this.h2=E?E&4294967295:s}update(E){let c,v;if(typeof E=="string"){c=new Uint8Array(E.length*2),v=0;for(let b=0,j=E.length;b<j;b++){const y=E.charCodeAt(b);y<=255?c[v++]=y:(c[v++]=y>>>8,c[v++]=y&255)}}else if((0,e.isArrayBuffer)(E))c=E.slice(),v=c.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const x=v>>2,p=v-x*4,_=new Uint32Array(c.buffer,0,x);let A=0,f=0,u=this.h1,C=this.h2;const F=3432918353,w=461845907,h=F&o,R=w&o;for(let b=0;b<x;b++)b&1?(A=_[b],A=A*F&a|A*h&o,A=A<<15|A>>>17,A=A*w&a|A*R&o,u^=A,u=u<<13|u>>>19,u=u*5+3864292196):(f=_[b],f=f*F&a|f*h&o,f=f<<15|f>>>17,f=f*w&a|f*R&o,C^=f,C=C<<13|C>>>19,C=C*5+3864292196);switch(A=0,p){case 3:A^=c[x*4+2]<<16;case 2:A^=c[x*4+1]<<8;case 1:A^=c[x*4],A=A*F&a|A*h&o,A=A<<15|A>>>17,A=A*w&a|A*R&o,x&1?u^=A:C^=A}this.h1=u,this.h2=C}hexdigest(){let E=this.h1,c=this.h2;return E^=c>>>1,E=E*3981806797&a|E*36045&o,c=c*4283543511&a|((c<<16|E>>>16)*2950163797&a)>>>16,E^=c>>>1,E=E*444984403&a|E*60499&o,c=c*3301882366&a|((c<<16|E>>>16)*3120437893&a)>>>16,E^=c>>>1,(E>>>0).toString(16).padStart(8,"0")+(c>>>0).toString(16).padStart(8,"0")}}t.MurmurHash3_64=D},(n,t,i)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var e=i(1);class s{constructor({ownerDocument:S=globalThis.document,styleElement:E=null}){re(this,o,new Set);this._document=S,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(S){this.nativeFontFaces.add(S),this._document.fonts.add(S)}removeNativeFontFace(S){this.nativeFontFaces.delete(S),this._document.fonts.delete(S)}insertRule(S){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const E=this.styleElement.sheet;E.insertRule(S,E.cssRules.length)}clear(){for(const S of this.nativeFontFaces)this._document.fonts.delete(S);this.nativeFontFaces.clear(),r(this,o).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(S){if(!(!S||r(this,o).has(S.loadedName))){if((0,e.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:E,src:c,style:v}=S,x=new FontFace(E,c,v);this.addNativeFontFace(x);try{await x.load(),r(this,o).add(E)}catch{(0,e.warn)(`Cannot load system font: ${S.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(x)}return}(0,e.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(S){if(S.attached||S.missingFile&&!S.systemFontInfo)return;if(S.attached=!0,S.systemFontInfo){await this.loadSystemFont(S.systemFontInfo);return}if(this.isFontLoadingAPISupported){const c=S.createNativeFontFace();if(c){this.addNativeFontFace(c);try{await c.loaded}catch(v){throw(0,e.warn)(`Failed to load font '${c.family}': '${v}'.`),S.disableFontFace=!0,v}}return}const E=S.createFontFaceRule();if(E){if(this.insertRule(E),this.isSyncFontLoadingSupported)return;await new Promise(c=>{const v=this._queueLoadingCallback(c);this._prepareFontLoadEvent(S,v)})}}get isFontLoadingAPISupported(){var E;const S=!!((E=this._document)!=null&&E.fonts);return(0,e.shadow)(this,"isFontLoadingAPISupported",S)}get isSyncFontLoadingSupported(){let S=!1;return(e.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(S=!0),(0,e.shadow)(this,"isSyncFontLoadingSupported",S)}_queueLoadingCallback(S){function E(){for((0,e.assert)(!v.done,"completeRequest() cannot be called twice."),v.done=!0;c.length>0&&c[0].done;){const x=c.shift();setTimeout(x.callback,0)}}const{loadingRequests:c}=this,v={done:!1,complete:E,callback:S};return c.push(v),v}get _loadTestFont(){const S=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,e.shadow)(this,"_loadTestFont",S)}_prepareFontLoadEvent(S,E){function c(g,T){return g.charCodeAt(T)<<24|g.charCodeAt(T+1)<<16|g.charCodeAt(T+2)<<8|g.charCodeAt(T+3)&255}function v(g,T,z,se){const V=g.substring(0,T),Q=g.substring(T+z);return V+se+Q}let x,p;const _=this._document.createElement("canvas");_.width=1,_.height=1;const A=_.getContext("2d");let f=0;function u(g,T){if(++f>30){(0,e.warn)("Load test font never loaded."),T();return}if(A.font="30px "+g,A.fillText(".",0,20),A.getImageData(0,0,1,1).data[3]>0){T();return}setTimeout(u.bind(null,g,T))}const C=`lt${Date.now()}${this.loadTestFontId++}`;let F=this._loadTestFont;F=v(F,976,C.length,C);const h=16,R=1482184792;let b=c(F,h);for(x=0,p=C.length-3;x<p;x+=4)b=b-R+c(C,x)|0;x<C.length&&(b=b-R+c(C+"XXX",x)|0),F=v(F,h,4,(0,e.string32)(b));const j=`url(data:font/opentype;base64,${btoa(F)});`,y=`@font-face {font-family:"${C}";src:${j}}`;this.insertRule(y);const L=this._document.createElement("div");L.style.visibility="hidden",L.style.width=L.style.height="10px",L.style.position="absolute",L.style.top=L.style.left="0px";for(const g of[S.loadedName,C]){const T=this._document.createElement("span");T.textContent="Hi",T.style.fontFamily=g,L.append(T)}this._document.body.append(L),u(C,()=>{L.remove(),E.complete()})}}o=new WeakMap,t.FontLoader=s;class a{constructor(S,{isEvalSupported:E=!0,disableFontFace:c=!1,ignoreErrors:v=!1,inspectFont:x=null}){this.compiledGlyphs=Object.create(null);for(const p in S)this[p]=S[p];this.isEvalSupported=E!==!1,this.disableFontFace=c===!0,this.ignoreErrors=v===!0,this._inspectFont=x}createNativeFontFace(){var E;if(!this.data||this.disableFontFace)return null;let S;if(!this.cssFontInfo)S=new FontFace(this.loadedName,this.data,{});else{const c={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(c.style=`oblique ${this.cssFontInfo.italicAngle}deg`),S=new FontFace(this.cssFontInfo.fontFamily,this.data,c)}return(E=this._inspectFont)==null||E.call(this,this),S}createFontFaceRule(){var v;if(!this.data||this.disableFontFace)return null;const S=(0,e.bytesToString)(this.data),E=`url(data:${this.mimetype};base64,${btoa(S)});`;let c;if(!this.cssFontInfo)c=`@font-face {font-family:"${this.loadedName}";src:${E}}`;else{let x=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(x+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),c=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${x}src:${E}}`}return(v=this._inspectFont)==null||v.call(this,this,E),c}getPathGenerator(S,E){if(this.compiledGlyphs[E]!==void 0)return this.compiledGlyphs[E];let c;try{c=S.get(this.loadedName+"_path_"+E)}catch(v){if(!this.ignoreErrors)throw v;return(0,e.warn)(`getPathGenerator - ignoring character: "${v}".`),this.compiledGlyphs[E]=function(x,p){}}if(this.isEvalSupported&&e.FeatureTest.isEvalSupported){const v=[];for(const x of c){const p=x.args!==void 0?x.args.join(","):"";v.push("c.",x.cmd,"(",p,`);
`)}return this.compiledGlyphs[E]=new Function("c","size",v.join(""))}return this.compiledGlyphs[E]=function(v,x){for(const p of c)p.cmd==="scale"&&(p.args=[x,-x]),v[p.cmd].apply(v,p.args)}}}t.FontFaceObject=a},(n,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeStandardFontDataFactory=t.NodeFilterFactory=t.NodeCanvasFactory=t.NodeCMapReaderFactory=void 0;var e=i(7);i(1);const s=function(E){return new Promise((c,v)=>{require$$5.readFile(E,(p,_)=>{if(p||!_){v(new Error(p));return}c(new Uint8Array(_))})})};class a extends e.BaseFilterFactory{}t.NodeFilterFactory=a;class o extends e.BaseCanvasFactory{_createCanvas(c,v){return require$$5.createCanvas(c,v)}}t.NodeCanvasFactory=o;class D extends e.BaseCMapReaderFactory{_fetchData(c,v){return s(c).then(x=>({cMapData:x,compressionType:v}))}}t.NodeCMapReaderFactory=D;class S extends e.BaseStandardFontDataFactory{_fetchData(c){return s(c)}}t.NodeStandardFontDataFactory=S},(n,t,i)=>{var ue,Yt,$t;Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var e=i(1),s=i(6),a=i(12),o=i(13);const D=16,S=100,E=4096,c=15,v=10,x=1e3,p=16;function _(M,l){if(M._removeMirroring)throw new Error("Context is already forwarding operations.");M.__originalSave=M.save,M.__originalRestore=M.restore,M.__originalRotate=M.rotate,M.__originalScale=M.scale,M.__originalTranslate=M.translate,M.__originalTransform=M.transform,M.__originalSetTransform=M.setTransform,M.__originalResetTransform=M.resetTransform,M.__originalClip=M.clip,M.__originalMoveTo=M.moveTo,M.__originalLineTo=M.lineTo,M.__originalBezierCurveTo=M.bezierCurveTo,M.__originalRect=M.rect,M.__originalClosePath=M.closePath,M.__originalBeginPath=M.beginPath,M._removeMirroring=()=>{M.save=M.__originalSave,M.restore=M.__originalRestore,M.rotate=M.__originalRotate,M.scale=M.__originalScale,M.translate=M.__originalTranslate,M.transform=M.__originalTransform,M.setTransform=M.__originalSetTransform,M.resetTransform=M.__originalResetTransform,M.clip=M.__originalClip,M.moveTo=M.__originalMoveTo,M.lineTo=M.__originalLineTo,M.bezierCurveTo=M.__originalBezierCurveTo,M.rect=M.__originalRect,M.closePath=M.__originalClosePath,M.beginPath=M.__originalBeginPath,delete M._removeMirroring},M.save=function(){l.save(),this.__originalSave()},M.restore=function(){l.restore(),this.__originalRestore()},M.translate=function(k,B){l.translate(k,B),this.__originalTranslate(k,B)},M.scale=function(k,B){l.scale(k,B),this.__originalScale(k,B)},M.transform=function(k,B,G,W,$,ce){l.transform(k,B,G,W,$,ce),this.__originalTransform(k,B,G,W,$,ce)},M.setTransform=function(k,B,G,W,$,ce){l.setTransform(k,B,G,W,$,ce),this.__originalSetTransform(k,B,G,W,$,ce)},M.resetTransform=function(){l.resetTransform(),this.__originalResetTransform()},M.rotate=function(k){l.rotate(k),this.__originalRotate(k)},M.clip=function(k){l.clip(k),this.__originalClip(k)},M.moveTo=function(d,k){l.moveTo(d,k),this.__originalMoveTo(d,k)},M.lineTo=function(d,k){l.lineTo(d,k),this.__originalLineTo(d,k)},M.bezierCurveTo=function(d,k,B,G,W,$){l.bezierCurveTo(d,k,B,G,W,$),this.__originalBezierCurveTo(d,k,B,G,W,$)},M.rect=function(d,k,B,G){l.rect(d,k,B,G),this.__originalRect(d,k,B,G)},M.closePath=function(){l.closePath(),this.__originalClosePath()},M.beginPath=function(){l.beginPath(),this.__originalBeginPath()}}class A{constructor(l){this.canvasFactory=l,this.cache=Object.create(null)}getCanvas(l,d,k){let B;return this.cache[l]!==void 0?(B=this.cache[l],this.canvasFactory.reset(B,d,k)):(B=this.canvasFactory.create(d,k),this.cache[l]=B),B}delete(l){delete this.cache[l]}clear(){for(const l in this.cache){const d=this.cache[l];this.canvasFactory.destroy(d),delete this.cache[l]}}}function f(M,l,d,k,B,G,W,$,ce,me){const[fe,be,Ee,je,ie,ae]=(0,s.getCurrentTransform)(M);if(be===0&&Ee===0){const Z=W*fe+ie,ne=Math.round(Z),xe=$*je+ae,Re=Math.round(xe),Ae=(W+ce)*fe+ie,te=Math.abs(Math.round(Ae)-ne)||1,we=($+me)*je+ae,Se=Math.abs(Math.round(we)-Re)||1;return M.setTransform(Math.sign(fe),0,0,Math.sign(je),ne,Re),M.drawImage(l,d,k,B,G,0,0,te,Se),M.setTransform(fe,be,Ee,je,ie,ae),[te,Se]}if(fe===0&&je===0){const Z=$*Ee+ie,ne=Math.round(Z),xe=W*be+ae,Re=Math.round(xe),Ae=($+me)*Ee+ie,te=Math.abs(Math.round(Ae)-ne)||1,we=(W+ce)*be+ae,Se=Math.abs(Math.round(we)-Re)||1;return M.setTransform(0,Math.sign(be),Math.sign(Ee),0,ne,Re),M.drawImage(l,d,k,B,G,0,0,Se,te),M.setTransform(fe,be,Ee,je,ie,ae),[Se,te]}M.drawImage(l,d,k,B,G,W,$,ce,me);const P=Math.hypot(fe,be),H=Math.hypot(Ee,je);return[P*ce,H*me]}function u(M){const{width:l,height:d}=M;if(l>x||d>x)return null;const k=1e3,B=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),G=l+1;let W=new Uint8Array(G*(d+1)),$,ce,me;const fe=l+7&-8;let be=new Uint8Array(fe*d),Ee=0;for(const H of M.data){let Z=128;for(;Z>0;)be[Ee++]=H&Z?0:255,Z>>=1}let je=0;for(Ee=0,be[Ee]!==0&&(W[0]=1,++je),ce=1;ce<l;ce++)be[Ee]!==be[Ee+1]&&(W[ce]=be[Ee]?2:1,++je),Ee++;for(be[Ee]!==0&&(W[ce]=2,++je),$=1;$<d;$++){Ee=$*fe,me=$*G,be[Ee-fe]!==be[Ee]&&(W[me]=be[Ee]?1:8,++je);let H=(be[Ee]?4:0)+(be[Ee-fe]?8:0);for(ce=1;ce<l;ce++)H=(H>>2)+(be[Ee+1]?4:0)+(be[Ee-fe+1]?8:0),B[H]&&(W[me+ce]=B[H],++je),Ee++;if(be[Ee-fe]!==be[Ee]&&(W[me+ce]=be[Ee]?2:4,++je),je>k)return null}for(Ee=fe*(d-1),me=$*G,be[Ee]!==0&&(W[me]=8,++je),ce=1;ce<l;ce++)be[Ee]!==be[Ee+1]&&(W[me+ce]=be[Ee]?4:8,++je),Ee++;if(be[Ee]!==0&&(W[me+ce]=4,++je),je>k)return null;const ie=new Int32Array([0,G,-1,0,-G,0,0,0,1]),ae=new Path2D;for($=0;je&&$<=d;$++){let H=$*G;const Z=H+l;for(;H<Z&&!W[H];)H++;if(H===Z)continue;ae.moveTo(H%G,$);const ne=H;let xe=W[H];do{const Re=ie[xe];do H+=Re;while(!W[H]);const Ae=W[H];Ae!==5&&Ae!==10?(xe=Ae,W[H]=0):(xe=Ae&51*xe>>4,W[H]&=xe>>2|xe<<2),ae.lineTo(H%G,H/G|0),W[H]||--je}while(ne!==H);--$}return be=null,W=null,function(H){H.save(),H.scale(1/l,-1/d),H.translate(0,-d),H.fill(ae),H.beginPath(),H.restore()}}class C{constructor(l,d){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=e.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=e.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=e.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,l,d])}clone(){const l=Object.create(this);return l.clipBox=this.clipBox.slice(),l}setCurrentPoint(l,d){this.x=l,this.y=d}updatePathMinMax(l,d,k){[d,k]=e.Util.applyTransform([d,k],l),this.minX=Math.min(this.minX,d),this.minY=Math.min(this.minY,k),this.maxX=Math.max(this.maxX,d),this.maxY=Math.max(this.maxY,k)}updateRectMinMax(l,d){const k=e.Util.applyTransform(d,l),B=e.Util.applyTransform(d.slice(2),l);this.minX=Math.min(this.minX,k[0],B[0]),this.minY=Math.min(this.minY,k[1],B[1]),this.maxX=Math.max(this.maxX,k[0],B[0]),this.maxY=Math.max(this.maxY,k[1],B[1])}updateScalingPathMinMax(l,d){e.Util.scaleMinMax(l,d),this.minX=Math.min(this.minX,d[0]),this.maxX=Math.max(this.maxX,d[1]),this.minY=Math.min(this.minY,d[2]),this.maxY=Math.max(this.maxY,d[3])}updateCurvePathMinMax(l,d,k,B,G,W,$,ce,me,fe){const be=e.Util.bezierBoundingBox(d,k,B,G,W,$,ce,me);if(fe){fe[0]=Math.min(fe[0],be[0],be[2]),fe[1]=Math.max(fe[1],be[0],be[2]),fe[2]=Math.min(fe[2],be[1],be[3]),fe[3]=Math.max(fe[3],be[1],be[3]);return}this.updateRectMinMax(l,be)}getPathBoundingBox(l=a.PathType.FILL,d=null){const k=[this.minX,this.minY,this.maxX,this.maxY];if(l===a.PathType.STROKE){d||(0,e.unreachable)("Stroke bounding box must include transform.");const B=e.Util.singularValueDecompose2dScale(d),G=B[0]*this.lineWidth/2,W=B[1]*this.lineWidth/2;k[0]-=G,k[1]-=W,k[2]+=G,k[3]+=W}return k}updateClipFromPath(){const l=e.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(l||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(l){this.clipBox=l,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(l=a.PathType.FILL,d=null){return e.Util.intersect(this.clipBox,this.getPathBoundingBox(l,d))}}function F(M,l){if(typeof ImageData<"u"&&l instanceof ImageData){M.putImageData(l,0,0);return}const d=l.height,k=l.width,B=d%p,G=(d-B)/p,W=B===0?G:G+1,$=M.createImageData(k,p);let ce=0,me;const fe=l.data,be=$.data;let Ee,je,ie,ae;if(l.kind===e.ImageKind.GRAYSCALE_1BPP){const P=fe.byteLength,H=new Uint32Array(be.buffer,0,be.byteLength>>2),Z=H.length,ne=k+7>>3,xe=4294967295,Re=e.FeatureTest.isLittleEndian?4278190080:255;for(Ee=0;Ee<W;Ee++){for(ie=Ee<G?p:B,me=0,je=0;je<ie;je++){const Ae=P-ce;let te=0;const we=Ae>ne?k:Ae*8-7,Se=we&-8;let We=0,Be=0;for(;te<Se;te+=8)Be=fe[ce++],H[me++]=Be&128?xe:Re,H[me++]=Be&64?xe:Re,H[me++]=Be&32?xe:Re,H[me++]=Be&16?xe:Re,H[me++]=Be&8?xe:Re,H[me++]=Be&4?xe:Re,H[me++]=Be&2?xe:Re,H[me++]=Be&1?xe:Re;for(;te<we;te++)We===0&&(Be=fe[ce++],We=128),H[me++]=Be&We?xe:Re,We>>=1}for(;me<Z;)H[me++]=0;M.putImageData($,0,Ee*p)}}else if(l.kind===e.ImageKind.RGBA_32BPP){for(je=0,ae=k*p*4,Ee=0;Ee<G;Ee++)be.set(fe.subarray(ce,ce+ae)),ce+=ae,M.putImageData($,0,je),je+=p;Ee<W&&(ae=k*B*4,be.set(fe.subarray(ce,ce+ae)),M.putImageData($,0,je))}else if(l.kind===e.ImageKind.RGB_24BPP)for(ie=p,ae=k*ie,Ee=0;Ee<W;Ee++){for(Ee>=G&&(ie=B,ae=k*ie),me=0,je=ae;je--;)be[me++]=fe[ce++],be[me++]=fe[ce++],be[me++]=fe[ce++],be[me++]=255;M.putImageData($,0,Ee*p)}else throw new Error(`bad image kind: ${l.kind}`)}function w(M,l){if(l.bitmap){M.drawImage(l.bitmap,0,0);return}const d=l.height,k=l.width,B=d%p,G=(d-B)/p,W=B===0?G:G+1,$=M.createImageData(k,p);let ce=0;const me=l.data,fe=$.data;for(let be=0;be<W;be++){const Ee=be<G?p:B;({srcPos:ce}=(0,o.convertBlackAndWhiteToRGBA)({src:me,srcPos:ce,dest:fe,width:k,height:Ee,nonBlackColor:0})),M.putImageData($,0,be*p)}}function h(M,l){const d=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const k of d)M[k]!==void 0&&(l[k]=M[k]);M.setLineDash!==void 0&&(l.setLineDash(M.getLineDash()),l.lineDashOffset=M.lineDashOffset)}function R(M){if(M.strokeStyle=M.fillStyle="#000000",M.fillRule="nonzero",M.globalAlpha=1,M.lineWidth=1,M.lineCap="butt",M.lineJoin="miter",M.miterLimit=10,M.globalCompositeOperation="source-over",M.font="10px sans-serif",M.setLineDash!==void 0&&(M.setLineDash([]),M.lineDashOffset=0),!e.isNodeJS){const{filter:l}=M;l!=="none"&&l!==""&&(M.filter="none")}}function b(M,l,d,k){const B=M.length;for(let G=3;G<B;G+=4){const W=M[G];if(W===0)M[G-3]=l,M[G-2]=d,M[G-1]=k;else if(W<255){const $=255-W;M[G-3]=M[G-3]*W+l*$>>8,M[G-2]=M[G-2]*W+d*$>>8,M[G-1]=M[G-1]*W+k*$>>8}}}function j(M,l,d){const k=M.length,B=1/255;for(let G=3;G<k;G+=4){const W=d?d[M[G]]:M[G];l[G]=l[G]*W*B|0}}function y(M,l,d){const k=M.length;for(let B=3;B<k;B+=4){const G=M[B-3]*77+M[B-2]*152+M[B-1]*28;l[B]=d?l[B]*d[G>>8]>>8:l[B]*G>>16}}function L(M,l,d,k,B,G,W,$,ce,me,fe){const be=!!G,Ee=be?G[0]:0,je=be?G[1]:0,ie=be?G[2]:0,ae=B==="Luminosity"?y:j,H=Math.min(k,Math.ceil(1048576/d));for(let Z=0;Z<k;Z+=H){const ne=Math.min(H,k-Z),xe=M.getImageData($-me,Z+(ce-fe),d,ne),Re=l.getImageData($,Z+ce,d,ne);be&&b(xe.data,Ee,je,ie),ae(xe.data,Re.data,W),l.putImageData(Re,$,Z+ce)}}function g(M,l,d,k){const B=k[0],G=k[1],W=k[2]-B,$=k[3]-G;W===0||$===0||(L(l.context,d,W,$,l.subtype,l.backdrop,l.transferMap,B,G,l.offsetX,l.offsetY),M.save(),M.globalAlpha=1,M.globalCompositeOperation="source-over",M.setTransform(1,0,0,1,0,0),M.drawImage(d.canvas,0,0),M.restore())}function T(M,l){const d=e.Util.singularValueDecompose2dScale(M);d[0]=Math.fround(d[0]),d[1]=Math.fround(d[1]);const k=Math.fround((globalThis.devicePixelRatio||1)*s.PixelsPerInch.PDF_TO_CSS_UNITS);return l!==void 0?l:d[0]<=k||d[1]<=k}const z=["butt","round","square"],se=["miter","round","bevel"],V={},Q={},ee=class ee{constructor(l,d,k,B,G,{optionalContentConfig:W,markedContentStack:$=null},ce,me){re(this,ue);this.ctx=l,this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=d,this.objs=k,this.canvasFactory=B,this.filterFactory=G,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=$||[],this.optionalContentConfig=W,this.cachedCanvases=new A(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=ce,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=me,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(l,d=null){return typeof l=="string"?l.startsWith("g_")?this.commonObjs.get(l):this.objs.get(l):d}beginDrawing({transform:l,viewport:d,transparency:k=!1,background:B=null}){const G=this.ctx.canvas.width,W=this.ctx.canvas.height,$=this.ctx.fillStyle;if(this.ctx.fillStyle=B||"#ffffff",this.ctx.fillRect(0,0,G,W),this.ctx.fillStyle=$,k){const ce=this.cachedCanvases.getCanvas("transparent",G,W);this.compositeCtx=this.ctx,this.transparentCanvas=ce.canvas,this.ctx=ce.context,this.ctx.save(),this.ctx.transform(...(0,s.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),R(this.ctx),l&&(this.ctx.transform(...l),this.outputScaleX=l[0],this.outputScaleY=l[0]),this.ctx.transform(...d.transform),this.viewportScale=d.scale,this.baseTransform=(0,s.getCurrentTransform)(this.ctx)}executeOperatorList(l,d,k,B){const G=l.argsArray,W=l.fnArray;let $=d||0;const ce=G.length;if(ce===$)return $;const me=ce-$>v&&typeof k=="function",fe=me?Date.now()+c:0;let be=0;const Ee=this.commonObjs,je=this.objs;let ie;for(;;){if(B!==void 0&&$===B.nextBreakPoint)return B.breakIt($,k),$;if(ie=W[$],ie!==e.OPS.dependency)this[ie].apply(this,G[$]);else for(const ae of G[$]){const P=ae.startsWith("g_")?Ee:je;if(!P.has(ae))return P.get(ae,k),$}if($++,$===ce)return $;if(me&&++be>v){if(Date.now()>fe)return k(),$;be=0}}}endDrawing(){J(this,ue,Yt).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const l of this._cachedBitmapsMap.values()){for(const d of l.values())typeof HTMLCanvasElement<"u"&&d instanceof HTMLCanvasElement&&(d.width=d.height=0);l.clear()}this._cachedBitmapsMap.clear(),J(this,ue,$t).call(this)}_scaleImage(l,d){const k=l.width,B=l.height;let G=Math.max(Math.hypot(d[0],d[1]),1),W=Math.max(Math.hypot(d[2],d[3]),1),$=k,ce=B,me="prescale1",fe,be;for(;G>2&&$>1||W>2&&ce>1;){let Ee=$,je=ce;G>2&&$>1&&(Ee=$>=16384?Math.floor($/2)-1||1:Math.ceil($/2),G/=$/Ee),W>2&&ce>1&&(je=ce>=16384?Math.floor(ce/2)-1||1:Math.ceil(ce)/2,W/=ce/je),fe=this.cachedCanvases.getCanvas(me,Ee,je),be=fe.context,be.clearRect(0,0,Ee,je),be.drawImage(l,0,0,$,ce,0,0,Ee,je),l=fe.canvas,$=Ee,ce=je,me=me==="prescale1"?"prescale2":"prescale1"}return{img:l,paintWidth:$,paintHeight:ce}}_createMaskCanvas(l){const d=this.ctx,{width:k,height:B}=l,G=this.current.fillColor,W=this.current.patternFill,$=(0,s.getCurrentTransform)(d);let ce,me,fe,be;if((l.bitmap||l.data)&&l.count>1){const te=l.bitmap||l.data.buffer;me=JSON.stringify(W?$:[$.slice(0,4),G]),ce=this._cachedBitmapsMap.get(te),ce||(ce=new Map,this._cachedBitmapsMap.set(te,ce));const we=ce.get(me);if(we&&!W){const Se=Math.round(Math.min($[0],$[2])+$[4]),We=Math.round(Math.min($[1],$[3])+$[5]);return{canvas:we,offsetX:Se,offsetY:We}}fe=we}fe||(be=this.cachedCanvases.getCanvas("maskCanvas",k,B),w(be.context,l));let Ee=e.Util.transform($,[1/k,0,0,-1/B,0,0]);Ee=e.Util.transform(Ee,[1,0,0,1,0,-B]);const je=e.Util.applyTransform([0,0],Ee),ie=e.Util.applyTransform([k,B],Ee),ae=e.Util.normalizeRect([je[0],je[1],ie[0],ie[1]]),P=Math.round(ae[2]-ae[0])||1,H=Math.round(ae[3]-ae[1])||1,Z=this.cachedCanvases.getCanvas("fillCanvas",P,H),ne=Z.context,xe=Math.min(je[0],ie[0]),Re=Math.min(je[1],ie[1]);ne.translate(-xe,-Re),ne.transform(...Ee),fe||(fe=this._scaleImage(be.canvas,(0,s.getCurrentTransformInverse)(ne)),fe=fe.img,ce&&W&&ce.set(me,fe)),ne.imageSmoothingEnabled=T((0,s.getCurrentTransform)(ne),l.interpolate),f(ne,fe,0,0,fe.width,fe.height,0,0,k,B),ne.globalCompositeOperation="source-in";const Ae=e.Util.transform((0,s.getCurrentTransformInverse)(ne),[1,0,0,1,-xe,-Re]);return ne.fillStyle=W?G.getPattern(d,this,Ae,a.PathType.FILL):G,ne.fillRect(0,0,k,B),ce&&!W&&(this.cachedCanvases.delete("fillCanvas"),ce.set(me,Z.canvas)),{canvas:Z.canvas,offsetX:Math.round(xe),offsetY:Math.round(Re)}}setLineWidth(l){l!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=l,this.ctx.lineWidth=l}setLineCap(l){this.ctx.lineCap=z[l]}setLineJoin(l){this.ctx.lineJoin=se[l]}setMiterLimit(l){this.ctx.miterLimit=l}setDash(l,d){const k=this.ctx;k.setLineDash!==void 0&&(k.setLineDash(l),k.lineDashOffset=d)}setRenderingIntent(l){}setFlatness(l){}setGState(l){for(const[d,k]of l)switch(d){case"LW":this.setLineWidth(k);break;case"LC":this.setLineCap(k);break;case"LJ":this.setLineJoin(k);break;case"ML":this.setMiterLimit(k);break;case"D":this.setDash(k[0],k[1]);break;case"RI":this.setRenderingIntent(k);break;case"FL":this.setFlatness(k);break;case"Font":this.setFont(k[0],k[1]);break;case"CA":this.current.strokeAlpha=k;break;case"ca":this.current.fillAlpha=k,this.ctx.globalAlpha=k;break;case"BM":this.ctx.globalCompositeOperation=k;break;case"SMask":this.current.activeSMask=k?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(k);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const l=this.inSMaskMode;this.current.activeSMask&&!l?this.beginSMaskMode():!this.current.activeSMask&&l&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const l=this.ctx.canvas.width,d=this.ctx.canvas.height,k="smaskGroupAt"+this.groupLevel,B=this.cachedCanvases.getCanvas(k,l,d);this.suspendedCtx=this.ctx,this.ctx=B.context;const G=this.ctx;G.setTransform(...(0,s.getCurrentTransform)(this.suspendedCtx)),h(this.suspendedCtx,G),_(G,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),h(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(l){if(!this.current.activeSMask)return;l?(l[0]=Math.floor(l[0]),l[1]=Math.floor(l[1]),l[2]=Math.ceil(l[2]),l[3]=Math.ceil(l[3])):l=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const d=this.current.activeSMask,k=this.suspendedCtx;g(k,d,this.ctx,l),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(h(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const l=this.current;this.stateStack.push(l),this.current=l.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),h(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(l,d,k,B,G,W){this.ctx.transform(l,d,k,B,G,W),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(l,d,k){const B=this.ctx,G=this.current;let W=G.x,$=G.y,ce,me;const fe=(0,s.getCurrentTransform)(B),be=fe[0]===0&&fe[3]===0||fe[1]===0&&fe[2]===0,Ee=be?k.slice(0):null;for(let je=0,ie=0,ae=l.length;je<ae;je++)switch(l[je]|0){case e.OPS.rectangle:W=d[ie++],$=d[ie++];const P=d[ie++],H=d[ie++],Z=W+P,ne=$+H;B.moveTo(W,$),P===0||H===0?B.lineTo(Z,ne):(B.lineTo(Z,$),B.lineTo(Z,ne),B.lineTo(W,ne)),be||G.updateRectMinMax(fe,[W,$,Z,ne]),B.closePath();break;case e.OPS.moveTo:W=d[ie++],$=d[ie++],B.moveTo(W,$),be||G.updatePathMinMax(fe,W,$);break;case e.OPS.lineTo:W=d[ie++],$=d[ie++],B.lineTo(W,$),be||G.updatePathMinMax(fe,W,$);break;case e.OPS.curveTo:ce=W,me=$,W=d[ie+4],$=d[ie+5],B.bezierCurveTo(d[ie],d[ie+1],d[ie+2],d[ie+3],W,$),G.updateCurvePathMinMax(fe,ce,me,d[ie],d[ie+1],d[ie+2],d[ie+3],W,$,Ee),ie+=6;break;case e.OPS.curveTo2:ce=W,me=$,B.bezierCurveTo(W,$,d[ie],d[ie+1],d[ie+2],d[ie+3]),G.updateCurvePathMinMax(fe,ce,me,W,$,d[ie],d[ie+1],d[ie+2],d[ie+3],Ee),W=d[ie+2],$=d[ie+3],ie+=4;break;case e.OPS.curveTo3:ce=W,me=$,W=d[ie+2],$=d[ie+3],B.bezierCurveTo(d[ie],d[ie+1],W,$,W,$),G.updateCurvePathMinMax(fe,ce,me,d[ie],d[ie+1],W,$,W,$,Ee),ie+=4;break;case e.OPS.closePath:B.closePath();break}be&&G.updateScalingPathMinMax(fe,Ee),G.setCurrentPoint(W,$)}closePath(){this.ctx.closePath()}stroke(l=!0){const d=this.ctx,k=this.current.strokeColor;d.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof k=="object"&&(k!=null&&k.getPattern)?(d.save(),d.strokeStyle=k.getPattern(d,this,(0,s.getCurrentTransformInverse)(d),a.PathType.STROKE),this.rescaleAndStroke(!1),d.restore()):this.rescaleAndStroke(!0)),l&&this.consumePath(this.current.getClippedPathBoundingBox()),d.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(l=!0){const d=this.ctx,k=this.current.fillColor,B=this.current.patternFill;let G=!1;B&&(d.save(),d.fillStyle=k.getPattern(d,this,(0,s.getCurrentTransformInverse)(d),a.PathType.FILL),G=!0);const W=this.current.getClippedPathBoundingBox();this.contentVisible&&W!==null&&(this.pendingEOFill?(d.fill("evenodd"),this.pendingEOFill=!1):d.fill()),G&&d.restore(),l&&this.consumePath(W)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=V}eoClip(){this.pendingClip=Q}beginText(){this.current.textMatrix=e.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const l=this.pendingTextPaths,d=this.ctx;if(l===void 0){d.beginPath();return}d.save(),d.beginPath();for(const k of l)d.setTransform(...k.transform),d.translate(k.x,k.y),k.addToPath(d,k.fontSize);d.restore(),d.clip(),d.beginPath(),delete this.pendingTextPaths}setCharSpacing(l){this.current.charSpacing=l}setWordSpacing(l){this.current.wordSpacing=l}setHScale(l){this.current.textHScale=l/100}setLeading(l){this.current.leading=-l}setFont(l,d){var fe;const k=this.commonObjs.get(l),B=this.current;if(!k)throw new Error(`Can't find font for ${l}`);if(B.fontMatrix=k.fontMatrix||e.FONT_IDENTITY_MATRIX,(B.fontMatrix[0]===0||B.fontMatrix[3]===0)&&(0,e.warn)("Invalid font matrix for font "+l),d<0?(d=-d,B.fontDirection=-1):B.fontDirection=1,this.current.font=k,this.current.fontSize=d,k.isType3Font)return;const G=k.loadedName||"sans-serif",W=((fe=k.systemFontInfo)==null?void 0:fe.css)||`"${G}", ${k.fallbackName}`;let $="normal";k.black?$="900":k.bold&&($="bold");const ce=k.italic?"italic":"normal";let me=d;d<D?me=D:d>S&&(me=S),this.current.fontSizeScale=d/me,this.ctx.font=`${ce} ${$} ${me}px ${W}`}setTextRenderingMode(l){this.current.textRenderingMode=l}setTextRise(l){this.current.textRise=l}moveText(l,d){this.current.x=this.current.lineX+=l,this.current.y=this.current.lineY+=d}setLeadingMoveText(l,d){this.setLeading(-d),this.moveText(l,d)}setTextMatrix(l,d,k,B,G,W){this.current.textMatrix=[l,d,k,B,G,W],this.current.textMatrixScale=Math.hypot(l,d),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(l,d,k,B){const G=this.ctx,W=this.current,$=W.font,ce=W.textRenderingMode,me=W.fontSize/W.fontSizeScale,fe=ce&e.TextRenderingMode.FILL_STROKE_MASK,be=!!(ce&e.TextRenderingMode.ADD_TO_PATH_FLAG),Ee=W.patternFill&&!$.missingFile;let je;($.disableFontFace||be||Ee)&&(je=$.getPathGenerator(this.commonObjs,l)),$.disableFontFace||Ee?(G.save(),G.translate(d,k),G.beginPath(),je(G,me),B&&G.setTransform(...B),(fe===e.TextRenderingMode.FILL||fe===e.TextRenderingMode.FILL_STROKE)&&G.fill(),(fe===e.TextRenderingMode.STROKE||fe===e.TextRenderingMode.FILL_STROKE)&&G.stroke(),G.restore()):((fe===e.TextRenderingMode.FILL||fe===e.TextRenderingMode.FILL_STROKE)&&G.fillText(l,d,k),(fe===e.TextRenderingMode.STROKE||fe===e.TextRenderingMode.FILL_STROKE)&&G.strokeText(l,d,k)),be&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,s.getCurrentTransform)(G),x:d,y:k,fontSize:me,addToPath:je})}get isFontSubpixelAAEnabled(){const{context:l}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);l.scale(1.5,1),l.fillText("I",0,10);const d=l.getImageData(0,0,10,10).data;let k=!1;for(let B=3;B<d.length;B+=4)if(d[B]>0&&d[B]<255){k=!0;break}return(0,e.shadow)(this,"isFontSubpixelAAEnabled",k)}showText(l){const d=this.current,k=d.font;if(k.isType3Font)return this.showType3Text(l);const B=d.fontSize;if(B===0)return;const G=this.ctx,W=d.fontSizeScale,$=d.charSpacing,ce=d.wordSpacing,me=d.fontDirection,fe=d.textHScale*me,be=l.length,Ee=k.vertical,je=Ee?1:-1,ie=k.defaultVMetrics,ae=B*d.fontMatrix[0],P=d.textRenderingMode===e.TextRenderingMode.FILL&&!k.disableFontFace&&!d.patternFill;G.save(),G.transform(...d.textMatrix),G.translate(d.x,d.y+d.textRise),me>0?G.scale(fe,-1):G.scale(fe,1);let H;if(d.patternFill){G.save();const Ae=d.fillColor.getPattern(G,this,(0,s.getCurrentTransformInverse)(G),a.PathType.FILL);H=(0,s.getCurrentTransform)(G),G.restore(),G.fillStyle=Ae}let Z=d.lineWidth;const ne=d.textMatrixScale;if(ne===0||Z===0){const Ae=d.textRenderingMode&e.TextRenderingMode.FILL_STROKE_MASK;(Ae===e.TextRenderingMode.STROKE||Ae===e.TextRenderingMode.FILL_STROKE)&&(Z=this.getSinglePixelWidth())}else Z/=ne;if(W!==1&&(G.scale(W,W),Z/=W),G.lineWidth=Z,k.isInvalidPDFjsFont){const Ae=[];let te=0;for(const we of l)Ae.push(we.unicode),te+=we.width;G.fillText(Ae.join(""),0,0),d.x+=te*ae*fe,G.restore(),this.compose();return}let xe=0,Re;for(Re=0;Re<be;++Re){const Ae=l[Re];if(typeof Ae=="number"){xe+=je*Ae*B/1e3;continue}let te=!1;const we=(Ae.isSpace?ce:0)+$,Se=Ae.fontChar,We=Ae.accent;let Be,Xe,Me=Ae.width;if(Ee){const Ke=Ae.vmetric||ie,$e=-(Ae.vmetric?Ke[1]:Me*.5)*ae,ye=Ke[2]*ae;Me=Ke?-Ke[0]:Me,Be=$e/W,Xe=(xe+ye)/W}else Be=xe/W,Xe=0;if(k.remeasure&&Me>0){const Ke=G.measureText(Se).width*1e3/B*W;if(Me<Ke&&this.isFontSubpixelAAEnabled){const $e=Me/Ke;te=!0,G.save(),G.scale($e,1),Be/=$e}else Me!==Ke&&(Be+=(Me-Ke)/2e3*B/W)}if(this.contentVisible&&(Ae.isInFont||k.missingFile)){if(P&&!We)G.fillText(Se,Be,Xe);else if(this.paintChar(Se,Be,Xe,H),We){const Ke=Be+B*We.offset.x/W,$e=Xe-B*We.offset.y/W;this.paintChar(We.fontChar,Ke,$e,H)}}const ze=Ee?Me*ae-we*me:Me*ae+we*me;xe+=ze,te&&G.restore()}Ee?d.y-=xe:d.x+=xe*fe,G.restore(),this.compose()}showType3Text(l){const d=this.ctx,k=this.current,B=k.font,G=k.fontSize,W=k.fontDirection,$=B.vertical?1:-1,ce=k.charSpacing,me=k.wordSpacing,fe=k.textHScale*W,be=k.fontMatrix||e.FONT_IDENTITY_MATRIX,Ee=l.length,je=k.textRenderingMode===e.TextRenderingMode.INVISIBLE;let ie,ae,P,H;if(!(je||G===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,d.save(),d.transform(...k.textMatrix),d.translate(k.x,k.y),d.scale(fe,W),ie=0;ie<Ee;++ie){if(ae=l[ie],typeof ae=="number"){H=$*ae*G/1e3,this.ctx.translate(H,0),k.x+=H*fe;continue}const Z=(ae.isSpace?me:0)+ce,ne=B.charProcOperatorList[ae.operatorListId];if(!ne){(0,e.warn)(`Type3 character "${ae.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=ae,this.save(),d.scale(G,G),d.transform(...be),this.executeOperatorList(ne),this.restore()),P=e.Util.applyTransform([ae.width,0],be)[0]*G+Z,d.translate(P,0),k.x+=P*fe}d.restore(),this.processingType3=null}}setCharWidth(l,d){}setCharWidthAndBounds(l,d,k,B,G,W){this.ctx.rect(k,B,G-k,W-B),this.ctx.clip(),this.endPath()}getColorN_Pattern(l){let d;if(l[0]==="TilingPattern"){const k=l[1],B=this.baseTransform||(0,s.getCurrentTransform)(this.ctx),G={createCanvasGraphics:W=>new ee(W,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};d=new a.TilingPattern(l,k,this.ctx,G,B)}else d=this._getPattern(l[1],l[2]);return d}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(l,d,k){const B=e.Util.makeHexColor(l,d,k);this.ctx.strokeStyle=B,this.current.strokeColor=B}setFillRGBColor(l,d,k){const B=e.Util.makeHexColor(l,d,k);this.ctx.fillStyle=B,this.current.fillColor=B,this.current.patternFill=!1}_getPattern(l,d=null){let k;return this.cachedPatterns.has(l)?k=this.cachedPatterns.get(l):(k=(0,a.getShadingPattern)(this.getObject(l)),this.cachedPatterns.set(l,k)),d&&(k.matrix=d),k}shadingFill(l){if(!this.contentVisible)return;const d=this.ctx;this.save();const k=this._getPattern(l);d.fillStyle=k.getPattern(d,this,(0,s.getCurrentTransformInverse)(d),a.PathType.SHADING);const B=(0,s.getCurrentTransformInverse)(d);if(B){const{width:G,height:W}=d.canvas,[$,ce,me,fe]=e.Util.getAxialAlignedBoundingBox([0,0,G,W],B);this.ctx.fillRect($,ce,me-$,fe-ce)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,e.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,e.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(l,d){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(l)&&l.length===6&&this.transform(...l),this.baseTransform=(0,s.getCurrentTransform)(this.ctx),d)){const k=d[2]-d[0],B=d[3]-d[1];this.ctx.rect(d[0],d[1],k,B),this.current.updateRectMinMax((0,s.getCurrentTransform)(this.ctx),d),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(l){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const d=this.ctx;l.isolated||(0,e.info)("TODO: Support non-isolated groups."),l.knockout&&(0,e.warn)("Knockout groups not supported.");const k=(0,s.getCurrentTransform)(d);if(l.matrix&&d.transform(...l.matrix),!l.bbox)throw new Error("Bounding box is required.");let B=e.Util.getAxialAlignedBoundingBox(l.bbox,(0,s.getCurrentTransform)(d));const G=[0,0,d.canvas.width,d.canvas.height];B=e.Util.intersect(B,G)||[0,0,0,0];const W=Math.floor(B[0]),$=Math.floor(B[1]);let ce=Math.max(Math.ceil(B[2])-W,1),me=Math.max(Math.ceil(B[3])-$,1),fe=1,be=1;ce>E&&(fe=ce/E,ce=E),me>E&&(be=me/E,me=E),this.current.startNewPathAndClipBox([0,0,ce,me]);let Ee="groupAt"+this.groupLevel;l.smask&&(Ee+="_smask_"+this.smaskCounter++%2);const je=this.cachedCanvases.getCanvas(Ee,ce,me),ie=je.context;ie.scale(1/fe,1/be),ie.translate(-W,-$),ie.transform(...k),l.smask?this.smaskStack.push({canvas:je.canvas,context:ie,offsetX:W,offsetY:$,scaleX:fe,scaleY:be,subtype:l.smask.subtype,backdrop:l.smask.backdrop,transferMap:l.smask.transferMap||null,startTransformInverse:null}):(d.setTransform(1,0,0,1,0,0),d.translate(W,$),d.scale(fe,be),d.save()),h(d,ie),this.ctx=ie,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(d),this.groupLevel++}endGroup(l){if(!this.contentVisible)return;this.groupLevel--;const d=this.ctx,k=this.groupStack.pop();if(this.ctx=k,this.ctx.imageSmoothingEnabled=!1,l.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const B=(0,s.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...B);const G=e.Util.getAxialAlignedBoundingBox([0,0,d.canvas.width,d.canvas.height],B);this.ctx.drawImage(d.canvas,0,0),this.ctx.restore(),this.compose(G)}}beginAnnotation(l,d,k,B,G){if(J(this,ue,Yt).call(this),R(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(d)&&d.length===4){const W=d[2]-d[0],$=d[3]-d[1];if(G&&this.annotationCanvasMap){k=k.slice(),k[4]-=d[0],k[5]-=d[1],d=d.slice(),d[0]=d[1]=0,d[2]=W,d[3]=$;const[ce,me]=e.Util.singularValueDecompose2dScale((0,s.getCurrentTransform)(this.ctx)),{viewportScale:fe}=this,be=Math.ceil(W*this.outputScaleX*fe),Ee=Math.ceil($*this.outputScaleY*fe);this.annotationCanvas=this.canvasFactory.create(be,Ee);const{canvas:je,context:ie}=this.annotationCanvas;this.annotationCanvasMap.set(l,je),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ie,this.ctx.save(),this.ctx.setTransform(ce,0,0,-me,0,$*me),R(this.ctx)}else R(this.ctx),this.ctx.rect(d[0],d[1],W,$),this.ctx.clip(),this.endPath()}this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...k),this.transform(...B)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),J(this,ue,$t).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(l){if(!this.contentVisible)return;const d=l.count;l=this.getObject(l.data,l),l.count=d;const k=this.ctx,B=this.processingType3;if(B&&(B.compiled===void 0&&(B.compiled=u(l)),B.compiled)){B.compiled(k);return}const G=this._createMaskCanvas(l),W=G.canvas;k.save(),k.setTransform(1,0,0,1,0,0),k.drawImage(W,G.offsetX,G.offsetY),k.restore(),this.compose()}paintImageMaskXObjectRepeat(l,d,k=0,B=0,G,W){if(!this.contentVisible)return;l=this.getObject(l.data,l);const $=this.ctx;$.save();const ce=(0,s.getCurrentTransform)($);$.transform(d,k,B,G,0,0);const me=this._createMaskCanvas(l);$.setTransform(1,0,0,1,me.offsetX-ce[4],me.offsetY-ce[5]);for(let fe=0,be=W.length;fe<be;fe+=2){const Ee=e.Util.transform(ce,[d,k,B,G,W[fe],W[fe+1]]),[je,ie]=e.Util.applyTransform([0,0],Ee);$.drawImage(me.canvas,je,ie)}$.restore(),this.compose()}paintImageMaskXObjectGroup(l){if(!this.contentVisible)return;const d=this.ctx,k=this.current.fillColor,B=this.current.patternFill;for(const G of l){const{data:W,width:$,height:ce,transform:me}=G,fe=this.cachedCanvases.getCanvas("maskCanvas",$,ce),be=fe.context;be.save();const Ee=this.getObject(W,G);w(be,Ee),be.globalCompositeOperation="source-in",be.fillStyle=B?k.getPattern(be,this,(0,s.getCurrentTransformInverse)(d),a.PathType.FILL):k,be.fillRect(0,0,$,ce),be.restore(),d.save(),d.transform(...me),d.scale(1,-1),f(d,fe.canvas,0,0,$,ce,0,-1,1,1),d.restore()}this.compose()}paintImageXObject(l){if(!this.contentVisible)return;const d=this.getObject(l);if(!d){(0,e.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(d)}paintImageXObjectRepeat(l,d,k,B){if(!this.contentVisible)return;const G=this.getObject(l);if(!G){(0,e.warn)("Dependent image isn't ready yet");return}const W=G.width,$=G.height,ce=[];for(let me=0,fe=B.length;me<fe;me+=2)ce.push({transform:[d,0,0,k,B[me],B[me+1]],x:0,y:0,w:W,h:$});this.paintInlineImageXObjectGroup(G,ce)}applyTransferMapsToCanvas(l){return this.current.transferMaps!=="none"&&(l.filter=this.current.transferMaps,l.drawImage(l.canvas,0,0),l.filter="none"),l.canvas}applyTransferMapsToBitmap(l){if(this.current.transferMaps==="none")return l.bitmap;const{bitmap:d,width:k,height:B}=l,G=this.cachedCanvases.getCanvas("inlineImage",k,B),W=G.context;return W.filter=this.current.transferMaps,W.drawImage(d,0,0),W.filter="none",G.canvas}paintInlineImageXObject(l){if(!this.contentVisible)return;const d=l.width,k=l.height,B=this.ctx;if(this.save(),!e.isNodeJS){const{filter:$}=B;$!=="none"&&$!==""&&(B.filter="none")}B.scale(1/d,-1/k);let G;if(l.bitmap)G=this.applyTransferMapsToBitmap(l);else if(typeof HTMLElement=="function"&&l instanceof HTMLElement||!l.data)G=l;else{const ce=this.cachedCanvases.getCanvas("inlineImage",d,k).context;F(ce,l),G=this.applyTransferMapsToCanvas(ce)}const W=this._scaleImage(G,(0,s.getCurrentTransformInverse)(B));B.imageSmoothingEnabled=T((0,s.getCurrentTransform)(B),l.interpolate),f(B,W.img,0,0,W.paintWidth,W.paintHeight,0,-k,d,k),this.compose(),this.restore()}paintInlineImageXObjectGroup(l,d){if(!this.contentVisible)return;const k=this.ctx;let B;if(l.bitmap)B=l.bitmap;else{const G=l.width,W=l.height,ce=this.cachedCanvases.getCanvas("inlineImage",G,W).context;F(ce,l),B=this.applyTransferMapsToCanvas(ce)}for(const G of d)k.save(),k.transform(...G.transform),k.scale(1,-1),f(k,B,G.x,G.y,G.w,G.h,0,-1,1,1),k.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(l){}markPointProps(l,d){}beginMarkedContent(l){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(l,d){l==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(d)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(l){const d=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(l);const k=this.ctx;this.pendingClip&&(d||(this.pendingClip===Q?k.clip("evenodd"):k.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),k.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const l=(0,s.getCurrentTransform)(this.ctx);if(l[1]===0&&l[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(l[0]),Math.abs(l[3]));else{const d=Math.abs(l[0]*l[3]-l[2]*l[1]),k=Math.hypot(l[0],l[2]),B=Math.hypot(l[1],l[3]);this._cachedGetSinglePixelWidth=Math.max(k,B)/d}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:l}=this.current,{a:d,b:k,c:B,d:G}=this.ctx.getTransform();let W,$;if(k===0&&B===0){const ce=Math.abs(d),me=Math.abs(G);if(ce===me)if(l===0)W=$=1/ce;else{const fe=ce*l;W=$=fe<1?1/fe:1}else if(l===0)W=1/ce,$=1/me;else{const fe=ce*l,be=me*l;W=fe<1?1/fe:1,$=be<1?1/be:1}}else{const ce=Math.abs(d*G-k*B),me=Math.hypot(d,k),fe=Math.hypot(B,G);if(l===0)W=fe/ce,$=me/ce;else{const be=l*ce;W=fe>be?fe/be:1,$=me>be?me/be:1}}this._cachedScaleForStroking[0]=W,this._cachedScaleForStroking[1]=$}return this._cachedScaleForStroking}rescaleAndStroke(l){const{ctx:d}=this,{lineWidth:k}=this.current,[B,G]=this.getScaleForStroking();if(d.lineWidth=k||1,B===1&&G===1){d.stroke();return}const W=d.getLineDash();if(l&&d.save(),d.scale(B,G),W.length>0){const $=Math.max(B,G);d.setLineDash(W.map(ce=>ce/$)),d.lineDashOffset/=$}d.stroke(),l&&d.restore()}isContentVisible(){for(let l=this.markedContentStack.length-1;l>=0;l--)if(!this.markedContentStack[l].visible)return!1;return!0}};ue=new WeakSet,Yt=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},$t=function(){if(this.pageColors){const l=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(l!=="none"){const d=this.ctx.filter;this.ctx.filter=l,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=d}}};let K=ee;t.CanvasGraphics=K;for(const M in e.OPS)K.prototype[M]!==void 0&&(K.prototype[e.OPS[M]]=K.prototype[M])},(n,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TilingPattern=t.PathType=void 0,t.getShadingPattern=p;var e=i(1),s=i(6);const a={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};t.PathType=a;function o(u,C){if(!C)return;const F=C[2]-C[0],w=C[3]-C[1],h=new Path2D;h.rect(C[0],C[1],F,w),u.clip(h)}class D{constructor(){this.constructor===D&&(0,e.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,e.unreachable)("Abstract method `getPattern` called.")}}class S extends D{constructor(C){super(),this._type=C[1],this._bbox=C[2],this._colorStops=C[3],this._p0=C[4],this._p1=C[5],this._r0=C[6],this._r1=C[7],this.matrix=null}_createGradient(C){let F;this._type==="axial"?F=C.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(F=C.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const w of this._colorStops)F.addColorStop(w[0],w[1]);return F}getPattern(C,F,w,h){let R;if(h===a.STROKE||h===a.FILL){const b=F.current.getClippedPathBoundingBox(h,(0,s.getCurrentTransform)(C))||[0,0,0,0],j=Math.ceil(b[2]-b[0])||1,y=Math.ceil(b[3]-b[1])||1,L=F.cachedCanvases.getCanvas("pattern",j,y,!0),g=L.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-b[0],-b[1]),w=e.Util.transform(w,[1,0,0,1,b[0],b[1]]),g.transform(...F.baseTransform),this.matrix&&g.transform(...this.matrix),o(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),R=C.createPattern(L.canvas,"no-repeat");const T=new DOMMatrix(w);R.setTransform(T)}else o(C,this._bbox),R=this._createGradient(C);return R}}function E(u,C,F,w,h,R,b,j){const y=C.coords,L=C.colors,g=u.data,T=u.width*4;let z;y[F+1]>y[w+1]&&(z=F,F=w,w=z,z=R,R=b,b=z),y[w+1]>y[h+1]&&(z=w,w=h,h=z,z=b,b=j,j=z),y[F+1]>y[w+1]&&(z=F,F=w,w=z,z=R,R=b,b=z);const se=(y[F]+C.offsetX)*C.scaleX,V=(y[F+1]+C.offsetY)*C.scaleY,Q=(y[w]+C.offsetX)*C.scaleX,K=(y[w+1]+C.offsetY)*C.scaleY,ue=(y[h]+C.offsetX)*C.scaleX,I=(y[h+1]+C.offsetY)*C.scaleY;if(V>=I)return;const q=L[R],ee=L[R+1],M=L[R+2],l=L[b],d=L[b+1],k=L[b+2],B=L[j],G=L[j+1],W=L[j+2],$=Math.round(V),ce=Math.round(I);let me,fe,be,Ee,je,ie,ae,P;for(let H=$;H<=ce;H++){if(H<K){const Ae=H<V?0:(V-H)/(V-K);me=se-(se-Q)*Ae,fe=q-(q-l)*Ae,be=ee-(ee-d)*Ae,Ee=M-(M-k)*Ae}else{let Ae;H>I?Ae=1:K===I?Ae=0:Ae=(K-H)/(K-I),me=Q-(Q-ue)*Ae,fe=l-(l-B)*Ae,be=d-(d-G)*Ae,Ee=k-(k-W)*Ae}let Z;H<V?Z=0:H>I?Z=1:Z=(V-H)/(V-I),je=se-(se-ue)*Z,ie=q-(q-B)*Z,ae=ee-(ee-G)*Z,P=M-(M-W)*Z;const ne=Math.round(Math.min(me,je)),xe=Math.round(Math.max(me,je));let Re=T*H+ne*4;for(let Ae=ne;Ae<=xe;Ae++)Z=(me-Ae)/(me-je),Z<0?Z=0:Z>1&&(Z=1),g[Re++]=fe-(fe-ie)*Z|0,g[Re++]=be-(be-ae)*Z|0,g[Re++]=Ee-(Ee-P)*Z|0,g[Re++]=255}}function c(u,C,F){const w=C.coords,h=C.colors;let R,b;switch(C.type){case"lattice":const j=C.verticesPerRow,y=Math.floor(w.length/j)-1,L=j-1;for(R=0;R<y;R++){let g=R*j;for(let T=0;T<L;T++,g++)E(u,F,w[g],w[g+1],w[g+j],h[g],h[g+1],h[g+j]),E(u,F,w[g+j+1],w[g+1],w[g+j],h[g+j+1],h[g+1],h[g+j])}break;case"triangles":for(R=0,b=w.length;R<b;R+=3)E(u,F,w[R],w[R+1],w[R+2],h[R],h[R+1],h[R+2]);break;default:throw new Error("illegal figure")}}class v extends D{constructor(C){super(),this._coords=C[2],this._colors=C[3],this._figures=C[4],this._bounds=C[5],this._bbox=C[7],this._background=C[8],this.matrix=null}_createMeshCanvas(C,F,w){const j=Math.floor(this._bounds[0]),y=Math.floor(this._bounds[1]),L=Math.ceil(this._bounds[2])-j,g=Math.ceil(this._bounds[3])-y,T=Math.min(Math.ceil(Math.abs(L*C[0]*1.1)),3e3),z=Math.min(Math.ceil(Math.abs(g*C[1]*1.1)),3e3),se=L/T,V=g/z,Q={coords:this._coords,colors:this._colors,offsetX:-j,offsetY:-y,scaleX:1/se,scaleY:1/V},K=T+2*2,ue=z+2*2,I=w.getCanvas("mesh",K,ue,!1),q=I.context,ee=q.createImageData(T,z);if(F){const l=ee.data;for(let d=0,k=l.length;d<k;d+=4)l[d]=F[0],l[d+1]=F[1],l[d+2]=F[2],l[d+3]=255}for(const l of this._figures)c(ee,l,Q);return q.putImageData(ee,2,2),{canvas:I.canvas,offsetX:j-2*se,offsetY:y-2*V,scaleX:se,scaleY:V}}getPattern(C,F,w,h){o(C,this._bbox);let R;if(h===a.SHADING)R=e.Util.singularValueDecompose2dScale((0,s.getCurrentTransform)(C));else if(R=e.Util.singularValueDecompose2dScale(F.baseTransform),this.matrix){const j=e.Util.singularValueDecompose2dScale(this.matrix);R=[R[0]*j[0],R[1]*j[1]]}const b=this._createMeshCanvas(R,h===a.SHADING?null:this._background,F.cachedCanvases);return h!==a.SHADING&&(C.setTransform(...F.baseTransform),this.matrix&&C.transform(...this.matrix)),C.translate(b.offsetX,b.offsetY),C.scale(b.scaleX,b.scaleY),C.createPattern(b.canvas,"no-repeat")}}class x extends D{getPattern(){return"hotpink"}}function p(u){switch(u[0]){case"RadialAxial":return new S(u);case"Mesh":return new v(u);case"Dummy":return new x}throw new Error(`Unknown IR type: ${u[0]}`)}const _={COLORED:1,UNCOLORED:2},f=class f{constructor(C,F,w,h,R){this.operatorList=C[2],this.matrix=C[3]||[1,0,0,1,0,0],this.bbox=C[4],this.xstep=C[5],this.ystep=C[6],this.paintType=C[7],this.tilingType=C[8],this.color=F,this.ctx=w,this.canvasGraphicsFactory=h,this.baseTransform=R}createPatternCanvas(C){const F=this.operatorList,w=this.bbox,h=this.xstep,R=this.ystep,b=this.paintType,j=this.tilingType,y=this.color,L=this.canvasGraphicsFactory;(0,e.info)("TilingType: "+j);const g=w[0],T=w[1],z=w[2],se=w[3],V=e.Util.singularValueDecompose2dScale(this.matrix),Q=e.Util.singularValueDecompose2dScale(this.baseTransform),K=[V[0]*Q[0],V[1]*Q[1]],ue=this.getSizeAndScale(h,this.ctx.canvas.width,K[0]),I=this.getSizeAndScale(R,this.ctx.canvas.height,K[1]),q=C.cachedCanvases.getCanvas("pattern",ue.size,I.size,!0),ee=q.context,M=L.createCanvasGraphics(ee);M.groupLevel=C.groupLevel,this.setFillAndStrokeStyleToContext(M,b,y);let l=g,d=T,k=z,B=se;return g<0&&(l=0,k+=Math.abs(g)),T<0&&(d=0,B+=Math.abs(T)),ee.translate(-(ue.scale*l),-(I.scale*d)),M.transform(ue.scale,0,0,I.scale,0,0),ee.save(),this.clipBbox(M,l,d,k,B),M.baseTransform=(0,s.getCurrentTransform)(M.ctx),M.executeOperatorList(F),M.endDrawing(),{canvas:q.canvas,scaleX:ue.scale,scaleY:I.scale,offsetX:l,offsetY:d}}getSizeAndScale(C,F,w){C=Math.abs(C);const h=Math.max(f.MAX_PATTERN_SIZE,F);let R=Math.ceil(C*w);return R>=h?R=h:w=R/C,{scale:w,size:R}}clipBbox(C,F,w,h,R){const b=h-F,j=R-w;C.ctx.rect(F,w,b,j),C.current.updateRectMinMax((0,s.getCurrentTransform)(C.ctx),[F,w,h,R]),C.clip(),C.endPath()}setFillAndStrokeStyleToContext(C,F,w){const h=C.ctx,R=C.current;switch(F){case _.COLORED:const b=this.ctx;h.fillStyle=b.fillStyle,h.strokeStyle=b.strokeStyle,R.fillColor=b.fillStyle,R.strokeColor=b.strokeStyle;break;case _.UNCOLORED:const j=e.Util.makeHexColor(w[0],w[1],w[2]);h.fillStyle=j,h.strokeStyle=j,R.fillColor=j,R.strokeColor=j;break;default:throw new e.FormatError(`Unsupported paint type: ${F}`)}}getPattern(C,F,w,h){let R=w;h!==a.SHADING&&(R=e.Util.transform(R,F.baseTransform),this.matrix&&(R=e.Util.transform(R,this.matrix)));const b=this.createPatternCanvas(F);let j=new DOMMatrix(R);j=j.translate(b.offsetX,b.offsetY),j=j.scale(1/b.scaleX,1/b.scaleY);const y=C.createPattern(b.canvas,"repeat");return y.setTransform(j),y}};Ze(f,"MAX_PATTERN_SIZE",3e3);let A=f;t.TilingPattern=A},(n,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertBlackAndWhiteToRGBA=a,t.convertToRGBA=s,t.grayToRGBA=D;var e=i(1);function s(S){switch(S.kind){case e.ImageKind.GRAYSCALE_1BPP:return a(S);case e.ImageKind.RGB_24BPP:return o(S)}return null}function a({src:S,srcPos:E=0,dest:c,width:v,height:x,nonBlackColor:p=4294967295,inverseDecode:_=!1}){const A=e.FeatureTest.isLittleEndian?4278190080:255,[f,u]=_?[p,A]:[A,p],C=v>>3,F=v&7,w=S.length;c=new Uint32Array(c.buffer);let h=0;for(let R=0;R<x;R++){for(const j=E+C;E<j;E++){const y=E<w?S[E]:255;c[h++]=y&128?u:f,c[h++]=y&64?u:f,c[h++]=y&32?u:f,c[h++]=y&16?u:f,c[h++]=y&8?u:f,c[h++]=y&4?u:f,c[h++]=y&2?u:f,c[h++]=y&1?u:f}if(F===0)continue;const b=E<w?S[E++]:255;for(let j=0;j<F;j++)c[h++]=b&1<<7-j?u:f}return{srcPos:E,destPos:h}}function o({src:S,srcPos:E=0,dest:c,destPos:v=0,width:x,height:p}){let _=0;const A=S.length>>2,f=new Uint32Array(S.buffer,E,A);if(e.FeatureTest.isLittleEndian){for(;_<A-2;_+=3,v+=4){const u=f[_],C=f[_+1],F=f[_+2];c[v]=u|4278190080,c[v+1]=u>>>24|C<<8|4278190080,c[v+2]=C>>>16|F<<16|4278190080,c[v+3]=F>>>8|4278190080}for(let u=_*4,C=S.length;u<C;u+=3)c[v++]=S[u]|S[u+1]<<8|S[u+2]<<16|4278190080}else{for(;_<A-2;_+=3,v+=4){const u=f[_],C=f[_+1],F=f[_+2];c[v]=u|255,c[v+1]=u<<24|C>>>8|255,c[v+2]=C<<16|F>>>16|255,c[v+3]=F<<8|255}for(let u=_*4,C=S.length;u<C;u+=3)c[v++]=S[u]<<24|S[u+1]<<16|S[u+2]<<8|255}return{srcPos:E,destPos:v}}function D(S,E){if(e.FeatureTest.isLittleEndian)for(let c=0,v=S.length;c<v;c++)E[c]=S[c]*65793|4278190080;else for(let c=0,v=S.length;c<v;c++)E[c]=S[c]*16843008|255}},(n,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;const i=Object.create(null);t.GlobalWorkerOptions=i,i.workerPort=null,i.workerSrc=""},(n,t,i)=>{var S,Cs,ws,_t;Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var e=i(1);const s={DATA:1,ERROR:2},a={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function o(x){switch(x instanceof Error||typeof x=="object"&&x!==null||(0,e.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),x.name){case"AbortException":return new e.AbortException(x.message);case"MissingPDFException":return new e.MissingPDFException(x.message);case"PasswordException":return new e.PasswordException(x.message,x.code);case"UnexpectedResponseException":return new e.UnexpectedResponseException(x.message,x.status);case"UnknownErrorException":return new e.UnknownErrorException(x.message,x.details);default:return new e.UnknownErrorException(x.message,x.toString())}}class D{constructor(p,_,A){re(this,S);this.sourceName=p,this.targetName=_,this.comObj=A,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=f=>{const u=f.data;if(u.targetName!==this.sourceName)return;if(u.stream){J(this,S,ws).call(this,u);return}if(u.callback){const F=u.callbackId,w=this.callbackCapabilities[F];if(!w)throw new Error(`Cannot resolve callback ${F}`);if(delete this.callbackCapabilities[F],u.callback===s.DATA)w.resolve(u.data);else if(u.callback===s.ERROR)w.reject(o(u.reason));else throw new Error("Unexpected callback case");return}const C=this.actionHandler[u.action];if(!C)throw new Error(`Unknown action from worker: ${u.action}`);if(u.callbackId){const F=this.sourceName,w=u.sourceName;new Promise(function(h){h(C(u.data))}).then(function(h){A.postMessage({sourceName:F,targetName:w,callback:s.DATA,callbackId:u.callbackId,data:h})},function(h){A.postMessage({sourceName:F,targetName:w,callback:s.ERROR,callbackId:u.callbackId,reason:o(h)})});return}if(u.streamId){J(this,S,Cs).call(this,u);return}C(u.data)},A.addEventListener("message",this._onComObjOnMessage)}on(p,_){const A=this.actionHandler;if(A[p])throw new Error(`There is already an actionName called "${p}"`);A[p]=_}send(p,_,A){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:p,data:_},A)}sendWithPromise(p,_,A){const f=this.callbackId++,u=new e.PromiseCapability;this.callbackCapabilities[f]=u;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:p,callbackId:f,data:_},A)}catch(C){u.reject(C)}return u.promise}sendWithStream(p,_,A,f){const u=this.streamId++,C=this.sourceName,F=this.targetName,w=this.comObj;return new ReadableStream({start:h=>{const R=new e.PromiseCapability;return this.streamControllers[u]={controller:h,startCall:R,pullCall:null,cancelCall:null,isClosed:!1},w.postMessage({sourceName:C,targetName:F,action:p,streamId:u,data:_,desiredSize:h.desiredSize},f),R.promise},pull:h=>{const R=new e.PromiseCapability;return this.streamControllers[u].pullCall=R,w.postMessage({sourceName:C,targetName:F,stream:a.PULL,streamId:u,desiredSize:h.desiredSize}),R.promise},cancel:h=>{(0,e.assert)(h instanceof Error,"cancel must have a valid reason");const R=new e.PromiseCapability;return this.streamControllers[u].cancelCall=R,this.streamControllers[u].isClosed=!0,w.postMessage({sourceName:C,targetName:F,stream:a.CANCEL,streamId:u,reason:o(h)}),R.promise}},A)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}S=new WeakSet,Cs=function(p){const _=p.streamId,A=this.sourceName,f=p.sourceName,u=this.comObj,C=this,F=this.actionHandler[p.action],w={enqueue(h,R=1,b){if(this.isCancelled)return;const j=this.desiredSize;this.desiredSize-=R,j>0&&this.desiredSize<=0&&(this.sinkCapability=new e.PromiseCapability,this.ready=this.sinkCapability.promise),u.postMessage({sourceName:A,targetName:f,stream:a.ENQUEUE,streamId:_,chunk:h},b)},close(){this.isCancelled||(this.isCancelled=!0,u.postMessage({sourceName:A,targetName:f,stream:a.CLOSE,streamId:_}),delete C.streamSinks[_])},error(h){(0,e.assert)(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,u.postMessage({sourceName:A,targetName:f,stream:a.ERROR,streamId:_,reason:o(h)}))},sinkCapability:new e.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:p.desiredSize,ready:null};w.sinkCapability.resolve(),w.ready=w.sinkCapability.promise,this.streamSinks[_]=w,new Promise(function(h){h(F(p.data,w))}).then(function(){u.postMessage({sourceName:A,targetName:f,stream:a.START_COMPLETE,streamId:_,success:!0})},function(h){u.postMessage({sourceName:A,targetName:f,stream:a.START_COMPLETE,streamId:_,reason:o(h)})})},ws=function(p){const _=p.streamId,A=this.sourceName,f=p.sourceName,u=this.comObj,C=this.streamControllers[_],F=this.streamSinks[_];switch(p.stream){case a.START_COMPLETE:p.success?C.startCall.resolve():C.startCall.reject(o(p.reason));break;case a.PULL_COMPLETE:p.success?C.pullCall.resolve():C.pullCall.reject(o(p.reason));break;case a.PULL:if(!F){u.postMessage({sourceName:A,targetName:f,stream:a.PULL_COMPLETE,streamId:_,success:!0});break}F.desiredSize<=0&&p.desiredSize>0&&F.sinkCapability.resolve(),F.desiredSize=p.desiredSize,new Promise(function(w){var h;w((h=F.onPull)==null?void 0:h.call(F))}).then(function(){u.postMessage({sourceName:A,targetName:f,stream:a.PULL_COMPLETE,streamId:_,success:!0})},function(w){u.postMessage({sourceName:A,targetName:f,stream:a.PULL_COMPLETE,streamId:_,reason:o(w)})});break;case a.ENQUEUE:if((0,e.assert)(C,"enqueue should have stream controller"),C.isClosed)break;C.controller.enqueue(p.chunk);break;case a.CLOSE:if((0,e.assert)(C,"close should have stream controller"),C.isClosed)break;C.isClosed=!0,C.controller.close(),J(this,S,_t).call(this,C,_);break;case a.ERROR:(0,e.assert)(C,"error should have stream controller"),C.controller.error(o(p.reason)),J(this,S,_t).call(this,C,_);break;case a.CANCEL_COMPLETE:p.success?C.cancelCall.resolve():C.cancelCall.reject(o(p.reason)),J(this,S,_t).call(this,C,_);break;case a.CANCEL:if(!F)break;new Promise(function(w){var h;w((h=F.onCancel)==null?void 0:h.call(F,o(p.reason)))}).then(function(){u.postMessage({sourceName:A,targetName:f,stream:a.CANCEL_COMPLETE,streamId:_,success:!0})},function(w){u.postMessage({sourceName:A,targetName:f,stream:a.CANCEL_COMPLETE,streamId:_,reason:o(w)})}),F.sinkCapability.reject(o(p.reason)),F.isCancelled=!0,delete this.streamSinks[_];break;default:throw new Error("Unexpected stream case")}},_t=async function(p,_){var A,f,u;await Promise.allSettled([(A=p.startCall)==null?void 0:A.promise,(f=p.pullCall)==null?void 0:f.promise,(u=p.cancelCall)==null?void 0:u.promise]),delete this.streamControllers[_]},t.MessageHandler=D},(n,t,i)=>{var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var e=i(1);class s{constructor({parsedData:S,rawData:E}){re(this,a);re(this,o);le(this,a,S),le(this,o,E)}getRaw(){return r(this,o)}get(S){return r(this,a).get(S)??null}getAll(){return(0,e.objectFromMap)(r(this,a))}has(S){return r(this,a).has(S)}}a=new WeakMap,o=new WeakMap,t.Metadata=s},(n,t,i)=>{var S,E,c,v,x,p,Jt;Object.defineProperty(t,"__esModule",{value:!0}),t.OptionalContentConfig=void 0;var e=i(1),s=i(8);const a=Symbol("INTERNAL");class o{constructor(f,u){re(this,S,!0);this.name=f,this.intent=u}get visible(){return r(this,S)}_setVisible(f,u){f!==a&&(0,e.unreachable)("Internal method `_setVisible` called."),le(this,S,u)}}S=new WeakMap;class D{constructor(f){re(this,p);re(this,E,null);re(this,c,new Map);re(this,v,null);re(this,x,null);if(this.name=null,this.creator=null,f!==null){this.name=f.name,this.creator=f.creator,le(this,x,f.order);for(const u of f.groups)r(this,c).set(u.id,new o(u.name,u.intent));if(f.baseState==="OFF")for(const u of r(this,c).values())u._setVisible(a,!1);for(const u of f.on)r(this,c).get(u)._setVisible(a,!0);for(const u of f.off)r(this,c).get(u)._setVisible(a,!1);le(this,v,this.getHash())}}isVisible(f){if(r(this,c).size===0)return!0;if(!f)return(0,e.warn)("Optional content group not defined."),!0;if(f.type==="OCG")return r(this,c).has(f.id)?r(this,c).get(f.id).visible:((0,e.warn)(`Optional content group not found: ${f.id}`),!0);if(f.type==="OCMD"){if(f.expression)return J(this,p,Jt).call(this,f.expression);if(!f.policy||f.policy==="AnyOn"){for(const u of f.ids){if(!r(this,c).has(u))return(0,e.warn)(`Optional content group not found: ${u}`),!0;if(r(this,c).get(u).visible)return!0}return!1}else if(f.policy==="AllOn"){for(const u of f.ids){if(!r(this,c).has(u))return(0,e.warn)(`Optional content group not found: ${u}`),!0;if(!r(this,c).get(u).visible)return!1}return!0}else if(f.policy==="AnyOff"){for(const u of f.ids){if(!r(this,c).has(u))return(0,e.warn)(`Optional content group not found: ${u}`),!0;if(!r(this,c).get(u).visible)return!0}return!1}else if(f.policy==="AllOff"){for(const u of f.ids){if(!r(this,c).has(u))return(0,e.warn)(`Optional content group not found: ${u}`),!0;if(r(this,c).get(u).visible)return!1}return!0}return(0,e.warn)(`Unknown optional content policy ${f.policy}.`),!0}return(0,e.warn)(`Unknown group type ${f.type}.`),!0}setVisibility(f,u=!0){if(!r(this,c).has(f)){(0,e.warn)(`Optional content group not found: ${f}`);return}r(this,c).get(f)._setVisible(a,!!u),le(this,E,null)}get hasInitialVisibility(){return r(this,v)===null||this.getHash()===r(this,v)}getOrder(){return r(this,c).size?r(this,x)?r(this,x).slice():[...r(this,c).keys()]:null}getGroups(){return r(this,c).size>0?(0,e.objectFromMap)(r(this,c)):null}getGroup(f){return r(this,c).get(f)||null}getHash(){if(r(this,E)!==null)return r(this,E);const f=new s.MurmurHash3_64;for(const[u,C]of r(this,c))f.update(`${u}:${C.visible}`);return le(this,E,f.hexdigest())}}E=new WeakMap,c=new WeakMap,v=new WeakMap,x=new WeakMap,p=new WeakSet,Jt=function(f){const u=f.length;if(u<2)return!0;const C=f[0];for(let F=1;F<u;F++){const w=f[F];let h;if(Array.isArray(w))h=J(this,p,Jt).call(this,w);else if(r(this,c).has(w))h=r(this,c).get(w).visible;else return(0,e.warn)(`Optional content group not found: ${w}`),!0;switch(C){case"And":if(!h)return!1;break;case"Or":if(h)return!0;break;case"Not":return!h;default:return!0}}return C==="And"},t.OptionalContentConfig=D},(n,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var e=i(1),s=i(6);class a{constructor({length:E,initialData:c,progressiveDone:v=!1,contentDispositionFilename:x=null,disableRange:p=!1,disableStream:_=!1},A){if((0,e.assert)(A,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=v,this._contentDispositionFilename=x,(c==null?void 0:c.length)>0){const f=c instanceof Uint8Array&&c.byteLength===c.buffer.byteLength?c.buffer:new Uint8Array(c).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=A,this._isStreamingSupported=!_,this._isRangeSupported=!p,this._contentLength=E,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((f,u)=>{this._onReceiveData({begin:f,chunk:u})}),this._pdfDataRangeTransport.addProgressListener((f,u)=>{this._onProgress({loaded:f,total:u})}),this._pdfDataRangeTransport.addProgressiveReadListener(f=>{this._onReceiveData({chunk:f})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:E,chunk:c}){const v=c instanceof Uint8Array&&c.byteLength===c.buffer.byteLength?c.buffer:new Uint8Array(c).buffer;if(E===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(v):this._queuedChunks.push(v);else{const x=this._rangeReaders.some(function(p){return p._begin!==E?!1:(p._enqueue(v),!0)});(0,e.assert)(x,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var E;return((E=this._fullRequestReader)==null?void 0:E._loaded)??0}_onProgress(E){var c,v,x,p;E.total===void 0?(v=(c=this._rangeReaders[0])==null?void 0:c.onProgress)==null||v.call(c,{loaded:E.loaded}):(p=(x=this._fullRequestReader)==null?void 0:x.onProgress)==null||p.call(x,{loaded:E.loaded,total:E.total})}_onProgressiveDone(){var E;(E=this._fullRequestReader)==null||E.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(E){const c=this._rangeReaders.indexOf(E);c>=0&&this._rangeReaders.splice(c,1)}getFullReader(){(0,e.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const E=this._queuedChunks;return this._queuedChunks=null,new o(this,E,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(E,c){if(c<=this._progressiveDataLength)return null;const v=new D(this,E,c);return this._pdfDataRangeTransport.requestDataRange(E,c),this._rangeReaders.push(v),v}cancelAllRequests(E){var c;(c=this._fullRequestReader)==null||c.cancel(E);for(const v of this._rangeReaders.slice(0))v.cancel(E);this._pdfDataRangeTransport.abort()}}t.PDFDataTransportStream=a;class o{constructor(E,c,v=!1,x=null){this._stream=E,this._done=v||!1,this._filename=(0,s.isPdfFile)(x)?x:null,this._queuedChunks=c||[],this._loaded=0;for(const p of this._queuedChunks)this._loaded+=p.byteLength;this._requests=[],this._headersReady=Promise.resolve(),E._fullRequestReader=this,this.onProgress=null}_enqueue(E){this._done||(this._requests.length>0?this._requests.shift().resolve({value:E,done:!1}):this._queuedChunks.push(E),this._loaded+=E.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const E=new e.PromiseCapability;return this._requests.push(E),E.promise}cancel(E){this._done=!0;for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class D{constructor(E,c,v){this._stream=E,this._begin=c,this._end=v,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(E){if(!this._done){if(this._requests.length===0)this._queuedChunk=E;else{this._requests.shift().resolve({value:E,done:!1});for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const c=this._queuedChunk;return this._queuedChunk=null,{value:c,done:!1}}if(this._done)return{value:void 0,done:!0};const E=new e.PromiseCapability;return this._requests.push(E),E.promise}cancel(E){this._done=!0;for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(n,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var e=i(1),s=i(20);function a(v,x,p){return{method:"GET",headers:v,signal:p.signal,mode:"cors",credentials:x?"include":"same-origin",redirect:"follow"}}function o(v){const x=new Headers;for(const p in v){const _=v[p];_!==void 0&&x.append(p,_)}return x}function D(v){return v instanceof Uint8Array?v.buffer:v instanceof ArrayBuffer?v:((0,e.warn)(`getArrayBuffer - unexpected data format: ${v}`),new Uint8Array(v).buffer)}class S{constructor(x){this.source=x,this.isHttp=/^https?:/i.test(x.url),this.httpHeaders=this.isHttp&&x.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var x;return((x=this._fullRequestReader)==null?void 0:x._loaded)??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new E(this),this._fullRequestReader}getRangeReader(x,p){if(p<=this._progressiveDataLength)return null;const _=new c(this,x,p);return this._rangeRequestReaders.push(_),_}cancelAllRequests(x){var p;(p=this._fullRequestReader)==null||p.cancel(x);for(const _ of this._rangeRequestReaders.slice(0))_.cancel(x)}}t.PDFFetchStream=S;class E{constructor(x){this._stream=x,this._reader=null,this._loaded=0,this._filename=null;const p=x.source;this._withCredentials=p.withCredentials||!1,this._contentLength=p.length,this._headersCapability=new e.PromiseCapability,this._disableRange=p.disableRange||!1,this._rangeChunkSize=p.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!p.disableStream,this._isRangeSupported=!p.disableRange,this._headers=o(this._stream.httpHeaders);const _=p.url;fetch(_,a(this._headers,this._withCredentials,this._abortController)).then(A=>{if(!(0,s.validateResponseStatus)(A.status))throw(0,s.createResponseStatusError)(A.status,_);this._reader=A.body.getReader(),this._headersCapability.resolve();const f=F=>A.headers.get(F),{allowRangeRequests:u,suggestedLength:C}=(0,s.validateRangeRequestCapabilities)({getResponseHeader:f,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=C||this._contentLength,this._filename=(0,s.extractFilenameFromHeader)(f),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new e.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var _;await this._headersCapability.promise;const{value:x,done:p}=await this._reader.read();return p?{value:x,done:p}:(this._loaded+=x.byteLength,(_=this.onProgress)==null||_.call(this,{loaded:this._loaded,total:this._contentLength}),{value:D(x),done:!1})}cancel(x){var p;(p=this._reader)==null||p.cancel(x),this._abortController.abort()}}class c{constructor(x,p,_){this._stream=x,this._reader=null,this._loaded=0;const A=x.source;this._withCredentials=A.withCredentials||!1,this._readCapability=new e.PromiseCapability,this._isStreamingSupported=!A.disableStream,this._abortController=new AbortController,this._headers=o(this._stream.httpHeaders),this._headers.append("Range",`bytes=${p}-${_-1}`);const f=A.url;fetch(f,a(this._headers,this._withCredentials,this._abortController)).then(u=>{if(!(0,s.validateResponseStatus)(u.status))throw(0,s.createResponseStatusError)(u.status,f);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var _;await this._readCapability.promise;const{value:x,done:p}=await this._reader.read();return p?{value:x,done:p}:(this._loaded+=x.byteLength,(_=this.onProgress)==null||_.call(this,{loaded:this._loaded}),{value:D(x),done:!1})}cancel(x){var p;(p=this._reader)==null||p.cancel(x),this._abortController.abort()}}},(n,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=S,t.extractFilenameFromHeader=D,t.validateRangeRequestCapabilities=o,t.validateResponseStatus=E;var e=i(1),s=i(21),a=i(6);function o({getResponseHeader:c,isHttp:v,rangeChunkSize:x,disableRange:p}){const _={allowRangeRequests:!1,suggestedLength:void 0},A=parseInt(c("Content-Length"),10);return!Number.isInteger(A)||(_.suggestedLength=A,A<=2*x)||p||!v||c("Accept-Ranges")!=="bytes"||(c("Content-Encoding")||"identity")!=="identity"||(_.allowRangeRequests=!0),_}function D(c){const v=c("Content-Disposition");if(v){let x=(0,s.getFilenameFromContentDispositionHeader)(v);if(x.includes("%"))try{x=decodeURIComponent(x)}catch{}if((0,a.isPdfFile)(x))return x}return null}function S(c,v){return c===404||c===0&&v.startsWith("file:")?new e.MissingPDFException('Missing PDF "'+v+'".'):new e.UnexpectedResponseException(`Unexpected server response (${c}) while retrieving PDF "${v}".`,c)}function E(c){return c===200||c===206}},(n,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=s;var e=i(1);function s(a){let o=!0,D=S("filename\\*","i").exec(a);if(D){D=D[1];let A=x(D);return A=unescape(A),A=p(A),A=_(A),c(A)}if(D=v(a),D){const A=_(D);return c(A)}if(D=S("filename","i").exec(a),D){D=D[1];let A=x(D);return A=_(A),c(A)}function S(A,f){return new RegExp("(?:^|;)\\s*"+A+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function E(A,f){if(A){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const u=new TextDecoder(A,{fatal:!0}),C=(0,e.stringToBytes)(f);f=u.decode(C),o=!1}catch{}}return f}function c(A){return o&&/[\x80-\xff]/.test(A)&&(A=E("utf-8",A),o&&(A=E("iso-8859-1",A))),A}function v(A){const f=[];let u;const C=S("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(u=C.exec(A))!==null;){let[,w,h,R]=u;if(w=parseInt(w,10),w in f){if(w===0)break;continue}f[w]=[h,R]}const F=[];for(let w=0;w<f.length&&w in f;++w){let[h,R]=f[w];R=x(R),h&&(R=unescape(R),w===0&&(R=p(R))),F.push(R)}return F.join("")}function x(A){if(A.startsWith('"')){const f=A.slice(1).split('\\"');for(let u=0;u<f.length;++u){const C=f[u].indexOf('"');C!==-1&&(f[u]=f[u].slice(0,C),f.length=u+1),f[u]=f[u].replaceAll(/\\(.)/g,"$1")}A=f.join('"')}return A}function p(A){const f=A.indexOf("'");if(f===-1)return A;const u=A.slice(0,f),F=A.slice(f+1).replace(/^[^']*'/,"");return E(u,F)}function _(A){return!A.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(A)?A:A.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,u,C,F){if(C==="q"||C==="Q")return F=F.replaceAll("_"," "),F=F.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,h){return String.fromCharCode(parseInt(h,16))}),E(u,F);try{F=atob(F)}catch{}return E(u,F)})}return""}},(n,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var e=i(1),s=i(20);const a=200,o=206;function D(x){const p=x.response;return typeof p!="string"?p:(0,e.stringToBytes)(p).buffer}class S{constructor(p,_={}){this.url=p,this.isHttp=/^https?:/i.test(p),this.httpHeaders=this.isHttp&&_.httpHeaders||Object.create(null),this.withCredentials=_.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(p,_,A){const f={begin:p,end:_};for(const u in A)f[u]=A[u];return this.request(f)}requestFull(p){return this.request(p)}request(p){const _=new XMLHttpRequest,A=this.currXhrId++,f=this.pendingRequests[A]={xhr:_};_.open("GET",this.url),_.withCredentials=this.withCredentials;for(const u in this.httpHeaders){const C=this.httpHeaders[u];C!==void 0&&_.setRequestHeader(u,C)}return this.isHttp&&"begin"in p&&"end"in p?(_.setRequestHeader("Range",`bytes=${p.begin}-${p.end-1}`),f.expectedStatus=o):f.expectedStatus=a,_.responseType="arraybuffer",p.onError&&(_.onerror=function(u){p.onError(_.status)}),_.onreadystatechange=this.onStateChange.bind(this,A),_.onprogress=this.onProgress.bind(this,A),f.onHeadersReceived=p.onHeadersReceived,f.onDone=p.onDone,f.onError=p.onError,f.onProgress=p.onProgress,_.send(null),A}onProgress(p,_){var f;const A=this.pendingRequests[p];A&&((f=A.onProgress)==null||f.call(A,_))}onStateChange(p,_){var w,h,R;const A=this.pendingRequests[p];if(!A)return;const f=A.xhr;if(f.readyState>=2&&A.onHeadersReceived&&(A.onHeadersReceived(),delete A.onHeadersReceived),f.readyState!==4||!(p in this.pendingRequests))return;if(delete this.pendingRequests[p],f.status===0&&this.isHttp){(w=A.onError)==null||w.call(A,f.status);return}const u=f.status||a;if(!(u===a&&A.expectedStatus===o)&&u!==A.expectedStatus){(h=A.onError)==null||h.call(A,f.status);return}const F=D(f);if(u===o){const b=f.getResponseHeader("Content-Range"),j=/bytes (\d+)-(\d+)\/(\d+)/.exec(b);A.onDone({begin:parseInt(j[1],10),chunk:F})}else F?A.onDone({begin:0,chunk:F}):(R=A.onError)==null||R.call(A,f.status)}getRequestXhr(p){return this.pendingRequests[p].xhr}isPendingRequest(p){return p in this.pendingRequests}abortRequest(p){const _=this.pendingRequests[p].xhr;delete this.pendingRequests[p],_.abort()}}class E{constructor(p){this._source=p,this._manager=new S(p.url,{httpHeaders:p.httpHeaders,withCredentials:p.withCredentials}),this._rangeChunkSize=p.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(p){const _=this._rangeRequestReaders.indexOf(p);_>=0&&this._rangeRequestReaders.splice(_,1)}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new c(this._manager,this._source),this._fullRequestReader}getRangeReader(p,_){const A=new v(this._manager,p,_);return A.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(A),A}cancelAllRequests(p){var _;(_=this._fullRequestReader)==null||_.cancel(p);for(const A of this._rangeRequestReaders.slice(0))A.cancel(p)}}t.PDFNetworkStream=E;class c{constructor(p,_){this._manager=p;const A={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=_.url,this._fullRequestId=p.requestFull(A),this._headersReceivedCapability=new e.PromiseCapability,this._disableRange=_.disableRange||!1,this._contentLength=_.length,this._rangeChunkSize=_.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const p=this._fullRequestId,_=this._manager.getRequestXhr(p),A=C=>_.getResponseHeader(C),{allowRangeRequests:f,suggestedLength:u}=(0,s.validateRangeRequestCapabilities)({getResponseHeader:A,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});f&&(this._isRangeSupported=!0),this._contentLength=u||this._contentLength,this._filename=(0,s.extractFilenameFromHeader)(A),this._isRangeSupported&&this._manager.abortRequest(p),this._headersReceivedCapability.resolve()}_onDone(p){if(p&&(this._requests.length>0?this._requests.shift().resolve({value:p.chunk,done:!1}):this._cachedChunks.push(p.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(p){this._storedError=(0,s.createResponseStatusError)(p,this._url),this._headersReceivedCapability.reject(this._storedError);for(const _ of this._requests)_.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(p){var _;(_=this.onProgress)==null||_.call(this,{loaded:p.loaded,total:p.lengthComputable?p.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const p=new e.PromiseCapability;return this._requests.push(p),p.promise}cancel(p){this._done=!0,this._headersReceivedCapability.reject(p);for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class v{constructor(p,_,A){this._manager=p;const f={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=p.url,this._requestId=p.requestRange(_,A,f),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var p;(p=this.onClosed)==null||p.call(this,this)}_onDone(p){const _=p.chunk;this._requests.length>0?this._requests.shift().resolve({value:_,done:!1}):this._queuedChunk=_,this._done=!0;for(const A of this._requests)A.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(p){this._storedError=(0,s.createResponseStatusError)(p,this._url);for(const _ of this._requests)_.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(p){var _;this.isStreamingSupported||(_=this.onProgress)==null||_.call(this,{loaded:p.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const _=this._queuedChunk;return this._queuedChunk=null,{value:_,done:!1}}if(this._done)return{value:void 0,done:!0};const p=new e.PromiseCapability;return this._requests.push(p),p.promise}cancel(p){this._done=!0;for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(n,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var e=i(1),s=i(20);const a=/^file:\/\/\/[a-zA-Z]:\//;function o(A){const f=require$$5,u=f.parse(A);return u.protocol==="file:"||u.host?u:/^[a-z]:[/\\]/i.test(A)?f.parse(`file:///${A}`):(u.host||(u.protocol="file:"),u)}class D{constructor(f){this.source=f,this.url=o(f.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&f.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new p(this):new v(this),this._fullRequestReader}getRangeReader(f,u){if(u<=this._progressiveDataLength)return null;const C=this.isFsUrl?new _(this,f,u):new x(this,f,u);return this._rangeRequestReaders.push(C),C}cancelAllRequests(f){var u;(u=this._fullRequestReader)==null||u.cancel(f);for(const C of this._rangeRequestReaders.slice(0))C.cancel(f)}}t.PDFNodeStream=D;class S{constructor(f){this._url=f.url,this._done=!1,this._storedError=null,this.onProgress=null;const u=f.source;this._contentLength=u.length,this._loaded=0,this._filename=null,this._disableRange=u.disableRange||!1,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!u.disableStream,this._isRangeSupported=!u.disableRange,this._readableStream=null,this._readCapability=new e.PromiseCapability,this._headersCapability=new e.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var C;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const f=this._readableStream.read();return f===null?(this._readCapability=new e.PromiseCapability,this.read()):(this._loaded+=f.length,(C=this.onProgress)==null||C.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(f).buffer,done:!1})}cancel(f){if(!this._readableStream){this._error(f);return}this._readableStream.destroy(f)}_error(f){this._storedError=f,this._readCapability.resolve()}_setReadableStream(f){this._readableStream=f,f.on("readable",()=>{this._readCapability.resolve()}),f.on("end",()=>{f.destroy(),this._done=!0,this._readCapability.resolve()}),f.on("error",u=>{this._error(u)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new e.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class E{constructor(f){this._url=f.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new e.PromiseCapability;const u=f.source;this._isStreamingSupported=!u.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var C;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const f=this._readableStream.read();return f===null?(this._readCapability=new e.PromiseCapability,this.read()):(this._loaded+=f.length,(C=this.onProgress)==null||C.call(this,{loaded:this._loaded}),{value:new Uint8Array(f).buffer,done:!1})}cancel(f){if(!this._readableStream){this._error(f);return}this._readableStream.destroy(f)}_error(f){this._storedError=f,this._readCapability.resolve()}_setReadableStream(f){this._readableStream=f,f.on("readable",()=>{this._readCapability.resolve()}),f.on("end",()=>{f.destroy(),this._done=!0,this._readCapability.resolve()}),f.on("error",u=>{this._error(u)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function c(A,f){return{protocol:A.protocol,auth:A.auth,host:A.hostname,port:A.port,path:A.path,method:"GET",headers:f}}class v extends S{constructor(f){super(f);const u=C=>{if(C.statusCode===404){const R=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=R,this._headersCapability.reject(R);return}this._headersCapability.resolve(),this._setReadableStream(C);const F=R=>this._readableStream.headers[R.toLowerCase()],{allowRangeRequests:w,suggestedLength:h}=(0,s.validateRangeRequestCapabilities)({getResponseHeader:F,isHttp:f.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=w,this._contentLength=h||this._contentLength,this._filename=(0,s.extractFilenameFromHeader)(F)};if(this._request=null,this._url.protocol==="http:"){const C=require$$5;this._request=C.request(c(this._url,f.httpHeaders),u)}else{const C=require$$5;this._request=C.request(c(this._url,f.httpHeaders),u)}this._request.on("error",C=>{this._storedError=C,this._headersCapability.reject(C)}),this._request.end()}}class x extends E{constructor(f,u,C){super(f),this._httpHeaders={};for(const w in f.httpHeaders){const h=f.httpHeaders[w];h!==void 0&&(this._httpHeaders[w]=h)}this._httpHeaders.Range=`bytes=${u}-${C-1}`;const F=w=>{if(w.statusCode===404){const h=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=h;return}this._setReadableStream(w)};if(this._request=null,this._url.protocol==="http:"){const w=require$$5;this._request=w.request(c(this._url,this._httpHeaders),F)}else{const w=require$$5;this._request=w.request(c(this._url,this._httpHeaders),F)}this._request.on("error",w=>{this._storedError=w}),this._request.end()}}class p extends S{constructor(f){super(f);let u=decodeURIComponent(this._url.path);a.test(this._url.href)&&(u=u.replace(/^\//,""));const C=require$$5;C.lstat(u,(F,w)=>{if(F){F.code==="ENOENT"&&(F=new e.MissingPDFException(`Missing PDF "${u}".`)),this._storedError=F,this._headersCapability.reject(F);return}this._contentLength=w.size,this._setReadableStream(C.createReadStream(u)),this._headersCapability.resolve()})}}class _ extends E{constructor(f,u,C){super(f);let F=decodeURIComponent(this._url.path);a.test(this._url.href)&&(F=F.replace(/^\//,""));const w=require$$5;this._setReadableStream(w.createReadStream(F,{start:u,end:C-1}))}}},(n,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var e=i(6),s=i(1);const a={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},o="http://www.w3.org/XML/1998/namespace",D="http://www.w3.org/1999/xlink",S=["butt","round","square"],E=["miter","round","bevel"],c=function(w,h="",R=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!R)return URL.createObjectURL(new Blob([w],{type:h}));const b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let j=`data:${h};base64,`;for(let y=0,L=w.length;y<L;y+=3){const g=w[y]&255,T=w[y+1]&255,z=w[y+2]&255,se=g>>2,V=(g&3)<<4|T>>4,Q=y+1<L?(T&15)<<2|z>>6:64,K=y+2<L?z&63:64;j+=b[se]+b[V]+b[Q]+b[K]}return j},v=function(){const w=new Uint8Array([137,80,78,71,13,10,26,10]),h=12,R=new Int32Array(256);for(let z=0;z<256;z++){let se=z;for(let V=0;V<8;V++)se=se&1?3988292384^se>>1&2147483647:se>>1&2147483647;R[z]=se}function b(z,se,V){let Q=-1;for(let K=se;K<V;K++){const ue=(Q^z[K])&255,I=R[ue];Q=Q>>>8^I}return Q^-1}function j(z,se,V,Q){let K=Q;const ue=se.length;V[K]=ue>>24&255,V[K+1]=ue>>16&255,V[K+2]=ue>>8&255,V[K+3]=ue&255,K+=4,V[K]=z.charCodeAt(0)&255,V[K+1]=z.charCodeAt(1)&255,V[K+2]=z.charCodeAt(2)&255,V[K+3]=z.charCodeAt(3)&255,K+=4,V.set(se,K),K+=se.length;const I=b(V,Q+4,K);V[K]=I>>24&255,V[K+1]=I>>16&255,V[K+2]=I>>8&255,V[K+3]=I&255}function y(z,se,V){let Q=1,K=0;for(let ue=se;ue<V;++ue)Q=(Q+(z[ue]&255))%65521,K=(K+Q)%65521;return K<<16|Q}function L(z){if(!s.isNodeJS)return g(z);try{const se=parseInt(process.versions.node)>=8?z:Buffer.from(z),V=require$$5.deflateSync(se,{level:9});return V instanceof Uint8Array?V:new Uint8Array(V)}catch(se){(0,s.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+se)}return g(z)}function g(z){let se=z.length;const V=65535,Q=Math.ceil(se/V),K=new Uint8Array(2+se+Q*5+4);let ue=0;K[ue++]=120,K[ue++]=156;let I=0;for(;se>V;)K[ue++]=0,K[ue++]=255,K[ue++]=255,K[ue++]=0,K[ue++]=0,K.set(z.subarray(I,I+V),ue),ue+=V,I+=V,se-=V;K[ue++]=1,K[ue++]=se&255,K[ue++]=se>>8&255,K[ue++]=~se&65535&255,K[ue++]=(~se&65535)>>8&255,K.set(z.subarray(I),ue),ue+=z.length-I;const q=y(z,0,z.length);return K[ue++]=q>>24&255,K[ue++]=q>>16&255,K[ue++]=q>>8&255,K[ue++]=q&255,K}function T(z,se,V,Q){const K=z.width,ue=z.height;let I,q,ee;const M=z.data;switch(se){case s.ImageKind.GRAYSCALE_1BPP:q=0,I=1,ee=K+7>>3;break;case s.ImageKind.RGB_24BPP:q=2,I=8,ee=K*3;break;case s.ImageKind.RGBA_32BPP:q=6,I=8,ee=K*4;break;default:throw new Error("invalid format")}const l=new Uint8Array((1+ee)*ue);let d=0,k=0;for(let me=0;me<ue;++me)l[d++]=0,l.set(M.subarray(k,k+ee),d),k+=ee,d+=ee;if(se===s.ImageKind.GRAYSCALE_1BPP&&Q){d=0;for(let me=0;me<ue;me++){d++;for(let fe=0;fe<ee;fe++)l[d++]^=255}}const B=new Uint8Array([K>>24&255,K>>16&255,K>>8&255,K&255,ue>>24&255,ue>>16&255,ue>>8&255,ue&255,I,q,0,0,0]),G=L(l),W=w.length+h*3+B.length+G.length,$=new Uint8Array(W);let ce=0;return $.set(w,ce),ce+=w.length,j("IHDR",B,$,ce),ce+=h+B.length,j("IDATA",G,$,ce),ce+=h+G.length,j("IEND",new Uint8Array(0),$,ce),c($,"image/png",V)}return function(se,V,Q){const K=se.kind===void 0?s.ImageKind.GRAYSCALE_1BPP:se.kind;return T(se,K,V,Q)}}();class x{constructor(){this.fontSizeScale=1,this.fontWeight=a.fontWeight,this.fontSize=0,this.textMatrix=s.IDENTITY_MATRIX,this.fontMatrix=s.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=s.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=a.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(h,R){this.x=h,this.y=R}}function p(w){let h=[];const R=[];for(const b of w){if(b.fn==="save"){h.push({fnId:92,fn:"group",items:[]}),R.push(h),h=h.at(-1).items;continue}b.fn==="restore"?h=R.pop():h.push(b)}return h}function _(w){if(Number.isInteger(w))return w.toString();const h=w.toFixed(10);let R=h.length-1;if(h[R]!=="0")return h;do R--;while(h[R]==="0");return h.substring(0,h[R]==="."?R:R+1)}function A(w){if(w[4]===0&&w[5]===0){if(w[1]===0&&w[2]===0)return w[0]===1&&w[3]===1?"":`scale(${_(w[0])} ${_(w[3])})`;if(w[0]===w[3]&&w[1]===-w[2]){const h=Math.acos(w[0])*180/Math.PI;return`rotate(${_(h)})`}}else if(w[0]===1&&w[1]===0&&w[2]===0&&w[3]===1)return`translate(${_(w[4])} ${_(w[5])})`;return`matrix(${_(w[0])} ${_(w[1])} ${_(w[2])} ${_(w[3])} ${_(w[4])} ${_(w[5])})`}let f=0,u=0,C=0;class F{constructor(h,R,b=!1){(0,e.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new e.DOMSVGFactory,this.current=new x,this.transformMatrix=s.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=h,this.objs=R,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!b,this._operatorIdMapping=[];for(const j in s.OPS)this._operatorIdMapping[s.OPS[j]]=j}getObject(h,R=null){return typeof h=="string"?h.startsWith("g_")?this.commonObjs.get(h):this.objs.get(h):R}save(){this.transformStack.push(this.transformMatrix);const h=this.current;this.extraStack.push(h),this.current=h.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(h){this.save(),this.executeOpTree(h),this.restore()}loadDependencies(h){const R=h.fnArray,b=h.argsArray;for(let j=0,y=R.length;j<y;j++)if(R[j]===s.OPS.dependency)for(const L of b[j]){const g=L.startsWith("g_")?this.commonObjs:this.objs,T=new Promise(z=>{g.get(L,z)});this.current.dependencies.push(T)}return Promise.all(this.current.dependencies)}transform(h,R,b,j,y,L){const g=[h,R,b,j,y,L];this.transformMatrix=s.Util.transform(this.transformMatrix,g),this.tgrp=null}getSVG(h,R){this.viewport=R;const b=this._initialize(R);return this.loadDependencies(h).then(()=>(this.transformMatrix=s.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(h)),b))}convertOpList(h){const R=this._operatorIdMapping,b=h.argsArray,j=h.fnArray,y=[];for(let L=0,g=j.length;L<g;L++){const T=j[L];y.push({fnId:T,fn:R[T],args:b[L]})}return p(y)}executeOpTree(h){for(const R of h){const b=R.fn,j=R.fnId,y=R.args;switch(j|0){case s.OPS.beginText:this.beginText();break;case s.OPS.dependency:break;case s.OPS.setLeading:this.setLeading(y);break;case s.OPS.setLeadingMoveText:this.setLeadingMoveText(y[0],y[1]);break;case s.OPS.setFont:this.setFont(y);break;case s.OPS.showText:this.showText(y[0]);break;case s.OPS.showSpacedText:this.showText(y[0]);break;case s.OPS.endText:this.endText();break;case s.OPS.moveText:this.moveText(y[0],y[1]);break;case s.OPS.setCharSpacing:this.setCharSpacing(y[0]);break;case s.OPS.setWordSpacing:this.setWordSpacing(y[0]);break;case s.OPS.setHScale:this.setHScale(y[0]);break;case s.OPS.setTextMatrix:this.setTextMatrix(y[0],y[1],y[2],y[3],y[4],y[5]);break;case s.OPS.setTextRise:this.setTextRise(y[0]);break;case s.OPS.setTextRenderingMode:this.setTextRenderingMode(y[0]);break;case s.OPS.setLineWidth:this.setLineWidth(y[0]);break;case s.OPS.setLineJoin:this.setLineJoin(y[0]);break;case s.OPS.setLineCap:this.setLineCap(y[0]);break;case s.OPS.setMiterLimit:this.setMiterLimit(y[0]);break;case s.OPS.setFillRGBColor:this.setFillRGBColor(y[0],y[1],y[2]);break;case s.OPS.setStrokeRGBColor:this.setStrokeRGBColor(y[0],y[1],y[2]);break;case s.OPS.setStrokeColorN:this.setStrokeColorN(y);break;case s.OPS.setFillColorN:this.setFillColorN(y);break;case s.OPS.shadingFill:this.shadingFill(y[0]);break;case s.OPS.setDash:this.setDash(y[0],y[1]);break;case s.OPS.setRenderingIntent:this.setRenderingIntent(y[0]);break;case s.OPS.setFlatness:this.setFlatness(y[0]);break;case s.OPS.setGState:this.setGState(y[0]);break;case s.OPS.fill:this.fill();break;case s.OPS.eoFill:this.eoFill();break;case s.OPS.stroke:this.stroke();break;case s.OPS.fillStroke:this.fillStroke();break;case s.OPS.eoFillStroke:this.eoFillStroke();break;case s.OPS.clip:this.clip("nonzero");break;case s.OPS.eoClip:this.clip("evenodd");break;case s.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case s.OPS.paintImageXObject:this.paintImageXObject(y[0]);break;case s.OPS.paintInlineImageXObject:this.paintInlineImageXObject(y[0]);break;case s.OPS.paintImageMaskXObject:this.paintImageMaskXObject(y[0]);break;case s.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(y[0],y[1]);break;case s.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case s.OPS.closePath:this.closePath();break;case s.OPS.closeStroke:this.closeStroke();break;case s.OPS.closeFillStroke:this.closeFillStroke();break;case s.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case s.OPS.nextLine:this.nextLine();break;case s.OPS.transform:this.transform(y[0],y[1],y[2],y[3],y[4],y[5]);break;case s.OPS.constructPath:this.constructPath(y[0],y[1]);break;case s.OPS.endPath:this.endPath();break;case 92:this.group(R.items);break;default:(0,s.warn)(`Unimplemented operator ${b}`);break}}}setWordSpacing(h){this.current.wordSpacing=h}setCharSpacing(h){this.current.charSpacing=h}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(h,R,b,j,y,L){const g=this.current;g.textMatrix=g.lineMatrix=[h,R,b,j,y,L],g.textMatrixScale=Math.hypot(h,R),g.x=g.lineX=0,g.y=g.lineY=0,g.xcoords=[],g.ycoords=[],g.tspan=this.svgFactory.createElement("svg:tspan"),g.tspan.setAttributeNS(null,"font-family",g.fontFamily),g.tspan.setAttributeNS(null,"font-size",`${_(g.fontSize)}px`),g.tspan.setAttributeNS(null,"y",_(-g.y)),g.txtElement=this.svgFactory.createElement("svg:text"),g.txtElement.append(g.tspan)}beginText(){const h=this.current;h.x=h.lineX=0,h.y=h.lineY=0,h.textMatrix=s.IDENTITY_MATRIX,h.lineMatrix=s.IDENTITY_MATRIX,h.textMatrixScale=1,h.tspan=this.svgFactory.createElement("svg:tspan"),h.txtElement=this.svgFactory.createElement("svg:text"),h.txtgrp=this.svgFactory.createElement("svg:g"),h.xcoords=[],h.ycoords=[]}moveText(h,R){const b=this.current;b.x=b.lineX+=h,b.y=b.lineY+=R,b.xcoords=[],b.ycoords=[],b.tspan=this.svgFactory.createElement("svg:tspan"),b.tspan.setAttributeNS(null,"font-family",b.fontFamily),b.tspan.setAttributeNS(null,"font-size",`${_(b.fontSize)}px`),b.tspan.setAttributeNS(null,"y",_(-b.y))}showText(h){const R=this.current,b=R.font,j=R.fontSize;if(j===0)return;const y=R.fontSizeScale,L=R.charSpacing,g=R.wordSpacing,T=R.fontDirection,z=R.textHScale*T,se=b.vertical,V=se?1:-1,Q=b.defaultVMetrics,K=j*R.fontMatrix[0];let ue=0;for(const ee of h){if(ee===null){ue+=T*g;continue}else if(typeof ee=="number"){ue+=V*ee*j/1e3;continue}const M=(ee.isSpace?g:0)+L,l=ee.fontChar;let d,k,B=ee.width;if(se){let W;const $=ee.vmetric||Q;W=ee.vmetric?$[1]:B*.5,W=-W*K;const ce=$[2]*K;B=$?-$[0]:B,d=W/y,k=(ue+ce)/y}else d=ue/y,k=0;(ee.isInFont||b.missingFile)&&(R.xcoords.push(R.x+d),se&&R.ycoords.push(-R.y+k),R.tspan.textContent+=l);const G=se?B*K-M*T:B*K+M*T;ue+=G}R.tspan.setAttributeNS(null,"x",R.xcoords.map(_).join(" ")),se?R.tspan.setAttributeNS(null,"y",R.ycoords.map(_).join(" ")):R.tspan.setAttributeNS(null,"y",_(-R.y)),se?R.y-=ue:R.x+=ue*z,R.tspan.setAttributeNS(null,"font-family",R.fontFamily),R.tspan.setAttributeNS(null,"font-size",`${_(R.fontSize)}px`),R.fontStyle!==a.fontStyle&&R.tspan.setAttributeNS(null,"font-style",R.fontStyle),R.fontWeight!==a.fontWeight&&R.tspan.setAttributeNS(null,"font-weight",R.fontWeight);const I=R.textRenderingMode&s.TextRenderingMode.FILL_STROKE_MASK;if(I===s.TextRenderingMode.FILL||I===s.TextRenderingMode.FILL_STROKE?(R.fillColor!==a.fillColor&&R.tspan.setAttributeNS(null,"fill",R.fillColor),R.fillAlpha<1&&R.tspan.setAttributeNS(null,"fill-opacity",R.fillAlpha)):R.textRenderingMode===s.TextRenderingMode.ADD_TO_PATH?R.tspan.setAttributeNS(null,"fill","transparent"):R.tspan.setAttributeNS(null,"fill","none"),I===s.TextRenderingMode.STROKE||I===s.TextRenderingMode.FILL_STROKE){const ee=1/(R.textMatrixScale||1);this._setStrokeAttributes(R.tspan,ee)}let q=R.textMatrix;R.textRise!==0&&(q=q.slice(),q[5]+=R.textRise),R.txtElement.setAttributeNS(null,"transform",`${A(q)} scale(${_(z)}, -1)`),R.txtElement.setAttributeNS(o,"xml:space","preserve"),R.txtElement.append(R.tspan),R.txtgrp.append(R.txtElement),this._ensureTransformGroup().append(R.txtElement)}setLeadingMoveText(h,R){this.setLeading(-R),this.moveText(h,R)}addFontStyle(h){if(!h.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const R=c(h.data,h.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${h.loadedName}"; src: url(${R}); }
`}setFont(h){const R=this.current,b=this.commonObjs.get(h[0]);let j=h[1];R.font=b,this.embedFonts&&!b.missingFile&&!this.embeddedFonts[b.loadedName]&&(this.addFontStyle(b),this.embeddedFonts[b.loadedName]=b),R.fontMatrix=b.fontMatrix||s.FONT_IDENTITY_MATRIX;let y="normal";b.black?y="900":b.bold&&(y="bold");const L=b.italic?"italic":"normal";j<0?(j=-j,R.fontDirection=-1):R.fontDirection=1,R.fontSize=j,R.fontFamily=b.loadedName,R.fontWeight=y,R.fontStyle=L,R.tspan=this.svgFactory.createElement("svg:tspan"),R.tspan.setAttributeNS(null,"y",_(-R.y)),R.xcoords=[],R.ycoords=[]}endText(){var R;const h=this.current;h.textRenderingMode&s.TextRenderingMode.ADD_TO_PATH_FLAG&&((R=h.txtElement)!=null&&R.hasChildNodes())&&(h.element=h.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(h){h>0&&(this.current.lineWidth=h)}setLineCap(h){this.current.lineCap=S[h]}setLineJoin(h){this.current.lineJoin=E[h]}setMiterLimit(h){this.current.miterLimit=h}setStrokeAlpha(h){this.current.strokeAlpha=h}setStrokeRGBColor(h,R,b){this.current.strokeColor=s.Util.makeHexColor(h,R,b)}setFillAlpha(h){this.current.fillAlpha=h}setFillRGBColor(h,R,b){this.current.fillColor=s.Util.makeHexColor(h,R,b),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(h){this.current.strokeColor=this._makeColorN_Pattern(h)}setFillColorN(h){this.current.fillColor=this._makeColorN_Pattern(h)}shadingFill(h){const{width:R,height:b}=this.viewport,j=s.Util.inverseTransform(this.transformMatrix),[y,L,g,T]=s.Util.getAxialAlignedBoundingBox([0,0,R,b],j),z=this.svgFactory.createElement("svg:rect");z.setAttributeNS(null,"x",y),z.setAttributeNS(null,"y",L),z.setAttributeNS(null,"width",g-y),z.setAttributeNS(null,"height",T-L),z.setAttributeNS(null,"fill",this._makeShadingPattern(h)),this.current.fillAlpha<1&&z.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(z)}_makeColorN_Pattern(h){return h[0]==="TilingPattern"?this._makeTilingPattern(h):this._makeShadingPattern(h)}_makeTilingPattern(h){const R=h[1],b=h[2],j=h[3]||s.IDENTITY_MATRIX,[y,L,g,T]=h[4],z=h[5],se=h[6],V=h[7],Q=`shading${C++}`,[K,ue,I,q]=s.Util.normalizeRect([...s.Util.applyTransform([y,L],j),...s.Util.applyTransform([g,T],j)]),[ee,M]=s.Util.singularValueDecompose2dScale(j),l=z*ee,d=se*M,k=this.svgFactory.createElement("svg:pattern");k.setAttributeNS(null,"id",Q),k.setAttributeNS(null,"patternUnits","userSpaceOnUse"),k.setAttributeNS(null,"width",l),k.setAttributeNS(null,"height",d),k.setAttributeNS(null,"x",`${K}`),k.setAttributeNS(null,"y",`${ue}`);const B=this.svg,G=this.transformMatrix,W=this.current.fillColor,$=this.current.strokeColor,ce=this.svgFactory.create(I-K,q-ue);if(this.svg=ce,this.transformMatrix=j,V===2){const me=s.Util.makeHexColor(...R);this.current.fillColor=me,this.current.strokeColor=me}return this.executeOpTree(this.convertOpList(b)),this.svg=B,this.transformMatrix=G,this.current.fillColor=W,this.current.strokeColor=$,k.append(ce.childNodes[0]),this.defs.append(k),`url(#${Q})`}_makeShadingPattern(h){switch(typeof h=="string"&&(h=this.objs.get(h)),h[0]){case"RadialAxial":const R=`shading${C++}`,b=h[3];let j;switch(h[1]){case"axial":const y=h[4],L=h[5];j=this.svgFactory.createElement("svg:linearGradient"),j.setAttributeNS(null,"id",R),j.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),j.setAttributeNS(null,"x1",y[0]),j.setAttributeNS(null,"y1",y[1]),j.setAttributeNS(null,"x2",L[0]),j.setAttributeNS(null,"y2",L[1]);break;case"radial":const g=h[4],T=h[5],z=h[6],se=h[7];j=this.svgFactory.createElement("svg:radialGradient"),j.setAttributeNS(null,"id",R),j.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),j.setAttributeNS(null,"cx",T[0]),j.setAttributeNS(null,"cy",T[1]),j.setAttributeNS(null,"r",se),j.setAttributeNS(null,"fx",g[0]),j.setAttributeNS(null,"fy",g[1]),j.setAttributeNS(null,"fr",z);break;default:throw new Error(`Unknown RadialAxial type: ${h[1]}`)}for(const y of b){const L=this.svgFactory.createElement("svg:stop");L.setAttributeNS(null,"offset",y[0]),L.setAttributeNS(null,"stop-color",y[1]),j.append(L)}return this.defs.append(j),`url(#${R})`;case"Mesh":return(0,s.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${h[0]}`)}}setDash(h,R){this.current.dashArray=h,this.current.dashPhase=R}constructPath(h,R){const b=this.current;let j=b.x,y=b.y,L=[],g=0;for(const T of h)switch(T|0){case s.OPS.rectangle:j=R[g++],y=R[g++];const z=R[g++],se=R[g++],V=j+z,Q=y+se;L.push("M",_(j),_(y),"L",_(V),_(y),"L",_(V),_(Q),"L",_(j),_(Q),"Z");break;case s.OPS.moveTo:j=R[g++],y=R[g++],L.push("M",_(j),_(y));break;case s.OPS.lineTo:j=R[g++],y=R[g++],L.push("L",_(j),_(y));break;case s.OPS.curveTo:j=R[g+4],y=R[g+5],L.push("C",_(R[g]),_(R[g+1]),_(R[g+2]),_(R[g+3]),_(j),_(y)),g+=6;break;case s.OPS.curveTo2:L.push("C",_(j),_(y),_(R[g]),_(R[g+1]),_(R[g+2]),_(R[g+3])),j=R[g+2],y=R[g+3],g+=4;break;case s.OPS.curveTo3:j=R[g+2],y=R[g+3],L.push("C",_(R[g]),_(R[g+1]),_(j),_(y),_(j),_(y)),g+=4;break;case s.OPS.closePath:L.push("Z");break}L=L.join(" "),b.path&&h.length>0&&h[0]!==s.OPS.rectangle&&h[0]!==s.OPS.moveTo?L=b.path.getAttributeNS(null,"d")+L:(b.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(b.path)),b.path.setAttributeNS(null,"d",L),b.path.setAttributeNS(null,"fill","none"),b.element=b.path,b.setCurrentPoint(j,y)}endPath(){const h=this.current;if(h.path=null,!this.pendingClip)return;if(!h.element){this.pendingClip=null;return}const R=`clippath${f++}`,b=this.svgFactory.createElement("svg:clipPath");b.setAttributeNS(null,"id",R),b.setAttributeNS(null,"transform",A(this.transformMatrix));const j=h.element.cloneNode(!0);if(this.pendingClip==="evenodd"?j.setAttributeNS(null,"clip-rule","evenodd"):j.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,b.append(j),this.defs.append(b),h.activeClipUrl){h.clipGroup=null;for(const y of this.extraStack)y.clipGroup=null;b.setAttributeNS(null,"clip-path",h.activeClipUrl)}h.activeClipUrl=`url(#${R})`,this.tgrp=null}clip(h){this.pendingClip=h}closePath(){const h=this.current;if(h.path){const R=`${h.path.getAttributeNS(null,"d")}Z`;h.path.setAttributeNS(null,"d",R)}}setLeading(h){this.current.leading=-h}setTextRise(h){this.current.textRise=h}setTextRenderingMode(h){this.current.textRenderingMode=h}setHScale(h){this.current.textHScale=h/100}setRenderingIntent(h){}setFlatness(h){}setGState(h){for(const[R,b]of h)switch(R){case"LW":this.setLineWidth(b);break;case"LC":this.setLineCap(b);break;case"LJ":this.setLineJoin(b);break;case"ML":this.setMiterLimit(b);break;case"D":this.setDash(b[0],b[1]);break;case"RI":this.setRenderingIntent(b);break;case"FL":this.setFlatness(b);break;case"Font":this.setFont(b);break;case"CA":this.setStrokeAlpha(b);break;case"ca":this.setFillAlpha(b);break;default:(0,s.warn)(`Unimplemented graphic state operator ${R}`);break}}fill(){const h=this.current;h.element&&(h.element.setAttributeNS(null,"fill",h.fillColor),h.element.setAttributeNS(null,"fill-opacity",h.fillAlpha),this.endPath())}stroke(){const h=this.current;h.element&&(this._setStrokeAttributes(h.element),h.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(h,R=1){const b=this.current;let j=b.dashArray;R!==1&&j.length>0&&(j=j.map(function(y){return R*y})),h.setAttributeNS(null,"stroke",b.strokeColor),h.setAttributeNS(null,"stroke-opacity",b.strokeAlpha),h.setAttributeNS(null,"stroke-miterlimit",_(b.miterLimit)),h.setAttributeNS(null,"stroke-linecap",b.lineCap),h.setAttributeNS(null,"stroke-linejoin",b.lineJoin),h.setAttributeNS(null,"stroke-width",_(R*b.lineWidth)+"px"),h.setAttributeNS(null,"stroke-dasharray",j.map(_).join(" ")),h.setAttributeNS(null,"stroke-dashoffset",_(R*b.dashPhase)+"px")}eoFill(){var h;(h=this.current.element)==null||h.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var h;(h=this.current.element)==null||h.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const h=this.svgFactory.createElement("svg:rect");h.setAttributeNS(null,"x","0"),h.setAttributeNS(null,"y","0"),h.setAttributeNS(null,"width","1px"),h.setAttributeNS(null,"height","1px"),h.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(h)}paintImageXObject(h){const R=this.getObject(h);if(!R){(0,s.warn)(`Dependent image with object ID ${h} is not ready yet`);return}this.paintInlineImageXObject(R)}paintInlineImageXObject(h,R){const b=h.width,j=h.height,y=v(h,this.forceDataSchema,!!R),L=this.svgFactory.createElement("svg:rect");L.setAttributeNS(null,"x","0"),L.setAttributeNS(null,"y","0"),L.setAttributeNS(null,"width",_(b)),L.setAttributeNS(null,"height",_(j)),this.current.element=L,this.clip("nonzero");const g=this.svgFactory.createElement("svg:image");g.setAttributeNS(D,"xlink:href",y),g.setAttributeNS(null,"x","0"),g.setAttributeNS(null,"y",_(-j)),g.setAttributeNS(null,"width",_(b)+"px"),g.setAttributeNS(null,"height",_(j)+"px"),g.setAttributeNS(null,"transform",`scale(${_(1/b)} ${_(-1/j)})`),R?R.append(g):this._ensureTransformGroup().append(g)}paintImageMaskXObject(h){const R=this.getObject(h.data,h);if(R.bitmap){(0,s.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const b=this.current,j=R.width,y=R.height,L=b.fillColor;b.maskId=`mask${u++}`;const g=this.svgFactory.createElement("svg:mask");g.setAttributeNS(null,"id",b.maskId);const T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x","0"),T.setAttributeNS(null,"y","0"),T.setAttributeNS(null,"width",_(j)),T.setAttributeNS(null,"height",_(y)),T.setAttributeNS(null,"fill",L),T.setAttributeNS(null,"mask",`url(#${b.maskId})`),this.defs.append(g),this._ensureTransformGroup().append(T),this.paintInlineImageXObject(R,g)}paintFormXObjectBegin(h,R){if(Array.isArray(h)&&h.length===6&&this.transform(h[0],h[1],h[2],h[3],h[4],h[5]),R){const b=R[2]-R[0],j=R[3]-R[1],y=this.svgFactory.createElement("svg:rect");y.setAttributeNS(null,"x",R[0]),y.setAttributeNS(null,"y",R[1]),y.setAttributeNS(null,"width",_(b)),y.setAttributeNS(null,"height",_(j)),this.current.element=y,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(h){const R=this.svgFactory.create(h.width,h.height),b=this.svgFactory.createElement("svg:defs");R.append(b),this.defs=b;const j=this.svgFactory.createElement("svg:g");return j.setAttributeNS(null,"transform",A(h.transform)),R.append(j),this.svg=j,R}_ensureClipGroup(){if(!this.current.clipGroup){const h=this.svgFactory.createElement("svg:g");h.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(h),this.current.clipGroup=h}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",A(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}t.SVGGraphics=F},(n,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaText=void 0;class i{static textContent(s){const a=[],o={items:a,styles:Object.create(null)};function D(S){var v;if(!S)return;let E=null;const c=S.name;if(c==="#text")E=S.value;else if(i.shouldBuildText(c))(v=S==null?void 0:S.attributes)!=null&&v.textContent?E=S.attributes.textContent:S.value&&(E=S.value);else return;if(E!==null&&a.push({str:E}),!!S.children)for(const x of S.children)D(x)}return D(s),o}static shouldBuildText(s){return!(s==="textarea"||s==="input"||s==="option"||s==="select")}}t.XfaText=i},(n,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayerRenderTask=void 0,t.renderTextLayer=A,t.updateTextLayer=f;var e=i(1),s=i(6);const a=1e5,o=30,D=.8,S=new Map;function E(u,C){let F;if(C&&e.FeatureTest.isOffscreenCanvasSupported)F=new OffscreenCanvas(u,u).getContext("2d",{alpha:!1});else{const w=document.createElement("canvas");w.width=w.height=u,F=w.getContext("2d",{alpha:!1})}return F}function c(u,C){const F=S.get(u);if(F)return F;const w=E(o,C);w.font=`${o}px ${u}`;const h=w.measureText("");let R=h.fontBoundingBoxAscent,b=Math.abs(h.fontBoundingBoxDescent);if(R){const y=R/(R+b);return S.set(u,y),w.canvas.width=w.canvas.height=0,y}w.strokeStyle="red",w.clearRect(0,0,o,o),w.strokeText("g",0,0);let j=w.getImageData(0,0,o,o).data;b=0;for(let y=j.length-1-3;y>=0;y-=4)if(j[y]>0){b=Math.ceil(y/4/o);break}w.clearRect(0,0,o,o),w.strokeText("A",0,o),j=w.getImageData(0,0,o,o).data,R=0;for(let y=0,L=j.length;y<L;y+=4)if(j[y]>0){R=o-Math.floor(y/4/o);break}if(w.canvas.width=w.canvas.height=0,R){const y=R/(R+b);return S.set(u,y),y}return S.set(u,D),D}function v(u,C,F){const w=document.createElement("span"),h={angle:0,canvasWidth:0,hasText:C.str!=="",hasEOL:C.hasEOL,fontSize:0};u._textDivs.push(w);const R=e.Util.transform(u._transform,C.transform);let b=Math.atan2(R[1],R[0]);const j=F[C.fontName];j.vertical&&(b+=Math.PI/2);const y=Math.hypot(R[2],R[3]),L=y*c(j.fontFamily,u._isOffscreenCanvasSupported);let g,T;b===0?(g=R[4],T=R[5]-L):(g=R[4]+L*Math.sin(b),T=R[5]-L*Math.cos(b));const z="calc(var(--scale-factor)*",se=w.style;u._container===u._rootContainer?(se.left=`${(100*g/u._pageWidth).toFixed(2)}%`,se.top=`${(100*T/u._pageHeight).toFixed(2)}%`):(se.left=`${z}${g.toFixed(2)}px)`,se.top=`${z}${T.toFixed(2)}px)`),se.fontSize=`${z}${y.toFixed(2)}px)`,se.fontFamily=j.fontFamily,h.fontSize=y,w.setAttribute("role","presentation"),w.textContent=C.str,w.dir=C.dir,u._fontInspectorEnabled&&(w.dataset.fontName=C.fontName),b!==0&&(h.angle=b*(180/Math.PI));let V=!1;if(C.str.length>1)V=!0;else if(C.str!==" "&&C.transform[0]!==C.transform[3]){const Q=Math.abs(C.transform[0]),K=Math.abs(C.transform[3]);Q!==K&&Math.max(Q,K)/Math.min(Q,K)>1.5&&(V=!0)}V&&(h.canvasWidth=j.vertical?C.height:C.width),u._textDivProperties.set(w,h),u._isReadableStream&&u._layoutText(w)}function x(u){const{div:C,scale:F,properties:w,ctx:h,prevFontSize:R,prevFontFamily:b}=u,{style:j}=C;let y="";if(w.canvasWidth!==0&&w.hasText){const{fontFamily:L}=j,{canvasWidth:g,fontSize:T}=w;(R!==T||b!==L)&&(h.font=`${T*F}px ${L}`,u.prevFontSize=T,u.prevFontFamily=L);const{width:z}=h.measureText(C.textContent);z>0&&(y=`scaleX(${g*F/z})`)}w.angle!==0&&(y=`rotate(${w.angle}deg) ${y}`),y.length>0&&(j.transform=y)}function p(u){if(u._canceled)return;const C=u._textDivs,F=u._capability;if(C.length>a){F.resolve();return}if(!u._isReadableStream)for(const h of C)u._layoutText(h);F.resolve()}class _{constructor({textContentSource:C,container:F,viewport:w,textDivs:h,textDivProperties:R,textContentItemsStr:b,isOffscreenCanvasSupported:j}){var z;this._textContentSource=C,this._isReadableStream=C instanceof ReadableStream,this._container=this._rootContainer=F,this._textDivs=h||[],this._textContentItemsStr=b||[],this._isOffscreenCanvasSupported=j,this._fontInspectorEnabled=!!((z=globalThis.FontInspector)!=null&&z.enabled),this._reader=null,this._textDivProperties=R||new WeakMap,this._canceled=!1,this._capability=new e.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:w.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:E(0,j)};const{pageWidth:y,pageHeight:L,pageX:g,pageY:T}=w.rawDims;this._transform=[1,0,0,-1,-g,T+L],this._pageWidth=y,this._pageHeight=L,(0,s.setLayerDimensions)(F,w),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new e.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new e.AbortException("TextLayer task cancelled."))}_processItems(C,F){for(const w of C){if(w.str===void 0){if(w.type==="beginMarkedContentProps"||w.type==="beginMarkedContent"){const h=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),w.id!==null&&this._container.setAttribute("id",`${w.id}`),h.append(this._container)}else w.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(w.str),v(this,w,F)}}_layoutText(C){const F=this._layoutTextParams.properties=this._textDivProperties.get(C);if(this._layoutTextParams.div=C,x(this._layoutTextParams),F.hasText&&this._container.append(C),F.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),this._container.append(w)}}_render(){const C=new e.PromiseCapability;let F=Object.create(null);if(this._isReadableStream){const w=()=>{this._reader.read().then(({value:h,done:R})=>{if(R){C.resolve();return}Object.assign(F,h.styles),this._processItems(h.items,F),w()},C.reject)};this._reader=this._textContentSource.getReader(),w()}else if(this._textContentSource){const{items:w,styles:h}=this._textContentSource;this._processItems(w,h),C.resolve()}else throw new Error('No "textContentSource" parameter specified.');C.promise.then(()=>{F=null,p(this)},this._capability.reject)}}t.TextLayerRenderTask=_;function A(u){!u.textContentSource&&(u.textContent||u.textContentStream)&&((0,s.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),u.textContentSource=u.textContent||u.textContentStream);const{container:C,viewport:F}=u,w=getComputedStyle(C),h=w.getPropertyValue("visibility"),R=parseFloat(w.getPropertyValue("--scale-factor"));h==="visible"&&(!R||Math.abs(R-F.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const b=new _(u);return b._render(),b}function f({container:u,viewport:C,textDivs:F,textDivProperties:w,isOffscreenCanvasSupported:h,mustRotate:R=!0,mustRescale:b=!0}){if(R&&(0,s.setLayerDimensions)(u,{rotation:C.rotation}),b){const j=E(0,h),L={prevFontSize:null,prevFontFamily:null,div:null,scale:C.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:j};for(const g of F)L.properties=w.get(g),L.div=g,x(L)}}},(n,t,i)=>{var c,v,x,p,_,A,f,u,C,F,w,Zt,St,Qt,es;Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditorLayer=void 0;var e=i(1),s=i(4),a=i(28),o=i(33),D=i(6),S=i(34);const y=class y{constructor({uiManager:g,pageIndex:T,div:z,accessibilityManager:se,annotationLayer:V,viewport:Q,l10n:K}){re(this,w);re(this,c);re(this,v,!1);re(this,x,null);re(this,p,this.pointerup.bind(this));re(this,_,this.pointerdown.bind(this));re(this,A,new Map);re(this,f,!1);re(this,u,!1);re(this,C,!1);re(this,F);const ue=[a.FreeTextEditor,o.InkEditor,S.StampEditor];if(!y._initialized){y._initialized=!0;for(const I of ue)I.initialize(K)}g.registerEditorTypes(ue),le(this,F,g),this.pageIndex=T,this.div=z,le(this,c,se),le(this,x,V),this.viewport=Q,r(this,F).addLayer(this)}get isEmpty(){return r(this,A).size===0}updateToolbar(g){r(this,F).updateToolbar(g)}updateMode(g=r(this,F).getMode()){J(this,w,es).call(this),g===e.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),g!==e.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",g===e.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",g===e.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",g===e.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(g){if(!g&&r(this,F).getMode()!==e.AnnotationEditorType.INK)return;if(!g){for(const z of r(this,A).values())if(z.isEmpty()){z.setInBackground();return}}J(this,w,St).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(g){r(this,F).setEditingState(g)}addCommands(g){r(this,F).addCommands(g)}enable(){this.div.style.pointerEvents="auto";const g=new Set;for(const z of r(this,A).values())z.enableEditing(),z.annotationElementId&&g.add(z.annotationElementId);if(!r(this,x))return;const T=r(this,x).getEditableAnnotations();for(const z of T){if(z.hide(),r(this,F).isDeletedAnnotationElement(z.data.id)||g.has(z.data.id))continue;const se=this.deserialize(z);se&&(this.addOrRebuild(se),se.enableEditing())}}disable(){var T;le(this,C,!0),this.div.style.pointerEvents="none";const g=new Set;for(const z of r(this,A).values()){if(z.disableEditing(),!z.annotationElementId||z.serialize()!==null){g.add(z.annotationElementId);continue}(T=this.getEditableAnnotation(z.annotationElementId))==null||T.show(),z.remove()}if(r(this,x)){const z=r(this,x).getEditableAnnotations();for(const se of z){const{id:V}=se.data;g.has(V)||r(this,F).isDeletedAnnotationElement(V)||se.show()}}J(this,w,es).call(this),this.isEmpty&&(this.div.hidden=!0),le(this,C,!1)}getEditableAnnotation(g){var T;return((T=r(this,x))==null?void 0:T.getEditableAnnotation(g))||null}setActiveEditor(g){r(this,F).getActive()!==g&&r(this,F).setActiveEditor(g)}enableClick(){this.div.addEventListener("pointerdown",r(this,_)),this.div.addEventListener("pointerup",r(this,p))}disableClick(){this.div.removeEventListener("pointerdown",r(this,_)),this.div.removeEventListener("pointerup",r(this,p))}attach(g){r(this,A).set(g.id,g);const{annotationElementId:T}=g;T&&r(this,F).isDeletedAnnotationElement(T)&&r(this,F).removeDeletedAnnotationElement(g)}detach(g){var T;r(this,A).delete(g.id),(T=r(this,c))==null||T.removePointerInTextLayer(g.contentDiv),!r(this,C)&&g.annotationElementId&&r(this,F).addDeletedAnnotationElement(g)}remove(g){this.detach(g),r(this,F).removeEditor(g),g.div.contains(document.activeElement)&&setTimeout(()=>{r(this,F).focusMainContainer()},0),g.div.remove(),g.isAttachedToDOM=!1,r(this,u)||this.addInkEditorIfNeeded(!1)}changeParent(g){var T;g.parent!==this&&(g.annotationElementId&&(r(this,F).addDeletedAnnotationElement(g.annotationElementId),s.AnnotationEditor.deleteAnnotationElement(g),g.annotationElementId=null),this.attach(g),(T=g.parent)==null||T.detach(g),g.setParent(this),g.div&&g.isAttachedToDOM&&(g.div.remove(),this.div.append(g.div)))}add(g){if(this.changeParent(g),r(this,F).addEditor(g),this.attach(g),!g.isAttachedToDOM){const T=g.render();this.div.append(T),g.isAttachedToDOM=!0}g.fixAndSetPosition(),g.onceAdded(),r(this,F).addToAnnotationStorage(g)}moveEditorInDOM(g){var z;if(!g.isAttachedToDOM)return;const{activeElement:T}=document;g.div.contains(T)&&(g._focusEventsAllowed=!1,setTimeout(()=>{g.div.contains(document.activeElement)?g._focusEventsAllowed=!0:(g.div.addEventListener("focusin",()=>{g._focusEventsAllowed=!0},{once:!0}),T.focus())},0)),g._structTreeParentId=(z=r(this,c))==null?void 0:z.moveElementInDOM(this.div,g.div,g.contentDiv,!0)}addOrRebuild(g){g.needsToBeRebuilt()?g.rebuild():this.add(g)}addUndoableEditor(g){const T=()=>g._uiManager.rebuild(g),z=()=>{g.remove()};this.addCommands({cmd:T,undo:z,mustExec:!1})}getNextId(){return r(this,F).getId()}pasteEditor(g,T){r(this,F).updateToolbar(g),r(this,F).updateMode(g);const{offsetX:z,offsetY:se}=J(this,w,Qt).call(this),V=this.getNextId(),Q=J(this,w,Zt).call(this,{parent:this,id:V,x:z,y:se,uiManager:r(this,F),isCentered:!0,...T});Q&&this.add(Q)}deserialize(g){switch(g.annotationType??g.annotationEditorType){case e.AnnotationEditorType.FREETEXT:return a.FreeTextEditor.deserialize(g,this,r(this,F));case e.AnnotationEditorType.INK:return o.InkEditor.deserialize(g,this,r(this,F));case e.AnnotationEditorType.STAMP:return S.StampEditor.deserialize(g,this,r(this,F))}return null}addNewEditor(){J(this,w,St).call(this,J(this,w,Qt).call(this),!0)}setSelected(g){r(this,F).setSelected(g)}toggleSelected(g){r(this,F).toggleSelected(g)}isSelected(g){return r(this,F).isSelected(g)}unselect(g){r(this,F).unselect(g)}pointerup(g){const{isMac:T}=e.FeatureTest.platform;if(!(g.button!==0||g.ctrlKey&&T)&&g.target===this.div&&r(this,f)){if(le(this,f,!1),!r(this,v)){le(this,v,!0);return}if(r(this,F).getMode()===e.AnnotationEditorType.STAMP){r(this,F).unselectAll();return}J(this,w,St).call(this,g,!1)}}pointerdown(g){if(r(this,f)){le(this,f,!1);return}const{isMac:T}=e.FeatureTest.platform;if(g.button!==0||g.ctrlKey&&T||g.target!==this.div)return;le(this,f,!0);const z=r(this,F).getActive();le(this,v,!z||z.isEmpty())}findNewParent(g,T,z){const se=r(this,F).findParent(T,z);return se===null||se===this?!1:(se.changeParent(g),!0)}destroy(){var g,T;((g=r(this,F).getActive())==null?void 0:g.parent)===this&&(r(this,F).commitOrRemove(),r(this,F).setActiveEditor(null));for(const z of r(this,A).values())(T=r(this,c))==null||T.removePointerInTextLayer(z.contentDiv),z.setParent(null),z.isAttachedToDOM=!1,z.div.remove();this.div=null,r(this,A).clear(),r(this,F).removeLayer(this)}render({viewport:g}){this.viewport=g,(0,D.setLayerDimensions)(this.div,g);for(const T of r(this,F).getEditors(this.pageIndex))this.add(T);this.updateMode()}update({viewport:g}){r(this,F).commitOrRemove(),this.viewport=g,(0,D.setLayerDimensions)(this.div,{rotation:g.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:g,pageHeight:T}=this.viewport.rawDims;return[g,T]}};c=new WeakMap,v=new WeakMap,x=new WeakMap,p=new WeakMap,_=new WeakMap,A=new WeakMap,f=new WeakMap,u=new WeakMap,C=new WeakMap,F=new WeakMap,w=new WeakSet,Zt=function(g){switch(r(this,F).getMode()){case e.AnnotationEditorType.FREETEXT:return new a.FreeTextEditor(g);case e.AnnotationEditorType.INK:return new o.InkEditor(g);case e.AnnotationEditorType.STAMP:return new S.StampEditor(g)}return null},St=function(g,T){const z=this.getNextId(),se=J(this,w,Zt).call(this,{parent:this,id:z,x:g.offsetX,y:g.offsetY,uiManager:r(this,F),isCentered:T});return se&&this.add(se),se},Qt=function(){const{x:g,y:T,width:z,height:se}=this.div.getBoundingClientRect(),V=Math.max(0,g),Q=Math.max(0,T),K=Math.min(window.innerWidth,g+z),ue=Math.min(window.innerHeight,T+se),I=(V+K)/2-g,q=(Q+ue)/2-T,[ee,M]=this.viewport.rotation%180===0?[I,q]:[q,I];return{offsetX:ee,offsetY:M}},es=function(){le(this,u,!0);for(const g of r(this,A).values())g.isEmpty()&&g.remove();le(this,u,!1)},Ze(y,"_initialized",!1);let E=y;t.AnnotationEditorLayer=E},(n,t,i)=>{var S,E,c,v,x,p,_,A,f,u,Ts,ks,Ps,gt,ts,Ms,ss;Object.defineProperty(t,"__esModule",{value:!0}),t.FreeTextEditor=void 0;var e=i(1),s=i(5),a=i(4),o=i(29);const y=class y extends a.AnnotationEditor{constructor(T){super({...T,name:"freeTextEditor"});re(this,u);re(this,S,this.editorDivBlur.bind(this));re(this,E,this.editorDivFocus.bind(this));re(this,c,this.editorDivInput.bind(this));re(this,v,this.editorDivKeydown.bind(this));re(this,x);re(this,p,"");re(this,_,`${this.id}-editor`);re(this,A);re(this,f,null);le(this,x,T.color||y._defaultColor||a.AnnotationEditor._defaultLineColor),le(this,A,T.fontSize||y._defaultFontSize)}static get _keyboardManager(){const T=y.prototype,z=Q=>Q.isEmpty(),se=s.AnnotationEditorUIManager.TRANSLATE_SMALL,V=s.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,e.shadow)(this,"_keyboardManager",new s.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],T.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],T.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],T._translateEmpty,{args:[-se,0],checker:z}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],T._translateEmpty,{args:[-V,0],checker:z}],[["ArrowRight","mac+ArrowRight"],T._translateEmpty,{args:[se,0],checker:z}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],T._translateEmpty,{args:[V,0],checker:z}],[["ArrowUp","mac+ArrowUp"],T._translateEmpty,{args:[0,-se],checker:z}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],T._translateEmpty,{args:[0,-V],checker:z}],[["ArrowDown","mac+ArrowDown"],T._translateEmpty,{args:[0,se],checker:z}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],T._translateEmpty,{args:[0,V],checker:z}]]))}static initialize(T){a.AnnotationEditor.initialize(T,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const z=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(z.getPropertyValue("--freetext-padding"))}static updateDefaultParams(T,z){switch(T){case e.AnnotationEditorParamsType.FREETEXT_SIZE:y._defaultFontSize=z;break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:y._defaultColor=z;break}}updateParams(T,z){switch(T){case e.AnnotationEditorParamsType.FREETEXT_SIZE:J(this,u,Ts).call(this,z);break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:J(this,u,ks).call(this,z);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,y._defaultFontSize],[e.AnnotationEditorParamsType.FREETEXT_COLOR,y._defaultColor||a.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,r(this,A)],[e.AnnotationEditorParamsType.FREETEXT_COLOR,r(this,x)]]}_translateEmpty(T,z){this._uiManager.translateSelectedEditors(T,z,!0)}getInitialTranslation(){const T=this.parentScale;return[-y._internalPadding*T,-(y._internalPadding+r(this,A))*T]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(e.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",r(this,v)),this.editorDiv.addEventListener("focus",r(this,E)),this.editorDiv.addEventListener("blur",r(this,S)),this.editorDiv.addEventListener("input",r(this,c)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",r(this,_)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",r(this,v)),this.editorDiv.removeEventListener("focus",r(this,E)),this.editorDiv.removeEventListener("blur",r(this,S)),this.editorDiv.removeEventListener("input",r(this,c)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(T){this._focusEventsAllowed&&(super.focusin(T),T.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var T;if(this.width){J(this,u,ss).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(T=this._initialOptions)!=null&&T.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const T=r(this,p),z=le(this,p,J(this,u,Ps).call(this).trimEnd());if(T===z)return;const se=V=>{if(le(this,p,V),!V){this.remove();return}J(this,u,ts).call(this),this._uiManager.rebuild(this),J(this,u,gt).call(this)};this.addCommands({cmd:()=>{se(z)},undo:()=>{se(T)},mustExec:!1}),J(this,u,gt).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(T){this.enterInEditMode()}keydown(T){T.target===this.div&&T.key==="Enter"&&(this.enterInEditMode(),T.preventDefault())}editorDivKeydown(T){y._keyboardManager.exec(this,T)}editorDivFocus(T){this.isEditing=!0}editorDivBlur(T){this.isEditing=!1}editorDivInput(T){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let T,z;this.width&&(T=this.x,z=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",r(this,_)),this.enableEditing(),a.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(V=>{var Q;return(Q=this.editorDiv)==null?void 0:Q.setAttribute("aria-label",V)}),a.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(V=>{var Q;return(Q=this.editorDiv)==null?void 0:Q.setAttribute("default-content",V)}),this.editorDiv.contentEditable=!0;const{style:se}=this.editorDiv;if(se.fontSize=`calc(${r(this,A)}px * var(--scale-factor))`,se.color=r(this,x),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,s.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[V,Q]=this.parentDimensions;if(this.annotationElementId){const{position:K}=r(this,f);let[ue,I]=this.getInitialTranslation();[ue,I]=this.pageTranslationToScreen(ue,I);const[q,ee]=this.pageDimensions,[M,l]=this.pageTranslation;let d,k;switch(this.rotation){case 0:d=T+(K[0]-M)/q,k=z+this.height-(K[1]-l)/ee;break;case 90:d=T+(K[0]-M)/q,k=z-(K[1]-l)/ee,[ue,I]=[I,-ue];break;case 180:d=T-this.width+(K[0]-M)/q,k=z-(K[1]-l)/ee,[ue,I]=[-ue,-I];break;case 270:d=T+(K[0]-M-this.height*ee)/q,k=z+(K[1]-l-this.width*q)/ee,[ue,I]=[-I,ue];break}this.setAt(d*V,k*Q,ue,I)}else this.setAt(T*V,z*Q,this.width*V,this.height*Q);J(this,u,ts).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(T,z,se){let V=null;if(T instanceof o.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:K,fontColor:ue},rect:I,rotation:q,id:ee},textContent:M,textPosition:l,parent:{page:{pageNumber:d}}}=T;if(!M||M.length===0)return null;V=T={annotationType:e.AnnotationEditorType.FREETEXT,color:Array.from(ue),fontSize:K,value:M.join(`
`),position:l,pageIndex:d-1,rect:I,rotation:q,id:ee,deleted:!1}}const Q=super.deserialize(T,z,se);return le(Q,A,T.fontSize),le(Q,x,e.Util.makeHexColor(...T.color)),le(Q,p,T.value),Q.annotationElementId=T.id||null,le(Q,f,V),Q}serialize(T=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const z=y._internalPadding*this.parentScale,se=this.getRect(z,z),V=a.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:r(this,x)),Q={annotationType:e.AnnotationEditorType.FREETEXT,color:V,fontSize:r(this,A),value:r(this,p),pageIndex:this.pageIndex,rect:se,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return T?Q:this.annotationElementId&&!J(this,u,Ms).call(this,Q)?null:(Q.id=this.annotationElementId,Q)}};S=new WeakMap,E=new WeakMap,c=new WeakMap,v=new WeakMap,x=new WeakMap,p=new WeakMap,_=new WeakMap,A=new WeakMap,f=new WeakMap,u=new WeakSet,Ts=function(T){const z=V=>{this.editorDiv.style.fontSize=`calc(${V}px * var(--scale-factor))`,this.translate(0,-(V-r(this,A))*this.parentScale),le(this,A,V),J(this,u,gt).call(this)},se=r(this,A);this.addCommands({cmd:()=>{z(T)},undo:()=>{z(se)},mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},ks=function(T){const z=r(this,x);this.addCommands({cmd:()=>{le(this,x,this.editorDiv.style.color=T)},undo:()=>{le(this,x,this.editorDiv.style.color=z)},mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ps=function(){const T=this.editorDiv.getElementsByTagName("div");if(T.length===0)return this.editorDiv.innerText;const z=[];for(const se of T)z.push(se.innerText.replace(/\r\n?|\n/,""));return z.join(`
`)},gt=function(){const[T,z]=this.parentDimensions;let se;if(this.isAttachedToDOM)se=this.div.getBoundingClientRect();else{const{currentLayer:V,div:Q}=this,K=Q.style.display;Q.style.display="hidden",V.div.append(this.div),se=Q.getBoundingClientRect(),Q.remove(),Q.style.display=K}this.rotation%180===this.parentRotation%180?(this.width=se.width/T,this.height=se.height/z):(this.width=se.height/T,this.height=se.width/z),this.fixAndSetPosition()},ts=function(){if(this.editorDiv.replaceChildren(),!!r(this,p))for(const T of r(this,p).split(`
`)){const z=document.createElement("div");z.append(T?document.createTextNode(T):document.createElement("br")),this.editorDiv.append(z)}},Ms=function(T){const{value:z,fontSize:se,color:V,rect:Q,pageIndex:K}=r(this,f);return T.value!==z||T.fontSize!==se||T.rect.some((ue,I)=>Math.abs(ue-Q[I])>=1)||T.color.some((ue,I)=>ue!==V[I])||T.pageIndex!==K},ss=function(T=!1){if(!this.annotationElementId)return;if(J(this,u,gt).call(this),!T&&(this.width===0||this.height===0)){setTimeout(()=>J(this,u,ss).call(this,!0),0);return}const z=y._internalPadding*this.parentScale;r(this,f).rect=this.getRect(z,z)},Ze(y,"_freeTextDefaultContent",""),Ze(y,"_internalPadding",0),Ze(y,"_defaultColor",null),Ze(y,"_defaultFontSize",10),Ze(y,"_type","freetext");let D=y;t.FreeTextEditor=D},(n,t,i)=>{var k,G,at,Ns,ce,me,fe,be,Ee,je,ie,ae,P,H,Z,ne,xe,Re,Ae,te,we,Se,Fs,Ct,ns,rs,ze,Ke,$e,ye,oe,de,Pe,as,Ve,U,ge,Ce,Ds,os;Object.defineProperty(t,"__esModule",{value:!0}),t.StampAnnotationElement=t.InkAnnotationElement=t.FreeTextAnnotationElement=t.AnnotationLayer=void 0;var e=i(1),s=i(6),a=i(3),o=i(30),D=i(31),S=i(32);const E=1e3,c=9,v=new WeakSet;function x(ke){return{width:ke[2]-ke[0],height:ke[3]-ke[1]}}class p{static create(O){switch(O.data.annotationType){case e.AnnotationType.LINK:return new A(O);case e.AnnotationType.TEXT:return new f(O);case e.AnnotationType.WIDGET:switch(O.data.fieldType){case"Tx":return new C(O);case"Btn":return O.data.radioButton?new h(O):O.data.checkBox?new w(O):new R(O);case"Ch":return new b(O);case"Sig":return new F(O)}return new u(O);case e.AnnotationType.POPUP:return new j(O);case e.AnnotationType.FREETEXT:return new L(O);case e.AnnotationType.LINE:return new g(O);case e.AnnotationType.SQUARE:return new T(O);case e.AnnotationType.CIRCLE:return new z(O);case e.AnnotationType.POLYLINE:return new se(O);case e.AnnotationType.CARET:return new Q(O);case e.AnnotationType.INK:return new K(O);case e.AnnotationType.POLYGON:return new V(O);case e.AnnotationType.HIGHLIGHT:return new ue(O);case e.AnnotationType.UNDERLINE:return new I(O);case e.AnnotationType.SQUIGGLY:return new q(O);case e.AnnotationType.STRIKEOUT:return new ee(O);case e.AnnotationType.STAMP:return new M(O);case e.AnnotationType.FILEATTACHMENT:return new l(O);default:return new _(O)}}}const B=class B{constructor(O,{isRenderable:N=!1,ignoreBorder:Y=!1,createQuadrilaterals:he=!1}={}){re(this,k,!1);this.isRenderable=N,this.data=O.data,this.layer=O.layer,this.linkService=O.linkService,this.downloadManager=O.downloadManager,this.imageResourcesPath=O.imageResourcesPath,this.renderForms=O.renderForms,this.svgFactory=O.svgFactory,this.annotationStorage=O.annotationStorage,this.enableScripting=O.enableScripting,this.hasJSActions=O.hasJSActions,this._fieldObjects=O.fieldObjects,this.parent=O.parent,N&&(this.container=this._createContainer(Y)),he&&this._createQuadrilaterals()}static _hasPopupData({titleObj:O,contentsObj:N,richText:Y}){return!!(O!=null&&O.str||N!=null&&N.str||Y!=null&&Y.str)}get hasPopupData(){return B._hasPopupData(this.data)}_createContainer(O){const{data:N,parent:{page:Y,viewport:he}}=this,pe=document.createElement("section");pe.setAttribute("data-annotation-id",N.id),this instanceof u||(pe.tabIndex=E),pe.style.zIndex=this.parent.zIndex++,this.data.popupRef&&pe.setAttribute("aria-haspopup","dialog"),N.noRotate&&pe.classList.add("norotate");const{pageWidth:ve,pageHeight:_e,pageX:Ie,pageY:Ne}=he.rawDims;if(!N.rect||this instanceof j){const{rotation:Ge}=N;return!N.hasOwnCanvas&&Ge!==0&&this.setRotation(Ge,pe),pe}const{width:Te,height:He}=x(N.rect),Fe=e.Util.normalizeRect([N.rect[0],Y.view[3]-N.rect[1]+Y.view[1],N.rect[2],Y.view[3]-N.rect[3]+Y.view[1]]);if(!O&&N.borderStyle.width>0){pe.style.borderWidth=`${N.borderStyle.width}px`;const Ge=N.borderStyle.horizontalCornerRadius,Ue=N.borderStyle.verticalCornerRadius;if(Ge>0||Ue>0){const Je=`calc(${Ge}px * var(--scale-factor)) / calc(${Ue}px * var(--scale-factor))`;pe.style.borderRadius=Je}else if(this instanceof h){const Je=`calc(${Te}px * var(--scale-factor)) / calc(${He}px * var(--scale-factor))`;pe.style.borderRadius=Je}switch(N.borderStyle.style){case e.AnnotationBorderStyleType.SOLID:pe.style.borderStyle="solid";break;case e.AnnotationBorderStyleType.DASHED:pe.style.borderStyle="dashed";break;case e.AnnotationBorderStyleType.BEVELED:(0,e.warn)("Unimplemented border style: beveled");break;case e.AnnotationBorderStyleType.INSET:(0,e.warn)("Unimplemented border style: inset");break;case e.AnnotationBorderStyleType.UNDERLINE:pe.style.borderBottomStyle="solid";break}const Ye=N.borderColor||null;Ye?(le(this,k,!0),pe.style.borderColor=e.Util.makeHexColor(Ye[0]|0,Ye[1]|0,Ye[2]|0)):pe.style.borderWidth=0}pe.style.left=`${100*(Fe[0]-Ie)/ve}%`,pe.style.top=`${100*(Fe[1]-Ne)/_e}%`;const{rotation:Oe}=N;return N.hasOwnCanvas||Oe===0?(pe.style.width=`${100*Te/ve}%`,pe.style.height=`${100*He/_e}%`):this.setRotation(Oe,pe),pe}setRotation(O,N=this.container){if(!this.data.rect)return;const{pageWidth:Y,pageHeight:he}=this.parent.viewport.rawDims,{width:pe,height:ve}=x(this.data.rect);let _e,Ie;O%180===0?(_e=100*pe/Y,Ie=100*ve/he):(_e=100*ve/Y,Ie=100*pe/he),N.style.width=`${_e}%`,N.style.height=`${Ie}%`,N.setAttribute("data-main-rotation",(360-O)%360)}get _commonActions(){const O=(N,Y,he)=>{const pe=he.detail[N],ve=pe[0],_e=pe.slice(1);he.target.style[Y]=o.ColorConverters[`${ve}_HTML`](_e),this.annotationStorage.setValue(this.data.id,{[Y]:o.ColorConverters[`${ve}_rgb`](_e)})};return(0,e.shadow)(this,"_commonActions",{display:N=>{const{display:Y}=N.detail,he=Y%2===1;this.container.style.visibility=he?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:he,noPrint:Y===1||Y===2})},print:N=>{this.annotationStorage.setValue(this.data.id,{noPrint:!N.detail.print})},hidden:N=>{const{hidden:Y}=N.detail;this.container.style.visibility=Y?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:Y,noView:Y})},focus:N=>{setTimeout(()=>N.target.focus({preventScroll:!1}),0)},userName:N=>{N.target.title=N.detail.userName},readonly:N=>{N.target.disabled=N.detail.readonly},required:N=>{this._setRequired(N.target,N.detail.required)},bgColor:N=>{O("bgColor","backgroundColor",N)},fillColor:N=>{O("fillColor","backgroundColor",N)},fgColor:N=>{O("fgColor","color",N)},textColor:N=>{O("textColor","color",N)},borderColor:N=>{O("borderColor","borderColor",N)},strokeColor:N=>{O("strokeColor","borderColor",N)},rotation:N=>{const Y=N.detail.rotation;this.setRotation(Y),this.annotationStorage.setValue(this.data.id,{rotation:Y})}})}_dispatchEventFromSandbox(O,N){const Y=this._commonActions;for(const he of Object.keys(N.detail)){const pe=O[he]||Y[he];pe==null||pe(N)}}_setDefaultPropertiesFromJS(O){if(!this.enableScripting)return;const N=this.annotationStorage.getRawValue(this.data.id);if(!N)return;const Y=this._commonActions;for(const[he,pe]of Object.entries(N)){const ve=Y[he];if(ve){const _e={detail:{[he]:pe},target:O};ve(_e),delete N[he]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:O}=this.data;if(!O)return;const[N,Y,he,pe]=this.data.rect;if(O.length===1){const[,{x:Ue,y:Ye},{x:Je,y:et}]=O[0];if(he===Ue&&pe===Ye&&N===Je&&Y===et)return}const{style:ve}=this.container;let _e;if(r(this,k)){const{borderColor:Ue,borderWidth:Ye}=ve;ve.borderWidth=0,_e=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Ue}" stroke-width="${Ye}">`],this.container.classList.add("hasBorder")}const Ie=he-N,Ne=pe-Y,{svgFactory:Te}=this,He=Te.createElement("svg");He.classList.add("quadrilateralsContainer"),He.setAttribute("width",0),He.setAttribute("height",0);const Fe=Te.createElement("defs");He.append(Fe);const Oe=Te.createElement("clipPath"),Ge=`clippath_${this.data.id}`;Oe.setAttribute("id",Ge),Oe.setAttribute("clipPathUnits","objectBoundingBox"),Fe.append(Oe);for(const[,{x:Ue,y:Ye},{x:Je,y:et}]of O){const Qe=Te.createElement("rect"),st=(Je-N)/Ie,nt=(pe-Ye)/Ne,rt=(Ue-Je)/Ie,xs=(Ye-et)/Ne;Qe.setAttribute("x",st),Qe.setAttribute("y",nt),Qe.setAttribute("width",rt),Qe.setAttribute("height",xs),Oe.append(Qe),_e==null||_e.push(`<rect vector-effect="non-scaling-stroke" x="${st}" y="${nt}" width="${rt}" height="${xs}"/>`)}r(this,k)&&(_e.push("</g></svg>')"),ve.backgroundImage=_e.join("")),this.container.append(He),this.container.style.clipPath=`url(#${Ge})`}_createPopup(){const{container:O,data:N}=this;O.setAttribute("aria-haspopup","dialog");const Y=new j({data:{color:N.color,titleObj:N.titleObj,modificationDate:N.modificationDate,contentsObj:N.contentsObj,richText:N.richText,parentRect:N.rect,borderStyle:0,id:`popup_${N.id}`,rotation:N.rotation},parent:this.parent,elements:[this]});this.parent.div.append(Y.render())}render(){(0,e.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(O,N=null){const Y=[];if(this._fieldObjects){const he=this._fieldObjects[O];if(he)for(const{page:pe,id:ve,exportValues:_e}of he){if(pe===-1||ve===N)continue;const Ie=typeof _e=="string"?_e:null,Ne=document.querySelector(`[data-element-id="${ve}"]`);if(Ne&&!v.has(Ne)){(0,e.warn)(`_getElementsByName - element not allowed: ${ve}`);continue}Y.push({id:ve,exportValue:Ie,domElement:Ne})}return Y}for(const he of document.getElementsByName(O)){const{exportValue:pe}=he,ve=he.getAttribute("data-element-id");ve!==N&&v.has(he)&&Y.push({id:ve,exportValue:pe,domElement:he})}return Y}show(){var O;this.container&&(this.container.hidden=!1),(O=this.popup)==null||O.maybeShow()}hide(){var O;this.container&&(this.container.hidden=!0),(O=this.popup)==null||O.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const O=this.getElementsToTriggerPopup();if(Array.isArray(O))for(const N of O)N.classList.add("highlightArea");else O.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:O,data:{id:N}}=this;this.container.addEventListener("dblclick",()=>{var Y;(Y=this.linkService.eventBus)==null||Y.dispatch("switchannotationeditormode",{source:this,mode:O,editId:N})})}};k=new WeakMap;let _=B;class A extends _{constructor(N,Y=null){super(N,{isRenderable:!0,ignoreBorder:!!(Y!=null&&Y.ignoreBorder),createQuadrilaterals:!0});re(this,G);this.isTooltipOnly=N.data.isTooltipOnly}render(){const{data:N,linkService:Y}=this,he=document.createElement("a");he.setAttribute("data-element-id",N.id);let pe=!1;return N.url?(Y.addLinkAttributes(he,N.url,N.newWindow),pe=!0):N.action?(this._bindNamedAction(he,N.action),pe=!0):N.attachment?(this._bindAttachment(he,N.attachment),pe=!0):N.setOCGState?(J(this,G,Ns).call(this,he,N.setOCGState),pe=!0):N.dest?(this._bindLink(he,N.dest),pe=!0):(N.actions&&(N.actions.Action||N.actions["Mouse Up"]||N.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(he,N),pe=!0),N.resetForm?(this._bindResetFormAction(he,N.resetForm),pe=!0):this.isTooltipOnly&&!pe&&(this._bindLink(he,""),pe=!0)),this.container.classList.add("linkAnnotation"),pe&&this.container.append(he),this.container}_bindLink(N,Y){N.href=this.linkService.getDestinationHash(Y),N.onclick=()=>(Y&&this.linkService.goToDestination(Y),!1),(Y||Y==="")&&J(this,G,at).call(this)}_bindNamedAction(N,Y){N.href=this.linkService.getAnchorUrl(""),N.onclick=()=>(this.linkService.executeNamedAction(Y),!1),J(this,G,at).call(this)}_bindAttachment(N,Y){N.href=this.linkService.getAnchorUrl(""),N.onclick=()=>{var he;return(he=this.downloadManager)==null||he.openOrDownloadData(this.container,Y.content,Y.filename),!1},J(this,G,at).call(this)}_bindJSAction(N,Y){N.href=this.linkService.getAnchorUrl("");const he=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const pe of Object.keys(Y.actions)){const ve=he.get(pe);ve&&(N[ve]=()=>{var _e;return(_e=this.linkService.eventBus)==null||_e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Y.id,name:pe}}),!1})}N.onclick||(N.onclick=()=>!1),J(this,G,at).call(this)}_bindResetFormAction(N,Y){const he=N.onclick;if(he||(N.href=this.linkService.getAnchorUrl("")),J(this,G,at).call(this),!this._fieldObjects){(0,e.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),he||(N.onclick=()=>!1);return}N.onclick=()=>{var He;he==null||he();const{fields:pe,refs:ve,include:_e}=Y,Ie=[];if(pe.length!==0||ve.length!==0){const Fe=new Set(ve);for(const Oe of pe){const Ge=this._fieldObjects[Oe]||[];for(const{id:Ue}of Ge)Fe.add(Ue)}for(const Oe of Object.values(this._fieldObjects))for(const Ge of Oe)Fe.has(Ge.id)===_e&&Ie.push(Ge)}else for(const Fe of Object.values(this._fieldObjects))Ie.push(...Fe);const Ne=this.annotationStorage,Te=[];for(const Fe of Ie){const{id:Oe}=Fe;switch(Te.push(Oe),Fe.type){case"text":{const Ue=Fe.defaultValue||"";Ne.setValue(Oe,{value:Ue});break}case"checkbox":case"radiobutton":{const Ue=Fe.defaultValue===Fe.exportValues;Ne.setValue(Oe,{value:Ue});break}case"combobox":case"listbox":{const Ue=Fe.defaultValue||"";Ne.setValue(Oe,{value:Ue});break}default:continue}const Ge=document.querySelector(`[data-element-id="${Oe}"]`);if(Ge){if(!v.has(Ge)){(0,e.warn)(`_bindResetFormAction - element not allowed: ${Oe}`);continue}}else continue;Ge.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((He=this.linkService.eventBus)==null||He.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Te,name:"ResetForm"}})),!1}}}G=new WeakSet,at=function(){this.container.setAttribute("data-internal-link","")},Ns=function(N,Y){N.href=this.linkService.getAnchorUrl(""),N.onclick=()=>(this.linkService.executeSetOCGState(Y),!1),J(this,G,at).call(this)};class f extends _{constructor(O){super(O,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const O=document.createElement("img");return O.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",O.alt="[{{type}} Annotation]",O.dataset.l10nId="text_annotation_type",O.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(O),this.container}}class u extends _{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(O){var N;this.data.hasOwnCanvas&&(((N=O.previousSibling)==null?void 0:N.nodeName)==="CANVAS"&&(O.previousSibling.hidden=!0),O.hidden=!1)}_getKeyModifier(O){const{isWin:N,isMac:Y}=e.FeatureTest.platform;return N&&O.ctrlKey||Y&&O.metaKey}_setEventListener(O,N,Y,he,pe){Y.includes("mouse")?O.addEventListener(Y,ve=>{var _e;(_e=this.linkService.eventBus)==null||_e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:he,value:pe(ve),shift:ve.shiftKey,modifier:this._getKeyModifier(ve)}})}):O.addEventListener(Y,ve=>{var _e;if(Y==="blur"){if(!N.focused||!ve.relatedTarget)return;N.focused=!1}else if(Y==="focus"){if(N.focused)return;N.focused=!0}pe&&((_e=this.linkService.eventBus)==null||_e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:he,value:pe(ve)}}))})}_setEventListeners(O,N,Y,he){var pe,ve,_e;for(const[Ie,Ne]of Y)(Ne==="Action"||(pe=this.data.actions)!=null&&pe[Ne])&&((Ne==="Focus"||Ne==="Blur")&&(N||(N={focused:!1})),this._setEventListener(O,N,Ie,Ne,he),Ne==="Focus"&&!((ve=this.data.actions)!=null&&ve.Blur)?this._setEventListener(O,N,"blur","Blur",null):Ne==="Blur"&&!((_e=this.data.actions)!=null&&_e.Focus)&&this._setEventListener(O,N,"focus","Focus",null))}_setBackgroundColor(O){const N=this.data.backgroundColor||null;O.style.backgroundColor=N===null?"transparent":e.Util.makeHexColor(N[0],N[1],N[2])}_setTextStyle(O){const N=["left","center","right"],{fontColor:Y}=this.data.defaultAppearanceData,he=this.data.defaultAppearanceData.fontSize||c,pe=O.style;let ve;const _e=2,Ie=Ne=>Math.round(10*Ne)/10;if(this.data.multiLine){const Ne=Math.abs(this.data.rect[3]-this.data.rect[1]-_e),Te=Math.round(Ne/(e.LINE_FACTOR*he))||1,He=Ne/Te;ve=Math.min(he,Ie(He/e.LINE_FACTOR))}else{const Ne=Math.abs(this.data.rect[3]-this.data.rect[1]-_e);ve=Math.min(he,Ie(Ne/e.LINE_FACTOR))}pe.fontSize=`calc(${ve}px * var(--scale-factor))`,pe.color=e.Util.makeHexColor(Y[0],Y[1],Y[2]),this.data.textAlignment!==null&&(pe.textAlign=N[this.data.textAlignment])}_setRequired(O,N){N?O.setAttribute("required",!0):O.removeAttribute("required"),O.setAttribute("aria-required",N)}}class C extends u{constructor(O){const N=O.renderForms||!O.data.hasAppearance&&!!O.data.fieldValue;super(O,{isRenderable:N})}setPropertyOnSiblings(O,N,Y,he){const pe=this.annotationStorage;for(const ve of this._getElementsByName(O.name,O.id))ve.domElement&&(ve.domElement[N]=Y),pe.setValue(ve.id,{[he]:Y})}render(){var he,pe;const O=this.annotationStorage,N=this.data.id;this.container.classList.add("textWidgetAnnotation");let Y=null;if(this.renderForms){const ve=O.getValue(N,{value:this.data.fieldValue});let _e=ve.value||"";const Ie=O.getValue(N,{charLimit:this.data.maxLen}).charLimit;Ie&&_e.length>Ie&&(_e=_e.slice(0,Ie));let Ne=ve.formattedValue||((he=this.data.textContent)==null?void 0:he.join(`
`))||null;Ne&&this.data.comb&&(Ne=Ne.replaceAll(/\s+/g,""));const Te={userValue:_e,formattedValue:Ne,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(Y=document.createElement("textarea"),Y.textContent=Ne??_e,this.data.doNotScroll&&(Y.style.overflowY="hidden")):(Y=document.createElement("input"),Y.type="text",Y.setAttribute("value",Ne??_e),this.data.doNotScroll&&(Y.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Y.hidden=!0),v.add(Y),Y.setAttribute("data-element-id",N),Y.disabled=this.data.readOnly,Y.name=this.data.fieldName,Y.tabIndex=E,this._setRequired(Y,this.data.required),Ie&&(Y.maxLength=Ie),Y.addEventListener("input",Fe=>{O.setValue(N,{value:Fe.target.value}),this.setPropertyOnSiblings(Y,"value",Fe.target.value,"value"),Te.formattedValue=null}),Y.addEventListener("resetform",Fe=>{const Oe=this.data.defaultFieldValue??"";Y.value=Te.userValue=Oe,Te.formattedValue=null});let He=Fe=>{const{formattedValue:Oe}=Te;Oe!=null&&(Fe.target.value=Oe),Fe.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Y.addEventListener("focus",Oe=>{if(Te.focused)return;const{target:Ge}=Oe;Te.userValue&&(Ge.value=Te.userValue),Te.lastCommittedValue=Ge.value,Te.commitKey=1,Te.focused=!0}),Y.addEventListener("updatefromsandbox",Oe=>{this.showElementAndHideCanvas(Oe.target);const Ge={value(Ue){Te.userValue=Ue.detail.value??"",O.setValue(N,{value:Te.userValue.toString()}),Ue.target.value=Te.userValue},formattedValue(Ue){const{formattedValue:Ye}=Ue.detail;Te.formattedValue=Ye,Ye!=null&&Ue.target!==document.activeElement&&(Ue.target.value=Ye),O.setValue(N,{formattedValue:Ye})},selRange(Ue){Ue.target.setSelectionRange(...Ue.detail.selRange)},charLimit:Ue=>{var Qe;const{charLimit:Ye}=Ue.detail,{target:Je}=Ue;if(Ye===0){Je.removeAttribute("maxLength");return}Je.setAttribute("maxLength",Ye);let et=Te.userValue;!et||et.length<=Ye||(et=et.slice(0,Ye),Je.value=Te.userValue=et,O.setValue(N,{value:et}),(Qe=this.linkService.eventBus)==null||Qe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:N,name:"Keystroke",value:et,willCommit:!0,commitKey:1,selStart:Je.selectionStart,selEnd:Je.selectionEnd}}))}};this._dispatchEventFromSandbox(Ge,Oe)}),Y.addEventListener("keydown",Oe=>{var Ye;Te.commitKey=1;let Ge=-1;if(Oe.key==="Escape"?Ge=0:Oe.key==="Enter"&&!this.data.multiLine?Ge=2:Oe.key==="Tab"&&(Te.commitKey=3),Ge===-1)return;const{value:Ue}=Oe.target;Te.lastCommittedValue!==Ue&&(Te.lastCommittedValue=Ue,Te.userValue=Ue,(Ye=this.linkService.eventBus)==null||Ye.dispatch("dispatcheventinsandbox",{source:this,detail:{id:N,name:"Keystroke",value:Ue,willCommit:!0,commitKey:Ge,selStart:Oe.target.selectionStart,selEnd:Oe.target.selectionEnd}}))});const Fe=He;He=null,Y.addEventListener("blur",Oe=>{var Ue;if(!Te.focused||!Oe.relatedTarget)return;Te.focused=!1;const{value:Ge}=Oe.target;Te.userValue=Ge,Te.lastCommittedValue!==Ge&&((Ue=this.linkService.eventBus)==null||Ue.dispatch("dispatcheventinsandbox",{source:this,detail:{id:N,name:"Keystroke",value:Ge,willCommit:!0,commitKey:Te.commitKey,selStart:Oe.target.selectionStart,selEnd:Oe.target.selectionEnd}})),Fe(Oe)}),(pe=this.data.actions)!=null&&pe.Keystroke&&Y.addEventListener("beforeinput",Oe=>{var nt;Te.lastCommittedValue=null;const{data:Ge,target:Ue}=Oe,{value:Ye,selectionStart:Je,selectionEnd:et}=Ue;let Qe=Je,st=et;switch(Oe.inputType){case"deleteWordBackward":{const rt=Ye.substring(0,Je).match(/\w*[^\w]*$/);rt&&(Qe-=rt[0].length);break}case"deleteWordForward":{const rt=Ye.substring(Je).match(/^[^\w]*\w*/);rt&&(st+=rt[0].length);break}case"deleteContentBackward":Je===et&&(Qe-=1);break;case"deleteContentForward":Je===et&&(st+=1);break}Oe.preventDefault(),(nt=this.linkService.eventBus)==null||nt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:N,name:"Keystroke",value:Ye,change:Ge||"",willCommit:!1,selStart:Qe,selEnd:st}})}),this._setEventListeners(Y,Te,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Oe=>Oe.target.value)}if(He&&Y.addEventListener("blur",He),this.data.comb){const Oe=(this.data.rect[2]-this.data.rect[0])/Ie;Y.classList.add("comb"),Y.style.letterSpacing=`calc(${Oe}px * var(--scale-factor) - 1ch)`}}else Y=document.createElement("div"),Y.textContent=this.data.fieldValue,Y.style.verticalAlign="middle",Y.style.display="table-cell";return this._setTextStyle(Y),this._setBackgroundColor(Y),this._setDefaultPropertiesFromJS(Y),this.container.append(Y),this.container}}class F extends u{constructor(O){super(O,{isRenderable:!!O.data.hasOwnCanvas})}}class w extends u{constructor(O){super(O,{isRenderable:O.renderForms})}render(){const O=this.annotationStorage,N=this.data,Y=N.id;let he=O.getValue(Y,{value:N.exportValue===N.fieldValue}).value;typeof he=="string"&&(he=he!=="Off",O.setValue(Y,{value:he})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const pe=document.createElement("input");return v.add(pe),pe.setAttribute("data-element-id",Y),pe.disabled=N.readOnly,this._setRequired(pe,this.data.required),pe.type="checkbox",pe.name=N.fieldName,he&&pe.setAttribute("checked",!0),pe.setAttribute("exportValue",N.exportValue),pe.tabIndex=E,pe.addEventListener("change",ve=>{const{name:_e,checked:Ie}=ve.target;for(const Ne of this._getElementsByName(_e,Y)){const Te=Ie&&Ne.exportValue===N.exportValue;Ne.domElement&&(Ne.domElement.checked=Te),O.setValue(Ne.id,{value:Te})}O.setValue(Y,{value:Ie})}),pe.addEventListener("resetform",ve=>{const _e=N.defaultFieldValue||"Off";ve.target.checked=_e===N.exportValue}),this.enableScripting&&this.hasJSActions&&(pe.addEventListener("updatefromsandbox",ve=>{const _e={value(Ie){Ie.target.checked=Ie.detail.value!=="Off",O.setValue(Y,{value:Ie.target.checked})}};this._dispatchEventFromSandbox(_e,ve)}),this._setEventListeners(pe,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ve=>ve.target.checked)),this._setBackgroundColor(pe),this._setDefaultPropertiesFromJS(pe),this.container.append(pe),this.container}}class h extends u{constructor(O){super(O,{isRenderable:O.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const O=this.annotationStorage,N=this.data,Y=N.id;let he=O.getValue(Y,{value:N.fieldValue===N.buttonValue}).value;typeof he=="string"&&(he=he!==N.buttonValue,O.setValue(Y,{value:he}));const pe=document.createElement("input");if(v.add(pe),pe.setAttribute("data-element-id",Y),pe.disabled=N.readOnly,this._setRequired(pe,this.data.required),pe.type="radio",pe.name=N.fieldName,he&&pe.setAttribute("checked",!0),pe.tabIndex=E,pe.addEventListener("change",ve=>{const{name:_e,checked:Ie}=ve.target;for(const Ne of this._getElementsByName(_e,Y))O.setValue(Ne.id,{value:!1});O.setValue(Y,{value:Ie})}),pe.addEventListener("resetform",ve=>{const _e=N.defaultFieldValue;ve.target.checked=_e!=null&&_e===N.buttonValue}),this.enableScripting&&this.hasJSActions){const ve=N.buttonValue;pe.addEventListener("updatefromsandbox",_e=>{const Ie={value:Ne=>{const Te=ve===Ne.detail.value;for(const He of this._getElementsByName(Ne.target.name)){const Fe=Te&&He.id===Y;He.domElement&&(He.domElement.checked=Fe),O.setValue(He.id,{value:Fe})}}};this._dispatchEventFromSandbox(Ie,_e)}),this._setEventListeners(pe,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_e=>_e.target.checked)}return this._setBackgroundColor(pe),this._setDefaultPropertiesFromJS(pe),this.container.append(pe),this.container}}class R extends A{constructor(O){super(O,{ignoreBorder:O.data.hasAppearance})}render(){const O=super.render();O.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(O.title=this.data.alternativeText);const N=O.lastChild;return this.enableScripting&&this.hasJSActions&&N&&(this._setDefaultPropertiesFromJS(N),N.addEventListener("updatefromsandbox",Y=>{this._dispatchEventFromSandbox({},Y)})),O}}class b extends u{constructor(O){super(O,{isRenderable:O.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const O=this.annotationStorage,N=this.data.id,Y=O.getValue(N,{value:this.data.fieldValue}),he=document.createElement("select");v.add(he),he.setAttribute("data-element-id",N),he.disabled=this.data.readOnly,this._setRequired(he,this.data.required),he.name=this.data.fieldName,he.tabIndex=E;let pe=this.data.combo&&this.data.options.length>0;this.data.combo||(he.size=this.data.options.length,this.data.multiSelect&&(he.multiple=!0)),he.addEventListener("resetform",Te=>{const He=this.data.defaultFieldValue;for(const Fe of he.options)Fe.selected=Fe.value===He});for(const Te of this.data.options){const He=document.createElement("option");He.textContent=Te.displayValue,He.value=Te.exportValue,Y.value.includes(Te.exportValue)&&(He.setAttribute("selected",!0),pe=!1),he.append(He)}let ve=null;if(pe){const Te=document.createElement("option");Te.value=" ",Te.setAttribute("hidden",!0),Te.setAttribute("selected",!0),he.prepend(Te),ve=()=>{Te.remove(),he.removeEventListener("input",ve),ve=null},he.addEventListener("input",ve)}const _e=Te=>{const He=Te?"value":"textContent",{options:Fe,multiple:Oe}=he;return Oe?Array.prototype.filter.call(Fe,Ge=>Ge.selected).map(Ge=>Ge[He]):Fe.selectedIndex===-1?null:Fe[Fe.selectedIndex][He]};let Ie=_e(!1);const Ne=Te=>{const He=Te.target.options;return Array.prototype.map.call(He,Fe=>({displayValue:Fe.textContent,exportValue:Fe.value}))};return this.enableScripting&&this.hasJSActions?(he.addEventListener("updatefromsandbox",Te=>{const He={value(Fe){ve==null||ve();const Oe=Fe.detail.value,Ge=new Set(Array.isArray(Oe)?Oe:[Oe]);for(const Ue of he.options)Ue.selected=Ge.has(Ue.value);O.setValue(N,{value:_e(!0)}),Ie=_e(!1)},multipleSelection(Fe){he.multiple=!0},remove(Fe){const Oe=he.options,Ge=Fe.detail.remove;Oe[Ge].selected=!1,he.remove(Ge),Oe.length>0&&Array.prototype.findIndex.call(Oe,Ye=>Ye.selected)===-1&&(Oe[0].selected=!0),O.setValue(N,{value:_e(!0),items:Ne(Fe)}),Ie=_e(!1)},clear(Fe){for(;he.length!==0;)he.remove(0);O.setValue(N,{value:null,items:[]}),Ie=_e(!1)},insert(Fe){const{index:Oe,displayValue:Ge,exportValue:Ue}=Fe.detail.insert,Ye=he.children[Oe],Je=document.createElement("option");Je.textContent=Ge,Je.value=Ue,Ye?Ye.before(Je):he.append(Je),O.setValue(N,{value:_e(!0),items:Ne(Fe)}),Ie=_e(!1)},items(Fe){const{items:Oe}=Fe.detail;for(;he.length!==0;)he.remove(0);for(const Ge of Oe){const{displayValue:Ue,exportValue:Ye}=Ge,Je=document.createElement("option");Je.textContent=Ue,Je.value=Ye,he.append(Je)}he.options.length>0&&(he.options[0].selected=!0),O.setValue(N,{value:_e(!0),items:Ne(Fe)}),Ie=_e(!1)},indices(Fe){const Oe=new Set(Fe.detail.indices);for(const Ge of Fe.target.options)Ge.selected=Oe.has(Ge.index);O.setValue(N,{value:_e(!0)}),Ie=_e(!1)},editable(Fe){Fe.target.disabled=!Fe.detail.editable}};this._dispatchEventFromSandbox(He,Te)}),he.addEventListener("input",Te=>{var Fe;const He=_e(!0);O.setValue(N,{value:He}),Te.preventDefault(),(Fe=this.linkService.eventBus)==null||Fe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:N,name:"Keystroke",value:Ie,changeEx:He,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(he,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Te=>Te.target.value)):he.addEventListener("input",function(Te){O.setValue(N,{value:_e(!0)})}),this.data.combo&&this._setTextStyle(he),this._setBackgroundColor(he),this._setDefaultPropertiesFromJS(he),this.container.append(he),this.container}}class j extends _{constructor(O){const{data:N,elements:Y}=O;super(O,{isRenderable:_._hasPopupData(N)}),this.elements=Y}render(){this.container.classList.add("popupAnnotation");const O=new y({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),N=[];for(const Y of this.elements)Y.popup=O,N.push(Y.data.id),Y.addHighlightArea();return this.container.setAttribute("aria-controls",N.map(Y=>`${e.AnnotationPrefix}${Y}`).join(",")),this.container}}class y{constructor({container:O,color:N,elements:Y,titleObj:he,modificationDate:pe,contentsObj:ve,richText:_e,parent:Ie,rect:Ne,parentRect:Te,open:He}){re(this,Se);re(this,ce,null);re(this,me,J(this,Se,Fs).bind(this));re(this,fe,J(this,Se,rs).bind(this));re(this,be,J(this,Se,ns).bind(this));re(this,Ee,J(this,Se,Ct).bind(this));re(this,je,null);re(this,ie,null);re(this,ae,null);re(this,P,null);re(this,H,null);re(this,Z,null);re(this,ne,!1);re(this,xe,null);re(this,Re,null);re(this,Ae,null);re(this,te,null);re(this,we,!1);var Oe;le(this,ie,O),le(this,te,he),le(this,ae,ve),le(this,Ae,_e),le(this,H,Ie),le(this,je,N),le(this,Re,Ne),le(this,Z,Te),le(this,P,Y);const Fe=s.PDFDateString.toDateObject(pe);Fe&&le(this,ce,Ie.l10n.get("annotation_date_string",{date:Fe.toLocaleDateString(),time:Fe.toLocaleTimeString()})),this.trigger=Y.flatMap(Ge=>Ge.getElementsToTriggerPopup());for(const Ge of this.trigger)Ge.addEventListener("click",r(this,Ee)),Ge.addEventListener("mouseenter",r(this,be)),Ge.addEventListener("mouseleave",r(this,fe)),Ge.classList.add("popupTriggerArea");for(const Ge of Y)(Oe=Ge.container)==null||Oe.addEventListener("keydown",r(this,me));r(this,ie).hidden=!0,He&&J(this,Se,Ct).call(this)}render(){if(r(this,xe))return;const{page:{view:O},viewport:{rawDims:{pageWidth:N,pageHeight:Y,pageX:he,pageY:pe}}}=r(this,H),ve=le(this,xe,document.createElement("div"));if(ve.className="popup",r(this,je)){const Qe=ve.style.outlineColor=e.Util.makeHexColor(...r(this,je));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?ve.style.backgroundColor=`color-mix(in srgb, ${Qe} 30%, white)`:ve.style.backgroundColor=e.Util.makeHexColor(...r(this,je).map(nt=>Math.floor(.7*(255-nt)+nt)))}const _e=document.createElement("span");_e.className="header";const Ie=document.createElement("h1");if(_e.append(Ie),{dir:Ie.dir,str:Ie.textContent}=r(this,te),ve.append(_e),r(this,ce)){const Qe=document.createElement("span");Qe.classList.add("popupDate"),r(this,ce).then(st=>{Qe.textContent=st}),_e.append(Qe)}const Ne=r(this,ae),Te=r(this,Ae);if(Te!=null&&Te.str&&(!(Ne!=null&&Ne.str)||Ne.str===Te.str))S.XfaLayer.render({xfaHtml:Te.html,intent:"richText",div:ve}),ve.lastChild.classList.add("richText","popupContent");else{const Qe=this._formatContents(Ne);ve.append(Qe)}let He=!!r(this,Z),Fe=He?r(this,Z):r(this,Re);for(const Qe of r(this,P))if(!Fe||e.Util.intersect(Qe.data.rect,Fe)!==null){Fe=Qe.data.rect,He=!0;break}const Oe=e.Util.normalizeRect([Fe[0],O[3]-Fe[1]+O[1],Fe[2],O[3]-Fe[3]+O[1]]),Ue=He?Fe[2]-Fe[0]+5:0,Ye=Oe[0]+Ue,Je=Oe[1],{style:et}=r(this,ie);et.left=`${100*(Ye-he)/N}%`,et.top=`${100*(Je-pe)/Y}%`,r(this,ie).append(ve)}_formatContents({str:O,dir:N}){const Y=document.createElement("p");Y.classList.add("popupContent"),Y.dir=N;const he=O.split(/(?:\r\n?|\n)/);for(let pe=0,ve=he.length;pe<ve;++pe){const _e=he[pe];Y.append(document.createTextNode(_e)),pe<ve-1&&Y.append(document.createElement("br"))}return Y}forceHide(){le(this,we,this.isVisible),r(this,we)&&(r(this,ie).hidden=!0)}maybeShow(){r(this,we)&&(le(this,we,!1),r(this,ie).hidden=!1)}get isVisible(){return r(this,ie).hidden===!1}}ce=new WeakMap,me=new WeakMap,fe=new WeakMap,be=new WeakMap,Ee=new WeakMap,je=new WeakMap,ie=new WeakMap,ae=new WeakMap,P=new WeakMap,H=new WeakMap,Z=new WeakMap,ne=new WeakMap,xe=new WeakMap,Re=new WeakMap,Ae=new WeakMap,te=new WeakMap,we=new WeakMap,Se=new WeakSet,Fs=function(O){O.altKey||O.shiftKey||O.ctrlKey||O.metaKey||(O.key==="Enter"||O.key==="Escape"&&r(this,ne))&&J(this,Se,Ct).call(this)},Ct=function(){le(this,ne,!r(this,ne)),r(this,ne)?(J(this,Se,ns).call(this),r(this,ie).addEventListener("click",r(this,Ee)),r(this,ie).addEventListener("keydown",r(this,me))):(J(this,Se,rs).call(this),r(this,ie).removeEventListener("click",r(this,Ee)),r(this,ie).removeEventListener("keydown",r(this,me)))},ns=function(){r(this,xe)||this.render(),this.isVisible?r(this,ne)&&r(this,ie).classList.add("focused"):(r(this,ie).hidden=!1,r(this,ie).style.zIndex=parseInt(r(this,ie).style.zIndex)+1e3)},rs=function(){r(this,ie).classList.remove("focused"),!(r(this,ne)||!this.isVisible)&&(r(this,ie).hidden=!0,r(this,ie).style.zIndex=parseInt(r(this,ie).style.zIndex)-1e3)};class L extends _{constructor(O){super(O,{isRenderable:!0,ignoreBorder:!0}),this.textContent=O.data.textContent,this.textPosition=O.data.textPosition,this.annotationEditorType=e.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const O=document.createElement("div");O.classList.add("annotationTextContent"),O.setAttribute("role","comment");for(const N of this.textContent){const Y=document.createElement("span");Y.textContent=N,O.append(Y)}this.container.append(O)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}t.FreeTextAnnotationElement=L;class g extends _{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0});re(this,ze,null)}render(){this.container.classList.add("lineAnnotation");const N=this.data,{width:Y,height:he}=x(N.rect),pe=this.svgFactory.create(Y,he,!0),ve=le(this,ze,this.svgFactory.createElement("svg:line"));return ve.setAttribute("x1",N.rect[2]-N.lineCoordinates[0]),ve.setAttribute("y1",N.rect[3]-N.lineCoordinates[1]),ve.setAttribute("x2",N.rect[2]-N.lineCoordinates[2]),ve.setAttribute("y2",N.rect[3]-N.lineCoordinates[3]),ve.setAttribute("stroke-width",N.borderStyle.width||1),ve.setAttribute("stroke","transparent"),ve.setAttribute("fill","transparent"),pe.append(ve),this.container.append(pe),!N.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,ze)}addHighlightArea(){this.container.classList.add("highlightArea")}}ze=new WeakMap;class T extends _{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0});re(this,Ke,null)}render(){this.container.classList.add("squareAnnotation");const N=this.data,{width:Y,height:he}=x(N.rect),pe=this.svgFactory.create(Y,he,!0),ve=N.borderStyle.width,_e=le(this,Ke,this.svgFactory.createElement("svg:rect"));return _e.setAttribute("x",ve/2),_e.setAttribute("y",ve/2),_e.setAttribute("width",Y-ve),_e.setAttribute("height",he-ve),_e.setAttribute("stroke-width",ve||1),_e.setAttribute("stroke","transparent"),_e.setAttribute("fill","transparent"),pe.append(_e),this.container.append(pe),!N.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,Ke)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ke=new WeakMap;class z extends _{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0});re(this,$e,null)}render(){this.container.classList.add("circleAnnotation");const N=this.data,{width:Y,height:he}=x(N.rect),pe=this.svgFactory.create(Y,he,!0),ve=N.borderStyle.width,_e=le(this,$e,this.svgFactory.createElement("svg:ellipse"));return _e.setAttribute("cx",Y/2),_e.setAttribute("cy",he/2),_e.setAttribute("rx",Y/2-ve/2),_e.setAttribute("ry",he/2-ve/2),_e.setAttribute("stroke-width",ve||1),_e.setAttribute("stroke","transparent"),_e.setAttribute("fill","transparent"),pe.append(_e),this.container.append(pe),!N.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,$e)}addHighlightArea(){this.container.classList.add("highlightArea")}}$e=new WeakMap;class se extends _{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0});re(this,ye,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const N=this.data,{width:Y,height:he}=x(N.rect),pe=this.svgFactory.create(Y,he,!0);let ve=[];for(const Ie of N.vertices){const Ne=Ie.x-N.rect[0],Te=N.rect[3]-Ie.y;ve.push(Ne+","+Te)}ve=ve.join(" ");const _e=le(this,ye,this.svgFactory.createElement(this.svgElementName));return _e.setAttribute("points",ve),_e.setAttribute("stroke-width",N.borderStyle.width||1),_e.setAttribute("stroke","transparent"),_e.setAttribute("fill","transparent"),pe.append(_e),this.container.append(pe),!N.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,ye)}addHighlightArea(){this.container.classList.add("highlightArea")}}ye=new WeakMap;class V extends se{constructor(O){super(O),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Q extends _{constructor(O){super(O,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class K extends _{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0});re(this,oe,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=e.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const N=this.data,{width:Y,height:he}=x(N.rect),pe=this.svgFactory.create(Y,he,!0);for(const ve of N.inkLists){let _e=[];for(const Ne of ve){const Te=Ne.x-N.rect[0],He=N.rect[3]-Ne.y;_e.push(`${Te},${He}`)}_e=_e.join(" ");const Ie=this.svgFactory.createElement(this.svgElementName);r(this,oe).push(Ie),Ie.setAttribute("points",_e),Ie.setAttribute("stroke-width",N.borderStyle.width||1),Ie.setAttribute("stroke","transparent"),Ie.setAttribute("fill","transparent"),!N.popupRef&&this.hasPopupData&&this._createPopup(),pe.append(Ie)}return this.container.append(pe),this.container}getElementsToTriggerPopup(){return r(this,oe)}addHighlightArea(){this.container.classList.add("highlightArea")}}oe=new WeakMap,t.InkAnnotationElement=K;class ue extends _{constructor(O){super(O,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class I extends _{constructor(O){super(O,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class q extends _{constructor(O){super(O,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class ee extends _{constructor(O){super(O,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class M extends _{constructor(O){super(O,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}t.StampAnnotationElement=M;class l extends _{constructor(N){var pe;super(N,{isRenderable:!0});re(this,Pe);re(this,de,null);const{filename:Y,content:he}=this.data.file;this.filename=(0,s.getFilenameFromUrl)(Y,!0),this.content=he,(pe=this.linkService.eventBus)==null||pe.dispatch("fileattachmentannotation",{source:this,filename:Y,content:he})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:N,data:Y}=this;let he;Y.hasAppearance||Y.fillAlpha===0?he=document.createElement("div"):(he=document.createElement("img"),he.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(Y.name)?"paperclip":"pushpin"}.svg`,Y.fillAlpha&&Y.fillAlpha<1&&(he.style=`filter: opacity(${Math.round(Y.fillAlpha*100)}%);`)),he.addEventListener("dblclick",J(this,Pe,as).bind(this)),le(this,de,he);const{isMac:pe}=e.FeatureTest.platform;return N.addEventListener("keydown",ve=>{ve.key==="Enter"&&(pe?ve.metaKey:ve.ctrlKey)&&J(this,Pe,as).call(this)}),!Y.popupRef&&this.hasPopupData?this._createPopup():he.classList.add("popupTriggerArea"),N.append(he),N}getElementsToTriggerPopup(){return r(this,de)}addHighlightArea(){this.container.classList.add("highlightArea")}}de=new WeakMap,Pe=new WeakSet,as=function(){var N;(N=this.downloadManager)==null||N.openOrDownloadData(this.container,this.content,this.filename)};class d{constructor({div:O,accessibilityManager:N,annotationCanvasMap:Y,l10n:he,page:pe,viewport:ve}){re(this,Ce);re(this,Ve,null);re(this,U,null);re(this,ge,new Map);this.div=O,le(this,Ve,N),le(this,U,Y),this.l10n=he,this.page=pe,this.viewport=ve,this.zIndex=0,this.l10n||(this.l10n=D.NullL10n)}async render(O){const{annotations:N}=O,Y=this.div;(0,s.setLayerDimensions)(Y,this.viewport);const he=new Map,pe={data:null,layer:Y,linkService:O.linkService,downloadManager:O.downloadManager,imageResourcesPath:O.imageResourcesPath||"",renderForms:O.renderForms!==!1,svgFactory:new s.DOMSVGFactory,annotationStorage:O.annotationStorage||new a.AnnotationStorage,enableScripting:O.enableScripting===!0,hasJSActions:O.hasJSActions,fieldObjects:O.fieldObjects,parent:this,elements:null};for(const ve of N){if(ve.noHTML)continue;const _e=ve.annotationType===e.AnnotationType.POPUP;if(_e){const Te=he.get(ve.id);if(!Te)continue;pe.elements=Te}else{const{width:Te,height:He}=x(ve.rect);if(Te<=0||He<=0)continue}pe.data=ve;const Ie=p.create(pe);if(!Ie.isRenderable)continue;if(!_e&&ve.popupRef){const Te=he.get(ve.popupRef);Te?Te.push(Ie):he.set(ve.popupRef,[Ie])}Ie.annotationEditorType>0&&r(this,ge).set(Ie.data.id,Ie);const Ne=Ie.render();ve.hidden&&(Ne.style.visibility="hidden"),J(this,Ce,Ds).call(this,Ne,ve.id)}J(this,Ce,os).call(this),await this.l10n.translate(Y)}update({viewport:O}){const N=this.div;this.viewport=O,(0,s.setLayerDimensions)(N,{rotation:O.rotation}),J(this,Ce,os).call(this),N.hidden=!1}getEditableAnnotations(){return Array.from(r(this,ge).values())}getEditableAnnotation(O){return r(this,ge).get(O)}}Ve=new WeakMap,U=new WeakMap,ge=new WeakMap,Ce=new WeakSet,Ds=function(O,N){var he;const Y=O.firstChild||O;Y.id=`${e.AnnotationPrefix}${N}`,this.div.append(O),(he=r(this,Ve))==null||he.moveElementInDOM(this.div,O,Y,!1)},os=function(){if(!r(this,U))return;const O=this.div;for(const[N,Y]of r(this,U)){const he=O.querySelector(`[data-annotation-id="${N}"]`);if(!he)continue;const{firstChild:pe}=he;pe?pe.nodeName==="CANVAS"?pe.replaceWith(Y):pe.before(Y):he.append(Y)}r(this,U).clear()},t.AnnotationLayer=d},(n,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorConverters=void 0;function i(a){return Math.floor(Math.max(0,Math.min(1,a))*255).toString(16).padStart(2,"0")}function e(a){return Math.max(0,Math.min(255,255*a))}class s{static CMYK_G([o,D,S,E]){return["G",1-Math.min(1,.3*o+.59*S+.11*D+E)]}static G_CMYK([o]){return["CMYK",0,0,0,1-o]}static G_RGB([o]){return["RGB",o,o,o]}static G_rgb([o]){return o=e(o),[o,o,o]}static G_HTML([o]){const D=i(o);return`#${D}${D}${D}`}static RGB_G([o,D,S]){return["G",.3*o+.59*D+.11*S]}static RGB_rgb(o){return o.map(e)}static RGB_HTML(o){return`#${o.map(i).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([o,D,S,E]){return["RGB",1-Math.min(1,o+E),1-Math.min(1,S+E),1-Math.min(1,D+E)]}static CMYK_rgb([o,D,S,E]){return[e(1-Math.min(1,o+E)),e(1-Math.min(1,S+E)),e(1-Math.min(1,D+E))]}static CMYK_HTML(o){const D=this.CMYK_RGB(o).slice(1);return this.RGB_HTML(D)}static RGB_CMYK([o,D,S]){const E=1-o,c=1-D,v=1-S,x=Math.min(E,c,v);return["CMYK",E,c,v,x]}}t.ColorConverters=s},(n,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullL10n=void 0,t.getL10nFallback=e;const i={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};i.print_progress_percent="{{progress}}%";function e(o,D){switch(o){case"find_match_count":o=`find_match_count[${D.total===1?"one":"other"}]`;break;case"find_match_count_limit":o=`find_match_count_limit[${D.limit===1?"one":"other"}]`;break}return i[o]||""}function s(o,D){return D?o.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(S,E)=>E in D?D[E]:"{{"+E+"}}"):o}const a={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(o,D=null,S=e(o,D)){return s(S,D)},async translate(o){}};t.NullL10n=a},(n,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaLayer=void 0;var e=i(25);class s{static setupStorage(o,D,S,E,c){const v=E.getValue(D,{value:null});switch(S.name){case"textarea":if(v.value!==null&&(o.textContent=v.value),c==="print")break;o.addEventListener("input",x=>{E.setValue(D,{value:x.target.value})});break;case"input":if(S.attributes.type==="radio"||S.attributes.type==="checkbox"){if(v.value===S.attributes.xfaOn?o.setAttribute("checked",!0):v.value===S.attributes.xfaOff&&o.removeAttribute("checked"),c==="print")break;o.addEventListener("change",x=>{E.setValue(D,{value:x.target.checked?x.target.getAttribute("xfaOn"):x.target.getAttribute("xfaOff")})})}else{if(v.value!==null&&o.setAttribute("value",v.value),c==="print")break;o.addEventListener("input",x=>{E.setValue(D,{value:x.target.value})})}break;case"select":if(v.value!==null){o.setAttribute("value",v.value);for(const x of S.children)x.attributes.value===v.value?x.attributes.selected=!0:x.attributes.hasOwnProperty("selected")&&delete x.attributes.selected}o.addEventListener("input",x=>{const p=x.target.options,_=p.selectedIndex===-1?"":p[p.selectedIndex].value;E.setValue(D,{value:_})});break}}static setAttributes({html:o,element:D,storage:S=null,intent:E,linkService:c}){const{attributes:v}=D,x=o instanceof HTMLAnchorElement;v.type==="radio"&&(v.name=`${v.name}-${E}`);for(const[p,_]of Object.entries(v))if(_!=null)switch(p){case"class":_.length&&o.setAttribute(p,_.join(" "));break;case"dataId":break;case"id":o.setAttribute("data-element-id",_);break;case"style":Object.assign(o.style,_);break;case"textContent":o.textContent=_;break;default:(!x||p!=="href"&&p!=="newWindow")&&o.setAttribute(p,_)}x&&c.addLinkAttributes(o,v.href,v.newWindow),S&&v.dataId&&this.setupStorage(o,v.dataId,D,S)}static render(o){var A;const D=o.annotationStorage,S=o.linkService,E=o.xfaHtml,c=o.intent||"display",v=document.createElement(E.name);E.attributes&&this.setAttributes({html:v,element:E,intent:c,linkService:S});const x=[[E,-1,v]],p=o.div;if(p.append(v),o.viewport){const f=`matrix(${o.viewport.transform.join(",")})`;p.style.transform=f}c!=="richText"&&p.setAttribute("class","xfaLayer xfaFont");const _=[];for(;x.length>0;){const[f,u,C]=x.at(-1);if(u+1===f.children.length){x.pop();continue}const F=f.children[++x.at(-1)[1]];if(F===null)continue;const{name:w}=F;if(w==="#text"){const R=document.createTextNode(F.value);_.push(R),C.append(R);continue}const h=(A=F==null?void 0:F.attributes)!=null&&A.xmlns?document.createElementNS(F.attributes.xmlns,w):document.createElement(w);if(C.append(h),F.attributes&&this.setAttributes({html:h,element:F,storage:D,intent:c,linkService:S}),F.children&&F.children.length>0)x.push([F,-1,h]);else if(F.value){const R=document.createTextNode(F.value);e.XfaText.shouldBuildText(w)&&_.push(R),h.append(R)}}for(const f of p.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:_}}static update(o){const D=`matrix(${o.viewport.transform.join(",")})`;o.div.style.transform=D,o.div.hidden=!1}}t.XfaLayer=s},(n,t,i)=>{var E,c,v,x,p,_,A,f,u,C,F,w,h,R,b,Is,Os,Ls,zs,ls,Bs,cs,Gs,Ws,Hs,Us,Vs,it,ds,wt,Tt,dt,us,kt,G,qs,hs,Xs,Ks,ps,Pt,ut;Object.defineProperty(t,"__esModule",{value:!0}),t.InkEditor=void 0;var e=i(1),s=i(4),a=i(29),o=i(6),D=i(5);const je=class je extends s.AnnotationEditor{constructor(P){super({...P,name:"inkEditor"});re(this,b);re(this,E,0);re(this,c,0);re(this,v,this.canvasPointermove.bind(this));re(this,x,this.canvasPointerleave.bind(this));re(this,p,this.canvasPointerup.bind(this));re(this,_,this.canvasPointerdown.bind(this));re(this,A,new Path2D);re(this,f,!1);re(this,u,!1);re(this,C,!1);re(this,F,null);re(this,w,0);re(this,h,0);re(this,R,null);this.color=P.color||null,this.thickness=P.thickness||null,this.opacity=P.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(P){s.AnnotationEditor.initialize(P,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(P,H){switch(P){case e.AnnotationEditorParamsType.INK_THICKNESS:je._defaultThickness=H;break;case e.AnnotationEditorParamsType.INK_COLOR:je._defaultColor=H;break;case e.AnnotationEditorParamsType.INK_OPACITY:je._defaultOpacity=H/100;break}}updateParams(P,H){switch(P){case e.AnnotationEditorParamsType.INK_THICKNESS:J(this,b,Is).call(this,H);break;case e.AnnotationEditorParamsType.INK_COLOR:J(this,b,Os).call(this,H);break;case e.AnnotationEditorParamsType.INK_OPACITY:J(this,b,Ls).call(this,H);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,je._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,je._defaultColor||s.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(je._defaultOpacity*100)]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||je._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,this.color||je._defaultColor||s.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??je._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(J(this,b,wt).call(this),J(this,b,Tt).call(this)),this.isAttachedToDOM||(this.parent.add(this),J(this,b,dt).call(this)),J(this,b,ut).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,r(this,F).disconnect(),le(this,F,null),super.remove())}setParent(P){!this.parent&&P?this._uiManager.removeShouldRescale(this):this.parent&&P===null&&this._uiManager.addShouldRescale(this),super.setParent(P)}onScaleChanging(){const[P,H]=this.parentDimensions,Z=this.width*P,ne=this.height*H;this.setDimensions(Z,ne)}enableEditMode(){r(this,f)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",r(this,_)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",r(this,_)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){r(this,f)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),le(this,f,!0),this.div.classList.add("disabled"),J(this,b,ut).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(P){this._focusEventsAllowed&&(super.focusin(P),this.enableEditMode())}canvasPointerdown(P){P.button!==0||!this.isInEditMode()||r(this,f)||(this.setInForeground(),P.preventDefault(),P.type!=="mouse"&&this.div.focus(),J(this,b,Bs).call(this,P.offsetX,P.offsetY))}canvasPointermove(P){P.preventDefault(),J(this,b,cs).call(this,P.offsetX,P.offsetY)}canvasPointerup(P){P.preventDefault(),J(this,b,ds).call(this,P)}canvasPointerleave(P){J(this,b,ds).call(this,P)}get isResizable(){return!this.isEmpty()&&r(this,f)}render(){if(this.div)return this.div;let P,H;this.width&&(P=this.x,H=this.y),super.render(),s.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Ae=>{var te;return(te=this.div)==null?void 0:te.setAttribute("aria-label",Ae)});const[Z,ne,xe,Re]=J(this,b,zs).call(this);if(this.setAt(Z,ne,0,0),this.setDims(xe,Re),J(this,b,wt).call(this),this.width){const[Ae,te]=this.parentDimensions;this.setAspectRatio(this.width*Ae,this.height*te),this.setAt(P*Ae,H*te,this.width*Ae,this.height*te),le(this,C,!0),J(this,b,dt).call(this),this.setDims(this.width*Ae,this.height*te),J(this,b,it).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return J(this,b,Tt).call(this),this.div}setDimensions(P,H){const Z=Math.round(P),ne=Math.round(H);if(r(this,w)===Z&&r(this,h)===ne)return;le(this,w,Z),le(this,h,ne),this.canvas.style.visibility="hidden";const[xe,Re]=this.parentDimensions;this.width=P/xe,this.height=H/Re,this.fixAndSetPosition(),r(this,f)&&J(this,b,us).call(this,P,H),J(this,b,dt).call(this),J(this,b,it).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(P,H,Z){var ze,Ke,$e;if(P instanceof a.InkAnnotationElement)return null;const ne=super.deserialize(P,H,Z);ne.thickness=P.thickness,ne.color=e.Util.makeHexColor(...P.color),ne.opacity=P.opacity;const[xe,Re]=ne.pageDimensions,Ae=ne.width*xe,te=ne.height*Re,we=ne.parentScale,Se=P.thickness/2;le(ne,f,!0),le(ne,w,Math.round(Ae)),le(ne,h,Math.round(te));const{paths:We,rect:Be,rotation:Xe}=P;for(let{bezier:ye}of We){ye=J(ze=je,G,Xs).call(ze,ye,Be,Xe);const oe=[];ne.paths.push(oe);let de=we*(ye[0]-Se),Pe=we*(ye[1]-Se);for(let Ve=2,U=ye.length;Ve<U;Ve+=6){const ge=we*(ye[Ve]-Se),Ce=we*(ye[Ve+1]-Se),De=we*(ye[Ve+2]-Se),Le=we*(ye[Ve+3]-Se),ke=we*(ye[Ve+4]-Se),O=we*(ye[Ve+5]-Se);oe.push([[de,Pe],[ge,Ce],[De,Le],[ke,O]]),de=ke,Pe=O}const qe=J(this,G,qs).call(this,oe);ne.bezierPath2D.push(qe)}const Me=J(Ke=ne,b,ps).call(Ke);return le(ne,c,Math.max(s.AnnotationEditor.MIN_SIZE,Me[2]-Me[0])),le(ne,E,Math.max(s.AnnotationEditor.MIN_SIZE,Me[3]-Me[1])),J($e=ne,b,us).call($e,Ae,te),ne}serialize(){if(this.isEmpty())return null;const P=this.getRect(0,0),H=s.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:e.AnnotationEditorType.INK,color:H,thickness:this.thickness,opacity:this.opacity,paths:J(this,b,Ks).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,P),pageIndex:this.pageIndex,rect:P,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};E=new WeakMap,c=new WeakMap,v=new WeakMap,x=new WeakMap,p=new WeakMap,_=new WeakMap,A=new WeakMap,f=new WeakMap,u=new WeakMap,C=new WeakMap,F=new WeakMap,w=new WeakMap,h=new WeakMap,R=new WeakMap,b=new WeakSet,Is=function(P){const H=this.thickness;this.addCommands({cmd:()=>{this.thickness=P,J(this,b,ut).call(this)},undo:()=>{this.thickness=H,J(this,b,ut).call(this)},mustExec:!0,type:e.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Os=function(P){const H=this.color;this.addCommands({cmd:()=>{this.color=P,J(this,b,it).call(this)},undo:()=>{this.color=H,J(this,b,it).call(this)},mustExec:!0,type:e.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ls=function(P){P/=100;const H=this.opacity;this.addCommands({cmd:()=>{this.opacity=P,J(this,b,it).call(this)},undo:()=>{this.opacity=H,J(this,b,it).call(this)},mustExec:!0,type:e.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},zs=function(){const{parentRotation:P,parentDimensions:[H,Z]}=this;switch(P){case 90:return[0,Z,Z,H];case 180:return[H,Z,H,Z];case 270:return[H,0,Z,H];default:return[0,0,H,Z]}},ls=function(){const{ctx:P,color:H,opacity:Z,thickness:ne,parentScale:xe,scaleFactor:Re}=this;P.lineWidth=ne*xe/Re,P.lineCap="round",P.lineJoin="round",P.miterLimit=10,P.strokeStyle=`${H}${(0,D.opacityToHex)(Z)}`},Bs=function(P,H){this.canvas.addEventListener("contextmenu",o.noContextMenu),this.canvas.addEventListener("pointerleave",r(this,x)),this.canvas.addEventListener("pointermove",r(this,v)),this.canvas.addEventListener("pointerup",r(this,p)),this.canvas.removeEventListener("pointerdown",r(this,_)),this.isEditing=!0,r(this,C)||(le(this,C,!0),J(this,b,dt).call(this),this.thickness||(this.thickness=je._defaultThickness),this.color||(this.color=je._defaultColor||s.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=je._defaultOpacity)),this.currentPath.push([P,H]),le(this,u,!1),J(this,b,ls).call(this),le(this,R,()=>{J(this,b,Hs).call(this),r(this,R)&&window.requestAnimationFrame(r(this,R))}),window.requestAnimationFrame(r(this,R))},cs=function(P,H){const[Z,ne]=this.currentPath.at(-1);if(this.currentPath.length>1&&P===Z&&H===ne)return;const xe=this.currentPath;let Re=r(this,A);if(xe.push([P,H]),le(this,u,!0),xe.length<=2){Re.moveTo(...xe[0]),Re.lineTo(P,H);return}xe.length===3&&(le(this,A,Re=new Path2D),Re.moveTo(...xe[0])),J(this,b,Us).call(this,Re,...xe.at(-3),...xe.at(-2),P,H)},Gs=function(){if(this.currentPath.length===0)return;const P=this.currentPath.at(-1);r(this,A).lineTo(...P)},Ws=function(P,H){le(this,R,null),P=Math.min(Math.max(P,0),this.canvas.width),H=Math.min(Math.max(H,0),this.canvas.height),J(this,b,cs).call(this,P,H),J(this,b,Gs).call(this);let Z;if(this.currentPath.length!==1)Z=J(this,b,Vs).call(this);else{const te=[P,H];Z=[[te,te.slice(),te.slice(),te]]}const ne=r(this,A),xe=this.currentPath;this.currentPath=[],le(this,A,new Path2D);const Re=()=>{this.allRawPaths.push(xe),this.paths.push(Z),this.bezierPath2D.push(ne),this.rebuild()},Ae=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(J(this,b,wt).call(this),J(this,b,Tt).call(this)),J(this,b,ut).call(this))};this.addCommands({cmd:Re,undo:Ae,mustExec:!0})},Hs=function(){if(!r(this,u))return;le(this,u,!1);const P=Math.ceil(this.thickness*this.parentScale),H=this.currentPath.slice(-3),Z=H.map(Re=>Re[0]),ne=H.map(Re=>Re[1]);Math.min(...Z)-P,Math.max(...Z)+P,Math.min(...ne)-P,Math.max(...ne)+P;const{ctx:xe}=this;xe.save(),xe.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Re of this.bezierPath2D)xe.stroke(Re);xe.stroke(r(this,A)),xe.restore()},Us=function(P,H,Z,ne,xe,Re,Ae){const te=(H+ne)/2,we=(Z+xe)/2,Se=(ne+Re)/2,We=(xe+Ae)/2;P.bezierCurveTo(te+2*(ne-te)/3,we+2*(xe-we)/3,Se+2*(ne-Se)/3,We+2*(xe-We)/3,Se,We)},Vs=function(){const P=this.currentPath;if(P.length<=2)return[[P[0],P[0],P.at(-1),P.at(-1)]];const H=[];let Z,[ne,xe]=P[0];for(Z=1;Z<P.length-2;Z++){const[Be,Xe]=P[Z],[Me,ze]=P[Z+1],Ke=(Be+Me)/2,$e=(Xe+ze)/2,ye=[ne+2*(Be-ne)/3,xe+2*(Xe-xe)/3],oe=[Ke+2*(Be-Ke)/3,$e+2*(Xe-$e)/3];H.push([[ne,xe],ye,oe,[Ke,$e]]),[ne,xe]=[Ke,$e]}const[Re,Ae]=P[Z],[te,we]=P[Z+1],Se=[ne+2*(Re-ne)/3,xe+2*(Ae-xe)/3],We=[te+2*(Re-te)/3,we+2*(Ae-we)/3];return H.push([[ne,xe],Se,We,[te,we]]),H},it=function(){if(this.isEmpty()){J(this,b,kt).call(this);return}J(this,b,ls).call(this);const{canvas:P,ctx:H}=this;H.setTransform(1,0,0,1,0,0),H.clearRect(0,0,P.width,P.height),J(this,b,kt).call(this);for(const Z of this.bezierPath2D)H.stroke(Z)},ds=function(P){this.canvas.removeEventListener("pointerleave",r(this,x)),this.canvas.removeEventListener("pointermove",r(this,v)),this.canvas.removeEventListener("pointerup",r(this,p)),this.canvas.addEventListener("pointerdown",r(this,_)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",o.noContextMenu)},10),J(this,b,Ws).call(this,P.offsetX,P.offsetY),this.addToAnnotationStorage(),this.setInBackground()},wt=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",s.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(P=>{var H;return(H=this.canvas)==null?void 0:H.setAttribute("aria-label",P)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Tt=function(){le(this,F,new ResizeObserver(P=>{const H=P[0].contentRect;H.width&&H.height&&this.setDimensions(H.width,H.height)})),r(this,F).observe(this.div)},dt=function(){if(!r(this,C))return;const[P,H]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*P),this.canvas.height=Math.ceil(this.height*H),J(this,b,kt).call(this)},us=function(P,H){const Z=J(this,b,Pt).call(this),ne=(P-Z)/r(this,c),xe=(H-Z)/r(this,E);this.scaleFactor=Math.min(ne,xe)},kt=function(){const P=J(this,b,Pt).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+P,this.translationY*this.scaleFactor+P)},G=new WeakSet,qs=function(P){const H=new Path2D;for(let Z=0,ne=P.length;Z<ne;Z++){const[xe,Re,Ae,te]=P[Z];Z===0&&H.moveTo(...xe),H.bezierCurveTo(Re[0],Re[1],Ae[0],Ae[1],te[0],te[1])}return H},hs=function(P,H,Z){const[ne,xe,Re,Ae]=H;switch(Z){case 0:for(let te=0,we=P.length;te<we;te+=2)P[te]+=ne,P[te+1]=Ae-P[te+1];break;case 90:for(let te=0,we=P.length;te<we;te+=2){const Se=P[te];P[te]=P[te+1]+ne,P[te+1]=Se+xe}break;case 180:for(let te=0,we=P.length;te<we;te+=2)P[te]=Re-P[te],P[te+1]+=xe;break;case 270:for(let te=0,we=P.length;te<we;te+=2){const Se=P[te];P[te]=Re-P[te+1],P[te+1]=Ae-Se}break;default:throw new Error("Invalid rotation")}return P},Xs=function(P,H,Z){const[ne,xe,Re,Ae]=H;switch(Z){case 0:for(let te=0,we=P.length;te<we;te+=2)P[te]-=ne,P[te+1]=Ae-P[te+1];break;case 90:for(let te=0,we=P.length;te<we;te+=2){const Se=P[te];P[te]=P[te+1]-xe,P[te+1]=Se-ne}break;case 180:for(let te=0,we=P.length;te<we;te+=2)P[te]=Re-P[te],P[te+1]-=xe;break;case 270:for(let te=0,we=P.length;te<we;te+=2){const Se=P[te];P[te]=Ae-P[te+1],P[te+1]=Re-Se}break;default:throw new Error("Invalid rotation")}return P},Ks=function(P,H,Z,ne){var we,Se;const xe=[],Re=this.thickness/2,Ae=P*H+Re,te=P*Z+Re;for(const We of this.paths){const Be=[],Xe=[];for(let Me=0,ze=We.length;Me<ze;Me++){const[Ke,$e,ye,oe]=We[Me],de=P*Ke[0]+Ae,Pe=P*Ke[1]+te,qe=P*$e[0]+Ae,Ve=P*$e[1]+te,U=P*ye[0]+Ae,ge=P*ye[1]+te,Ce=P*oe[0]+Ae,De=P*oe[1]+te;Me===0&&(Be.push(de,Pe),Xe.push(de,Pe)),Be.push(qe,Ve,U,ge,Ce,De),Xe.push(qe,Ve),Me===ze-1&&Xe.push(Ce,De)}xe.push({bezier:J(we=je,G,hs).call(we,Be,ne,this.rotation),points:J(Se=je,G,hs).call(Se,Xe,ne,this.rotation)})}return xe},ps=function(){let P=1/0,H=-1/0,Z=1/0,ne=-1/0;for(const xe of this.paths)for(const[Re,Ae,te,we]of xe){const Se=e.Util.bezierBoundingBox(...Re,...Ae,...te,...we);P=Math.min(P,Se[0]),Z=Math.min(Z,Se[1]),H=Math.max(H,Se[2]),ne=Math.max(ne,Se[3])}return[P,Z,H,ne]},Pt=function(){return r(this,f)?Math.ceil(this.thickness*this.parentScale):0},ut=function(P=!1){if(this.isEmpty())return;if(!r(this,f)){J(this,b,it).call(this);return}const H=J(this,b,ps).call(this),Z=J(this,b,Pt).call(this);le(this,c,Math.max(s.AnnotationEditor.MIN_SIZE,H[2]-H[0])),le(this,E,Math.max(s.AnnotationEditor.MIN_SIZE,H[3]-H[1]));const ne=Math.ceil(Z+r(this,c)*this.scaleFactor),xe=Math.ceil(Z+r(this,E)*this.scaleFactor),[Re,Ae]=this.parentDimensions;this.width=ne/Re,this.height=xe/Ae,this.setAspectRatio(ne,xe);const te=this.translationX,we=this.translationY;this.translationX=-H[0],this.translationY=-H[1],J(this,b,dt).call(this),J(this,b,it).call(this),le(this,w,ne),le(this,h,xe),this.setDims(ne,xe);const Se=P?Z/this.scaleFactor/2:0;this.translate(te-this.translationX-Se,we-this.translationY-Se)},re(je,G),Ze(je,"_defaultColor",null),Ze(je,"_defaultOpacity",1),Ze(je,"_defaultThickness",1),Ze(je,"_type","ink");let S=je;t.InkEditor=S},(n,t,i)=>{var S,E,c,v,x,p,_,A,f,u,C,bt,vt,Mt,ms,Ys,$s,fs,Nt,Js;Object.defineProperty(t,"__esModule",{value:!0}),t.StampEditor=void 0;var e=i(1),s=i(4),a=i(6),o=i(29);const T=class T extends s.AnnotationEditor{constructor(V){super({...V,name:"stampEditor"});re(this,C);re(this,S,null);re(this,E,null);re(this,c,null);re(this,v,null);re(this,x,null);re(this,p,null);re(this,_,null);re(this,A,null);re(this,f,!1);re(this,u,!1);le(this,v,V.bitmapUrl),le(this,x,V.bitmapFile)}static initialize(V){s.AnnotationEditor.initialize(V)}static get supportedTypes(){const V=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,e.shadow)(this,"supportedTypes",V.map(Q=>`image/${Q}`))}static get supportedTypesStr(){return(0,e.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(V){return this.supportedTypes.includes(V)}static paste(V,Q){Q.pasteEditor(e.AnnotationEditorType.STAMP,{bitmapFile:V.getAsFile()})}remove(){var V,Q;r(this,E)&&(le(this,S,null),this._uiManager.imageManager.deleteId(r(this,E)),(V=r(this,p))==null||V.remove(),le(this,p,null),(Q=r(this,_))==null||Q.disconnect(),le(this,_,null)),super.remove()}rebuild(){if(!this.parent){r(this,E)&&J(this,C,Mt).call(this);return}super.rebuild(),this.div!==null&&(r(this,E)&&J(this,C,Mt).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(r(this,c)||r(this,S)||r(this,v)||r(this,x))}get isResizable(){return!0}render(){if(this.div)return this.div;let V,Q;if(this.width&&(V=this.x,Q=this.y),super.render(),this.div.hidden=!0,r(this,S)?J(this,C,ms).call(this):J(this,C,Mt).call(this),this.width){const[K,ue]=this.parentDimensions;this.setAt(V*K,Q*ue,this.width*K,this.height*ue)}return this.div}static deserialize(V,Q,K){if(V instanceof o.StampAnnotationElement)return null;const ue=super.deserialize(V,Q,K),{rect:I,bitmapUrl:q,bitmapId:ee,isSvg:M,accessibilityData:l}=V;ee&&K.imageManager.isValidId(ee)?le(ue,E,ee):le(ue,v,q),le(ue,f,M);const[d,k]=ue.pageDimensions;return ue.width=(I[2]-I[0])/d,ue.height=(I[3]-I[1])/k,l&&(ue.altTextData=l),ue}serialize(V=!1,Q=null){if(this.isEmpty())return null;const K={annotationType:e.AnnotationEditorType.STAMP,bitmapId:r(this,E),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:r(this,f),structTreeParentId:this._structTreeParentId};if(V)return K.bitmapUrl=J(this,C,Nt).call(this,!0),K.accessibilityData=this.altTextData,K;const{decorative:ue,altText:I}=this.altTextData;if(!ue&&I&&(K.accessibilityData={type:"Figure",alt:I}),Q===null)return K;Q.stamps||(Q.stamps=new Map);const q=r(this,f)?(K.rect[2]-K.rect[0])*(K.rect[3]-K.rect[1]):null;if(!Q.stamps.has(r(this,E)))Q.stamps.set(r(this,E),{area:q,serialized:K}),K.bitmap=J(this,C,Nt).call(this,!1);else if(r(this,f)){const ee=Q.stamps.get(r(this,E));q>ee.area&&(ee.area=q,ee.serialized.bitmap.close(),ee.serialized.bitmap=J(this,C,Nt).call(this,!1))}return K}};S=new WeakMap,E=new WeakMap,c=new WeakMap,v=new WeakMap,x=new WeakMap,p=new WeakMap,_=new WeakMap,A=new WeakMap,f=new WeakMap,u=new WeakMap,C=new WeakSet,bt=function(V,Q=!1){if(!V){this.remove();return}le(this,S,V.bitmap),Q||(le(this,E,V.id),le(this,f,V.isSvg)),J(this,C,ms).call(this)},vt=function(){le(this,c,null),this._uiManager.enableWaiting(!1),r(this,p)&&this.div.focus()},Mt=function(){if(r(this,E)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(r(this,E)).then(Q=>J(this,C,bt).call(this,Q,!0)).finally(()=>J(this,C,vt).call(this));return}if(r(this,v)){const Q=r(this,v);le(this,v,null),this._uiManager.enableWaiting(!0),le(this,c,this._uiManager.imageManager.getFromUrl(Q).then(K=>J(this,C,bt).call(this,K)).finally(()=>J(this,C,vt).call(this)));return}if(r(this,x)){const Q=r(this,x);le(this,x,null),this._uiManager.enableWaiting(!0),le(this,c,this._uiManager.imageManager.getFromFile(Q).then(K=>J(this,C,bt).call(this,K)).finally(()=>J(this,C,vt).call(this)));return}const V=document.createElement("input");V.type="file",V.accept=T.supportedTypesStr,le(this,c,new Promise(Q=>{V.addEventListener("change",async()=>{if(!V.files||V.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const K=await this._uiManager.imageManager.getFromFile(V.files[0]);J(this,C,bt).call(this,K)}Q()}),V.addEventListener("cancel",()=>{this.remove(),Q()})}).finally(()=>J(this,C,vt).call(this))),V.click()},ms=function(){const{div:V}=this;let{width:Q,height:K}=r(this,S);const[ue,I]=this.pageDimensions,q=.75;if(this.width)Q=this.width*ue,K=this.height*I;else if(Q>q*ue||K>q*I){const d=Math.min(q*ue/Q,q*I/K);Q*=d,K*=d}const[ee,M]=this.parentDimensions;this.setDims(Q*ee/ue,K*M/I),this._uiManager.enableWaiting(!1);const l=le(this,p,document.createElement("canvas"));V.append(l),V.hidden=!1,J(this,C,fs).call(this,Q,K),J(this,C,Js).call(this),r(this,u)||(this.parent.addUndoableEditor(this),le(this,u,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},Ys=function(V,Q){var q;const[K,ue]=this.parentDimensions;this.width=V/K,this.height=Q/ue,this.setDims(V,Q),(q=this._initialOptions)!=null&&q.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,r(this,A)!==null&&clearTimeout(r(this,A)),le(this,A,setTimeout(()=>{le(this,A,null),J(this,C,fs).call(this,V,Q)},200))},$s=function(V,Q){const{width:K,height:ue}=r(this,S);let I=K,q=ue,ee=r(this,S);for(;I>2*V||q>2*Q;){const M=I,l=q;I>2*V&&(I=I>=16384?Math.floor(I/2)-1:Math.ceil(I/2)),q>2*Q&&(q=q>=16384?Math.floor(q/2)-1:Math.ceil(q/2));const d=new OffscreenCanvas(I,q);d.getContext("2d").drawImage(ee,0,0,M,l,0,0,I,q),ee=d.transferToImageBitmap()}return ee},fs=function(V,Q){V=Math.ceil(V),Q=Math.ceil(Q);const K=r(this,p);if(!K||K.width===V&&K.height===Q)return;K.width=V,K.height=Q;const ue=r(this,f)?r(this,S):J(this,C,$s).call(this,V,Q),I=K.getContext("2d");I.filter=this._uiManager.hcmFilter,I.drawImage(ue,0,0,ue.width,ue.height,0,0,V,Q)},Nt=function(V){if(V){if(r(this,f)){const ue=this._uiManager.imageManager.getSvgUrl(r(this,E));if(ue)return ue}const Q=document.createElement("canvas");return{width:Q.width,height:Q.height}=r(this,S),Q.getContext("2d").drawImage(r(this,S),0,0),Q.toDataURL()}if(r(this,f)){const[Q,K]=this.pageDimensions,ue=Math.round(this.width*Q*a.PixelsPerInch.PDF_TO_CSS_UNITS),I=Math.round(this.height*K*a.PixelsPerInch.PDF_TO_CSS_UNITS),q=new OffscreenCanvas(ue,I);return q.getContext("2d").drawImage(r(this,S),0,0,r(this,S).width,r(this,S).height,0,0,ue,I),q.transferToImageBitmap()}return structuredClone(r(this,S))},Js=function(){le(this,_,new ResizeObserver(V=>{const Q=V[0].contentRect;Q.width&&Q.height&&J(this,C,Ys).call(this,Q.width,Q.height)})),r(this,_).observe(this.div)},Ze(T,"_type","stamp");let D=T;t.StampEditor=D}],__webpack_module_cache__={};function __w_pdfjs_require__(n){var t=__webpack_module_cache__[n];if(t!==void 0)return t.exports;var i=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n](i,i.exports,__w_pdfjs_require__),i.exports}var __webpack_exports__={};return(()=>{var n=__webpack_exports__;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"AbortException",{enumerable:!0,get:function(){return t.AbortException}}),Object.defineProperty(n,"AnnotationEditorLayer",{enumerable:!0,get:function(){return a.AnnotationEditorLayer}}),Object.defineProperty(n,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return t.AnnotationEditorParamsType}}),Object.defineProperty(n,"AnnotationEditorType",{enumerable:!0,get:function(){return t.AnnotationEditorType}}),Object.defineProperty(n,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return o.AnnotationEditorUIManager}}),Object.defineProperty(n,"AnnotationLayer",{enumerable:!0,get:function(){return D.AnnotationLayer}}),Object.defineProperty(n,"AnnotationMode",{enumerable:!0,get:function(){return t.AnnotationMode}}),Object.defineProperty(n,"CMapCompressionType",{enumerable:!0,get:function(){return t.CMapCompressionType}}),Object.defineProperty(n,"DOMSVGFactory",{enumerable:!0,get:function(){return e.DOMSVGFactory}}),Object.defineProperty(n,"FeatureTest",{enumerable:!0,get:function(){return t.FeatureTest}}),Object.defineProperty(n,"GlobalWorkerOptions",{enumerable:!0,get:function(){return S.GlobalWorkerOptions}}),Object.defineProperty(n,"ImageKind",{enumerable:!0,get:function(){return t.ImageKind}}),Object.defineProperty(n,"InvalidPDFException",{enumerable:!0,get:function(){return t.InvalidPDFException}}),Object.defineProperty(n,"MissingPDFException",{enumerable:!0,get:function(){return t.MissingPDFException}}),Object.defineProperty(n,"OPS",{enumerable:!0,get:function(){return t.OPS}}),Object.defineProperty(n,"PDFDataRangeTransport",{enumerable:!0,get:function(){return i.PDFDataRangeTransport}}),Object.defineProperty(n,"PDFDateString",{enumerable:!0,get:function(){return e.PDFDateString}}),Object.defineProperty(n,"PDFWorker",{enumerable:!0,get:function(){return i.PDFWorker}}),Object.defineProperty(n,"PasswordResponses",{enumerable:!0,get:function(){return t.PasswordResponses}}),Object.defineProperty(n,"PermissionFlag",{enumerable:!0,get:function(){return t.PermissionFlag}}),Object.defineProperty(n,"PixelsPerInch",{enumerable:!0,get:function(){return e.PixelsPerInch}}),Object.defineProperty(n,"PromiseCapability",{enumerable:!0,get:function(){return t.PromiseCapability}}),Object.defineProperty(n,"RenderingCancelledException",{enumerable:!0,get:function(){return e.RenderingCancelledException}}),Object.defineProperty(n,"SVGGraphics",{enumerable:!0,get:function(){return i.SVGGraphics}}),Object.defineProperty(n,"UnexpectedResponseException",{enumerable:!0,get:function(){return t.UnexpectedResponseException}}),Object.defineProperty(n,"Util",{enumerable:!0,get:function(){return t.Util}}),Object.defineProperty(n,"VerbosityLevel",{enumerable:!0,get:function(){return t.VerbosityLevel}}),Object.defineProperty(n,"XfaLayer",{enumerable:!0,get:function(){return E.XfaLayer}}),Object.defineProperty(n,"build",{enumerable:!0,get:function(){return i.build}}),Object.defineProperty(n,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return t.createValidAbsoluteUrl}}),Object.defineProperty(n,"getDocument",{enumerable:!0,get:function(){return i.getDocument}}),Object.defineProperty(n,"getFilenameFromUrl",{enumerable:!0,get:function(){return e.getFilenameFromUrl}}),Object.defineProperty(n,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return e.getPdfFilenameFromUrl}}),Object.defineProperty(n,"getXfaPageViewport",{enumerable:!0,get:function(){return e.getXfaPageViewport}}),Object.defineProperty(n,"isDataScheme",{enumerable:!0,get:function(){return e.isDataScheme}}),Object.defineProperty(n,"isPdfFile",{enumerable:!0,get:function(){return e.isPdfFile}}),Object.defineProperty(n,"loadScript",{enumerable:!0,get:function(){return e.loadScript}}),Object.defineProperty(n,"noContextMenu",{enumerable:!0,get:function(){return e.noContextMenu}}),Object.defineProperty(n,"normalizeUnicode",{enumerable:!0,get:function(){return t.normalizeUnicode}}),Object.defineProperty(n,"renderTextLayer",{enumerable:!0,get:function(){return s.renderTextLayer}}),Object.defineProperty(n,"setLayerDimensions",{enumerable:!0,get:function(){return e.setLayerDimensions}}),Object.defineProperty(n,"shadow",{enumerable:!0,get:function(){return t.shadow}}),Object.defineProperty(n,"updateTextLayer",{enumerable:!0,get:function(){return s.updateTextLayer}}),Object.defineProperty(n,"version",{enumerable:!0,get:function(){return i.version}});var t=__w_pdfjs_require__(1),i=__w_pdfjs_require__(2),e=__w_pdfjs_require__(6),s=__w_pdfjs_require__(26),a=__w_pdfjs_require__(27),o=__w_pdfjs_require__(5),D=__w_pdfjs_require__(29),S=__w_pdfjs_require__(14),E=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;pdfExports.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`;function detectPDFType(n,t){const i=n.toUpperCase(),e=t.toUpperCase();return e.includes("B03")||i.includes("TOPSIDE")||i.includes("RISER P5")||i.includes("RISER P6")?"B03_TOPSIDE":e.includes("B05")||i.includes("SUBSEA")||i.includes("PE_4")||i.includes("PE_EO")?"B05_SUBSEA":e.includes("PVT")||e.includes("CALIBRATION")||i.includes("K-FACTORS")||i.includes("MOLAR COMPOSITION")?"PVT_CALIBRATION":"UNKNOWN"}function extractDate(n,t){const i=t.match(/(\d{8})/);if(i){const s=i[1];return`${s.slice(0,4)}-${s.slice(4,6)}-${s.slice(6,8)}`}const e=n.match(/(\d{4})[/-](\d{2})[/-](\d{2})/);return e?`${e[1]}-${e[2]}-${e[3]}`:new Date().toISOString().split("T")[0]}function extractNumber(n,t){const i=n.match(t);if(i){const e=i[1].replace(",",".");return parseFloat(e)||0}return 0}function parseB03Topside(n,t){const i=extractDate(n,t);let e="13FT0367";(n.includes("P6")||n.includes("13FT0417"))&&(e="13FT0417");let s=extractNumber(n,/(?:oil|óleo)[\s:]+(\d+\.?\d*)/i),a=extractNumber(n,/(?:gas|gás)[\s:]+(\d+\.?\d*)/i),o=extractNumber(n,/(?:water|água)[\s:]+(\d+\.?\d*)/i);if(s===0){const x=n.match(/Oil\s+(\d+\.?\d*)/i);x&&(s=parseFloat(x[1])||0)}if(a===0){const x=n.match(/Gas\s+(\d+\.?\d*)/i);x&&(a=parseFloat(x[1])||0)}if(o===0){const x=n.match(/Water\s+(\d+\.?\d*)/i);x&&(o=parseFloat(x[1])||0)}const D=/(\d{3,5}\.?\d*)\s*(?:t|ton)/gi,S=[];let E;for(;(E=D.exec(n))!==null;)S.push(parseFloat(E[1]));S.length>=3&&s===0&&(s=S[0],a=S[1],o=S[2]||0);const c=s+a,v=c+o;return{date:i,source:"TOPSIDE",meterTag:e,oil:s,gas:a,water:o,hc:c,total:v,fileName:t}}function parseB05Subsea(n,t){const i=extractDate(n,t);let e="18FT1506";n.includes("PE_EO4")||n.includes("18FT1806")?e="18FT1806":n.includes("PE_EO105")||n.includes("18FT1706")?e="18FT1706":(n.includes("PE_EO10")||n.includes("18FT1406"))&&(e="18FT1406");let s=extractNumber(n,/(?:oil|óleo)[\s:]+(\d+\.?\d*)/i),a=extractNumber(n,/(?:gas|gás)[\s:]+(\d+\.?\d*)/i),o=extractNumber(n,/(?:water|água)[\s:]+(\d+\.?\d*)/i);if(a===0){const x=n.match(/(?:hc|hydrocarbon)[\s:]+(\d+\.?\d*)/i);x&&(s=parseFloat(x[1])||0)}const D=/(\d{3,5}\.?\d*)\s*(?:t|ton)/gi,S=[];let E;for(;(E=D.exec(n))!==null;)S.push(parseFloat(E[1]));S.length>=2&&s===0&&(s=S[0],o=S[1]||0);const c=s+a,v=c+o;return{date:i,source:"SUBSEA",meterTag:e,oil:s,gas:a,water:o,hc:c,total:v,fileName:t}}function parsePVTCalibration(n,t){const i=n.match(/(?:calibration|cal\.?)\s*(?:#|no\.?|number)?\s*(\d+)/i),e=i?parseInt(i[1]):0;let s="13FT0367",a="Riser P5";n.includes("13FT0417")&&(s="13FT0417",a="Riser P6");const o=extractDate(n,t),D=n.match(/end[:\s]+(\d{4}-\d{2}-\d{2})/i),S=D?D[1]:o,E=extractNumber(n,/mpfm.*?pressure[:\s]+(\d+\.?\d*)/i)||extractNumber(n,/pressure.*?mpfm[:\s]+(\d+\.?\d*)/i)||11505.73,c=extractNumber(n,/separator.*?pressure[:\s]+(\d+\.?\d*)/i)||extractNumber(n,/pressure.*?separator[:\s]+(\d+\.?\d*)/i)||8343.63,v=extractNumber(n,/mpfm.*?temp[:\s]+(\d+\.?\d*)/i)||extractNumber(n,/temp.*?mpfm[:\s]+(\d+\.?\d*)/i)||75.07,x=extractNumber(n,/separator.*?temp[:\s]+(\d+\.?\d*)/i)||extractNumber(n,/temp.*?separator[:\s]+(\d+\.?\d*)/i)||72.18,p=[{component:"N₂",molPercent:.575,molecularWeight:28.01},{component:"CO₂",molPercent:.02,molecularWeight:44.01},{component:"C₁",molPercent:62.183,molecularWeight:16.04},{component:"C₂",molPercent:8.069,molecularWeight:30.07},{component:"C₃",molPercent:5.047,molecularWeight:44.1},{component:"i-C₄",molPercent:1.069,molecularWeight:58.12},{component:"n-C₄",molPercent:1.858,molecularWeight:58.12},{component:"i-C₅",molPercent:.681,molecularWeight:72.15},{component:"n-C₅",molPercent:.788,molecularWeight:72.15},{component:"C₆",molPercent:1.112,molecularWeight:86.18},{component:"C₇",molPercent:1.138,molecularWeight:97.37},{component:"C₈",molPercent:1.657,molecularWeight:111.29},{component:"C₉",molPercent:1.472,molecularWeight:125.25},{component:"C₁₀+",molPercent:14.331,molecularWeight:289.64}],_=extractNumber(n,/k[_-]?oil.*?new[:\s]+(\d+\.?\d*)/i)||extractNumber(n,/new.*?k[_-]?oil[:\s]+(\d+\.?\d*)/i)||1.0908,A=extractNumber(n,/k[_-]?gas.*?new[:\s]+(\d+\.?\d*)/i)||extractNumber(n,/new.*?k[_-]?gas[:\s]+(\d+\.?\d*)/i)||1.09262,f=extractNumber(n,/k[_-]?water.*?new[:\s]+(\d+\.?\d*)/i)||1,u=extractNumber(n,/mpfm.*?oil.*?(\d{4,}\.?\d*)/i)||6365.07,C=extractNumber(n,/mpfm.*?gas.*?(\d{3,}\.?\d*)/i)||1476.18,F=extractNumber(n,/mpfm.*?water.*?(\d+\.?\d*)/i)||1.46,w=extractNumber(n,/separator.*?oil.*?(\d{4,}\.?\d*)/i)||6742.65,h=extractNumber(n,/separator.*?gas.*?(\d{3,}\.?\d*)/i)||1813.28,R=extractNumber(n,/separator.*?water.*?(\d+\.?\d*)/i)||24.93;return{calibrationNo:e,meterTag:s,meterName:a,startDate:o,endDate:S,pressure:{mpfm:E,separator:c},temperature:{mpfm:v,separator:x},composition:p,kFactors:{oil:{used:.94433,new:_},gas:{used:.96191,new:A},water:{used:1,new:f}},accumulatedMass:{mpfm:{oil:u,gas:C,water:F,hc:u+C},separator:{oil:w,gas:h,water:R,hc:w+h}},fileName:t}}async function extractTextFromPDF(n){const t=await n.arrayBuffer(),i=await pdfExports.getDocument({data:t}).promise;let e="";for(let s=1;s<=i.numPages;s++){const D=(await(await i.getPage(s)).getTextContent()).items.filter(S=>"str"in S).map(S=>S.str).join(" ");e+=D+`
`}return e}async function parsePDFFile(n){try{const t=await extractTextFromPDF(n),i=detectPDFType(t,n.name);switch(i){case"B03_TOPSIDE":return{success:!0,type:i,dailyData:parseB03Topside(t,n.name),fileName:n.name};case"B05_SUBSEA":return{success:!0,type:i,dailyData:parseB05Subsea(t,n.name),fileName:n.name};case"PVT_CALIBRATION":return{success:!0,type:i,calibrationData:parsePVTCalibration(t,n.name),fileName:n.name};default:return{success:!1,type:"UNKNOWN",error:"Tipo de PDF não reconhecido. Use arquivos B03 (Topside), B05 (Subsea) ou PVT Calibration.",fileName:n.name}}}catch(t){return{success:!1,type:"UNKNOWN",error:t instanceof Error?t.message:"Erro ao processar PDF",fileName:n.name}}}async function parsePDFBatch(n){const t=[];for(const i of n){const e=await parsePDFFile(i);t.push(e)}return t}const ImportDataModal=({isOpen:n,onClose:t})=>{const{importMonitoringData:i,addAlert:e,updateMeter:s,meters:a}=useAppStore(),[o,D]=reactExports.useState([]),[S,E]=reactExports.useState([]),[c,v]=reactExports.useState(!1),[x,p]=reactExports.useState(!1),_=reactExports.useRef(null),A=reactExports.useCallback(y=>{y.preventDefault(),p(!0)},[]),f=reactExports.useCallback(y=>{y.preventDefault(),p(!1)},[]),u=reactExports.useCallback(y=>{y.preventDefault(),p(!1);const L=Array.from(y.dataTransfer.files).filter(g=>g.type==="application/pdf"||g.name.endsWith(".pdf"));L.length>0&&D(g=>[...g,...L])},[]),C=y=>{const L=Array.from(y.target.files||[]).filter(g=>g.type==="application/pdf"||g.name.endsWith(".pdf"));L.length>0&&D(g=>[...g,...L]),_.current&&(_.current.value="")},F=y=>{D(L=>L.filter((g,T)=>T!==y)),E(L=>L.filter((g,T)=>T!==y))},w=async()=>{if(o.length!==0){v(!0),E([]);try{const y=await parsePDFBatch(o);E(y)}catch{e({type:"error",severity:"critical",message:"Erro ao processar arquivos PDF"})}finally{v(!1)}}},h=()=>{const y=S.filter(T=>T.success);if(y.length===0){e({type:"error",severity:"warning",message:"Nenhum dado válido para importar"});return}const L=new Map;y.forEach(T=>{if(T.dailyData){const z=T.dailyData.date,se=L.get(z)||{};T.dailyData.source==="TOPSIDE"?se.topside=T.dailyData:se.subsea=T.dailyData,L.set(z,se)}if(T.calibrationData){const z=a.find(se=>se.tag===T.calibrationData.meterTag);z&&(s(z.id,{kOil:T.calibrationData.kFactors.oil.new,kGas:T.calibrationData.kFactors.gas.new,kWater:T.calibrationData.kFactors.water.new,lastCalibration:T.calibrationData.endDate}),e({type:"success",severity:"info",message:`K-factors do medidor ${z.tag} atualizados pela calibração`,meterId:z.id,meterTag:z.tag}))}});const g=[];L.forEach((T,z)=>{const se=T.subsea,V=T.topside,Q=(se==null?void 0:se.oil)||0,K=(se==null?void 0:se.gas)||0,ue=(se==null?void 0:se.water)||0,I=Q+K,q=(V==null?void 0:V.oil)||0,ee=(V==null?void 0:V.gas)||0,M=(V==null?void 0:V.water)||0,l=q+ee,d=q*.98,k=ee*.99,B=M,G=d+k,W=I>0?(l-I)/I*100:0,$=I+ue,ce=l+M,me=$>0?(ce-$)/$*100:0,fe=Math.abs(W)>10?"FAIL":Math.abs(W)>7?"ALERT":"OK",be=Math.abs(me)>7?"FAIL":Math.abs(me)>5?"ALERT":"OK";g.push({id:`mon-${z}-${Date.now()}`,date:z,subOil:Q,subGas:K,subWater:ue,subHC:I,topOil:q,topGas:ee,topWater:M,topHC:l,sepOil:d,sepGas:k,sepWater:B,sepHC:G,hcBalTS:parseFloat(W.toFixed(2)),totalBalTS:parseFloat(me.toFixed(2)),hcBalancePercent:parseFloat(W.toFixed(2)),totalBalancePercent:parseFloat(me.toFixed(2)),hcStatus:fe,totalStatus:be,action:fe==="FAIL"||be==="FAIL"?"INVESTIGAR":"MONITORAR",subVsTS:parseFloat(W.toFixed(2)),topVsTS:0,topVsSub:parseFloat(((l-I)/(I||1)*100).toFixed(2))})}),g.length>0&&(i(g),e({type:"success",severity:"info",message:`${g.length} registro(s) de produção importado(s) com sucesso`})),R()},R=()=>{D([]),E([]),v(!1),t()},b=S.filter(y=>y.success).length,j=S.filter(y=>!y.success).length;return jsxRuntimeExports.jsx(Modal,{isOpen:n,onClose:R,title:"Importar Relatórios PDF",size:"lg",children:jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-blue-300",children:"Arraste e solte arquivos PDF ou clique para selecionar. São aceitos:"}),jsxRuntimeExports.jsxs("ul",{className:"text-xs text-blue-300/80 mt-2 space-y-1 ml-4",children:[jsxRuntimeExports.jsxs("li",{children:["• ",jsxRuntimeExports.jsx("strong",{children:"B03_MPFM_Daily"})," - Relatórios Topside (Riser P5/P6)"]}),jsxRuntimeExports.jsxs("li",{children:["• ",jsxRuntimeExports.jsx("strong",{children:"B05_MPFM_Daily"})," - Relatórios Subsea (PE_4, PE_EO)"]}),jsxRuntimeExports.jsxs("li",{children:["• ",jsxRuntimeExports.jsx("strong",{children:"PVTCalibration"})," - Relatórios de Calibração PVT"]})]})]}),jsxRuntimeExports.jsxs("div",{onDragOver:A,onDragLeave:f,onDrop:u,onClick:()=>{var y;return(y=_.current)==null?void 0:y.click()},className:cn("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-all",x?"border-blue-500 bg-blue-500/10":"border-zinc-600 hover:border-zinc-500 hover:bg-zinc-800/50"),children:[jsxRuntimeExports.jsx("input",{ref:_,type:"file",accept:".pdf",multiple:!0,onChange:C,className:"hidden"}),jsxRuntimeExports.jsx(FileUp,{size:48,className:cn("mx-auto mb-3",x?"text-blue-400":"text-zinc-500")}),jsxRuntimeExports.jsx("p",{className:"text-zinc-300 font-medium",children:x?"Solte os arquivos aqui":"Arraste PDFs ou clique para selecionar"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Suporta múltiplos arquivos (importação em lote)"})]}),o.length>0&&jsxRuntimeExports.jsxs(Card,{className:"p-3 bg-zinc-800/50 max-h-48 overflow-y-auto",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsxs("span",{className:"text-sm font-medium text-zinc-300",children:[o.length," arquivo(s) selecionado(s)"]}),S.length>0&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[b>0&&jsxRuntimeExports.jsxs(Badge,{variant:"success",children:[b," OK"]}),j>0&&jsxRuntimeExports.jsxs(Badge,{variant:"error",children:[j," Erro"]})]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:o.map((y,L)=>{const g=S[L];return jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-2 bg-zinc-900/50 rounded",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[jsxRuntimeExports.jsx(FileText,{size:16,className:"text-zinc-400 flex-shrink-0"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-zinc-300 truncate",children:y.name})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[g&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:g.success?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(CheckCircle,{size:14,className:"text-emerald-400"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-emerald-400",children:g.type.replace("_"," ")})]}):jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(XCircle,{size:14,className:"text-red-400"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-red-400 max-w-32 truncate",children:g.error})]})}),jsxRuntimeExports.jsx("button",{onClick:T=>{T.stopPropagation(),F(L)},className:"p-1 text-zinc-500 hover:text-red-400 transition-colors",children:jsxRuntimeExports.jsx(Trash2,{size:14})})]})]},L)})})]}),S.length>0&&b>0&&jsxRuntimeExports.jsxs(Card,{className:"p-3 bg-emerald-500/10 border-emerald-500/30",children:[jsxRuntimeExports.jsxs("h4",{className:"text-sm font-medium text-emerald-400 mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Database,{size:16}),"Dados Prontos para Importação"]}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-emerald-300/80 space-y-1",children:[S.filter(y=>y.success&&y.dailyData).length>0&&jsxRuntimeExports.jsxs("p",{children:["• ",S.filter(y=>y.dailyData).length," registro(s) de produção diária"]}),S.filter(y=>y.success&&y.calibrationData).length>0&&jsxRuntimeExports.jsxs("p",{children:["• ",S.filter(y=>y.calibrationData).length," relatório(s) de calibração"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 pt-2 border-t border-zinc-800",children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",onClick:R,children:"Cancelar"}),S.length===0?jsxRuntimeExports.jsx(Button,{variant:"primary",onClick:w,disabled:o.length===0||c,children:c?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader2,{size:16,className:"animate-spin mr-2"}),"Processando..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Upload,{size:16,className:"mr-2"}),"Processar PDFs"]})}):jsxRuntimeExports.jsxs(Button,{variant:"primary",onClick:h,disabled:b===0,children:[jsxRuntimeExports.jsx(Database,{size:16,className:"mr-2"}),"Importar ",b," Registro(s)"]})]})]})})};function objectsToCSV(n,t){if(n.length===0)return"";const i=t||Object.keys(n[0]).map(a=>({key:a,header:String(a)})),e=i.map(a=>`"${a.header}"`).join(","),s=n.map(a=>i.map(o=>{const D=a[o.key];return D==null?"":typeof D=="string"?`"${D.replace(/"/g,'""')}"`:String(D)}).join(","));return[e,...s].join(`
`)}function downloadFile(n,t,i){const e=new Blob([n],{type:i}),s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)}function exportMonitoringDataToCSV(n){const i=objectsToCSV(n,[{key:"date",header:"Data"},{key:"subOil",header:"Subsea Óleo (t)"},{key:"subGas",header:"Subsea Gás (t)"},{key:"subHC",header:"Subsea HC (t)"},{key:"topOil",header:"Topside Óleo (t)"},{key:"topGas",header:"Topside Gás (t)"},{key:"topHC",header:"Topside HC (t)"},{key:"sepOil",header:"Separador Óleo (t)"},{key:"sepGas",header:"Separador Gás (t)"},{key:"sepHC",header:"Separador HC (t)"},{key:"hcBalTS",header:"Balanço HC (%)"},{key:"totalBalTS",header:"Balanço Total (%)"},{key:"hcStatus",header:"Status HC"},{key:"action",header:"Ação"}]),e=new Date().toISOString().split("T")[0];downloadFile(i,`monitoramento_mpfm_${e}.csv`,"text/csv;charset=utf-8")}function exportMetersToCSV(n){const i=objectsToCSV(n,[{key:"tag",header:"TAG"},{key:"name",header:"Nome"},{key:"location",header:"Localização"},{key:"status",header:"Status"},{key:"manufacturer",header:"Fabricante"},{key:"model",header:"Modelo"},{key:"serialNumber",header:"Número de Série"},{key:"lastCalibration",header:"Última Calibração"},{key:"kOil",header:"K-Oil"},{key:"kGas",header:"K-Gas"},{key:"kWater",header:"K-Water"},{key:"daysToCalibration",header:"Dias para Calibração"}]),e=new Date().toISOString().split("T")[0];downloadFile(i,`medidores_mpfm_${e}.csv`,"text/csv;charset=utf-8")}function exportCalibrationEventsToCSV(n){const i=objectsToCSV(n,[{key:"id",header:"ID Evento"},{key:"meterTag",header:"TAG Medidor"},{key:"meterName",header:"Nome Medidor"},{key:"type",header:"Tipo"},{key:"status",header:"Status"},{key:"result",header:"Resultado"},{key:"startDate",header:"Data Início"},{key:"endDate",header:"Data Fim"},{key:"currentStep",header:"Etapa Atual"},{key:"progress",header:"Progresso (%)"},{key:"responsible",header:"Responsável"}]),e=new Date().toISOString().split("T")[0];downloadFile(i,`calibracoes_mpfm_${e}.csv`,"text/csv;charset=utf-8")}function exportAllDataToJSON(n,t){const i={version:"1.0.0",exportDate:new Date().toISOString(),...n},e=JSON.stringify(i,null,2),s=new Date().toISOString().split("T")[0];downloadFile(e,`${t||"mpfm_backup"}_${s}.json`,"application/json")}function generateCalibrationReport(n){const t=new Date().toLocaleString("pt-BR");return`
================================================================================
                    RELATÓRIO DE AVALIAÇÃO DE DESEMPENHO MPFM
                           CONFORME RANP 44/2015
================================================================================

ID do Evento: ${n.id}
Data de Emissão: ${t}

DADOS DO MEDIDOR
--------------------------------------------------------------------------------
TAG: ${n.meterTag}
Nome: ${n.meterName}
Tipo de Avaliação: ${n.type}

STATUS DA AVALIAÇÃO
--------------------------------------------------------------------------------
Status: ${n.status}
Resultado: ${n.result||"Pendente"}
Etapa Atual: ${n.currentStep}/7
Progresso: ${n.progress}%

PERÍODO
--------------------------------------------------------------------------------
Data de Início: ${n.startDate}
Data de Término: ${n.endDate||"Em andamento"}

RESPONSÁVEL
--------------------------------------------------------------------------------
${n.responsible}

================================================================================
                           FIM DO RELATÓRIO
================================================================================
`}function exportCalibrationReport(n){const t=generateCalibrationReport(n),i=new Date().toISOString().split("T")[0];downloadFile(t,`relatorio_${n.id}_${i}.txt`,"text/plain;charset=utf-8")}const ExportDataModal=({isOpen:n,onClose:t})=>{const{monitoringData:i,meters:e,calibrationEvents:s,selectedEvent:a}=useAppStore(),[o,D]=reactExports.useState("monitoring"),[S,E]=reactExports.useState("csv"),[c,v]=reactExports.useState(!1),x=async()=>{v(!0);try{switch(o){case"monitoring":S==="csv"?exportMonitoringDataToCSV(i):exportAllDataToJSON({monitoringData:i},"monitoring_data");break;case"meters":S==="csv"?exportMetersToCSV(e):exportAllDataToJSON({meters:e},"meters");break;case"calibration":S==="csv"?exportCalibrationEventsToCSV(s):exportAllDataToJSON({calibrationEvents:s},"calibration_events");break;case"all":exportAllDataToJSON({monitoringData:i,meters:e,calibrationEvents:s},"mpfm_monitor_backup");break;case"report":a&&exportCalibrationReport(a);break}t()}catch(p){console.error("Erro ao exportar:",p)}finally{v(!1)}};return jsxRuntimeExports.jsx(Modal,{isOpen:n,onClose:t,title:"Exportar Dados",size:"lg",children:jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"O que deseja exportar?"}),jsxRuntimeExports.jsx(Select,{value:o,onChange:p=>D(p.target.value),options:[{value:"monitoring",label:"Dados de Monitoramento"},{value:"meters",label:"Cadastro de Medidores"},{value:"calibration",label:"Eventos de Calibração"},{value:"all",label:"Backup Completo"},...a?[{value:"report",label:"Relatório de Calibração (Evento Selecionado)"}]:[]]})]}),o!=="all"&&o!=="report"&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Formato"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsxs("label",{className:"flex items-center",children:[jsxRuntimeExports.jsx("input",{type:"radio",name:"format",value:"csv",checked:S==="csv",onChange:p=>E(p.target.value),className:"mr-2"}),"CSV (Excel)"]}),jsxRuntimeExports.jsxs("label",{className:"flex items-center",children:[jsxRuntimeExports.jsx("input",{type:"radio",name:"format",value:"json",checked:S==="json",onChange:p=>E(p.target.value),className:"mr-2"}),"JSON"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Resumo"}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[o==="monitoring"&&jsxRuntimeExports.jsxs("p",{children:["📊 ",i.length," registros de monitoramento"]}),o==="meters"&&jsxRuntimeExports.jsxs("p",{children:["📍 ",e.length," medidores cadastrados"]}),o==="calibration"&&jsxRuntimeExports.jsxs("p",{children:["🔧 ",s.length," eventos de calibração"]}),o==="all"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("p",{children:["📊 ",i.length," registros de monitoramento"]}),jsxRuntimeExports.jsxs("p",{children:["📍 ",e.length," medidores"]}),jsxRuntimeExports.jsxs("p",{children:["🔧 ",s.length," eventos de calibração"]})]}),o==="report"&&a&&jsxRuntimeExports.jsxs("p",{children:["📄 Relatório para evento: ",a.id]})]})]}),o==="all"&&jsxRuntimeExports.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-yellow-700",children:"⚠️ O backup completo será exportado em formato JSON. Guarde este arquivo em local seguro para restauração futura."})}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",onClick:t,children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{type:"button",variant:"primary",onClick:x,disabled:c||o==="report"&&!a,children:c?"Exportando...":"Exportar"})]})]})})},NewCalibrationModal=({isOpen:n,onClose:t})=>{const{meters:i,addCalibrationEvent:e,setSelectedEvent:s}=useAppStore(),[a,o]=reactExports.useState(""),[D,S]=reactExports.useState("Periódica"),[E,c]=reactExports.useState(""),[v,x]=reactExports.useState({}),p=i.filter(u=>u.status==="active"),_=()=>{const u={};return a||(u.meterId="Selecione um medidor"),D||(u.type="Selecione o tipo de avaliação"),x(u),Object.keys(u).length===0},A=u=>{if(u.preventDefault(),!_())return;const C=i.find(w=>w.id===a);if(!C)return;const F=e(C,D);s(F),o(""),S("Periódica"),c(""),x({}),t()},f=()=>{o(""),S("Periódica"),c(""),x({}),t()};return jsxRuntimeExports.jsx(Modal,{isOpen:n,onClose:f,title:"Nova Avaliação de Calibração",size:"md",children:jsxRuntimeExports.jsxs("form",{onSubmit:A,className:"space-y-6",children:[p.length===0&&jsxRuntimeExports.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-yellow-700",children:"⚠️ Nenhum medidor ativo cadastrado. Adicione um medidor antes de criar uma avaliação de calibração."})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Select,{label:"Medidor MPFM *",value:a,onChange:u=>{o(u.target.value),x(C=>({...C,meterId:""}))},options:[{value:"",label:"Selecione um medidor..."},...p.map(u=>({value:u.id,label:`${u.tag} - ${u.name} (${u.location})`}))],error:v.meterId})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Select,{label:"Tipo de Avaliação *",value:D,onChange:u=>{S(u.target.value),x(C=>({...C,type:""}))},options:[{value:"Comissionamento",label:"Comissionamento - Primeira calibração do medidor"},{value:"Periódica",label:"Periódica - Calibração regular (anual)"},{value:"Especial",label:"Especial - Após manutenção ou alteração"},{value:"Investigação",label:"Investigação - Desvio detectado no monitoramento"}],error:v.type})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Input,{label:"Ordem de Serviço (Opcional)",placeholder:"Ex: OS-2024-001",value:E,onChange:u=>c(u.target.value)})}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Etapas da Avaliação"}),jsxRuntimeExports.jsxs("ol",{className:"text-xs text-blue-700 list-decimal list-inside space-y-1",children:[jsxRuntimeExports.jsx("li",{children:"Registro e Identificação"}),jsxRuntimeExports.jsx("li",{children:"Configuração PVT"}),jsxRuntimeExports.jsx("li",{children:"Totalizadores"}),jsxRuntimeExports.jsx("li",{children:"Cálculo K-Factors"}),jsxRuntimeExports.jsx("li",{children:"Balanço de Massas"}),jsxRuntimeExports.jsx("li",{children:"Monitoramento Pós"}),jsxRuntimeExports.jsx("li",{children:"Registro de Alarmes"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",onClick:f,children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{type:"submit",variant:"primary",disabled:p.length===0,children:"Iniciar Avaliação"})]})]})})};function useInitializeRealData(){const n=useAppStore(i=>i.meters),t=reactExports.useRef(!1);reactExports.useEffect(()=>{t.current||(t.current=!0,n.length===0&&(console.log("[MPFM] Inicializando medidores do FPSO Bacalhau..."),realMeters.forEach(i=>{useAppStore.setState(e=>({meters:[...e.meters,{...i,id:`meter-${i.tag}`}]}))})),console.log("[MPFM] Inicialização concluída! Importe PDFs para popular dados de produção."))},[n.length])}function App(){useInitializeRealData();const{showMeterModal:n,setShowMeterModal:t,showImportModal:i,setShowImportModal:e,showExportModal:s,setShowExportModal:a,showNewEventModal:o,setShowNewEventModal:D,editingMeter:S,setEditingMeter:E}=useAppStore(),c=()=>{t(!1),E(null)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Layout,{children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(Navigate,{to:"/monitoring",replace:!0})}),jsxRuntimeExports.jsx(Route,{path:"/monitoring",element:jsxRuntimeExports.jsx(MonitoringPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/calibration",element:jsxRuntimeExports.jsx(CalibrationPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/compliance",element:jsxRuntimeExports.jsx(CompliancePage,{})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(Navigate,{to:"/monitoring",replace:!0})})]})}),jsxRuntimeExports.jsx(NewMeterModal,{isOpen:n,onClose:c,editingMeter:S}),jsxRuntimeExports.jsx(ImportDataModal,{isOpen:i,onClose:()=>e(!1)}),jsxRuntimeExports.jsx(ExportDataModal,{isOpen:s,onClose:()=>a(!1)}),jsxRuntimeExports.jsx(NewCalibrationModal,{isOpen:o,onClose:()=>D(!1)})]})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React$2.StrictMode,{children:jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsx(App,{})})}));
//# sourceMappingURL=index-DQChN_u4.js.map
